var app=function(){"use strict";function t(){}const e=t=>t;function n(t){return t()}function r(){return Object.create(null)}function i(t){t.forEach(n)}function o(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function a(e,n,r){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function u(t){return null==t?"":t}const c="undefined"!=typeof window;let h=c?()=>window.performance.now():()=>Date.now(),l=c?t=>requestAnimationFrame(t):t;const f=new Set;function p(t){f.forEach((e=>{e.c(t)||(f.delete(e),e.f())})),0!==f.size&&l(p)}function d(t,e){t.appendChild(e)}function y(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function g(t){const e=w("style");return function(t,e){d(t.head||t,e)}(y(t),e),e}function v(t,e,n){t.insertBefore(e,n||null)}function m(t){t.parentNode.removeChild(t)}function b(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function w(t){return document.createElement(t)}function E(t){return document.createTextNode(t)}function I(){return E(" ")}function _(){return E("")}function T(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function S(t){return function(e){return e.preventDefault(),t.call(this,e)}}function N(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function A(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function D(t,e){t.value=null==e?"":e}function C(t,e){for(let n=0;n<t.options.length;n+=1){const r=t.options[n];if(r.__value===e)return void(r.selected=!0)}t.selectedIndex=-1}function k(t,e,n){t.classList[n?"add":"remove"](e)}function x(t,e,n=!1){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,!1,e),r}const R=new Set;let O,L=0;function P(t,e,n,r,i,o,s,a=0){const u=16.666/r;let c="{\n";for(let t=0;t<=1;t+=u){const r=e+(n-e)*o(t);c+=100*t+`%{${s(r,1-r)}}\n`}const h=c+`100% {${s(n,1-n)}}\n}`,l=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(h)}_${a}`,f=y(t);R.add(f);const p=f.__svelte_stylesheet||(f.__svelte_stylesheet=g(t).sheet),d=f.__svelte_rules||(f.__svelte_rules={});d[l]||(d[l]=!0,p.insertRule(`@keyframes ${l} ${h}`,p.cssRules.length));const v=t.style.animation||"";return t.style.animation=`${v?`${v}, `:""}${l} ${r}ms linear ${i}ms 1 both`,L+=1,l}function F(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),i=n.length-r.length;i&&(t.style.animation=r.join(", "),L-=i,L||l((()=>{L||(R.forEach((t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}})),R.clear())})))}function M(t){O=t}function V(){if(!O)throw new Error("Function called outside component initialization");return O}function U(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const q=[],j=[],B=[],$=[],K=Promise.resolve();let z=!1;function G(t){B.push(t)}let H=!1;const Q=new Set;function W(){if(!H){H=!0;do{for(let t=0;t<q.length;t+=1){const e=q[t];M(e),Y(e.$$)}for(M(null),q.length=0;j.length;)j.pop()();for(let t=0;t<B.length;t+=1){const e=B[t];Q.has(e)||(Q.add(e),e())}B.length=0}while(q.length);for(;$.length;)$.pop()();z=!1,H=!1,Q.clear()}}function Y(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(G)}}let X;function J(t,e,n){t.dispatchEvent(x(`${e?"intro":"outro"}${n}`))}const Z=new Set;let tt;function et(){tt={r:0,c:[],p:tt}}function nt(){tt.r||i(tt.c),tt=tt.p}function rt(t,e){t&&t.i&&(Z.delete(t),t.i(e))}function it(t,e,n,r){if(t&&t.o){if(Z.has(t))return;Z.add(t),tt.c.push((()=>{Z.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}const ot={duration:0};function st(n,r,s,a){let u=r(n,s),c=a?0:1,d=null,y=null,g=null;function v(){g&&F(n,g)}function m(t,e){const n=t.b-c;return e*=Math.abs(n),{a:c,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function b(r){const{delay:o=0,duration:s=300,easing:a=e,tick:b=t,css:w}=u||ot,E={start:h()+o,b:r};r||(E.group=tt,tt.r+=1),d||y?y=E:(w&&(v(),g=P(n,c,r,s,o,a,w)),r&&b(0,1),d=m(E,s),G((()=>J(n,r,"start"))),function(t){let e;0===f.size&&l(p),new Promise((n=>{f.add(e={c:t,f:n})}))}((t=>{if(y&&t>y.start&&(d=m(y,s),y=null,J(n,d.b,"start"),w&&(v(),g=P(n,c,d.b,d.duration,0,a,u.css))),d)if(t>=d.end)b(c=d.b,1-c),J(n,d.b,"end"),y||(d.b?v():--d.group.r||i(d.group.c)),d=null;else if(t>=d.start){const e=t-d.start;c=d.a+d.d*a(e/d.duration),b(c,1-c)}return!(!d&&!y)})))}return{run(t){o(u)?(X||(X=Promise.resolve(),X.then((()=>{X=null}))),X).then((()=>{u=u(),b(t)})):b(t)},end(){v(),d=y=null}}}function at(t,e){it(t,1,1,(()=>{e.delete(t.key)}))}function ut(t){t&&t.c()}function ct(t,e,r,s){const{fragment:a,on_mount:u,on_destroy:c,after_update:h}=t.$$;a&&a.m(e,r),s||G((()=>{const e=u.map(n).filter(o);c?c.push(...e):i(e),t.$$.on_mount=[]})),h.forEach(G)}function ht(t,e){const n=t.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function lt(t,e){-1===t.$$.dirty[0]&&(q.push(t),z||(z=!0,K.then(W)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ft(e,n,o,s,a,u,c,h=[-1]){const l=O;M(e);const f=e.$$={fragment:null,ctx:null,props:u,update:t,not_equal:a,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(l?l.$$.context:[])),callbacks:r(),dirty:h,skip_bound:!1,root:n.target||l.$$.root};c&&c(f.root);let p=!1;if(f.ctx=o?o(e,n.props||{},((t,n,...r)=>{const i=r.length?r[0]:n;return f.ctx&&a(f.ctx[t],f.ctx[t]=i)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](i),p&&lt(e,t)),n})):[],f.update(),p=!0,i(f.before_update),f.fragment=!!s&&s(f.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);f.fragment&&f.fragment.l(t),t.forEach(m)}else f.fragment&&f.fragment.c();n.intro&&rt(e.$$.fragment),ct(e,n.target,n.anchor,n.customElement),W()}M(l)}class pt{$destroy(){ht(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const dt=[];function yt(e,n=t){let r;const i=new Set;function o(t){if(s(e,t)&&(e=t,r)){const t=!dt.length;for(const t of i)t[1](),dt.push(t,e);if(t){for(let t=0;t<dt.length;t+=2)dt[t][0](dt[t+1]);dt.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(s,a=t){const u=[s,a];return i.add(u),1===i.size&&(r=n(o)||t),s(e),()=>{i.delete(u),0===i.size&&(r(),r=null)}}}}var gt,vt=new Uint8Array(16);function mt(){if(!gt&&!(gt="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return gt(vt)}var bt=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function wt(t){return"string"==typeof t&&bt.test(t)}for(var Et=[],It=0;It<256;++It)Et.push((It+256).toString(16).substr(1));function _t(t,e,n){var r=(t=t||{}).random||(t.rng||mt)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(Et[t[e+0]]+Et[t[e+1]]+Et[t[e+2]]+Et[t[e+3]]+"-"+Et[t[e+4]]+Et[t[e+5]]+"-"+Et[t[e+6]]+Et[t[e+7]]+"-"+Et[t[e+8]]+Et[t[e+9]]+"-"+Et[t[e+10]]+Et[t[e+11]]+Et[t[e+12]]+Et[t[e+13]]+Et[t[e+14]]+Et[t[e+15]]).toLowerCase();if(!wt(n))throw TypeError("Stringified UUID is invalid");return n}(r)}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var Tt=function(t,e){return Tt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},Tt(t,e)};function St(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Tt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Nt=function(){return Nt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Nt.apply(this,arguments)};function At(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function Dt(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function Ct(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function kt(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function xt(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Rt=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},Ot={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|a>>4,f=(15&a)<<2|c>>6,p=63&c;u||(p=64,s||(f=64)),r.push(n[h],n[l],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Rt(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();var c=o<<2|s>>4;if(r.push(c),64!==a){var h=s<<4&240|a>>2;if(r.push(h),64!==u){var l=a<<6&192|u;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},Lt=function(t){return function(t){var e=Rt(t);return Ot.encodeByteArray(e,!0)}(t).replace(/\./g,"")};function Pt(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=Pt(t[n],e[n]));return t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Ft=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Mt(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Vt(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Ut=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,qt.prototype.create),o}return St(e,t),e}(Error),qt=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?jt(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new Ut(i,a,r);return u},t}();function jt(t,e){return t.replace(Bt,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var Bt=/\{\$([^}]+)}/g;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function $t(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Kt(t,e){var n=new zt(t,e);return n.subscribe.bind(n)}var zt=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n},void 0===r.next&&(r.next=Gt),void 0===r.error&&(r.error=Gt),void 0===r.complete&&(r.complete=Gt);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function Gt(){}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ht(t){return t&&t._delegate?t._delegate:t}var Qt=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),Wt="[DEFAULT]",Yt=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new Ft;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(r)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t))try{this.getOrInitializeService({instanceIdentifier:Wt})}catch(t){}try{for(var r=Ct(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=kt(i.value,2),s=o[0],a=o[1],u=this.normalizeInstanceIdentifier(s);try{var c=this.getOrInitializeService({instanceIdentifier:u});a.resolve(c)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=Wt),this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return At(this,void 0,void 0,(function(){var t;return Dt(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(xt(xt([],kt(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),kt(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=Wt),this.instances.has(t)},t.prototype.getOptions=function(t){return void 0===t&&(t=Wt),this.instancesOptions.get(t)||{}},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var r=t.options,i=void 0===r?{}:r,o=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(o))throw Error(this.name+"("+o+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var s=this.getOrInitializeService({instanceIdentifier:o,options:i});try{for(var a=Ct(this.instancesDeferred.entries()),u=a.next();!u.done;u=a.next()){var c=kt(u.value,2),h=c[0],l=c[1];o===this.normalizeInstanceIdentifier(h)&&l.resolve(s)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return s},t.prototype.onInit=function(t,e){var n,r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&t(o,r),function(){i.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,r,i=this.onInitCallbacks.get(e);if(i)try{for(var o=Ct(i),s=o.next();!s.done;s=o.next()){var a=s.value;try{a(t,e)}catch(t){}}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===Wt?void 0:e),options:i}),this.instances.set(n,o),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(o,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(t){}return o||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=Wt),this.component?this.component.multipleInstances?t:Wt:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Xt,Jt=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new Yt(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function Zt(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var te,ee=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(te||(te={}));var ne,re={debug:te.DEBUG,verbose:te.VERBOSE,info:te.INFO,warn:te.WARN,error:te.ERROR,silent:te.SILENT},ie=te.INFO,oe=((Xt={})[te.DEBUG]="log",Xt[te.VERBOSE]="log",Xt[te.INFO]="info",Xt[te.WARN]="warn",Xt[te.ERROR]="error",Xt),se=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=oe[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,Zt(["["+i+"]  "+t.name+":"],n))}},ae=function(){function t(t){this.name=t,this._logLevel=ie,this._logHandler=se,this._userLogHandler=null,ee.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in te))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?re[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Zt([this,te.DEBUG],t)),this._logHandler.apply(this,Zt([this,te.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Zt([this,te.VERBOSE],t)),this._logHandler.apply(this,Zt([this,te.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Zt([this,te.INFO],t)),this._logHandler.apply(this,Zt([this,te.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Zt([this,te.WARN],t)),this._logHandler.apply(this,Zt([this,te.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Zt([this,te.ERROR],t)),this._logHandler.apply(this,Zt([this,te.ERROR],t))},t}();function ue(t){ee.forEach((function(e){e.setLogLevel(t)}))}var ce,he=((ne={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",ne["bad-app-name"]="Illegal App name: '{$appName}",ne["duplicate-app"]="Firebase App named '{$appName}' already exists",ne["app-deleted"]="Firebase App named '{$appName}' already deleted",ne["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",ne["invalid-log-argument"]="First argument to `onLog` must be null or a function.",ne),le=new qt("app","Firebase",he),fe="@firebase/app",pe="[DEFAULT]",de=((ce={})[fe]="fire-core",ce["@firebase/analytics"]="fire-analytics",ce["@firebase/app-check"]="fire-app-check",ce["@firebase/auth"]="fire-auth",ce["@firebase/database"]="fire-rtdb",ce["@firebase/functions"]="fire-fn",ce["@firebase/installations"]="fire-iid",ce["@firebase/messaging"]="fire-fcm",ce["@firebase/performance"]="fire-perf",ce["@firebase/remote-config"]="fire-rc",ce["@firebase/storage"]="fire-gcs",ce["@firebase/firestore"]="fire-fst",ce["fire-js"]="fire-js",ce["firebase-wrapper"]="fire-js-all",ce),ye=new ae("@firebase/app"),ge=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=Pt(void 0,t),this.container=new Jt(e.name),this._addComponent(new Qt("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){var n;void 0===e&&(e=pe),this.checkDestroyed_();var r=this.container.getProvider(t);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=pe),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){ye.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw le.create("app-deleted",{appName:this.name_})},t}();ge.prototype.name&&ge.prototype.options||ge.prototype.delete||console.log("dc");
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function ve(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var o=i;void 0===o.name&&(o.name=pe);var s=o.name;if("string"!=typeof s||!s)throw le.create("bad-app-name",{appName:String(s)});if($t(e,s))throw le.create("duplicate-app",{appName:s});var a=new t(n,o,r);return e[s]=a,a},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=de[t])&&void 0!==r?r:t;n&&(i+="-"+n);var s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return s&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),s&&a&&u.push("and"),a&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void ye.warn(u.join(" "))}o(new Qt(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:ue,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw le.create("invalid-log-argument");!function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=re[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:te[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=ee;r<i.length;r++)n(i[r])}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t,e)},apps:null,SDK_VERSION:"8.10.0",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){if("serverAuth"===e)return null;return e}}};function i(t){if(!$t(e,t=t||pe))throw le.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return ye.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var a=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[s])throw le.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&Pt(a,o.serviceProps),r[s]=a,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,s);return n.apply(this,o.multipleInstances?t:[])}}for(var u=0,c=Object.keys(e);u<c.length;u++){var h=c[u];e[h]._addComponent(o)}return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var me=function t(){var e=ve(ge);return e.INTERNAL=Nt(Nt({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){Pt(e,t)},createSubscribe:Kt,ErrorFactory:qt,deepExtend:Pt}),e}(),be=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){ye.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var we=self.firebase.SDK_VERSION;we&&we.indexOf("LITE")>=0&&ye.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Ee=me.initializeApp;me.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Vt()&&ye.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),Ee.apply(void 0,t)};var Ie=me;!function(t,e){t.INTERNAL.registerComponent(new Qt("platform-logger",(function(t){return new be(t)}),"PRIVATE")),t.registerVersion(fe,"0.6.30",e),t.registerVersion("fire-js","")}(Ie);var _e="8.10.0";
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
Ie.registerVersion("firebase",_e,"app"),Ie.SDK_VERSION=_e;
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var Te=function(t,e){return Te=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},Te(t,e)};function Se(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var Ne,Ae="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},De=De||{},Ce=Ae||self;function ke(){}function xe(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Re(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Oe="closure_uid_"+(1e9*Math.random()>>>0),Le=0;function Pe(t,e,n){return t.call.apply(t.bind,arguments)}function Fe(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Me(t,e,n){return(Me=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Pe:Fe).apply(null,arguments)}function Ve(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Ue(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function qe(){this.s=this.s,this.o=this.o}var je={};qe.prototype.s=!1,qe.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,Oe)&&t[Oe]||(t[Oe]=++Le)}(this);delete je[t]}},qe.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Be=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},$e=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function Ke(t){return Array.prototype.concat.apply([],arguments)}function ze(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Ge(t){return/^[\s\xa0]*$/.test(t)}var He,Qe=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function We(t,e){return-1!=t.indexOf(e)}function Ye(t,e){return t<e?-1:t>e?1:0}t:{var Xe=Ce.navigator;if(Xe){var Je=Xe.userAgent;if(Je){He=Je;break t}}He=""}function Ze(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function tn(t){var e={};for(var n in t)e[n]=t[n];return e}var en="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function nn(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<en.length;o++)n=en[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function rn(t){return rn[" "](t),t}rn[" "]=ke;var on,sn,an=We(He,"Opera"),un=We(He,"Trident")||We(He,"MSIE"),cn=We(He,"Edge"),hn=cn||un,ln=We(He,"Gecko")&&!(We(He.toLowerCase(),"webkit")&&!We(He,"Edge"))&&!(We(He,"Trident")||We(He,"MSIE"))&&!We(He,"Edge"),fn=We(He.toLowerCase(),"webkit")&&!We(He,"Edge");function pn(){var t=Ce.document;return t?t.documentMode:void 0}t:{var dn="",yn=(sn=He,ln?/rv:([^\);]+)(\)|;)/.exec(sn):cn?/Edge\/([\d\.]+)/.exec(sn):un?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(sn):fn?/WebKit\/(\S+)/.exec(sn):an?/(?:Version)[ \/]?(\S+)/.exec(sn):void 0);if(yn&&(dn=yn?yn[1]:""),un){var gn=pn();if(null!=gn&&gn>parseFloat(dn)){on=String(gn);break t}}on=dn}var vn,mn={};function bn(){return function(t){var e=mn;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}((function(){for(var t=0,e=Qe(String(on)).split("."),n=Qe("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Ye(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Ye(0==o[2].length,0==s[2].length)||Ye(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t}))}if(Ce.document&&un){var wn=pn();vn=wn||(parseInt(on,10)||void 0)}else vn=void 0;var En=vn,In=function(){if(!Ce.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Ce.addEventListener("test",ke,e),Ce.removeEventListener("test",ke,e)}catch(t){}return t}();function _n(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function Tn(t,e){if(_n.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(ln){t:{try{rn(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Sn[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Tn.Z.h.call(this)}}_n.prototype.h=function(){this.defaultPrevented=!0},Ue(Tn,_n);var Sn={2:"touch",3:"pen",4:"mouse"};Tn.prototype.h=function(){Tn.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Nn="closure_listenable_"+(1e6*Math.random()|0),An=0;function Dn(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++An,this.ca=this.fa=!1}function Cn(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function kn(t){this.src=t,this.g={},this.h=0}function xn(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],o=Be(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Cn(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Rn(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ca&&o.listener==e&&o.capture==!!n&&o.ia==r)return i}return-1}kn.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var s=Rn(t,e,r,i);return-1<s?(e=t[s],n||(e.fa=!1)):((e=new Dn(e,this.src,o,!!r,i)).fa=n,t.push(e)),e};var On="closure_lm_"+(1e6*Math.random()|0),Ln={};function Pn(t,e,n,r,i){if(r&&r.once)return Mn(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Pn(t,e[o],n,r,i);return null}return n=Kn(n),t&&t[Nn]?t.N(e,n,Re(r)?!!r.capture:!!r,i):Fn(t,e,n,!1,r,i)}function Fn(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=Re(i)?!!i.capture:!!i,a=Bn(t);if(a||(t[On]=a=new kn(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){function t(n){return e.call(t.src,t.listener,n)}var e=jn;return t}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)In||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(qn(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Mn(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Mn(t,e[o],n,r,i);return null}return n=Kn(n),t&&t[Nn]?t.O(e,n,Re(r)?!!r.capture:!!r,i):Fn(t,e,n,!0,r,i)}function Vn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Vn(t,e[o],n,r,i);else r=Re(r)?!!r.capture:!!r,n=Kn(n),t&&t[Nn]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=Rn(o=t.g[e],n,r,i))&&(Cn(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.g[e],t.h--)))):t&&(t=Bn(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Rn(e,n,r,i)),(n=-1<t?e[t]:null)&&Un(n))}function Un(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[Nn])xn(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(qn(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Bn(e))?(xn(n,t),0==n.h&&(n.src=null,e[On]=null)):Cn(t)}}}function qn(t){return t in Ln?Ln[t]:Ln[t]="on"+t}function jn(t,e){if(t.ca)t=!0;else{e=new Tn(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&Un(t),t=n.call(r,e)}return t}function Bn(t){return(t=t[On])instanceof kn?t:null}var $n="__closure_events_fn_"+(1e9*Math.random()>>>0);function Kn(t){return"function"==typeof t?t:(t[$n]||(t[$n]=function(e){return t.handleEvent(e)}),t[$n])}function zn(){qe.call(this),this.i=new kn(this),this.P=this,this.I=null}function Gn(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"==typeof e)e=new _n(e,t);else if(e instanceof _n)e.target=e.target||t;else{var i=e;nn(e=new _n(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.g=n[o];i=Hn(s,r,!0,e)&&i}if(i=Hn(s=e.g=t,r,!0,e)&&i,i=Hn(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Hn(s=e.g=n[o],r,!1,e)&&i}function Hn(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.ca&&s.capture==n){var a=s.listener,u=s.ia||s.src;s.fa&&xn(t.i,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}Ue(zn,qe),zn.prototype[Nn]=!0,zn.prototype.removeEventListener=function(t,e,n,r){Vn(this,t,e,n,r)},zn.prototype.M=function(){if(zn.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)Cn(n[r]);delete e.g[t],e.h--}}this.I=null},zn.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},zn.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var Qn=Ce.JSON.stringify;function Wn(){var t=rr,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Yn,Xn=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=Jn.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),Jn=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t},t}())((function(){return new Zn}),(function(t){return t.reset()})),Zn=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function tr(t){Ce.setTimeout((function(){throw t}),0)}function er(t,e){Yn||function(){var t=Ce.Promise.resolve(void 0);Yn=function(){t.then(ir)}}(),nr||(Yn(),nr=!0),rr.add(t,e)}var nr=!1,rr=new Xn;function ir(){for(var t;t=Wn();){try{t.h.call(t.g)}catch(t){tr(t)}var e=Jn;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}nr=!1}function or(t,e){zn.call(this),this.h=t||1,this.g=e||Ce,this.j=Me(this.kb,this),this.l=Date.now()}function sr(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function ar(t,e,n){if("function"==typeof t)n&&(t=Me(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Me(t.handleEvent,t)}return 2147483647<Number(e)?-1:Ce.setTimeout(t,e||0)}function ur(t){t.g=ar((function(){t.g=null,t.i&&(t.i=!1,ur(t))}),t.j);var e=t.h;t.h=null,t.m.apply(null,e)}Ue(or,zn),(Ne=or.prototype).da=!1,Ne.S=null,Ne.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Gn(this,"tick"),this.da&&(sr(this),this.start()))}},Ne.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Ne.M=function(){or.Z.M.call(this),sr(this),delete this.g};var cr=function(t){function e(e,n){var r=t.call(this)||this;return r.m=e,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Te(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:ur(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(Ce.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(qe);function hr(t){qe.call(this),this.h=t,this.g={}}Ue(hr,qe);var lr=[];function fr(t,e,n,r){Array.isArray(n)||(n&&(lr[0]=n.toString()),n=lr);for(var i=0;i<n.length;i++){var o=Pn(e,n[i],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function pr(t){Ze(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Un(t)}),t),t.g={}}function dr(){this.g=!0}function yr(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Qn(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}hr.prototype.M=function(){hr.Z.M.call(this),pr(this)},hr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},dr.prototype.Aa=function(){this.g=!1},dr.prototype.info=function(){};var gr={},vr=null;function mr(){return vr=vr||new zn}function br(t){_n.call(this,gr.Ma,t)}function wr(t){var e=mr();Gn(e,new br(e,t))}function Er(t,e){_n.call(this,gr.STAT_EVENT,t),this.stat=e}function Ir(t){var e=mr();Gn(e,new Er(e,t))}function _r(t,e){_n.call(this,gr.Na,t),this.size=e}function Tr(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Ce.setTimeout((function(){t()}),e)}gr.Ma="serverreachability",Ue(br,_n),gr.STAT_EVENT="statevent",Ue(Er,_n),gr.Na="timingevent",Ue(_r,_n);var Sr={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Nr={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Ar(){}function Dr(t){return t.h||(t.h=t.i())}function Cr(){}Ar.prototype.h=null;var kr,xr={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Rr(){_n.call(this,"d")}function Or(){_n.call(this,"c")}function Lr(){}function Pr(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new hr(this),this.P=Mr,t=hn?125:void 0,this.W=new or(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Fr}function Fr(){this.i=null,this.g="",this.h=!1}Ue(Rr,_n),Ue(Or,_n),Ue(Lr,Ar),Lr.prototype.g=function(){return new XMLHttpRequest},Lr.prototype.i=function(){return{}},kr=new Lr;var Mr=45e3,Vr={},Ur={};function qr(t,e,n){t.K=1,t.v=ci(ri(e)),t.s=n,t.U=!0,jr(t,null)}function jr(t,e){t.F=Date.now(),zr(t),t.A=ri(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),Ii(n.h,"t",r),t.C=0,n=t.l.H,t.h=new Fr,t.g=To(t.l,n?e:null,!t.s),0<t.O&&(t.L=new cr(Me(t.Ia,t,t.g),t.O)),fr(t.V,t.g,"readystatechange",t.gb),e=t.H?tn(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),wr(1),function(t,e,n,r,i,o){t.info((function(){if(t.g)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&"type"==l[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function Br(t){return!!t.g&&("GET"==t.u&&2!=t.K&&t.l.Ba)}function $r(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;){if((r=Kr(t,n))==Ur){4==e&&(t.o=4,Ir(14),i=!1),yr(t.j,t.m,null,"[Incomplete Response]");break}if(r==Vr){t.o=4,Ir(15),yr(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}yr(t.j,t.m,r,null),Yr(t,r)}Br(t)&&r!=Ur&&r!=Vr&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,Ir(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),go(e),e.L=!0,Ir(11))):(yr(t.j,t.m,n,"[Invalid Chunked Response]"),Wr(t),Qr(t))}function Kr(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?Ur:(n=Number(e.substring(n,r)),isNaN(n)?Vr:(r+=1)+n>e.length?Ur:(e=e.substr(r,n),t.C=r+n,e))}function zr(t){t.Y=Date.now()+t.P,Gr(t,t.P)}function Gr(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Tr(Me(t.eb,t),e)}function Hr(t){t.B&&(Ce.clearTimeout(t.B),t.B=null)}function Qr(t){0==t.l.G||t.I||bo(t.l,t)}function Wr(t){Hr(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,sr(t.W),pr(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Yr(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||Ci(n.i,t)))if(n.I=t.N,!t.J&&Ci(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(o){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;mo(n),so(n)}yo(n),Ir(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=Tr(Me(n.ab,n),6e3));if(1>=Di(n.i)&&n.ka){try{n.ka()}catch(o){}n.ka=void 0}}else Eo(n,11)}else if((t.J||n.g==t)&&mo(n),!Ge(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var o=i[e];if(n.U=o[0],o=o[1],2==n.G)if("c"==o[0]){n.J=o[1],n.la=o[2];var s=o[3];null!=s&&(n.ma=s,n.h.info("VER="+n.ma));var a=o[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var u=o[5];null!=u&&"number"==typeof u&&0<u&&(r=1.5*u,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=t.g;if(c){var h=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=r.i;!l.g&&(We(h,"spdy")||We(h,"quic")||We(h,"h2"))&&(l.j=l.l,l.g=new Set,l.h&&(ki(l,l.h),l.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,ui(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var p=t;if((r=n).oa=_o(r,r.H?r.la:null,r.W),p.J){xi(r.i,p);var d=p,y=r.K;y&&d.setTimeout(y),d.B&&(Hr(d),zr(d)),r.g=p}else po(r);0<n.l.length&&co(n)}else"stop"!=o[0]&&"close"!=o[0]||Eo(n,7);else 3==n.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?Eo(n,7):oo(n):"noop"!=o[0]&&n.j&&n.j.wa(o),n.A=0)}wr(4)}catch(o){}}function Xr(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(xe(t)||"string"==typeof t)$e(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(xe(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;r=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(xe(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),i=r.length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Jr(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Jr)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Zr(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];ti(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)ti(i,r=t.g[e])||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}function ti(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(Ne=Pr.prototype).setTimeout=function(t){this.P=t},Ne.gb=function(t){t=t.target;var e=this.L;e&&3==to(t)?e.l():this.Ia(t)},Ne.Ia=function(t){try{if(t==this.g)t:{var e=to(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||hn||this.g&&(this.h.h||this.g.ga()||eo(this.g)))){this.I||4!=e||7==n||wr(8==n||0>=r?3:2),Hr(this);var i=this.g.ba();this.N=i;e:if(Br(this)){var o=eo(this.g);t="";var s=o.length,a=4==to(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Wr(this),Qr(this);var u="";break e}this.h.i=new Ce.TextDecoder}for(n=0;n<s;n++)this.h.h=!0,t+=this.h.i.decode(o[n],{stream:a&&n==s-1});o.splice(0,s),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,h=this.g;if((c=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ge(c)){var l=c;break e}}l=null}if(!(i=l)){this.i=!1,this.o=3,Ir(12),Wr(this),Qr(this);break t}yr(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Yr(this,i)}this.U?($r(this,e,u),hn&&this.i&&3==e&&(fr(this.V,this.W,"tick",this.fb),this.W.start())):(yr(this.j,this.m,u,null),Yr(this,u)),4==e&&Wr(this),this.i&&!this.I&&(4==e?bo(this.l,this):(this.i=!1,zr(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,Ir(12)):(this.o=0,Ir(13)),Wr(this),Qr(this)}}}catch(e){}},Ne.fb=function(){if(this.g){var t=to(this.g),e=this.g.ga();this.C<e.length&&(Hr(this),$r(this,t,e),this.i&&4!=t&&zr(this))}},Ne.cancel=function(){this.I=!0,Wr(this)},Ne.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(wr(3),Ir(17)),Wr(this),this.o=2,Qr(this)):Gr(this,this.Y-t)},(Ne=Jr.prototype).R=function(){Zr(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},Ne.T=function(){return Zr(this),this.g.concat()},Ne.get=function(t,e){return ti(this.h,t)?this.h[t]:e},Ne.set=function(t,e){ti(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},Ne.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var ei=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function ni(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof ni){this.g=void 0!==e?e:t.g,ii(this,t.j),this.s=t.s,oi(this,t.i),si(this,t.m),this.l=t.l,e=t.h;var n=new mi;n.i=e.i,e.g&&(n.g=new Jr(e.g),n.h=e.h),ai(this,n),this.o=t.o}else t&&(n=String(t).match(ei))?(this.g=!!e,ii(this,n[1]||"",!0),this.s=hi(n[2]||""),oi(this,n[3]||"",!0),si(this,n[4]),this.l=hi(n[5]||"",!0),ai(this,n[6]||"",!0),this.o=hi(n[7]||"")):(this.g=!!e,this.h=new mi(null,this.g))}function ri(t){return new ni(t)}function ii(t,e,n){t.j=n?hi(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function oi(t,e,n){t.i=n?hi(e,!0):e}function si(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function ai(t,e,n){e instanceof mi?(t.h=e,function(t,e){e&&!t.j&&(bi(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(wi(this,e),Ii(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=li(e,gi)),t.h=new mi(e,t.g))}function ui(t,e,n){t.h.set(e,n)}function ci(t){return ui(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function hi(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function li(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,fi),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function fi(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}ni.prototype.toString=function(){var t=[],e=this.j;e&&t.push(li(e,pi,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(li(e,pi,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(li(n,"/"==n.charAt(0)?yi:di,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",li(n,vi)),t.join("")};var pi=/[#\/\?@]/g,di=/[#\?:]/g,yi=/[#\?]/g,gi=/[#\?@]/g,vi=/#/g;function mi(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function bi(t){t.g||(t.g=new Jr,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function wi(t,e){bi(t),e=_i(t,e),ti(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,ti((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&Zr(t)))}function Ei(t,e){return bi(t),e=_i(t,e),ti(t.g.h,e)}function Ii(t,e,n){wi(t,e),0<n.length&&(t.i=null,t.g.set(_i(t,e),ze(n)),t.h+=n.length)}function _i(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(Ne=mi.prototype).add=function(t,e){bi(this),this.i=null,t=_i(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},Ne.forEach=function(t,e){bi(this),this.g.forEach((function(n,r){$e(n,(function(n){t.call(e,n,r,this)}),this)}),this)},Ne.T=function(){bi(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},Ne.R=function(t){bi(this);var e=[];if("string"==typeof t)Ei(this,t)&&(e=Ke(e,this.g.get(_i(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=Ke(e,t[n])}return e},Ne.set=function(t,e){return bi(this),this.i=null,Ei(this,t=_i(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},Ne.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},Ne.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.i=t.join("&")};var Ti=function(t,e){this.h=t,this.g=e};function Si(t){this.l=t||Ni,Ce.PerformanceNavigationTiming?t=0<(t=Ce.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(Ce.g&&Ce.g.Ea&&Ce.g.Ea()&&Ce.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Ni=10;function Ai(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Di(t){return t.h?1:t.g?t.g.size:0}function Ci(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function ki(t,e){t.g?t.g.add(e):t.h=e}function xi(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Ri(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var r=t.i;try{for(var i=Se(t.g.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.D)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return ze(t.i)}function Oi(){}function Li(){this.g=new Oi}function Pi(t,e,n){var r=n||"";try{Xr(t,(function(t,n){var i=t;Re(t)&&(i=Qn(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function Fi(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function Mi(t){this.l=t.$b||null,this.j=t.ib||!1}function Vi(t,e){zn.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Ui,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Si.prototype.cancel=function(){var t,e;if(this.i=Ri(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=Se(this.g.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},Oi.prototype.stringify=function(t){return Ce.JSON.stringify(t,void 0)},Oi.prototype.parse=function(t){return Ce.JSON.parse(t,void 0)},Ue(Mi,Ar),Mi.prototype.g=function(){return new Vi(this.l,this.j)},Mi.prototype.i=function(t){return function(){return t}}({}),Ue(Vi,zn);var Ui=0;function qi(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function ji(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Bi(t)}function Bi(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(Ne=Vi.prototype).open=function(t,e){if(this.readyState!=Ui)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Bi(this)},Ne.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||Ce).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},Ne.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,ji(this)),this.readyState=Ui},Ne.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Bi(this)),this.g&&(this.readyState=3,Bi(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==Ce.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;qi(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},Ne.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?ji(this):Bi(this),3==this.readyState&&qi(this)}},Ne.Ua=function(t){this.g&&(this.response=this.responseText=t,ji(this))},Ne.Ta=function(t){this.g&&(this.response=t,ji(this))},Ne.ha=function(){this.g&&ji(this)},Ne.setRequestHeader=function(t,e){this.v.append(t,e)},Ne.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},Ne.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Vi.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var $i=Ce.JSON.parse;function Ki(t){zn.call(this),this.headers=new Jr,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=zi,this.K=this.L=!1}Ue(Ki,zn);var zi="",Gi=/^https?$/i,Hi=["POST","PUT"];function Qi(t){return"content-type"==t.toLowerCase()}function Wi(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Yi(t),Ji(t)}function Yi(t){t.D||(t.D=!0,Gn(t,"complete"),Gn(t,"error"))}function Xi(t){if(t.h&&void 0!==De&&(!t.C[1]||4!=to(t)||2!=t.ba()))if(t.v&&4==to(t))ar(t.Fa,0,t);else if(Gn(t,"readystatechange"),4==to(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.H).match(ei)[1]||null;if(!o&&Ce.self&&Ce.self.location){var s=Ce.self.location.protocol;o=s.substr(0,s.length-1)}i=!Gi.test(o?o.toLowerCase():"")}e=i}if(e)Gn(t,"complete"),Gn(t,"success");else{t.m=6;try{var a=2<to(t)?t.g.statusText:""}catch(t){a=""}t.j=a+" ["+t.ba()+"]",Yi(t)}}finally{Ji(t)}}}function Ji(t,e){if(t.g){Zi(t);var n=t.g,r=t.C[0]?ke:null;t.g=null,t.C=null,e||Gn(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Zi(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(Ce.clearTimeout(t.A),t.A=null)}function to(t){return t.g?t.g.readyState:0}function eo(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case zi:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function no(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return Ze(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):ui(t,e,n))}function ro(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function io(t){this.za=0,this.l=[],this.h=new dr,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=ro("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=ro("baseRetryDelayMs",5e3,t),this.$a=ro("retryDelaySeedMs",1e4,t),this.Ya=ro("forwardChannelMaxRetries",2,t),this.ra=ro("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new Si(t&&t.concurrentRequestLimit),this.Ca=new Li,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function oo(t){if(ao(t),3==t.G){var e=t.V++,n=ri(t.F);ui(n,"SID",t.J),ui(n,"RID",e),ui(n,"TYPE","terminate"),lo(t,n),(e=new Pr(t,t.h,e,void 0)).K=2,e.v=ci(ri(n)),n=!1,Ce.navigator&&Ce.navigator.sendBeacon&&(n=Ce.navigator.sendBeacon(e.v.toString(),"")),!n&&Ce.Image&&((new Image).src=e.v,n=!0),n||(e.g=To(e.l,null),e.g.ea(e.v)),e.F=Date.now(),zr(e)}Io(t)}function so(t){t.g&&(go(t),t.g.cancel(),t.g=null)}function ao(t){so(t),t.u&&(Ce.clearTimeout(t.u),t.u=null),mo(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Ce.clearTimeout(t.m),t.m=null)}function uo(t,e){t.l.push(new Ti(t.Za++,e)),3==t.G&&co(t)}function co(t){Ai(t.i)||t.m||(t.m=!0,er(t.Ha,t),t.C=0)}function ho(t,e){var n;n=e?e.m:t.V++;var r=ri(t.F);ui(r,"SID",t.J),ui(r,"RID",n),ui(r,"AID",t.U),lo(t,r),t.o&&t.s&&no(r,t.o,t.s),n=new Pr(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=fo(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),ki(t.i,n),qr(n,r,e)}function lo(t,e){t.j&&Xr({},(function(t,n){ui(e,n,t)}))}function fo(t,e,n){n=Math.min(t.l.length,n);var r=t.j?Me(t.j.Oa,t.j,t):null;t:for(var i=t.l,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].h,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].h,h=i[u].g;if(0>(c-=o))o=Math.max(0,i[u].h-100),a=!1;else try{Pi(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function po(t){t.g||t.u||(t.Y=1,er(t.Ga,t),t.A=0)}function yo(t){return!(t.g||t.u||3<=t.A)&&(t.Y++,t.u=Tr(Me(t.Ga,t),wo(t,t.A)),t.A++,!0)}function go(t){null!=t.B&&(Ce.clearTimeout(t.B),t.B=null)}function vo(t){t.g=new Pr(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=ri(t.oa);ui(e,"RID","rpc"),ui(e,"SID",t.J),ui(e,"CI",t.N?"0":"1"),ui(e,"AID",t.U),lo(t,e),ui(e,"TYPE","xmlhttp"),t.o&&t.s&&no(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=ci(ri(e)),n.s=null,n.U=!0,jr(n,t)}function mo(t){null!=t.v&&(Ce.clearTimeout(t.v),t.v=null)}function bo(t,e){var n=null;if(t.g==e){mo(t),go(t),t.g=null;var r=2}else{if(!Ci(t.i,e))return;n=e.D,xi(t.i,e),r=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;Gn(r=mr(),new _r(r,n,e,i)),co(t)}else po(t);else if(3==(i=e.o)||0==i&&0<t.I||!(1==r&&function(t,e){return!(Di(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=Tr(Me(t.Ha,t,e),wo(t,t.C)),t.C++,0)))}(t,e)||2==r&&yo(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Eo(t,5);break;case 4:Eo(t,10);break;case 3:Eo(t,6);break;default:Eo(t,2)}}function wo(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function Eo(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var r=Me(t.jb,t);n||(n=new ni("//www.google.com/images/cleardot.gif"),Ce.location&&"http"==Ce.location.protocol||ii(n,"https"),ci(n)),function(t,e){var n=new dr;if(Ce.Image){var r=new Image;r.onload=Ve(Fi,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Ve(Fi,n,r,"TestLoadImage: error",!1,e),r.onabort=Ve(Fi,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Ve(Fi,n,r,"TestLoadImage: timeout",!1,e),Ce.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Ir(2);t.G=0,t.j&&t.j.va(e),Io(t),ao(t)}function Io(t){t.G=0,t.I=-1,t.j&&(0==Ri(t.i).length&&0==t.l.length||(t.i.i.length=0,ze(t.l),t.l.length=0),t.j.ua())}function _o(t,e,n){var r=function(t){return t instanceof ni?ri(t):new ni(t,void 0)}(n);if(""!=r.i)e&&oi(r,e+"."+r.i),si(r,r.m);else{var i=Ce.location;r=function(t,e,n,r){var i=new ni(null,void 0);return t&&ii(i,t),e&&oi(i,e),n&&si(i,n),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&Ze(t.aa,(function(t,e){ui(r,e,t)})),e=t.D,n=t.sa,e&&n&&ui(r,e,n),ui(r,"VER",t.ma),lo(t,r),r}function To(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new Ki(new Mi({ib:!0})):new Ki(t.qa)).L=t.H,e}function So(){}function No(){if(un&&!(10<=Number(En)))throw Error("Environmental error: no available transport.")}function Ao(t,e){zn.call(this),this.g=new io(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!Ge(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Ge(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new ko(this)}function Do(t){Rr.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Co(){Or.call(this),this.status=1}function ko(t){this.g=t}(Ne=Ki.prototype).ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():kr.g(),this.C=this.u?Dr(this.u):Dr(kr),this.g.onreadystatechange=Me(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void Wi(this,t)}t=n||"";var i=new Jr(this.headers);r&&Xr(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=Qi,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.T()),n=Ce.FormData&&t instanceof Ce.FormData,!(0<=Be(Hi,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Zi(this),0<this.B&&((this.K=function(t){return un&&bn()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Me(this.pa,this)):this.A=ar(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Wi(this,t)}},Ne.pa=function(){void 0!==De&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Gn(this,"timeout"),this.abort(8))},Ne.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Gn(this,"complete"),Gn(this,"abort"),Ji(this))},Ne.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ji(this,!0)),Ki.Z.M.call(this)},Ne.Fa=function(){this.s||(this.F||this.v||this.l?Xi(this):this.cb())},Ne.cb=function(){Xi(this)},Ne.ba=function(){try{return 2<to(this)?this.g.status:-1}catch(t){return-1}},Ne.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},Ne.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),$i(e)}},Ne.Da=function(){return this.m},Ne.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(Ne=io.prototype).ma=8,Ne.G=1,Ne.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(t){}},Ne.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new Pr(this,this.h,t,void 0),n=this.s;if(this.P&&(n?nn(n=tn(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var o=this.l[i];if(void 0===(o="__data__"in o.g&&"string"==typeof(o=o.g.__data__)?o.length:void 0))break;if(4096<(r+=o)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=fo(this,e,r),ui(i=ri(this.F),"RID",t),ui(i,"CVER",22),this.D&&ui(i,"X-HTTP-Session-Id",this.D),lo(this,i),this.o&&n&&no(i,this.o,n),ki(this.i,e),this.Ra&&ui(i,"TYPE","init"),this.ja?(ui(i,"$req",r),ui(i,"SID","null"),e.$=!0,qr(e,i,null)):qr(e,i,r),this.G=2}}else 3==this.G&&(t?ho(this,t):0==this.l.length||Ai(this.i)||ho(this))},Ne.Ga=function(){if(this.u=null,vo(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Tr(Me(this.bb,this),t)}},Ne.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Ir(10),so(this),vo(this))},Ne.ab=function(){null!=this.v&&(this.v=null,so(this),yo(this),Ir(19))},Ne.jb=function(t){t?(this.h.info("Successfully pinged google.com"),Ir(2)):(this.h.info("Failed to ping google.com"),Ir(1))},(Ne=So.prototype).xa=function(){},Ne.wa=function(){},Ne.va=function(){},Ne.ua=function(){},Ne.Oa=function(){},No.prototype.g=function(t,e){return new Ao(t,e)},Ue(Ao,zn),Ao.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),er(Me(t.hb,t,e))),Ir(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=_o(t,null,t.W),co(t)},Ao.prototype.close=function(){oo(this.g)},Ao.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,uo(this.g,e)}else this.v?((e={}).__data__=Qn(t),uo(this.g,e)):uo(this.g,t)},Ao.prototype.M=function(){this.g.j=null,delete this.j,oo(this.g),delete this.g,Ao.Z.M.call(this)},Ue(Do,Rr),Ue(Co,Or),Ue(ko,So),ko.prototype.xa=function(){Gn(this.g,"a")},ko.prototype.wa=function(t){Gn(this.g,new Do(t))},ko.prototype.va=function(t){Gn(this.g,new Co(t))},ko.prototype.ua=function(){Gn(this.g,"b")},No.prototype.createWebChannel=No.prototype.g,Ao.prototype.send=Ao.prototype.u,Ao.prototype.open=Ao.prototype.m,Ao.prototype.close=Ao.prototype.close,Sr.NO_ERROR=0,Sr.TIMEOUT=8,Sr.HTTP_ERROR=6,Nr.COMPLETE="complete",Cr.EventType=xr,xr.OPEN="a",xr.CLOSE="b",xr.ERROR="c",xr.MESSAGE="d",zn.prototype.listen=zn.prototype.N,Ki.prototype.listenOnce=Ki.prototype.O,Ki.prototype.getLastError=Ki.prototype.La,Ki.prototype.getLastErrorCode=Ki.prototype.Da,Ki.prototype.getStatus=Ki.prototype.ba,Ki.prototype.getResponseJson=Ki.prototype.Qa,Ki.prototype.getResponseText=Ki.prototype.ga,Ki.prototype.send=Ki.prototype.ea;var xo=Sr,Ro=Nr,Oo=gr,Lo=10,Po=11,Fo=Mi,Mo=Cr,Vo=Ki,Uo=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();Uo.o=-1;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var qo={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},jo=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return St(e,t),e}(Error),Bo=new ae("@firebase/firestore");function $o(){return Bo.logLevel}function Ko(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Bo.logLevel<=te.DEBUG){var r=e.map(Ho);Bo.debug.apply(Bo,xt(["Firestore (8.10.0): "+t],r))}}function zo(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Bo.logLevel<=te.ERROR){var r=e.map(Ho);Bo.error.apply(Bo,xt(["Firestore (8.10.0): "+t],r))}}function Go(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Bo.logLevel<=te.WARN){var r=e.map(Ho);Bo.warn.apply(Bo,xt(["Firestore (8.10.0): "+t],r))}}function Ho(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Qo(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.10.0) INTERNAL ASSERTION FAILED: "+t;throw zo(e),new Error(e)}function Wo(t,e){t||Qo()}function Yo(t,e){return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Xo(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Jo=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Xo(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Zo(t,e){return t<e?-1:t>e?1:0}function ts(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function es(t){return t+"\0"}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ns=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new jo(qo.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new jo(qo.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new jo(qo.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new jo(qo.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?Zo(this.nanoseconds,t.nanoseconds):Zo(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),rs=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new ns(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function is(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function os(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ss(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var as=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Qo(),void 0===n?n=t.length-e:n>t.length-e&&Qo(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),us=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return St(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new jo(qo.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.emptyPath=function(){return new e([])},e}(as),cs=/^[_a-zA-Z][_a-zA-Z0-9]*$/,hs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return St(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return cs.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new jo(qo.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new jo(qo.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new jo(qo.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new jo(qo.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(as),ls=function(){function t(t){this.fields=t,t.sort(hs.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return ts(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),fs=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return Zo(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();fs.EMPTY_BYTE_STRING=new fs("");var ps=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ds(t){if(Wo(!!t),"string"==typeof t){var e=0,n=ps.exec(t);if(Wo(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ys(t.seconds),nanos:ys(t.nanos)}}function ys(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function gs(t){return"string"==typeof t?fs.fromBase64String(t):fs.fromUint8Array(t)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function vs(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ms(t){var e=t.mapValue.fields.__previous_value__;return vs(e)?ms(e):e}function bs(t){var e=ds(t.mapValue.fields.__local_write_time__.timestampValue);return new ns(e.seconds,e.nanos)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ws(t){return null==t}function Es(t){return 0===t&&1/t==-1/0}function Is(t){return"number"==typeof t&&Number.isInteger(t)&&!Es(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var _s=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(us.fromString(e))},t.fromName=function(e){return new t(us.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===us.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return us.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new us(e.slice()))},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ts(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?vs(t)?4:10:Qo()}function Ss(t,e){var n=Ts(t);if(n!==Ts(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return bs(t).isEqual(bs(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=ds(t.timestampValue),r=ds(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return gs(t.bytesValue).isEqual(gs(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return ys(t.geoPointValue.latitude)===ys(e.geoPointValue.latitude)&&ys(t.geoPointValue.longitude)===ys(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return ys(t.integerValue)===ys(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=ys(t.doubleValue),r=ys(e.doubleValue);return n===r?Es(n)===Es(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return ts(t.arrayValue.values||[],e.arrayValue.values||[],Ss);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(is(n)!==is(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Ss(n[i],r[i])))return!1;return!0}(t,e);default:return Qo()}}function Ns(t,e){return void 0!==(t.values||[]).find((function(t){return Ss(t,e)}))}function As(t,e){var n=Ts(t),r=Ts(e);if(n!==r)return Zo(n,r);switch(n){case 0:return 0;case 1:return Zo(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=ys(t.integerValue||t.doubleValue),r=ys(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Ds(t.timestampValue,e.timestampValue);case 4:return Ds(bs(t),bs(e));case 5:return Zo(t.stringValue,e.stringValue);case 6:return function(t,e){var n=gs(t),r=gs(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Zo(n[i],r[i]);if(0!==o)return o}return Zo(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Zo(ys(t.latitude),ys(e.latitude));return 0!==n?n:Zo(ys(t.longitude),ys(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=As(n[i],r[i]);if(o)return o}return Zo(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=Zo(r[s],o[s]);if(0!==a)return a;var u=As(n[r[s]],i[o[s]]);if(0!==u)return u}return Zo(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Qo()}}function Ds(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Zo(t,e);var n=ds(t),r=ds(e),i=Zo(n.seconds,r.seconds);return 0!==i?i:Zo(n.nanos,r.nanos)}function Cs(t){return ks(t)}function ks(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=ds(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?gs(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,_s.fromName(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=ks(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+ks(t.fields[o])}return e+"}"}(t.mapValue):Qo();var e,n}function xs(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function Rs(t){return!!t&&"integerValue"in t}function Os(t){return!!t&&"arrayValue"in t}function Ls(t){return!!t&&"nullValue"in t}function Ps(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Fs(t){return!!t&&"mapValue"in t}function Ms(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){var e={mapValue:{fields:{}}};return os(t.mapValue.fields,(function(t,n){return e.mapValue.fields[t]=Ms(n)})),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Ms(t.arrayValue.values[r]);return n}return Object.assign({},t)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Vs=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!Fs(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ms(e)},t.prototype.setAll=function(t){var e=this,n=hs.emptyPath(),r={},i=[];t.forEach((function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=Ms(t):i.push(o.lastSegment())}));var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());Fs(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return Ss(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];Fs(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){os(e,(function(e,n){return t[e]=n}));for(var r=0,i=n;r<i.length;r++){var o=i[r];delete t[o]}},t.prototype.clone=function(){return new t(Ms(this.value))},t}();function Us(t){var e=[];return os(t.fields,(function(t,n){var r=new hs([t]);if(Fs(n)){var i=Us(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var a=s[o];e.push(r.child(a))}}else e.push(r)})),new ls(e)
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var qs=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,rs.min(),Vs.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,Vs.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,Vs.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=Vs.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=Vs.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),js=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Bs(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new js(t,e,n,r,i,o,s)}function $s(t){var e=Yo(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+Cs(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),ws(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=na(e.startAt)),e.endAt&&(n+="|ub:",n+=na(e.endAt)),e.h=n}return e.h}function Ks(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!ia(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!Ss(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!sa(t.startAt,e.startAt)&&sa(t.endAt,e.endAt)}function zs(t){return _s.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Gs=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return St(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new Hs(t,n,r):"array-contains"===n?new Xs(t,r):"in"===n?new Js(t,r):"not-in"===n?new Zs(t,r):"array-contains-any"===n?new ta(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new Qs(t,n):new Ws(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(As(e,this.value)):null!==e&&Ts(this.value)===Ts(e)&&this.m(As(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Qo()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),Hs=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=_s.fromName(r.referenceValue),i}return St(e,t),e.prototype.matches=function(t){var e=_s.comparator(t.key,this.key);return this.m(e)},e}(Gs),Qs=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Ys("in",n),r}return St(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Gs),Ws=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Ys("not-in",n),r}return St(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Gs);function Ys(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return _s.fromName(t.referenceValue)}))}var Xs=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return St(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return Os(e)&&Ns(e.arrayValue,this.value)},e}(Gs),Js=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return St(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&Ns(this.value.arrayValue,e)},e}(Gs),Zs=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return St(e,t),e.prototype.matches=function(t){if(Ns(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!Ns(this.value.arrayValue,e)},e}(Gs),ta=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return St(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!Os(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return Ns(e.value.arrayValue,t)}))},e}(Gs),ea=function(t,e){this.position=t,this.before=e};function na(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return Cs(t)})).join(",")}var ra=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function ia(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function oa(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?_s.comparator(_s.fromName(s.referenceValue),n.key):As(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function sa(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Ss(t.position[n],e.position[n]))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var aa=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt};function ua(t,e,n,r,i,o,s,a){return new aa(t,e,n,r,i,o,s,a)}function ca(t){return new aa(t)}function ha(t){return!ws(t.limit)&&"F"===t.limitType}function la(t){return!ws(t.limit)&&"L"===t.limitType}function fa(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function pa(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function da(t){return null!==t.collectionGroup}function ya(t){var e=Yo(t);if(null===e.p){e.p=[];var n=pa(e),r=fa(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new ra(n)),e.p.push(new ra(hs.keyField(),"asc"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var a=s[o];e.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new ra(hs.keyField(),u))}}}return e.p}function ga(t){var e=Yo(t);if(!e.T)if("F"===e.limitType)e.T=Bs(e.path,e.collectionGroup,ya(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=ya(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ra(o.field,s))}var a=e.endAt?new ea(e.endAt.position,!e.endAt.before):null,u=e.startAt?new ea(e.startAt.position,!e.startAt.before):null;e.T=Bs(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.T}function va(t,e,n){return new aa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ma(t,e){return Ks(ga(t),ga(e))&&t.limitType===e.limitType}function ba(t){return $s(ga(t))+"|lt:"+t.limitType}function wa(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+Cs(e.value);var e})).join(", ")+"]"),ws(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+na(t.startAt)),t.endAt&&(e+=", endAt: "+na(t.endAt)),"Target("+e+")"}(ga(t))+"; limitType="+t.limitType+")"}function Ea(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):_s.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!oa(t.startAt,ya(t),e)||t.endAt&&oa(t.endAt,ya(t),e))}(t,e)}function Ia(t){return function(e,n){for(var r=!1,i=0,o=ya(t);i<o.length;i++){var s=o[i],a=_a(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function _a(t,e,n){var r=t.field.isKeyField()?_s.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?As(r,i):Qo()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Qo()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ta(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Es(e)?"-0":e}}function Sa(t){return{integerValue:""+t}}function Na(t,e){return Is(e)?Sa(e):Ta(t,e)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Aa=function(){this._=void 0};function Da(t,e,n){return t instanceof xa?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Ra?Oa(t,e):t instanceof La?Pa(t,e):function(t,e){var n=ka(t,e),r=Ma(n)+Ma(t.A);return Rs(n)&&Rs(t.A)?Sa(r):Ta(t.R,r)}(t,e)}function Ca(t,e,n){return t instanceof Ra?Oa(t,e):t instanceof La?Pa(t,e):n}function ka(t,e){return t instanceof Fa?Rs(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var xa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return St(e,t),e}(Aa),Ra=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return St(e,t),e}(Aa);function Oa(t,e){for(var n=Va(e),r=function(t){n.some((function(e){return Ss(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var La=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return St(e,t),e}(Aa);function Pa(t,e){for(var n=Va(e),r=function(t){n=n.filter((function(e){return!Ss(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Fa=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return St(e,t),e}(Aa);function Ma(t){return ys(t.integerValue||t.doubleValue)}function Va(t){return Os(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ua=function(t,e){this.field=t,this.transform=e},qa=function(t,e){this.version=t,this.transformResults=e},ja=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Ba(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var $a=function(){};function Ka(t,e,n){t instanceof Wa?function(t,e,n){var r=t.value.clone(),i=Ja(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof Ya?function(t,e,n){if(Ba(t.precondition,e)){var r=Ja(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(Xa(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function za(t,e,n){t instanceof Wa?function(t,e,n){if(Ba(t.precondition,e)){var r=t.value.clone(),i=Za(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(Qa(e),r).setHasLocalMutations()}}(t,e,n):t instanceof Ya?function(t,e,n){if(Ba(t.precondition,e)){var r=Za(t.fieldTransforms,n,e),i=e.data;i.setAll(Xa(t)),i.setAll(r),e.convertToFoundDocument(Qa(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){Ba(t.precondition,e)&&e.convertToNoDocument(rs.min())}(t,e)}function Ga(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=ka(o.transform,s||null);null!=a&&(null==n&&(n=Vs.empty()),n.set(o.field,a))}return n||null}function Ha(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&ts(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Ra&&e instanceof Ra||t instanceof La&&e instanceof La?ts(t.elements,e.elements,Ss):t instanceof Fa&&e instanceof Fa?Ss(t.A,e.A):t instanceof xa&&e instanceof xa}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Qa(t){return t.isFoundDocument()?t.version:rs.min()}var Wa=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return St(e,t),e}($a),Ya=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return St(e,t),e}($a);function Xa(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function Ja(t,e,n){var r=new Map;Wo(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,Ca(s,a,n[i]))}return r}function Za(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=n.data.field(s.field);r.set(s.field,Da(a,u,e))}return r}var tu,eu,nu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return St(e,t),e}($a),ru=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return St(e,t),e}($a),iu=function(t){this.count=t};function ou(t){switch(t){default:return Qo();case qo.CANCELLED:case qo.UNKNOWN:case qo.DEADLINE_EXCEEDED:case qo.RESOURCE_EXHAUSTED:case qo.INTERNAL:case qo.UNAVAILABLE:case qo.UNAUTHENTICATED:return!1;case qo.INVALID_ARGUMENT:case qo.NOT_FOUND:case qo.ALREADY_EXISTS:case qo.PERMISSION_DENIED:case qo.FAILED_PRECONDITION:case qo.ABORTED:case qo.OUT_OF_RANGE:case qo.UNIMPLEMENTED:case qo.DATA_LOSS:return!0}}function su(t){if(void 0===t)return zo("GRPC error has no .code"),qo.UNKNOWN;switch(t){case tu.OK:return qo.OK;case tu.CANCELLED:return qo.CANCELLED;case tu.UNKNOWN:return qo.UNKNOWN;case tu.DEADLINE_EXCEEDED:return qo.DEADLINE_EXCEEDED;case tu.RESOURCE_EXHAUSTED:return qo.RESOURCE_EXHAUSTED;case tu.INTERNAL:return qo.INTERNAL;case tu.UNAVAILABLE:return qo.UNAVAILABLE;case tu.UNAUTHENTICATED:return qo.UNAUTHENTICATED;case tu.INVALID_ARGUMENT:return qo.INVALID_ARGUMENT;case tu.NOT_FOUND:return qo.NOT_FOUND;case tu.ALREADY_EXISTS:return qo.ALREADY_EXISTS;case tu.PERMISSION_DENIED:return qo.PERMISSION_DENIED;case tu.FAILED_PRECONDITION:return qo.FAILED_PRECONDITION;case tu.ABORTED:return qo.ABORTED;case tu.OUT_OF_RANGE:return qo.OUT_OF_RANGE;case tu.UNIMPLEMENTED:return qo.UNIMPLEMENTED;case tu.DATA_LOSS:return qo.DATA_LOSS;default:return Qo()}}(eu=tu||(tu={}))[eu.OK=0]="OK",eu[eu.CANCELLED=1]="CANCELLED",eu[eu.UNKNOWN=2]="UNKNOWN",eu[eu.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",eu[eu.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",eu[eu.NOT_FOUND=5]="NOT_FOUND",eu[eu.ALREADY_EXISTS=6]="ALREADY_EXISTS",eu[eu.PERMISSION_DENIED=7]="PERMISSION_DENIED",eu[eu.UNAUTHENTICATED=16]="UNAUTHENTICATED",eu[eu.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",eu[eu.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",eu[eu.ABORTED=10]="ABORTED",eu[eu.OUT_OF_RANGE=11]="OUT_OF_RANGE",eu[eu.UNIMPLEMENTED=12]="UNIMPLEMENTED",eu[eu.INTERNAL=13]="INTERNAL",eu[eu.UNAVAILABLE=14]="UNAVAILABLE",eu[eu.DATA_LOSS=15]="DATA_LOSS";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var au=function(){function t(t,e){this.comparator=t,this.root=e||cu.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,cu.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,cu.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new uu(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new uu(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new uu(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new uu(this.root,t,this.comparator,!0)},t}(),uu=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),cu=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Qo();if(this.right.isRed())throw Qo();var t=this.left.check();if(t!==this.right.check())throw Qo();return t+(this.isRed()?0:1)},t}();cu.EMPTY=null,cu.RED=!0,cu.BLACK=!1,cu.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Qo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Qo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Qo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Qo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Qo()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new cu(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var hu=function(){function t(t){this.comparator=t,this.data=new au(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new lu(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new lu(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),lu=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),fu=new au(_s.comparator);function pu(){return fu}var du=new au(_s.comparator);function yu(){return du}var gu=new au(_s.comparator);var vu=new hu(_s.comparator);function mu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=vu,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var bu=new hu(Zo);function wu(){return bu}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Eu=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,Iu.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(rs.min(),r,wu(),pu(),mu())},t}(),Iu=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(fs.EMPTY_BYTE_STRING,n,mu(),mu(),mu())},t}(),_u=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},Tu=function(t,e){this.targetId=t,this.V=e},Su=function(t,e,n,r){void 0===n&&(n=fs.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Nu=function(){function t(){this.S=0,this.D=Cu(),this.C=fs.EMPTY_BYTE_STRING,this.N=!1,this.k=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"F",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.k},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.k=!0,this.C=t)},t.prototype.M=function(){var t=mu(),e=mu(),n=mu();return this.D.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Qo()}})),new Iu(this.C,this.N,t,e,n)},t.prototype.L=function(){this.k=!1,this.D=Cu()},t.prototype.B=function(t,e){this.k=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.k=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.k=!0,this.N=!0},t}(),Au=function(){function t(t){this.W=t,this.G=new Map,this.H=pu(),this.J=Du(),this.Y=new hu(Zo)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.F||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.F||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:Qo()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach((function(t,r){n.st(r)&&e(r)}))},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(zs(i))if(0===n){var o=new _s(i.path);this.tt(e,o,qs.newNoDocument(o,rs.min()))}else Wo(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach((function(r,i){var o=e.ot(i);if(o){if(r.current&&zs(o.target)){var s=new _s(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,qs.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}}));var r=mu();this.J.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Eu(t,n,this.Y,this.H,r);return this.H=pu(),this.J=Du(),this.Y=new hu(Zo),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new Nu,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new hu(Zo),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||Ko("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.F?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new Nu),this.W.getRemoteKeysForTarget(t).forEach((function(n){e.tt(t,n,null)}))},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function Du(){return new au(_s.comparator)}function Cu(){return new au(_s.comparator)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ku={asc:"ASCENDING",desc:"DESCENDING"},xu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ru=function(t,e){this.databaseId=t,this.I=e};function Ou(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Lu(t,e){return t.I?e.toBase64():e.toUint8Array()}function Pu(t,e){return Ou(t,e.toTimestamp())}function Fu(t){return Wo(!!t),rs.fromTimestamp(function(t){var e=ds(t);return new ns(e.seconds,e.nanos)}(t))}function Mu(t,e){return function(t){return new us(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Vu(t){var e=us.fromString(t);return Wo(ac(e)),e}function Uu(t,e){return Mu(t.databaseId,e.path)}function qu(t,e){var n=Vu(e);if(n.get(1)!==t.databaseId.projectId)throw new jo(qo.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new jo(qo.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new _s(Ku(n))}function ju(t,e){return Mu(t.databaseId,e)}function Bu(t){var e=Vu(t);return 4===e.length?us.emptyPath():Ku(e)}function $u(t){return new us(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Ku(t){return Wo(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function zu(t,e,n){return{name:Uu(t,e),fields:n.value.mapValue.fields}}function Gu(t,e){var n;if(e instanceof Wa)n={update:zu(t,e.key,e.value)};else if(e instanceof nu)n={delete:Uu(t,e.key)};else if(e instanceof Ya)n={update:zu(t,e.key,e.data),updateMask:sc(e.fieldMask)};else{if(!(e instanceof ru))return Qo();n={verify:Uu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof xa)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ra)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof La)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Fa)return{fieldPath:e.field.canonicalString(),increment:n.A};throw Qo()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Pu(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Qo()}(t,e.precondition)),n}function Hu(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?ja.updateTime(Fu(t.updateTime)):void 0!==t.exists?ja.exists(t.exists):ja.none()}(e.currentDocument):ja.none(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)Wo("REQUEST_TIME"===e.setToServerValue),n=new xa;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new Ra(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new La(i)}else"increment"in e?n=new Fa(t,e.increment):Qo();var o=hs.fromServerFormat(e.fieldPath);return new Ua(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=qu(t,e.update.name),o=new Vs({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){var e=t.fieldPaths||[];return new ls(e.map((function(t){return hs.fromServerFormat(t)})))}(e.updateMask);return new Ya(i,o,s,n,r)}return new Wa(i,o,n,r)}if(e.delete){var a=qu(t,e.delete);return new nu(a,n)}if(e.verify){var u=qu(t,e.verify);return new ru(u,n)}return Qo()}function Qu(t,e){return{documents:[ju(t,e.path)]}}function Wu(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=ju(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ju(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(Ps(t.value))return{unaryFilter:{field:nc(t.field),op:"IS_NAN"}};if(Ls(t.value))return{unaryFilter:{field:nc(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ps(t.value))return{unaryFilter:{field:nc(t.field),op:"IS_NOT_NAN"}};if(Ls(t.value))return{unaryFilter:{field:nc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:nc(t.field),op:ec(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:nc(t.field),direction:tc(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.I||ws(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=Ju(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Ju(e.endAt)),n}function Yu(t){var e=Bu(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Wo(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=Xu(n.where));var a=[];n.orderBy&&(a=n.orderBy.map((function(t){return function(t){return new ra(rc(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return ws(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Zu(n.startAt));var h=null;return n.endAt&&(h=Zu(n.endAt)),ua(e,i,a,s,u,"F",c,h)}function Xu(t){return t?void 0!==t.unaryFilter?[oc(t)]:void 0!==t.fieldFilter?[ic(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return Xu(t)})).reduce((function(t,e){return t.concat(e)})):Qo():[]}function Ju(t){return{before:t.before,values:t.position}}function Zu(t){var e=!!t.before,n=t.values||[];return new ea(n,e)}function tc(t){return ku[t]}function ec(t){return xu[t]}function nc(t){return{fieldPath:t.canonicalString()}}function rc(t){return hs.fromServerFormat(t.fieldPath)}function ic(t){return Gs.create(rc(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Qo()}}(t.fieldFilter.op),t.fieldFilter.value)}function oc(t){switch(t.unaryFilter.op){case"IS_NAN":var e=rc(t.unaryFilter.field);return Gs.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=rc(t.unaryFilter.field);return Gs.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=rc(t.unaryFilter.field);return Gs.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=rc(t.unaryFilter.field);return Gs.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Qo()}}function sc(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function ac(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function uc(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=hc(e)),e=cc(t.get(n),e);return hc(e)}function cc(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function hc(t){return t+""}function lc(t){var e=t.length;if(Wo(e>=2),2===e)return Wo(""===t.charAt(0)&&""===t.charAt(1)),us.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&Qo(),t.charAt(s+1)){case"":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Qo()}o=s+2}return new us(r)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var fc=function(t,e){this.seconds=t,this.nanoseconds=e},pc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};pc.store="owner",pc.key="owner";var dc=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};dc.store="mutationQueues",dc.keyPath="userId";var yc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};yc.store="mutations",yc.keyPath="batchId",yc.userMutationsIndex="userMutationsIndex",yc.userMutationsKeyPath=["userId","batchId"];var gc=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,uc(e)]},t.key=function(t,e,n){return[t,uc(e),n]},t}();gc.store="documentMutations",gc.PLACEHOLDER=new gc;var vc=function(t,e){this.path=t,this.readTime=e},mc=function(t,e){this.path=t,this.version=e},bc=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};bc.store="remoteDocuments",bc.readTimeIndex="readTimeIndex",bc.readTimeIndexPath="readTime",bc.collectionReadTimeIndex="collectionReadTimeIndex",bc.collectionReadTimeIndexPath=["parentPath","readTime"];var wc=function(t){this.byteSize=t};wc.store="remoteDocumentGlobal",wc.key="remoteDocumentGlobalKey";var Ec=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Ec.store="targets",Ec.keyPath="targetId",Ec.queryTargetsIndexName="queryTargetsIndex",Ec.queryTargetsKeyPath=["canonicalId","targetId"];var Ic=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ic.store="targetDocuments",Ic.keyPath=["targetId","path"],Ic.documentTargetsIndex="documentTargetsIndex",Ic.documentTargetsKeyPath=["path","targetId"];var _c=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};_c.key="targetGlobalKey",_c.store="targetGlobal";var Tc=function(t,e){this.collectionId=t,this.parent=e};Tc.store="collectionParents",Tc.keyPath=["collectionId","parent"];var Sc=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Sc.store="clientMetadata",Sc.keyPath="clientId";var Nc=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Nc.store="bundles",Nc.keyPath="bundleId";var Ac=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Ac.store="namedQueries",Ac.keyPath="name";var Dc=xt(xt([],xt(xt([],xt(xt([],xt(xt([],[dc.store,yc.store,gc.store,bc.store,Ec.store,pc.store,_c.store,Ic.store]),[Sc.store])),[wc.store])),[Tc.store])),[Nc.store,Ac.store]),Cc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",kc=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),xc=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},Rc=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&Qo(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),Oc=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new xc,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new Fc(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=jc(e.target.error);n.ft.reject(new Fc(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Fc(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(Ko("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Vc(e)},t}(),Lc=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(Mt())&&zo("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Ko("SimpleDb","Removing database:",t),Uc(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=Mt(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return At(this,void 0,void 0,(function(){var e,n=this;return Dt(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(Ko("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new Fc(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new jo(qo.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new Fc(t,n))},i.onupgradeneeded=function(t){Ko("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.wt.Rt(e,i.transaction,t.oldVersion,n.version).next((function(){Ko("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}}))}))},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return At(this,void 0,void 0,(function(){var i,o,s,a,u;return Dt(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,h;return Dt(this,(function(l){switch(l.label){case 0:++o,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,a.At(t)];case 2:return a.db=l.sent(),e=Oc.open(a.db,t,i?"readonly":"readwrite",n),s=r(e).catch((function(t){return e.abort(t),Rc.reject(t)})).toPromise(),u={},s.catch((function(){})),[4,e.dt];case 3:return[2,(u.value=(l.sent(),s),u)];case 4:return c=l.sent(),h="FirebaseError"!==c.name&&o<3,Ko("SimpleDb","Transaction failed with error:",c.message,"Retrying:",h),a.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Pc=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return Uc(this.Pt.delete())},t}(),Fc=function(t){function e(e,n){var r=this;return(r=t.call(this,qo.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return St(e,t),e}(jo);function Mc(t){return"IndexedDbTransactionError"===t.name}var Vc=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Ko("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Ko("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Uc(n)},t.prototype.add=function(t){return Ko("SimpleDb","ADD",this.store.name,t,t),Uc(this.store.add(t))},t.prototype.get=function(t){var e=this;return Uc(this.store.get(t)).next((function(n){return void 0===n&&(n=null),Ko("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return Ko("SimpleDb","DELETE",this.store.name,t),Uc(this.store.delete(t))},t.prototype.count=function(){return Ko("SimpleDb","COUNT",this.store.name),Uc(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.kt=function(t,e){Ko("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Ft=!1;var r=this.cursor(n);return this.xt(r,(function(t,e,n){return n.delete()}))},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new Rc((function(n,r){e.onerror=function(t){var e=jc(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.xt=function(t,e){var n=[];return new Rc((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Pc(i),s=e(i.primaryKey,i.value,o);if(s instanceof Rc){var a=s.catch((function(t){return o.done(),Rc.reject(t)}));n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return Rc.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Ft?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Uc(t){return new Rc((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=jc(t.target.error);n(e)}}))}var qc=!1;function jc(t){var e=Lc._t(Mt());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new jo("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return qc||(qc=!0,setTimeout((function(){throw r}),0)),r}}return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Bc=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return St(e,t),e}(kc);function $c(t,e){var n=Yo(t);return Lc.It(n.Mt,e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Kc=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&Ka(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&za(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&za(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(rs.min())}))},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),mu())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&ts(this.mutations,t.mutations,(function(t,e){return Ha(t,e)}))&&ts(this.baseMutations,t.baseMutations,(function(t,e){return Ha(t,e)}))},t}(),zc=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){Wo(e.mutations.length===r.length);for(var i=gu,o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Gc=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=rs.min()),void 0===o&&(o=rs.min()),void 0===s&&(s=fs.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),Hc=function(t){this.Lt=t};function Qc(t,e){if(e.document)return function(t,e,n){var r=qu(t,e.name),i=Fu(e.updateTime),o=new Vs({mapValue:{fields:e.fields}}),s=qs.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=_s.fromSegments(e.noDocument.path),r=Zc(e.noDocument.readTime),i=qs.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=_s.fromSegments(e.unknownDocument.path);return r=Zc(e.unknownDocument.version),qs.newUnknownDocument(o,r)}return Qo()}function Wc(t,e,n){var r=Yc(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:Uu(t,e.key),fields:e.data.value.mapValue.fields,updateTime:Ou(t,e.version.toTimestamp())}}(t.Lt,e),s=e.hasCommittedMutations;return new bc(null,null,o,s,r,i)}if(e.isNoDocument()){var a=e.key.path.toArray(),u=Jc(e.version);return s=e.hasCommittedMutations,new bc(null,new vc(a,u),null,s,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),h=Jc(e.version);return new bc(new mc(c,h),null,null,!0,r,i)}return Qo()}function Yc(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Xc(t){var e=new ns(t[0],t[1]);return rs.fromTimestamp(e)}function Jc(t){var e=t.toTimestamp();return new fc(e.seconds,e.nanoseconds)}function Zc(t){var e=new ns(t.seconds,t.nanoseconds);return rs.fromTimestamp(e)}function th(t,e){for(var n=(e.baseMutations||[]).map((function(e){return Hu(t.Lt,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var s=e.mutations.map((function(e){return Hu(t.Lt,e)})),a=ns.fromMillis(e.localWriteTimeMs);return new Kc(e.batchId,a,n,s)}function eh(t){var e,n,r=Zc(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Zc(t.lastLimboFreeSnapshotVersion):rs.min();return void 0!==t.query.documents?(Wo(1===(n=t.query).documents.length),e=ga(ca(Bu(n.documents[0])))):e=function(t){return ga(Yu(t))}(t.query),new Gc(e,t.targetId,0,t.lastListenSequenceNumber,r,i,fs.fromBase64String(t.resumeToken))}function nh(t,e){var n,r=Jc(e.snapshotVersion),i=Jc(e.lastLimboFreeSnapshotVersion);n=zs(e.target)?Qu(t.Lt,e.target):Wu(t.Lt,e.target);var o=e.resumeToken.toBase64();return new Ec(e.targetId,$s(e.target),r,o,e.sequenceNumber,i,n)}function rh(t){var e=Yu({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?va(e,e.limit,"L"):e}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ih=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return oh(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:Zc(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return oh(t).put({bundleId:(n=e).id,createTime:Jc(Fu(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return sh(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:rh(e.bundledQuery),readTime:Zc(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return sh(t).put(function(t){return{name:t.name,readTime:Jc(Fu(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function oh(t){return $c(t,Nc.store)}function sh(t){return $c(t,Ac.store)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ah=function(){function t(){this.Bt=new uh}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),Rc.resolve()},t.prototype.getCollectionParents=function(t,e){return Rc.resolve(this.Bt.getEntries(e))},t}(),uh=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new hu(us.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new hu(us.comparator)).toArray()},t}(),ch=function(){function t(){this.qt=new uh}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.qt.add(e)}));var o={collectionId:r,parent:uc(i)};return hh(t).put(o)}return Rc.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[es(e),""],!1,!0);return hh(t).Nt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(lc(o.parent))}return n}))},t}();function hh(t){return $c(t,Tc.store)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var lh={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},fh=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ph(t,e,n){var r=t.store(yc.store),i=t.store(gc.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},(function(t,e,n){return a++,n.delete()}));o.push(u.next((function(){Wo(1===a)})));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],p=gc.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return Rc.waitFor(o).next((function(){return c}))}function dh(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Qo();e=t.noDocument}return JSON.stringify(e).length}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */fh.DEFAULT_COLLECTION_PERCENTILE=10,fh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,fh.DEFAULT=new fh(41943040,fh.DEFAULT_COLLECTION_PERCENTILE,fh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),fh.DISABLED=new fh(-1,0,0);var yh=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Kt={}}return t.Qt=function(e,n,r,i){return Wo(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return vh(t).$t({index:yc.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=mh(t),s=vh(t);return s.add({}).next((function(a){Wo("number"==typeof a);for(var u=new Kc(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return Gu(t.Lt,e)})),i=n.mutations.map((function(e){return Gu(t.Lt,e)}));return new yc(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),h=[],l=new hu((function(t,e){return Zo(t.canonicalString(),e.canonicalString())})),f=0,p=r;f<p.length;f++){var d=p[f],y=gc.key(i.userId,d.key.path,a);l=l.add(d.key.path.popLast()),h.push(s.put(c)),h.push(o.put(y,gc.PLACEHOLDER))}return l.forEach((function(e){h.push(i.Ut.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.Kt[a]=u.keys()})),Rc.waitFor(h).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return vh(t).get(e).next((function(t){return t?(Wo(t.userId===n.userId),th(n.R,t)):null}))},t.prototype.jt=function(t,e){var n=this;return this.Kt[e]?Rc.resolve(this.Kt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.Kt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return vh(t).$t({index:yc.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(Wo(e.batchId>=r),o=th(n.R,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return vh(t).$t({index:yc.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return vh(t).Nt(yc.userMutationsIndex,n).next((function(t){return t.map((function(t){return th(e.R,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=gc.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return mh(t).$t({range:i},(function(r,i,s){var a=r[0],u=r[1],c=r[2],h=lc(u);if(a===n.userId&&e.path.isEqual(h))return vh(t).get(c).next((function(t){if(!t)throw Qo();Wo(t.userId===n.userId),o.push(th(n.R,t))}));s.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new hu(Zo),i=[];return e.forEach((function(e){var o=gc.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=mh(t).$t({range:s},(function(t,i,o){var s=t[0],a=t[1],u=t[2],c=lc(a);s===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(a)})),Rc.waitFor(i).next((function(){return n.Wt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=gc.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new hu(Zo);return mh(t).$t({range:s},(function(t,e,o){var s=t[0],u=t[1],c=t[2],h=lc(u);s===n.userId&&r.isPrefixOf(h)?h.length===i&&(a=a.add(c)):o.done()})).next((function(){return n.Wt(t,a)}))},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(vh(t).get(e).next((function(t){if(null===t)throw Qo();Wo(t.userId===n.userId),r.push(th(n.R,t))})))})),Rc.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return ph(t.Mt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Gt(e.batchId)})),Rc.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Gt=function(t){delete this.Kt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return Rc.resolve();var r=IDBKeyRange.lowerBound(gc.prefixForUser(e.userId)),i=[];return mh(t).$t({range:r},(function(t,n,r){if(t[0]===e.userId){var o=lc(t[1]);i.push(o)}else r.done()})).next((function(){Wo(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return gh(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return bh(t).get(this.userId).next((function(t){return t||new dc(e.userId,-1,"")}))},t}();function gh(t,e,n){var r=gc.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return mh(t).$t({range:o,Ft:!0},(function(t,n,r){var o=t[0],a=t[1];t[2],o===e&&a===i&&(s=!0),r.done()})).next((function(){return s}))}function vh(t){return $c(t,yc.store)}function mh(t){return $c(t,gc.store)}function bh(t){return $c(t,dc.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var wh=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),Eh=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next((function(n){var r=new wh(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next((function(t){return rs.fromTimestamp(new ns(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next((function(){return n.Xt(t).next((function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return Ih(t).delete(e.targetId)})).next((function(){return n.Xt(t)})).next((function(e){return Wo(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Ih(t).$t((function(s,a){var u=eh(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return Rc.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return Ih(t).$t((function(t,n){var r=eh(n);e(r)}))},t.prototype.Xt=function(t){return _h(t).get(_c.key).next((function(t){return Wo(null!==t),t}))},t.prototype.Zt=function(t,e){return _h(t).put(_c.key,e)},t.prototype.te=function(t,e){return Ih(t).put(nh(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=$s(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Ih(t).$t({range:r,index:Ec.queryTargetsIndexName},(function(t,n,r){var o=eh(n);Ks(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Th(t);return e.forEach((function(e){var s=uc(e.path);i.push(o.put(new Ic(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))})),Rc.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Th(t);return Rc.forEach(e,(function(e){var o=uc(e.path);return Rc.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Th(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Th(t),i=mu();return r.$t({range:n,Ft:!0},(function(t,e,n){var r=lc(t[1]),o=new _s(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=uc(e.path),r=IDBKeyRange.bound([n],[es(n)],!1,!0),i=0;return Th(t).$t({index:Ic.documentTargetsIndex,Ft:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.lt=function(t,e){return Ih(t).get(e).next((function(t){return t?eh(t):null}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ih(t){return $c(t,Ec.store)}function _h(t){return $c(t,_c.store)}function Th(t){return $c(t,Ic.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Sh(t){return At(this,void 0,void 0,(function(){return Dt(this,(function(e){if(t.code!==qo.FAILED_PRECONDITION||t.message!==Cc)throw t;return Ko("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Nh(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Zo(n,i);return 0===s?Zo(r,o):s}var Ah=function(){function t(t){this.ne=t,this.buffer=new hu(Nh),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Nh(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Dh=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;Ko("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return At(e,void 0,void 0,(function(){var e;return Dt(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return Mc(e=n.sent())?(Ko("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Sh(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),Ch=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return Rc.resolve(Uo.o);var r=new Ah(e);return this.ae.forEachTarget(t,(function(t){return r.re(t.sequenceNumber)})).next((function(){return n.ae.le(t,(function(t){return r.re(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Ko("LruGarbageCollector","Garbage collection skipped; disabled"),Rc.resolve(lh)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(Ko("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),lh):n.fe(t,e)}))},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,a,u,c=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>c.params.maximumSequenceNumbersToCollect?(Ko("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)})).next((function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)})).next((function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)})).next((function(t){return u=Date.now(),$o()<=te.DEBUG&&Ko("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-h)+"ms"),Rc.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),kh=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new Ch(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.de=function(t){var e=0;return this.le(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return xh(t,n)},t.prototype.removeReference=function(t,e,n){return xh(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return xh(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return bh(t).Ot((function(r){return gh(t,r,e).next((function(t){return t&&(n=!0),Rc.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,(function(s,a){if(a<=e){var u=n._e(t,s).next((function(e){if(!e)return o++,r.getEntry(t,s).next((function(){return r.removeEntry(s),Th(t).delete([0,uc(s.path)])}))}));i.push(u)}})).next((function(){return Rc.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return xh(t,e)},t.prototype.we=function(t,e){var n,r=Th(t),i=Uo.o;return r.$t({index:Ic.documentTargetsIndex},(function(t,r){var o=t[0];t[1];var s=r.path,a=r.sequenceNumber;0===o?(i!==Uo.o&&e(new _s(lc(n)),i),i=a,n=s):i=Uo.o})).next((function(){i!==Uo.o&&e(new _s(lc(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function xh(t,e){return Th(t).put(function(t,e){return new Ic(0,uc(t.path),e)}(e,t.currentSequenceNumber))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Rh=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.equalsFn(s,t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){os(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];t(s,a)}}))},t.prototype.isEmpty=function(){return ss(this.inner)},t}(),Oh=function(){function t(){this.changes=new Rh((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:rs.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:qs.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?Rc.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),Lh=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return Mh(t).put(Vh(e),n)},t.prototype.removeEntry=function(t,e){var n=Mh(t),r=Vh(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.me(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return Mh(t).get(Vh(e)).next((function(t){return n.ye(e,t)}))},t.prototype.ge=function(t,e){var n=this;return Mh(t).get(Vh(e)).next((function(t){return{document:n.ye(e,t),size:dh(t)}}))},t.prototype.getEntries=function(t,e){var n=this,r=pu();return this.pe(t,e,(function(t,e){var i=n.ye(t,e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.Ee=function(t,e){var n=this,r=pu(),i=new au(_s.comparator);return this.pe(t,e,(function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,dh(e))})).next((function(){return{documents:r,Te:i}}))},t.prototype.pe=function(t,e,n){if(e.isEmpty())return Rc.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return Mh(t).$t({range:r},(function(t,e,r){for(var s=_s.fromSegments(t);o&&_s.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=pu(),o=e.path.length+1,s={};if(n.isEqual(rs.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=Yc(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=bc.collectionReadTimeIndex}return Mh(t).$t(s,(function(t,n,s){if(t.length===o){var a=Qc(r.R,n);e.path.isPrefixOf(a.key.path)?Ea(e,a)&&(i=i.insert(a.key,a)):s.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new Ph(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return Fh(t).get(wc.key).next((function(t){return Wo(!!t),t}))},t.prototype.me=function(t,e){return Fh(t).put(wc.key,e)},t.prototype.ye=function(t,e){if(e){var n=Qc(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(rs.min()))return n}return qs.newInvalidDocument(t)},t}(),Ph=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new Rh((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return St(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new hu((function(t,e){return Zo(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=Wc(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=dh(u);r+=c-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var h=Wc(e.Ie.R,qs.newNoDocument(o,rs.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,h))}else n.push(e.Ie.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))})),n.push(this.Ie.updateMetadata(t,r)),Rc.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next((function(t){return n.Ae.set(e,t.size),t.document}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next((function(t){var e=t.documents;return t.Te.forEach((function(t,e){n.Ae.set(t,e)})),e}))},e}(Oh);
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Fh(t){return $c(t,wc.store)}function Mh(t){return $c(t,bc.store)}function Vh(t){return t.path.toArray()}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Uh=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;Wo(n<r&&n>=0&&r<=11);var o=new Oc("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(pc.store)}(t),function(t){t.createObjectStore(dc.store,{keyPath:dc.keyPath}),t.createObjectStore(yc.store,{keyPath:yc.keyPath,autoIncrement:!0}).createIndex(yc.userMutationsIndex,yc.userMutationsKeyPath,{unique:!0}),t.createObjectStore(gc.store)}(t),qh(t),function(t){t.createObjectStore(bc.store)}(t));var s=Rc.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Ic.store),t.deleteObjectStore(Ec.store),t.deleteObjectStore(_c.store)}(t),qh(t)),s=s.next((function(){return function(t){var e=t.store(_c.store),n=new _c(0,0,rs.min().toTimestamp(),0);return e.put(_c.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(yc.store).Nt().next((function(n){t.deleteObjectStore(yc.store),t.createObjectStore(yc.store,{keyPath:yc.keyPath,autoIncrement:!0}).createIndex(yc.userMutationsIndex,yc.userMutationsKeyPath,{unique:!0});var r=e.store(yc.store),i=n.map((function(t){return r.put(t)}));return Rc.waitFor(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Sc.store,{keyPath:Sc.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.Re(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(wc.store)}(t),i.be(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ve(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.Pe(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(bc.store);e.createIndex(bc.readTimeIndex,bc.readTimeIndexPath,{unique:!1}),e.createIndex(bc.collectionReadTimeIndex,bc.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(Nc.store,{keyPath:Nc.keyPath})}(t),function(t){t.createObjectStore(Ac.store,{keyPath:Ac.keyPath})}(t)}))),s},t.prototype.be=function(t){var e=0;return t.store(bc.store).$t((function(t,n){e+=dh(n)})).next((function(){var n=new wc(e);return t.store(wc.store).put(wc.key,n)}))},t.prototype.Re=function(t){var e=this,n=t.store(dc.store),r=t.store(yc.store);return n.Nt().next((function(n){return Rc.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(yc.userMutationsIndex,i).next((function(r){return Rc.forEach(r,(function(r){Wo(r.userId===n.userId);var i=th(e.R,r);return ph(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ve=function(t){var e=t.store(Ic.store),n=t.store(bc.store);return t.store(_c.store).get(_c.key).next((function(t){var r=[];return n.$t((function(n,i){var o=new us(n),s=function(t){return[0,uc(t)]}(o);r.push(e.get(s).next((function(n){return n?Rc.resolve():function(n){return e.put(new Ic(0,uc(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return Rc.waitFor(r)}))}))},t.prototype.Pe=function(t,e){t.createObjectStore(Tc.store,{keyPath:Tc.keyPath});var n=e.store(Tc.store),r=new uh,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:uc(i)})}};return e.store(bc.store).$t({Ft:!0},(function(t,e){var n=new us(t);return i(n.popLast())})).next((function(){return e.store(gc.store).$t({Ft:!0},(function(t,e){t[0];var n=t[1];t[2];var r=lc(n);return i(r.popLast())}))}))},t.prototype.Ve=function(t){var e=this,n=t.store(Ec.store);return n.$t((function(t,r){var i=eh(r),o=nh(e.R,i);return n.put(o)}))},t}();function qh(t){t.createObjectStore(Ic.store,{keyPath:Ic.keyPath}).createIndex(Ic.documentTargetsIndex,Ic.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ec.store,{keyPath:Ec.keyPath}).createIndex(Ec.queryTargetsIndexName,Ec.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(_c.store)}var jh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Bh=function(){function t(e,n,r,i,o,s,a,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=c,this.Ce=h,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ke=null,this.inForeground=!1,this.Fe=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new jo(qo.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new kh(this,i),this.Le=n+"main",this.R=new Hc(u),this.Be=new Lc(this.Le,11,new Uh(this.R)),this.qe=new Eh(this.referenceDelegate,this.R),this.Ut=new ch,this.Ue=function(t,e){return new Lh(t,e)}(this.R,this.Ut),this.Ke=new ih,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===h&&zo("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new jo(qo.FAILED_PRECONDITION,jh);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.qe.getHighestSequenceNumber(e)}))})).then((function(e){t.Ne=new Uo(e,t.De)})).then((function(){t.xe=!0})).catch((function(e){return t.Be&&t.Be.close(),Promise.reject(e)}))},t.prototype.He=function(t){var e=this;return this.Me=function(n){return At(e,void 0,void 0,(function(){return Dt(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt((function(n){return At(e,void 0,void 0,(function(){return Dt(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget((function(){return At(e,void 0,void 0,(function(){return Dt(this,(function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return Kh(e).put(new Sc(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Je(e).next((function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable((function(){return t.Me(!1)})))}))})).next((function(){return t.Ye(e)})).next((function(n){return t.isPrimary&&!n?t.Xe(e).next((function(){return!1})):!!n&&t.Ze(e).next((function(){return!0}))}))})).catch((function(e){if(Mc(e))return Ko("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Ko("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Se.enqueueRetryable((function(){return t.Me(e)})),t.isPrimary=e}))},t.prototype.Je=function(t){var e=this;return $h(t).get(pc.key).next((function(t){return Rc.resolve(e.tn(t))}))},t.prototype.en=function(t){return Kh(t).delete(this.clientId)},t.prototype.nn=function(){return At(this,void 0,void 0,(function(){var t,e,n,r,i=this;return Dt(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=$c(t,Sc.store);return e.Nt().next((function(t){var n=i.rn(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return Rc.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Qe)for(e=0,n=t;e<n.length;e++)r=n[e],this.Qe.removeItem(this.on(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.je().then((function(){return t.nn()})).then((function(){return t.ze()}))}))},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?Rc.resolve(!0):$h(t).get(pc.key).next((function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new jo(qo.FAILED_PRECONDITION,jh);return!1}}return!(!e.networkEnabled||!e.inForeground)||Kh(t).Nt().next((function(t){return void 0===e.rn(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&Ko("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return At(this,void 0,void 0,(function(){var t=this;return Dt(this,(function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[pc.store,Sc.store],(function(e){var n=new Bc(e,Uo.o);return t.Xe(n).next((function(){return t.en(n)}))}))];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}}))}))},t.prototype.rn=function(t,e){var n=this;return t.filter((function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)}))},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return Kh(e).Nt().next((function(e){return t.rn(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return yh.Qt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;Ko("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Be.runTransaction(t,o,Dc,(function(o){return i=new Bc(o,r.Ne?r.Ne.next():Uo.o),"readwrite-primary"===e?r.Je(i).next((function(t){return!!t||r.Ye(i)})).next((function(e){if(!e)throw zo("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new jo(qo.FAILED_PRECONDITION,Cc);return n(i)})).next((function(t){return r.Ze(i).next((function(){return t}))})):r.dn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.dn=function(t){var e=this;return $h(t).get(pc.key).next((function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new jo(qo.FAILED_PRECONDITION,jh)}))},t.prototype.Ze=function(t){var e=new pc(this.clientId,this.allowTabSynchronization,Date.now());return $h(t).put(pc.key,e)},t.yt=function(){return Lc.yt()},t.prototype.Xe=function(t){var e=this,n=$h(t);return n.get(pc.key).next((function(t){return e.tn(t)?(Ko("IndexedDbPersistence","Releasing primary lease."),n.delete(pc.key)):Rc.resolve()}))},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(zo("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Fe=function(){t.Se.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.je()}))},this.document.addEventListener("visibilitychange",this.Fe),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.Fe&&(this.document.removeEventListener("visibilitychange",this.Fe),this.Fe=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.ke=function(){e.un(),!Vt()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")&&navigator.appVersion.match("Version/14")&&e.Se.enterRestrictedMode(!0),e.Se.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.ke))},t.prototype.hn=function(){this.ke&&(this.window.removeEventListener("pagehide",this.ke),this.ke=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Qe)||void 0===e?void 0:e.getItem(this.on(t)));return Ko("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return zo("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(t){zo("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function $h(t){return $c(t,pc.store)}function Kh(t){return $c(t,Sc.store)}function zh(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var Gh=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.yn(t,e,r)}))},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next((function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t}))},t.prototype.gn=function(t,e){t.forEach((function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)}))},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next((function(e){return n.En(t,e).next((function(){return e}))}))},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.gn(e,t)}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return _s.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):da(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new _s(e)).next((function(t){var e=yu();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=yu();return this.Ut.getCollectionParents(t,i).next((function(s){return Rc.forEach(s,(function(s){var a=function(t,e){return new aa(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.An(t,a,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.Rn(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,h=r.get(c);null==h&&(h=qs.newInvalidDocument(c),r=r.insert(c,h)),za(u,h,o.localWriteTime),h.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(t,n){Ea(e,n)||(r=r.remove(t))})),r}))},t.prototype.Rn=function(t,e,n){for(var r=mu(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof Ya&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))})),c}))},t}(),Hh=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=mu(),i=mu(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Qh=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(rs.min())?this.Dn(t,e):this.Sn.pn(t,r).next((function(o){var s=i.Cn(e,o);return(ha(e)||la(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):($o()<=te.DEBUG&&Ko("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),wa(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next((function(t){return s.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.Cn=function(t,e){var n=new hu(Ia(t));return e.forEach((function(e,r){Ea(t,r)&&(n=n.add(r))})),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return $o()<=te.DEBUG&&Ko("QueryEngine","Using full collection scan to execute query:",wa(e)),this.Sn.getDocumentsMatchingQuery(t,e,rs.min())},t}(),Wh=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.kn=new au(Zo),this.Fn=new Rh((function(t){return $s(t)}),Ks),this.$n=rs.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new Gh(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.kn)}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Yh(t,e,n,r){return new Wh(t,e,n,r)}function Xh(t,e){return At(this,void 0,void 0,(function(){var n,r,i,o;return Dt(this,(function(s){switch(s.label){case 0:return n=Yo(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n._n.getAllMutationBatches(t).next((function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new Gh(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],s=mu(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];s=s.add(f.key)}}for(var p=0,d=e;p<d.length;p++){var y=d[p];r.push(y.batchId);for(var g=0,v=y.mutations;g<v.length;g++){var m=v[g];s=s.add(m.key)}}return i.pn(t,s).next((function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}}))}))}function Jh(t,e){var n=Yo(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=Rc.resolve();return o.forEach((function(t){s=s.next((function(){return r.getEntry(e,t)})).next((function(e){var o=n.docVersions.get(t);Wo(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))}))})),s.next((function(){return t._n.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}function Zh(t){var e=Yo(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.qe.getLastRemoteSnapshotVersion(t)}))}function tl(t,e){var n=Yo(t),r=e.snapshotVersion,i=n.kn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.kn;var s=[];e.targetChanges.forEach((function(e,o){var a=i.get(o);if(a){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)})));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=a.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return Wo(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,c,e)&&s.push(n.qe.updateTargetData(t,c))}}}));var a=pu();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),s.push(function(t,e,n,r,i){var o=mu();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=pu();return n.forEach((function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(rs.min())?(e.removeEntry(n,u),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):Ko("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)})),o}))}(t,o,e.documentUpdates,r,void 0).next((function(t){a=t}))),!r.isEqual(rs.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next((function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)}));s.push(u)}return Rc.waitFor(s).next((function(){return o.apply(t)})).next((function(){return n.Mn.En(t,a)})).next((function(){return a}))})).then((function(t){return n.kn=i,t}))}function el(t,e){var n=Yo(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)}))}function nl(t,e){var n=Yo(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.qe.getTargetData(t,e).next((function(i){return i?(r=i,Rc.resolve(r)):n.qe.allocateTargetId(t).next((function(i){return r=new Gc(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.kn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.kn=n.kn.insert(t.targetId,t),n.Fn.set(e,t.targetId)),t}))}function rl(t,e,n){return At(this,void 0,void 0,(function(){var r,i,o,s;return Dt(this,(function(a){switch(a.label){case 0:r=Yo(t),i=r.kn.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.referenceDelegate.removeTarget(t,i)}))];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!Mc(s=a.sent()))throw s;return Ko("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.kn=r.kn.remove(e),r.Fn.delete(i.target),[2]}}))}))}function il(t,e,n){var r=Yo(t),i=rs.min(),o=mu();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=Yo(t),i=r.Fn.get(n);return void 0!==i?Rc.resolve(r.kn.get(i)):r.qe.getTargetData(e,n)}(r,t,ga(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:rs.min(),n?o:mu())})).next((function(t){return{documents:t,Bn:o}}))}))}function ol(t,e){var n=Yo(t),r=Yo(n.qe),i=n.kn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.lt(t,e).next((function(t){return t?t.target:null}))}))}function sl(t){var e=Yo(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=Yo(t),i=pu(),o=Yc(n),s=Mh(e),a=IDBKeyRange.lowerBound(o,!0);return s.$t({index:bc.readTimeIndex,range:a},(function(t,e){var n=Qc(r.R,e);i=i.insert(n.key,n),o=e.readTime})).next((function(){return{wn:i,readTime:Xc(o)}}))}(e.On,t,e.$n)})).then((function(t){var n=t.wn,r=t.readTime;return e.$n=r,n}))}function al(t){return At(this,void 0,void 0,(function(){var e;return Dt(this,(function(n){return[2,(e=Yo(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=Mh(t),n=rs.min();return e.$t({index:bc.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=Xc(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.$n=t}))]}))}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ul=function(){function t(t){this.R=t,this.Qn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return Rc.resolve(this.Qn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Qn.set(e.id,{id:(n=e).id,version:n.version,createTime:Fu(n.createTime)}),Rc.resolve()},t.prototype.getNamedQuery=function(t,e){return Rc.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:rh(t.bundledQuery),readTime:Fu(t.readTime)}}(e)),Rc.resolve()},t}(),cl=function(){function t(){this.Wn=new hu(hl.Gn),this.zn=new hu(hl.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new hl(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.Yn(new hl(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.Zn=function(t){var e=this,n=new _s(new us([])),r=new hl(n,t),i=new hl(n,t+1),o=[];return this.zn.forEachInRange([r,i],(function(t){e.Yn(t),o.push(t.key)})),o},t.prototype.ts=function(){var t=this;this.Wn.forEach((function(e){return t.Yn(e)}))},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new _s(new us([])),n=new hl(e,t),r=new hl(e,t+1),i=mu();return this.zn.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new hl(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),hl=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return _s.comparator(t.key,e.key)||Zo(t.ns,e.ns)},t.Hn=function(t,e){return Zo(t.ns,e.ns)||_s.comparator(t.key,e.key)},t}(),ll=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new hu(hl.Gn)}return t.prototype.checkEmpty=function(t){return Rc.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new Kc(i,e,n,r);this._n.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.rs=this.rs.add(new hl(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return Rc.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return Rc.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.cs(n),i=r<0?0:r;return Rc.resolve(this._n.length>i?this._n[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return Rc.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return Rc.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new hl(e,0),i=new hl(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(t){var e=n.os(t.ns);o.push(e)})),Rc.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new hu(Zo);return e.forEach((function(t){var e=new hl(t,0),i=new hl(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],(function(t){r=r.add(t.ns)}))})),Rc.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;_s.isDocumentKey(i)||(i=i.child(""));var o=new hl(new _s(i),0),s=new hu(Zo);return this.rs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)}),o),Rc.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.os(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;Wo(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return Rc.forEach(e.mutations,(function(i){var o=new hl(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.rs=r}))},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new hl(e,0),r=this.rs.firstAfterOrEqual(n);return Rc.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return this._n.length,Rc.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),fl=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new au(_s.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Rc.resolve(n?n.document.clone():qs.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=pu();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():qs.newInvalidDocument(t))})),Rc.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=pu(),i=new _s(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.key,u=s.value,c=u.document,h=u.readTime;if(!e.path.isPrefixOf(a.path))break;h.compareTo(n)<=0||Ea(e,c)&&(r=r.insert(c.key,c.clone()))}return Rc.resolve(r)},t.prototype.fs=function(t,e){return Rc.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new pl(this)},t.prototype.getSize=function(t){return Rc.resolve(this.size)},t}(),pl=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return St(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)})),Rc.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(Oh),dl=function(){function t(t){this.persistence=t,this.ds=new Rh((function(t){return $s(t)}),Ks),this.lastRemoteSnapshotVersion=rs.min(),this.highestTargetId=0,this.ws=0,this._s=new cl,this.targetCount=0,this.ys=wh.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach((function(t,n){return e(n)})),Rc.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return Rc.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return Rc.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),Rc.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),Rc.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new wh(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,Rc.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),Rc.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,Rc.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach((function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)})),Rc.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return Rc.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return Rc.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),Rc.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),Rc.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),Rc.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return Rc.resolve(n)},t.prototype.containsKey=function(t,e){return Rc.resolve(this._s.containsKey(e))},t}(),yl=function(){function t(t,e){var n=this;this.gs={},this.Ne=new Uo(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new dl(this),this.Ut=new ah,this.Ue=function(t,e){return new fl(t,(function(t){return n.referenceDelegate.ps(t)}))}(this.Ut),this.R=new Hc(e),this.Ke=new ul(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new ll(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;Ko("MemoryPersistence","Starting transaction:",t);var i=new gl(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(t){return r.referenceDelegate.Ts(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Is=function(t,e){return Rc.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),gl=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return St(e,t),e}(kc),vl=function(){function t(t){this.persistence=t,this.As=new cl,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw Qo()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),Rc.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),Rc.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),Rc.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach((function(t){return n.vs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.vs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Rc.forEach(this.vs,(function(r){var i=_s.fromPath(r);return e.Ps(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Rs=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next((function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())}))},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return Rc.or([function(){return Rc.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),ml=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function bl(t,e){return"firestore_clients_"+t+"_"+e}function wl(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function El(t,e){return"firestore_targets_"+t+"_"+e}ml.UNAUTHENTICATED=new ml(null),ml.GOOGLE_CREDENTIALS=new ml("google-credentials-uid"),ml.FIRST_PARTY=new ml("first-party-uid"),ml.MOCK_USER=new ml("mock-user");var Il=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new jo(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(zo("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),_l=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new jo(i.error.code,i.error.message)),o?new t(e,i.state,r):(zo("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Tl=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=wu(),s=0;i&&s<r.activeTargetIds.length;++s)i=Is(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(zo("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Sl=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(zo("SharedClientState","Failed to parse online state: "+e),null)},t}(),Nl=function(){function t(){this.activeTargetIds=wu()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Al=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.ks.bind(this),this.Fs=new au(Zo),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=bl(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Fs=this.Fs.insert(this.Ns,new Nl),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Ks=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return At(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,a,u,c,h,l=this;return Dt(this,(function(f){switch(f.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(bl(this.persistenceKey,r)))&&(o=Tl.Vs(r,i))&&(this.Fs=this.Fs.insert(o.clientId,o));for(this.Qs(),(s=this.storage.getItem(this.Us))&&(a=this.js(s))&&this.Ws(a),u=0,c=this.$s;u<c.length;u++)h=c[u],this.ks(h);return this.$s=[],this.window.addEventListener("pagehide",(function(){return l.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.Fs)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.Fs.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(El(this.persistenceKey,t));if(n){var r=_l.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Qs(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(El(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.Hs(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Ko("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Ko("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Ko("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.ks=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Ko("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void zo("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return At(e,void 0,void 0,(function(){var t,e,r,i,o,s;return Dt(this,(function(a){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(s=function(t){var e=Uo.o;if(null!=t)try{var n=JSON.parse(t);Wo("number"==typeof n),e=n}catch(t){zo("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Uo.o&&this.sequenceNumberHandler(s);else if(n.key===this.Ks)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.Fs.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new Il(this.currentUser,t,e,n),i=wl(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=wl(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){var e={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(e))},t.prototype.Ys=function(t,e,n){var r=El(this.persistenceKey,t),i=new _l(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return Tl.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Il.Vs(new ml(i),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return _l.Vs(r,e)},t.prototype.js=function(t){return Sl.Vs(t)},t.prototype.ii=function(t){return At(this,void 0,void 0,(function(){return Dt(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(Ko("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.Fs.insert(t,e):this.Fs.remove(t),i=this.Gs(this.Fs),o=this.Gs(r),s=[],a=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||a.push(t)})),this.syncEngine.hi(s,a).then((function(){n.Fs=r}))},t.prototype.Ws=function(t){this.Fs.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=wu();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),Dl=function(){function t(){this.li=new Nl,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new Nl,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),Cl=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),kl=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){Ko("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){Ko("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),xl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Rl=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),Ol=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return St(e,t),e.prototype.Fi=function(t,e,n,r){return new Promise((function(i,o){var s=new Vo;s.listenOnce(Ro.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case xo.NO_ERROR:var e=s.getResponseJson();Ko("Connection","XHR received:",JSON.stringify(e)),i(e);break;case xo.TIMEOUT:Ko("Connection",'RPC "'+t+'" timed out'),o(new jo(qo.DEADLINE_EXCEEDED,"Request time out"));break;case xo.HTTP_ERROR:var n=s.getStatus();if(Ko("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(qo).indexOf(e)>=0?e:qo.UNKNOWN}(r.status);o(new jo(a,r.message))}else o(new jo(qo.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new jo(qo.UNAVAILABLE,"Connection failed."));break;default:Qo()}}finally{Ko("Connection",'RPC "'+t+'" completed.')}}));var a=JSON.stringify(r);s.send(e,"POST",a,n,15)}))},e.prototype.Oi=function(t,e){var n,r=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new No,o=mr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(s.xmlHttpFactory=new Fo({})),this.ki(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Mt())||"object"==typeof navigator&&"ReactNative"===navigator.product||Mt().indexOf("Electron/")>=0||function(){var t=Mt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||Mt().indexOf("MSAppHost/")>=0||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=r.join("");Ko("Connection","Creating WebChannel: "+a,s);var u=i.createWebChannel(a,s),c=!1,h=!1,l=new Rl({Ei:function(t){h?Ko("Connection","Not sending because WebChannel is closed:",t):(c||(Ko("Connection","Opening WebChannel transport."),u.open(),c=!0),Ko("Connection","WebChannel sending:",t),u.send(t))},Ti:function(){return u.close()}}),f=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(u,Mo.EventType.OPEN,(function(){h||Ko("Connection","WebChannel transport opened.")})),f(u,Mo.EventType.CLOSE,(function(){h||(h=!0,Ko("Connection","WebChannel transport closed"),l.Vi())})),f(u,Mo.EventType.ERROR,(function(t){h||(h=!0,Go("Connection","WebChannel transport errored:",t),l.Vi(new jo(qo.UNAVAILABLE,"The operation could not be completed")))})),f(u,Mo.EventType.MESSAGE,(function(t){var e;if(!h){var n=t.data[0];Wo(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){Ko("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=tu[t];if(void 0!==e)return su(e)}(o),a=i.message;void 0===s&&(s=qo.INTERNAL,a="Unknown error status: "+o+" with message "+i.message),h=!0,l.Vi(new jo(s,a)),u.close()}else Ko("Connection","WebChannel received:",n),l.Si(n)}})),f(o,Oo.STAT_EVENT,(function(t){t.stat===Lo?Ko("Connection","Detected buffering proxy"):t.stat===Po&&Ko("Connection","Detected no buffering proxy")})),setTimeout((function(){l.Pi()}),0),l},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);Ko("RestConnection","Sending: ",i,n);var o={};return this.ki(o,r),this.Fi(t,i,o,n).then((function(t){return Ko("RestConnection","Received: ",t),t}),(function(e){throw Go("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.ki=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.10.0",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){var n=xl[t];return this.Di+"/v1/"+e+":"+n},t}());
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ll(){return"undefined"!=typeof window?window:null}function Pl(){return"undefined"!=typeof document?document:null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Fl(t){return new Ru(t,!0)}var Ml=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Qi=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Ki),i=Math.max(0,n-r);i>0&&Ko("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return e.Ki=Date.now(),t()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),Vl=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Ml(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return At(this,void 0,void 0,(function(){return Dt(this,(function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return t.rr()})))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return At(this,void 0,void 0,(function(){return Dt(this,(function(t){return this.er()?[2,this.close(0)]:[2]}))}))},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return At(this,void 0,void 0,(function(){return Dt(this,(function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===qo.RESOURCE_EXHAUSTED?(zo(e.toString()),zo("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):e&&e.code===qo.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(e){t.Yi===n&&t.lr(e)}),(function(n){e((function(){var e=new jo(qo.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)}))}))},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii((function(){n((function(){return e.state=2,e.listener.Ii()}))})),this.stream.Ri((function(t){n((function(){return e.dr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji((function(){return At(t,void 0,void 0,(function(){return Dt(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.dr=function(t){return Ko("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget((function(){return e.Yi===t?n():(Ko("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Ul=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return St(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Qo()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(Wo(void 0===e||"string"==typeof e),fs.fromBase64String(e||"")):(Wo(void 0===e||e instanceof Uint8Array),fs.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?qo.UNKNOWN:su(t.code);return new jo(e,t.message||"")}(a);n=new Su(r,i,o,s||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=qu(t,r.document.name),o=Fu(r.document.updateTime);var a=new Vs({mapValue:{fields:r.document.fields}}),u=(s=qs.newFoundDocument(i,o,a),r.targetIds||[]),c=r.removedTargetIds||[];n=new _u(u,c,s.key,s)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=qu(t,r.document),o=r.readTime?Fu(r.readTime):rs.min(),a=qs.newNoDocument(i,o),s=r.removedTargetIds||[],n=new _u([],s,a.key,a);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=qu(t,r.document),o=r.removedTargetIds||[],n=new _u([],o,i,null);else{if(!("filter"in e))return Qo();e.filter;var h=e.filter;h.targetId,r=h.count||0,i=new iu(r),o=h.targetId,n=new Tu(o,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return rs.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?rs.min():e.readTime?Fu(e.readTime):rs.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=$u(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=zs(r)?{documents:Qu(t,r)}:{query:Wu(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Lu(t,e.resumeToken):e.snapshotVersion.compareTo(rs.min())>0&&(n.readTime=Ou(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Qo()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=$u(this.R),e.removeTarget=t,this.cr(e)},e}(Vl),ql=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return St(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(Wo(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(Wo(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?Fu(t.updateTime):Fu(e);return n.isEqual(rs.min())&&(n=Fu(e)),new qa(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=Fu(t.commitTime);return this.listener.Tr(n,e)}return Wo(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=$u(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Gu(e.R,t)}))};this.cr(n)},e}(Vl),jl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return St(e,t),e.prototype.br=function(){if(this.Rr)throw new jo(qo.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===qo.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new jo(qo.UNKNOWN,t.toString())}))},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.$i(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===qo.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new jo(qo.UNKNOWN,t.toString())}))},e.prototype.terminate=function(){this.Rr=!0},e}((function(){})),Bl=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()})))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.kr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.kr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(zo(e),this.Vr=!1):Ko("OnlineStateTracker",e)},t.prototype.kr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),$l=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Fr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di((function(t){n.enqueueAndForget((function(){return At(o,void 0,void 0,(function(){return Dt(this,(function(t){switch(t.label){case 0:return Jl(this)?(Ko("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return At(this,void 0,void 0,(function(){var e;return Dt(this,(function(n){switch(n.label){case 0:return(e=Yo(t)).Or.add(4),[4,zl(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,Kl(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Br=new Bl(n,r)};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Kl(t){return At(this,void 0,void 0,(function(){var e,n;return Dt(this,(function(r){switch(r.label){case 0:if(!Jl(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function zl(t){return At(this,void 0,void 0,(function(){var e,n;return Dt(this,(function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Gl(t,e){var n=Yo(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),Xl(n)?Yl(n):df(n).er()&&Ql(n,e))}function Hl(t,e){var n=Yo(t),r=df(n);n.$r.delete(e),r.er()&&Wl(n,e),0===n.$r.size&&(r.er()?r.ir():Jl(n)&&n.Br.set("Unknown"))}function Ql(t,e){t.qr.U(e.targetId),df(t).mr(e)}function Wl(t,e){t.qr.U(e),df(t).yr(e)}function Yl(t){t.qr=new Au({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),df(t).start(),t.Br.Sr()}function Xl(t){return Jl(t)&&!df(t).tr()&&t.$r.size>0}function Jl(t){return 0===Yo(t).Or.size}function Zl(t){t.qr=void 0}function tf(t){return At(this,void 0,void 0,(function(){return Dt(this,(function(e){return t.$r.forEach((function(e,n){Ql(t,e)})),[2]}))}))}function ef(t,e){return At(this,void 0,void 0,(function(){return Dt(this,(function(n){return Zl(t),Xl(t)?(t.Br.Nr(e),Yl(t)):t.Br.set("Unknown"),[2]}))}))}function nf(t,e,n){return At(this,void 0,void 0,(function(){var r,i,o;return Dt(this,(function(s){switch(s.label){case 0:if(t.Br.set("Online"),!(e instanceof Su&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return At(this,void 0,void 0,(function(){var n,r,i,o;return Dt(this,(function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?(o=i[r],t.$r.has(o)?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]):[3,5];case 2:s.sent(),t.$r.delete(o),t.qr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),Ko("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,rf(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof _u?t.qr.X(e):e instanceof Tu?t.qr.rt(e):t.qr.et(e),n.isEqual(rs.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,Zh(t.localStore)];case 8:return i=s.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(fs.EMPTY_BYTE_STRING,n.snapshotVersion)),Wl(t,e);var r=new Gc(n.target,e,1,n.sequenceNumber);Ql(t,r)}})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return Ko("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,rf(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}}))}))}function rf(t,e,n){return At(this,void 0,void 0,(function(){var r=this;return Dt(this,(function(i){switch(i.label){case 0:if(!Mc(e))throw e;return t.Or.add(1),[4,zl(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return Zh(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return At(r,void 0,void 0,(function(){return Dt(this,(function(e){switch(e.label){case 0:return Ko("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,Kl(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function of(t,e){return e().catch((function(n){return rf(t,n,e)}))}function sf(t){return At(this,void 0,void 0,(function(){var e,n,r,i,o;return Dt(this,(function(s){switch(s.label){case 0:e=Yo(t),n=yf(e),r=e.Fr.length>0?e.Fr[e.Fr.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return Jl(t)&&t.Fr.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,el(e.localStore,r)];case 3:return null===(i=s.sent())?(0===e.Fr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.Fr.push(e);var n=yf(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,rf(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return af(e)&&uf(e),[2]}}))}))}function af(t){return Jl(t)&&!yf(t).tr()&&t.Fr.length>0}function uf(t){yf(t).start()}function cf(t){return At(this,void 0,void 0,(function(){return Dt(this,(function(e){return yf(t).Ar(),[2]}))}))}function hf(t){return At(this,void 0,void 0,(function(){var e,n,r,i;return Dt(this,(function(o){for(e=yf(t),n=0,r=t.Fr;n<r.length;n++)i=r[n],e.Er(i.mutations);return[2]}))}))}function lf(t,e,n){return At(this,void 0,void 0,(function(){var r,i;return Dt(this,(function(o){switch(o.label){case 0:return r=t.Fr.shift(),i=zc.from(r,e,n),[4,of(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,sf(t)];case 2:return o.sent(),[2]}}))}))}function ff(t,e){return At(this,void 0,void 0,(function(){return Dt(this,(function(n){switch(n.label){case 0:return e&&yf(t).pr?[4,function(t,e){return At(this,void 0,void 0,(function(){var n,r;return Dt(this,(function(i){switch(i.label){case 0:return ou(r=e.code)&&r!==qo.ABORTED?(n=t.Fr.shift(),yf(t).sr(),[4,of(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,sf(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return af(t)&&uf(t),[2]}}))}))}function pf(t,e){return At(this,void 0,void 0,(function(){var n;return Dt(this,(function(r){switch(r.label){case 0:return n=Yo(t),e?(n.Or.delete(2),[4,Kl(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,zl(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function df(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=Yo(t);return r.br(),new Ul(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:tf.bind(null,t),Ri:ef.bind(null,t),_r:nf.bind(null,t)}),t.Mr.push((function(n){return At(e,void 0,void 0,(function(){return Dt(this,(function(e){switch(e.label){case 0:return n?(t.Ur.sr(),Xl(t)?Yl(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),Zl(t),e.label=3;case 3:return[2]}}))}))}))),t.Ur}function yf(t){var e=this;return t.Kr||(t.Kr=function(t,e,n){var r=Yo(t);return r.br(),new ql(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:cf.bind(null,t),Ri:ff.bind(null,t),Ir:hf.bind(null,t),Tr:lf.bind(null,t)}),t.Mr.push((function(n){return At(e,void 0,void 0,(function(){return Dt(this,(function(e){switch(e.label){case 0:return n?(t.Kr.sr(),[4,sf(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kr.stop()];case 3:e.sent(),t.Fr.length>0&&(Ko("RemoteStore","Stopping write stream with "+t.Fr.length+" pending writes"),t.Fr=[]),e.label=4;case 4:return[2]}}))}))}))),t.Kr
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var gf=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new xc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new jo(qo.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function vf(t,e){if(zo("AsyncQueue",e+": "+t),Mc(t))return new jo(qo.UNAVAILABLE,e+": "+t);throw t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var mf=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||_s.comparator(e.key,n.key)}:function(t,e){return _s.comparator(t.key,e.key)},this.keyedMap=yu(),this.sortedSet=new au(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),bf=function(){function t(){this.Qr=new au(_s.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Qr.get(e);n?0!==t.type&&3===n.type?this.Qr=this.Qr.insert(e,t):3===t.type&&1!==n.type?this.Qr=this.Qr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Qr=this.Qr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Qr=this.Qr.remove(e):1===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):Qo():this.Qr=this.Qr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Qr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),wf=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,mf.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&ma(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Ef=function(){this.Wr=void 0,this.listeners=[]},If=function(){this.queries=new Rh((function(t){return ba(t)}),ma),this.onlineState="Unknown",this.Gr=new Set};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function _f(t,e){return At(this,void 0,void 0,(function(){var n,r,i,o,s,a,u;return Dt(this,(function(c){switch(c.label){case 0:if(n=Yo(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new Ef),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=c.sent(),[3,4];case 3:return a=c.sent(),u=vf(a,"Initialization of query '"+wa(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&Af(n),[2]}}))}))}function Tf(t,e){return At(this,void 0,void 0,(function(){var n,r,i,o,s;return Dt(this,(function(a){return n=Yo(t),r=e.query,i=!1,(o=n.queries.get(r))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function Sf(t,e){for(var n=Yo(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,u=n.queries.get(a);if(u){for(var c=0,h=u.listeners;c<h.length;c++)h[c].Hr(s)&&(r=!0);u.Wr=s}}r&&Af(n)}function Nf(t,e,n){var r=Yo(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Af(t){t.Gr.forEach((function(t){t.next()}))}var Df=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new wf(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.so&&n||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=wf.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),Cf=function(t){this.key=t},kf=function(t){this.key=t},xf=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=mu(),this.mutatedKeys=mu(),this.lo=Ia(t),this.fo=new mf(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new bf,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=ha(this.query)&&i.size===this.query.limit?i.last():null,c=la(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var h=i.get(t),l=Ea(n.query,e)?e:null,f=!!h&&n.mutatedKeys.has(h.key),p=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),d=!1;h&&l?h.data.isEqual(l.data)?f!==p&&(r.track({type:3,doc:l}),d=!0):n.yo(h,l)||(r.track({type:2,doc:l}),d=!0,(u&&n.lo(l,u)>0||c&&n.lo(l,c)<0)&&(a=!0)):!h&&l?(r.track({type:0,doc:l}),d=!0):h&&!l&&(r.track({type:1,doc:h}),d=!0,(u||c)&&(a=!0)),d&&(l?(s=s.add(l),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),ha(this.query)||la(this.query))for(;s.size>this.query.limit;){var h=ha(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Qo()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)})),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new wf(this.query,t.fo,i,o,t.mutatedKeys,0===a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new bf,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.uo=e.uo.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.uo=e.uo.delete(t)})),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=mu(),this.fo.forEach((function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))}));var n=[];return e.forEach((function(e){t.ho.has(e)||n.push(new kf(e))})),this.ho.forEach((function(t){e.has(t)||n.push(new Cf(t))})),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=mu();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return wf.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),Rf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Of=function(t){this.key=t,this.bo=!1},Lf=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new Rh((function(t){return ba(t)}),ma),this.Vo=new Map,this.So=new Set,this.Do=new au(_s.comparator),this.Co=new Map,this.No=new cl,this.xo={},this.ko=new Map,this.Fo=wh.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Pf(t,e){return At(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Dt(this,(function(u){switch(u.label){case 0:return n=hp(t),(o=n.Po.get(e))?(r=o.targetId,n.sharedClientState.addLocalQueryTarget(r),i=o.view.Ro(),[3,4]):[3,1];case 1:return[4,nl(n.localStore,ga(e))];case 2:return s=u.sent(),a=n.sharedClientState.addLocalQueryTarget(s.targetId),r=s.targetId,[4,Ff(n,e,r,"current"===a)];case 3:i=u.sent(),n.isPrimaryClient&&Gl(n.remoteStore,s),u.label=4;case 4:return[2,i]}}))}))}function Ff(t,e,n,r){return At(this,void 0,void 0,(function(){var i,o,s,a,u,c;return Dt(this,(function(h){switch(h.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return At(this,void 0,void 0,(function(){var i,o,s;return Dt(this,(function(a){switch(a.label){case 0:return(i=e.view._o(n)).Nn?[4,il(t.localStore,e.query,!1).then((function(t){var n=t.documents;return e.view._o(n,i)}))]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(Wf(t,e.targetId,s.To),s.snapshot)]}}))}))}(t,e,n,r)},[4,il(t.localStore,e,!0)];case 1:return i=h.sent(),o=new xf(e,i.Bn),s=o._o(i.documents),a=Iu.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(s,t.isPrimaryClient,a),Wf(t,n,u.To),c=new Rf(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}}))}))}function Mf(t,e){return At(this,void 0,void 0,(function(){var n,r,i;return Dt(this,(function(o){switch(o.label){case 0:return n=Yo(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter((function(t){return!ma(t,e)}))),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,rl(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),Hl(n.remoteStore,r.targetId),Hf(n,r.targetId)})).catch(Sh)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Hf(n,r.targetId),[4,rl(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function Vf(t,e,n){return At(this,void 0,void 0,(function(){var r,i,o,s;return Dt(this,(function(a){switch(a.label){case 0:r=lp(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=Yo(t),i=ns.now(),o=e.reduce((function(t,e){return t.add(e.key)}),mu());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Mn.pn(t,o).next((function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],h=Ga(c,n.get(c.key));null!=h&&s.push(new Ya(c.key,h,Us(h.value.mapValue),ja.exists(!0)))}return r._n.addMutationBatch(t,i,s,e)}))})).then((function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}}))}(r.localStore,e)];case 2:return i=a.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new au(Zo)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,Jf(r,i.changes)];case 3:return a.sent(),[4,sf(r.remoteStore)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=vf(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}}))}))}function Uf(t,e){return At(this,void 0,void 0,(function(){var n,r;return Dt(this,(function(i){switch(i.label){case 0:n=Yo(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,tl(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.Co.get(e);r&&(Wo(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?Wo(r.bo):t.removedDocuments.size>0&&(Wo(r.bo),r.bo=!1))})),[4,Jf(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Sh(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function qf(t,e,n){var r=Yo(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=Yo(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)})),r&&Af(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function jf(t,e,n){return At(this,void 0,void 0,(function(){var r,i,o,s,a,u;return Dt(this,(function(c){switch(c.label){case 0:return(r=Yo(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(s=(s=new au(_s.comparator)).insert(o,qs.newNoDocument(o,rs.min())),a=mu().add(o),u=new Eu(rs.min(),new Map,new hu(Zo),s,a),[4,Uf(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),Xf(r),[3,4];case 2:return[4,rl(r.localStore,e,!1).then((function(){return Hf(r,e,n)})).catch(Sh)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function Bf(t,e){return At(this,void 0,void 0,(function(){var n,r,i;return Dt(this,(function(o){switch(o.label){case 0:n=Yo(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,Jh(n.localStore,e)];case 2:return i=o.sent(),Gf(n,r,null),zf(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,Jf(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Sh(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function $f(t,e,n){return At(this,void 0,void 0,(function(){var r,i;return Dt(this,(function(o){switch(o.label){case 0:r=Yo(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Yo(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n._n.lookupMutationBatch(t,e).next((function(e){return Wo(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}(r.localStore,e)];case 2:return i=o.sent(),Gf(r,e,n),zf(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,Jf(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Sh(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Kf(t,e){return At(this,void 0,void 0,(function(){var n,r,i,o,s;return Dt(this,(function(a){switch(a.label){case 0:Jl((n=Yo(t)).remoteStore)||Ko("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=Yo(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e._n.getHighestUnacknowledgedBatchId(t)}))}(n.localStore)];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.ko.get(r)||[]).push(e),n.ko.set(r,i),[3,4]);case 3:return o=a.sent(),s=vf(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}}))}))}function zf(t,e){(t.ko.get(e)||[]).forEach((function(t){t.resolve()})),t.ko.delete(e)}function Gf(t,e,n){var r=Yo(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function Hf(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach((function(e){t.No.containsKey(e)||Qf(t,e)}))}function Qf(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(Hl(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),Xf(t))}function Wf(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Cf?(t.No.addReference(o.key,e),Yf(t,o)):o instanceof kf?(Ko("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||Qf(t,o.key)):Qo()}}function Yf(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(Ko("SyncEngine","New document in limbo: "+n),t.So.add(r),Xf(t))}function Xf(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new _s(us.fromString(e)),r=t.Fo.next();t.Co.set(r,new Of(n)),t.Do=t.Do.insert(n,r),Gl(t.remoteStore,new Gc(ga(ca(n.path)),r,2,Uo.o))}}function Jf(t,e,n){return At(this,void 0,void 0,(function(){var r,i,o,s;return Dt(this,(function(a){switch(a.label){case 0:return r=Yo(t),i=[],o=[],s=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach((function(t,a){s.push(r.Oo(a,e,n).then((function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Hh.Pn(a.targetId,t);o.push(e)}})))})),[4,Promise.all(s)]);case 1:return a.sent(),r.vo._r(i),[4,function(t,e){return At(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,h;return Dt(this,(function(l){switch(l.label){case 0:n=Yo(t),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return Rc.forEach(e,(function(e){return Rc.forEach(e.bn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return Rc.forEach(e.vn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return l.sent(),[3,4];case 3:if(!Mc(r=l.sent()))throw r;return Ko("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)s=o[i],a=s.targetId,s.fromCache||(u=n.kn.get(a),c=u.snapshotVersion,h=u.withLastLimboFreeSnapshotVersion(c),n.kn=n.kn.insert(a,h));return[2]}}))}))}(r.localStore,o)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function Zf(t,e){return At(this,void 0,void 0,(function(){var n,r;return Dt(this,(function(i){switch(i.label){case 0:return(n=Yo(t)).currentUser.isEqual(e)?[3,3]:(Ko("SyncEngine","User change. New user:",e.toKey()),[4,Xh(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.ko.forEach((function(t){t.forEach((function(t){t.reject(new jo(qo.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.ko.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,Jf(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function tp(t,e){var n=Yo(t),r=n.Co.get(e);if(r&&r.bo)return mu().add(r.key);var i=mu(),o=n.Vo.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=a[s],c=n.Po.get(u);i=i.unionWith(c.view.wo)}return i}function ep(t,e){return At(this,void 0,void 0,(function(){var n,r,i;return Dt(this,(function(o){switch(o.label){case 0:return[4,il((n=Yo(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&Wf(n,e.targetId,i.To),i)]}}))}))}function np(t){return At(this,void 0,void 0,(function(){var e;return Dt(this,(function(n){return[2,sl((e=Yo(t)).localStore).then((function(t){return Jf(e,t)}))]}))}))}function rp(t,e,n,r){return At(this,void 0,void 0,(function(){var i,o;return Dt(this,(function(s){switch(s.label){case 0:return[4,function(t,e){var n=Yo(t),r=Yo(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.jt(t,e).next((function(e){return e?n.Mn.pn(t,e):Rc.resolve(null)}))}))}((i=Yo(t)).localStore,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,sf(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Gf(i,e,r||null),zf(i,e),function(t,e){Yo(Yo(t)._n).Gt(e)}(i.localStore,e)):Qo(),s.label=4;case 4:return[4,Jf(i,o)];case 5:return s.sent(),[3,7];case 6:Ko("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}}))}))}function ip(t,e){return At(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c;return Dt(this,(function(h){switch(h.label){case 0:return hp(n=Yo(t)),lp(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,op(n,r.toArray())]);case 1:return i=h.sent(),n.$o=!0,[4,pf(n.remoteStore,!0)];case 2:for(h.sent(),o=0,s=i;o<s.length;o++)a=s[o],Gl(n.remoteStore,a);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(u=[],c=Promise.resolve(),n.Vo.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?u.push(e):c=c.then((function(){return Hf(n,e),rl(n.localStore,e,!0)})),Hl(n.remoteStore,e)})),[4,c]);case 4:return h.sent(),[4,op(n,u)];case 5:return h.sent(),function(t){var e=Yo(t);e.Co.forEach((function(t,n){Hl(e.remoteStore,n)})),e.No.ts(),e.Co=new Map,e.Do=new au(_s.comparator)}(n),n.$o=!1,[4,pf(n.remoteStore,!1)];case 6:h.sent(),h.label=7;case 7:return[2]}}))}))}function op(t,e,n){return At(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,h,l,f,p,d,y;return Dt(this,(function(g){switch(g.label){case 0:n=Yo(t),r=[],i=[],o=0,s=e,g.label=1;case 1:return o<s.length?(a=s[o],u=void 0,(c=n.Vo.get(a))&&0!==c.length?[4,nl(n.localStore,ga(c[0]))]:[3,7]):[3,13];case 2:u=g.sent(),h=0,l=c,g.label=3;case 3:return h<l.length?(f=l[h],p=n.Po.get(f),[4,ep(n,p)]):[3,6];case 4:(d=g.sent()).snapshot&&i.push(d.snapshot),g.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,ol(n.localStore,a)];case 8:return y=g.sent(),[4,nl(n.localStore,y)];case 9:return u=g.sent(),[4,Ff(n,sp(y),a,!1)];case 10:g.sent(),g.label=11;case 11:r.push(u),g.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}}))}))}function sp(t){return ua(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function ap(t){var e=Yo(t);return Yo(Yo(e.localStore).persistence).fn()}function up(t,e,n,r){return At(this,void 0,void 0,(function(){var i,o,s;return Dt(this,(function(a){switch(a.label){case 0:return(i=Yo(t)).$o?(Ko("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,sl(i.localStore)];case 3:return o=a.sent(),s=Eu.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,Jf(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,rl(i.localStore,e,!0)];case 6:return a.sent(),Hf(i,e,r),[3,8];case 7:Qo(),a.label=8;case 8:return[2]}}))}))}function cp(t,e,n){return At(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,h,l,f;return Dt(this,(function(p){switch(p.label){case 0:if(!(r=hp(t)).$o)return[3,10];i=0,o=e,p.label=1;case 1:return i<o.length?(s=o[i],r.Vo.has(s)?(Ko("SyncEngine","Adding an already active target "+s),[3,5]):[4,ol(r.localStore,s)]):[3,6];case 2:return a=p.sent(),[4,nl(r.localStore,a)];case 3:return u=p.sent(),[4,Ff(r,sp(a),u.targetId,!1)];case 4:p.sent(),Gl(r.remoteStore,u),p.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Dt(this,(function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,rl(r.localStore,t,!1).then((function(){Hl(r.remoteStore,t),Hf(r,t)})).catch(Sh)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},h=0,l=n,p.label=7;case 7:return h<l.length?(f=l[h],[5,c(f)]):[3,10];case 8:p.sent(),p.label=9;case 9:return h++,[3,7];case 10:return[2]}}))}))}function hp(t){var e=Yo(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Uf.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=tp.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=jf.bind(null,e),e.vo._r=Sf.bind(null,e.eventManager),e.vo.Mo=Nf.bind(null,e.eventManager),e}function lp(t){var e=Yo(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Bf.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=$f.bind(null,e),e}var fp=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return At(this,void 0,void 0,(function(){return Dt(this,(function(e){switch(e.label){case 0:return this.R=Fl(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Ko(t),[2]}}))}))},t.prototype.Uo=function(t){return null},t.prototype.Ko=function(t){return Yh(this.persistence,new Qh,t.initialUser,this.R)},t.prototype.qo=function(t){return new yl(vl.bs,this.R)},t.prototype.Bo=function(t){return new Dl},t.prototype.terminate=function(){return At(this,void 0,void 0,(function(){return Dt(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),pp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qo=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return St(e,t),e.prototype.initialize=function(e){return At(this,void 0,void 0,(function(){var n=this;return Dt(this,(function(r){switch(r.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return r.sent(),[4,al(this.localStore)];case 2:return r.sent(),[4,this.Qo.initialize(this,e)];case 3:return r.sent(),[4,lp(this.Qo.syncEngine)];case 4:return r.sent(),[4,sf(this.Qo.remoteStore)];case 5:return r.sent(),[4,this.persistence.He((function(){return n.gcScheduler&&!n.gcScheduler.started&&n.gcScheduler.start(n.localStore),Promise.resolve()}))];case 6:return r.sent(),[2]}}))}))},e.prototype.Ko=function(t){return Yh(this.persistence,new Qh,t.initialUser,this.R)},e.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new Dh(e,t.asyncQueue)},e.prototype.qo=function(t){var e=zh(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?fh.withCacheSize(this.cacheSizeBytes):fh.DEFAULT;return new Bh(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,Ll(),Pl(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new Dl},e}(fp),dp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Qo=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return St(e,t),e.prototype.initialize=function(e){return At(this,void 0,void 0,(function(){var n,r=this;return Dt(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Qo.syncEngine,this.sharedClientState instanceof Al?(this.sharedClientState.syncEngine={ui:rp.bind(null,n),ai:up.bind(null,n),hi:cp.bind(null,n),fn:ap.bind(null,n),ci:np.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He((function(t){return At(r,void 0,void 0,(function(){return Dt(this,(function(e){switch(e.label){case 0:return[4,ip(this.Qo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Bo=function(t){var e=Ll();if(!Al.yt(e))throw new jo(qo.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=zh(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new Al(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(pp),yp=function(){function t(){}return t.prototype.initialize=function(t,e){return At(this,void 0,void 0,(function(){var n=this;return Dt(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return qf(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=Zf.bind(null,this.syncEngine),[4,pf(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new If},t.prototype.createDatastore=function(t){var e,n=Fl(t.databaseInfo.databaseId),r=(e=t.databaseInfo,new Ol(e));return function(t,e,n){return new jl(t,e,n)}(t.credentials,r,n)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return qf(s.syncEngine,t,0)},o=kl.yt()?new kl:new Cl,new $l(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){var a=new Lf(t,e,n,r,i,o);return s&&(a.$o=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return At(this,void 0,void 0,(function(){var e;return Dt(this,(function(n){switch(n.label){case 0:return e=Yo(t),Ko("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,zl(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}(),gp=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),vp=function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return At(this,void 0,void 0,(function(){var e,n=this;return Dt(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new jo(qo.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return At(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Dt(this,(function(u){switch(u.label){case 0:return n=Yo(t),r=$u(n.R)+"/documents",i={documents:e.map((function(t){return Uu(n.R,t)}))},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){Wo(!!e.found),e.found.name,e.found.updateTime;var n=qu(t,e.found.name),r=Fu(e.found.updateTime),i=new Vs({mapValue:{fields:e.found.fields}});return qs.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){Wo(!!e.missing),Wo(!!e.readTime);var n=qu(t,e.missing),r=Fu(e.readTime);return qs.newNoDocument(n,r)}(t,e):Qo()}(n.R,t);s.set(e.key.toString(),e)})),a=[],[2,(e.forEach((function(t){var e=s.get(t.toString());Wo(!!e),a.push(e)})),a)]}}))}))}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach((function(t){return n.recordVersion(t)})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new nu(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return At(this,void 0,void 0,(function(){var t,e=this;return Dt(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=_s.fromPath(n);e.mutations.push(new ru(r,e.precondition(r)))})),[4,function(t,e){return At(this,void 0,void 0,(function(){var n,r,i;return Dt(this,(function(o){switch(o.label){case 0:return n=Yo(t),r=$u(n.R)+"/documents",i={writes:e.map((function(t){return Gu(n.R,t)}))},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw Qo();e=rs.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new jo(qo.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?ja.updateTime(e):ja.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(rs.min()))throw new jo(qo.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ja.updateTime(e)}return ja.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}(),mp=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new Ml(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.ec-=1,this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji((function(){return At(t,void 0,void 0,(function(){var t,e,n=this;return Dt(this,(function(r){return t=new vp(this.datastore),(e=this.sc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.ic(t)}))}))})).catch((function(t){n.ic(t)})),[2]}))}))}))},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!ws(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return e.nc(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!ou(e)}return!1},t}(),bp=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=ml.UNAUTHENTICATED,this.clientId=Jo.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,(function(t){return At(r,void 0,void 0,(function(){return Dt(this,(function(e){switch(e.label){case 0:return Ko("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}}))}))}))}return t.prototype.getConfiguration=function(){return At(this,void 0,void 0,(function(){return Dt(this,(function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}))}))},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new jo(qo.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new xc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return At(t,void 0,void 0,(function(){var t,n;return Dt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=vf(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function wp(t,e){return At(this,void 0,void 0,(function(){var n,r,i=this;return Dt(this,(function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),Ko("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener((function(t){return At(i,void 0,void 0,(function(){return Dt(this,(function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,Xh(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}}))}))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function Ep(t,e){return At(this,void 0,void 0,(function(){var n,r;return Dt(this,(function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,Ip(t)];case 1:return n=i.sent(),Ko("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener((function(t){return function(t,e){return At(this,void 0,void 0,(function(){var n,r;return Dt(this,(function(i){switch(i.label){case 0:return(n=Yo(t)).asyncQueue.verifyOperationInProgress(),Ko("RemoteStore","RemoteStore received new credentials"),r=Jl(n),n.Or.add(3),[4,zl(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,Kl(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,t)})),t.onlineComponents=e,[2]}}))}))}function Ip(t){return At(this,void 0,void 0,(function(){return Dt(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(Ko("FirestoreClient","Using default OfflineComponentProvider"),[4,wp(t,new fp)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function _p(t){return At(this,void 0,void 0,(function(){return Dt(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(Ko("FirestoreClient","Using default OnlineComponentProvider"),[4,Ep(t,new yp)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function Tp(t){return Ip(t).then((function(t){return t.persistence}))}function Sp(t){return Ip(t).then((function(t){return t.localStore}))}function Np(t){return _p(t).then((function(t){return t.remoteStore}))}function Ap(t){return _p(t).then((function(t){return t.syncEngine}))}function Dp(t){return At(this,void 0,void 0,(function(){var e,n;return Dt(this,(function(r){switch(r.label){case 0:return[4,_p(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=Pf.bind(null,e.syncEngine),n.onUnlisten=Mf.bind(null,e.syncEngine),n)]}}))}))}function Cp(t,e,n){var r=this;void 0===n&&(n={});var i=new xc;return t.asyncQueue.enqueueAndForget((function(){return At(r,void 0,void 0,(function(){var r;return Dt(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new gp({next:function(o){e.enqueueAndForget((function(){return Tf(t,s)}));var a=o.docs.has(n);!a&&o.fromCache?i.reject(new jo(qo.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new jo(qo.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Df(ca(n.path),o,{includeMetadataChanges:!0,so:!0});return _f(t,s)},[4,Dp(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}function kp(t,e,n){var r=this;void 0===n&&(n={});var i=new xc;return t.asyncQueue.enqueueAndForget((function(){return At(r,void 0,void 0,(function(){var r;return Dt(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new gp({next:function(n){e.enqueueAndForget((function(){return Tf(t,s)})),n.fromCache&&"server"===r.source?i.reject(new jo(qo.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Df(n,o,{includeMetadataChanges:!0,so:!0});return _f(t,s)},[4,Dp(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}var xp=function(t,e,n,r,i,o,s,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},Rp=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Op=new Map,Lp=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},Pp=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable((function(){return e(ml.UNAUTHENTICATED)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Fp=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Mp=function(){function t(t){var e=this;this.currentUser=ml.UNAUTHENTICATED,this.oc=new xc,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)}))};var n=function(t){Ko("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit((function(t){return n(t)})),setTimeout((function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(Ko("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}}),0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.cc!==e?(Ko("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Wo("string"==typeof n.accessToken),new Lp(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable((function(){return At(n,void 0,void 0,(function(){return Dt(this,(function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}}))}))}))},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return Wo(null===t||"string"==typeof t),new ml(t)},t}(),Vp=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=ml.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),Up=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new Vp(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable((function(){return e(ml.FIRST_PARTY)}))},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function qp(t,e,n){if(!n)throw new jo(qo.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function jp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new jo(qo.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Bp(t,e,n,r){if(!0===e&&!0===r)throw new jo(qo.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function $p(t){if(!_s.isDocumentKey(t))throw new jo(qo.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Kp(t){if(_s.isDocumentKey(t))throw new jo(qo.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function zp(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Qo()}function Gp(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new jo(qo.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=zp(t);throw new jo(qo.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Hp(t,e){if(e<=0)throw new jo(qo.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Qp=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new jo(qo.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new jo(qo.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,Bp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),Wp=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Qp({}),this._settingsFrozen=!1,t instanceof Rp?(this._databaseId=t,this._credentials=new Pp):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new jo(qo.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Rp(t.options.projectId)}(t),this._credentials=new Mp(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new jo(qo.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new jo(qo.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Qp(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new Pp;switch(t.type){case"gapi":var e=t.client;return Wo(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Up(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new jo(qo.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return this,(t=Op.get(this))&&(Ko("ComponentProvider","Removing Datastore"),Op.delete(this),t.terminate()),Promise.resolve();var t},t}(),Yp=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Jp(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),Xp=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),Jp=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,ca(r))||this)._path=r,i.type="collection",i}return St(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new Yp(this.firestore,null,new _s(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(Xp);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Zp(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Ht(t),qp("collection","path",e),t instanceof Wp)return Kp(n=us.fromString.apply(us,xt([e],r))),new Jp(t,null,n);if(!(t instanceof Yp||t instanceof Jp))throw new jo(qo.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Kp(n=us.fromString.apply(us,xt([t.path],r)).child(us.fromString(e))),new Jp(t.firestore,null,n)}function td(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Ht(t),1===arguments.length&&(e=Jo.u()),qp("doc","path",e),t instanceof Wp)return $p(n=us.fromString.apply(us,xt([e],r))),new Yp(t,null,new _s(n));if(!(t instanceof Yp||t instanceof Jp))throw new jo(qo.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return $p(n=t._path.child(us.fromString.apply(us,xt([e],r)))),new Yp(t.firestore,t instanceof Jp?t.converter:null,new _s(n))}function ed(t,e){return t=Ht(t),e=Ht(e),(t instanceof Yp||t instanceof Jp)&&(e instanceof Yp||e instanceof Jp)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function nd(t,e){return t=Ht(t),e=Ht(e),t instanceof Xp&&e instanceof Xp&&t.firestore===e.firestore&&ma(t._query,e._query)&&t.converter===e.converter
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var rd=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=!1,this.Tc=[],this.Zi=new Ml(this,"async_queue_retry"),this.Ic=function(){var e=Pl();e&&Ko("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=Pl();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ic)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ac(),this.Rc(t)},t.prototype.enterRestrictedMode=function(t){if(!this._c){this._c=!0,this.Ec=t||!1;var e=Pl();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Ic)}},t.prototype.enqueue=function(t){var e=this;if(this.Ac(),this._c)return new Promise((function(){}));var n=new xc;return this.Rc((function(){return e._c&&e.Ec?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.wc.push(t),e.bc()}))},t.prototype.bc=function(){return At(this,void 0,void 0,(function(){var t,e=this;return Dt(this,(function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!Mc(t=n.sent()))throw t;return Ko("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji((function(){return e.bc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Rc=function(t){var e=this,n=this.dc.then((function(){return e.gc=!0,t().catch((function(t){throw e.yc=t,e.gc=!1,zo("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.gc=!1,t}))}));return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ac(),this.Tc.indexOf(t)>-1&&(e=0);var i=gf.createAndSchedule(this,t,e,n,(function(t){return r.vc(t)}));return this.mc.push(i),i},t.prototype.Ac=function(){this.yc&&Qo()},t.prototype.verifyOperationInProgress=function(){},t.prototype.Pc=function(){return At(this,void 0,void 0,(function(){var t;return Dt(this,(function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Vc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Sc=function(t){var e=this;return this.Pc().then((function(){e.mc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.Pc()}))},t.prototype.Dc=function(t){this.Tc.push(t)},t.prototype.vc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function id(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var od=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new rd,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return St(e,t),e.prototype._terminate=function(){return this._firestoreClient||ad(this),this._firestoreClient.terminate()},e}(Wp);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function sd(t){return t._firestoreClient||ad(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function ad(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new xp(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new bp(t._credentials,t._queue,r)}function ud(t,e,n){var r=this,i=new xc;return t.asyncQueue.enqueue((function(){return At(r,void 0,void 0,(function(){var r;return Dt(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,wp(t,n)];case 1:return o.sent(),[4,Ep(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===qo.FAILED_PRECONDITION||t.code===qo.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function cd(t){if(t._initialized||t._terminated)throw new jo(qo.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var hd=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new jo(qo.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new hs(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),ld=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(fs.fromBase64String(e))}catch(e){throw new jo(qo.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(fs.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),fd=function(t){this._methodName=t},pd=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new jo(qo.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new jo(qo.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return Zo(this._lat,t._lat)||Zo(this._long,t._long)},t}(),dd=/^__.*__$/,yd=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new Ya(t,this.data,this.fieldMask,e,this.fieldTransforms):new Wa(t,this.data,e,this.fieldTransforms)},t}(),gd=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new Ya(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function vd(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Qo()}}var md=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Cc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Nc",{get:function(){return this.settings.Nc},enumerable:!1,configurable:!0}),t.prototype.xc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.kc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,Fc:!1});return r.$c(t),r},t.prototype.Oc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,Fc:!1});return r.Cc(),r},t.prototype.Mc=function(t){return this.xc({path:void 0,Fc:!0})},t.prototype.Lc=function(t){return Vd(t,this.settings.methodName,this.settings.Bc||!1,this.path,this.settings.qc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.Cc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.$c(this.path.get(t))},t.prototype.$c=function(t){if(0===t.length)throw this.Lc("Document fields must not be empty");if(vd(this.Nc)&&dd.test(t))throw this.Lc('Document fields cannot begin and end with "__"')},t}(),bd=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||Fl(t)}return t.prototype.Uc=function(t,e,n,r){return void 0===r&&(r=!1),new md({Nc:t,methodName:e,qc:n,path:hs.emptyPath(),Fc:!1,Bc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function wd(t){var e=t._freezeSettings(),n=Fl(t._databaseId);return new bd(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Ed(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Uc(o.merge||o.mergeFields?2:0,e,n,i);Ld("Data must be an object, but it was:",s,r);var a,u,c=Rd(r,s);if(o.merge)a=new ls(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var p=Pd(e,f[l],n);if(!s.contains(p))throw new jo(qo.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Ud(h,p)||h.push(p)}a=new ls(h),u=s.fieldTransforms.filter((function(t){return a.covers(t.field)}))}else a=null,u=s.fieldTransforms;return new yd(new Vs(c),a,u)}var Id=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return St(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Nc)throw 1===t.Nc?t.Lc(this._methodName+"() can only appear at the top level of your update data"):t.Lc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(fd);function _d(t,e,n){return new md({Nc:3,qc:e.settings.qc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var Td=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return St(e,t),e.prototype._toFieldTransform=function(t){return new Ua(t.path,new xa)},e.prototype.isEqual=function(t){return t instanceof e},e}(fd),Sd=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return St(e,t),e.prototype._toFieldTransform=function(t){var e=_d(this,t,!0),n=this.Kc.map((function(t){return xd(t,e)})),r=new Ra(n);return new Ua(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(fd),Nd=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return St(e,t),e.prototype._toFieldTransform=function(t){var e=_d(this,t,!0),n=this.Kc.map((function(t){return xd(t,e)})),r=new La(n);return new Ua(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(fd),Ad=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Qc=n,r}return St(e,t),e.prototype._toFieldTransform=function(t){var e=new Fa(t.R,Na(t.R,this.Qc));return new Ua(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(fd);function Dd(t,e,n,r){var i=t.Uc(1,e,n);Ld("Data must be an object, but it was:",i,r);var o=[],s=Vs.empty();os(r,(function(t,r){var a=Md(e,t,n);r=Ht(r);var u=i.Oc(a);if(r instanceof Id)o.push(a);else{var c=xd(r,u);null!=c&&(o.push(a),s.set(a,c))}}));var a=new ls(o);return new gd(s,a,i.fieldTransforms)}function Cd(t,e,n,r,i,o){var s=t.Uc(1,e,n),a=[Pd(e,r,n)],u=[i];if(o.length%2!=0)throw new jo(qo.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(Pd(e,o[c])),u.push(o[c+1]);for(var h=[],l=Vs.empty(),f=a.length-1;f>=0;--f)if(!Ud(h,a[f])){var p=a[f],d=u[f];d=Ht(d);var y=s.Oc(p);if(d instanceof Id)h.push(p);else{var g=xd(d,y);null!=g&&(h.push(p),l.set(p,g))}}var v=new ls(h);return new gd(l,v,s.fieldTransforms)}function kd(t,e,n,r){return void 0===r&&(r=!1),xd(n,t.Uc(r?4:3,e))}function xd(t,e){if(Od(t=Ht(t)))return Ld("Unsupported field value:",e,t),Rd(t,e);if(t instanceof fd)return function(t,e){if(!vd(e.Nc))throw e.Lc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Lc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&4!==e.Nc)throw e.Lc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=xd(o[i],e.Mc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=Ht(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Na(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ns.fromDate(t);return{timestampValue:Ou(e.R,n)}}if(t instanceof ns)return n=new ns(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Ou(e.R,n)};if(t instanceof pd)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof ld)return{bytesValue:Lu(e.R,t._byteString)};if(t instanceof Yp){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Lc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Mu(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Lc("Unsupported field value: "+zp(t))}(t,e)}function Rd(t,e){var n={};return ss(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):os(t,(function(t,r){var i=xd(r,e.kc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Od(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ns||t instanceof pd||t instanceof ld||t instanceof Yp||t instanceof fd)}function Ld(t,e,n){if(!Od(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=zp(n);throw"an object"===r?e.Lc(t+" a custom object"):e.Lc(t+" "+r)}}function Pd(t,e,n){if((e=Ht(e))instanceof hd)return e._internalPath;if("string"==typeof e)return Md(t,e);throw Vd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Fd=new RegExp("[~\\*/\\[\\]]");function Md(t,e,n){if(e.search(Fd)>=0)throw Vd("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(hd.bind.apply(hd,xt([void 0],e.split(".")))))._internalPath}catch(r){throw Vd("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Vd(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new jo(qo.INVALID_ARGUMENT,(a+=". ")+t+u)}function Ud(t,e){return t.some((function(t){return t.isEqual(e)}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var qd=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Yp(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new jd(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(Bd("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),jd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return St(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(qd);function Bd(t,e){return"string"==typeof e?Md(t,e):e instanceof hd?e._internalPath:e._delegate._internalPath}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var $d=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Kd=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return St(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new zd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(Bd("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(qd),zd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return St(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Kd),Gd=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new $d(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new zd(n._firestore,n._userDataWriter,r.key,r,new $d(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new jo(qo.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){return{type:"added",doc:new zd(t._firestore,t._userDataWriter,e.doc.key,e.doc,new $d(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new zd(t._firestore,t._userDataWriter,e.doc.key,e.doc,new $d(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Hd(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function Hd(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Qo()}}function Qd(t,e){return t instanceof Kd&&e instanceof Kd?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Gd&&e instanceof Gd&&t._firestore===e._firestore&&nd(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Wd(t){if(la(t)&&0===t.explicitOrderBy.length)throw new jo(qo.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Yd=function(){};function Xd(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var Jd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).jc=e,i.Wc=n,i.Gc=r,i.type="where",i}return St(e,t),e.prototype._apply=function(t){var e=wd(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new jo(qo.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){oy(s,o);for(var u=[],c=0,h=s;c<h.length;c++){var l=h[c];u.push(iy(r,t,l))}a={arrayValue:{values:u}}}else a=iy(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||oy(s,o),a=kd(n,"where",s,"in"===o||"not-in"===o);var f=Gs.create(i,o,a);return function(t,e){if(e.g()){var n=pa(t);if(null!==n&&!n.isEqual(e.field))throw new jo(qo.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=fa(t);null!==r&&sy(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new jo(qo.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new jo(qo.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t._query,0,e,t.firestore._databaseId,this.jc,this.Wc,this.Gc);return new Xp(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new aa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(Yd),Zd=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).jc=e,r.zc=n,r.type="orderBy",r}return St(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new jo(qo.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new jo(qo.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ra(e,n);return function(t,e){if(null===fa(t)){var n=pa(t);null!==n&&sy(t,n,e.field)}}(t,r),r}(t._query,this.jc,this.zc);return new Xp(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new aa(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(Yd),ty=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Hc=n,i.Jc=r,i}return St(e,t),e.prototype._apply=function(t){return new Xp(t.firestore,t.converter,va(t._query,this.Hc,this.Jc))},e}(Yd),ey=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return St(e,t),e.prototype._apply=function(t){var e=ry(t,this.type,this.Yc,this.Xc);return new Xp(t.firestore,t.converter,function(t,e){return new aa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(Yd),ny=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return St(e,t),e.prototype._apply=function(t){var e=ry(t,this.type,this.Yc,this.Xc);return new Xp(t.firestore,t.converter,function(t,e){return new aa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(Yd);function ry(t,e,n,r){if(n[0]=Ht(n[0]),n[0]instanceof qd)return function(t,e,n,r,i){if(!r)throw new jo(qo.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=ya(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(xs(e,r.key));else{var c=r.data.field(u.field);if(vs(c))throw new jo(qo.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.canonicalString();throw new jo(qo.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new ea(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=wd(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new jo(qo.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new jo(qo.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!da(t)&&-1!==c.indexOf("/"))throw new jo(qo.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(us.fromString(c));if(!_s.isDocumentKey(h))throw new jo(qo.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new _s(h);a.push(xs(e,l))}else{var f=kd(n,r,c);a.push(f)}}return new ea(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function iy(t,e,n){if("string"==typeof(n=Ht(n))){if(""===n)throw new jo(qo.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!da(e)&&-1!==n.indexOf("/"))throw new jo(qo.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(us.fromString(n));if(!_s.isDocumentKey(r))throw new jo(qo.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return xs(t,new _s(r))}if(n instanceof Yp)return xs(t,n._key);throw new jo(qo.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+zp(n)+".")}function oy(t,e){if(!Array.isArray(t)||0===t.length)throw new jo(qo.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new jo(qo.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function sy(t,e,n){if(!n.isEqual(e))throw new jo(qo.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ay=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),Ts(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ys(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(gs(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Qo()}},t.prototype.convertObject=function(t,e){var n=this,r={};return os(t.fields,(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new pd(ys(t.latitude),ys(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=ms(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(bs(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=ds(t);return new ns(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=us.fromString(t);Wo(ac(n));var r=new Rp(n.get(1),n.get(3)),i=new _s(n.popFirst(5));return r.isEqual(e)||zo("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function uy(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var cy=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return St(e,t),e.prototype.convertBytes=function(t){return new ld(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Yp(this.firestore,null,e)},e}(ay),hy=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=wd(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=ly(t,this._firestore),i=uy(r.converter,e,n),o=Ed(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,ja.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=ly(t,this._firestore);return o="string"==typeof(e=Ht(e))||e instanceof hd?Cd(this._dataReader,"WriteBatch.update",s._key,e,n,r):Dd(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,ja.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=ly(t,this._firestore);return this._mutations=this._mutations.concat(new nu(e._key,ja.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new jo(qo.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ly(t,e){if((t=Ht(t)).firestore!==e)throw new jo(qo.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var fy=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return St(e,t),e.prototype.convertBytes=function(t){return new ld(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Yp(this.firestore,null,e)},e}(ay);function py(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Gp(t,Yp);var o=Gp(t.firestore,od),s=wd(o);return yy(o,[("string"==typeof(e=Ht(e))||e instanceof hd?Cd(s,"updateDoc",t._key,e,n,r):Dd(s,"updateDoc",t._key,e)).toMutation(t._key,ja.exists(!0))])}function dy(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=Ht(t);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||id(i[a])||(s=i[a],a++);var u,c,h,l={includeMetadataChanges:s.includeMetadataChanges};if(id(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof Yp)c=Gp(t.firestore,od),h=ca(t._key.path),u={next:function(e){i[a]&&i[a](gy(c,t,e))},error:i[a+1],complete:i[a+2]};else{var p=Gp(t,Xp);c=Gp(p.firestore,od),h=p._query;var d=new fy(c);u={next:function(t){i[a]&&i[a](new Gd(c,d,p,t))},error:i[a+1],complete:i[a+2]},Wd(t._query)}return function(t,e,n,r){var i=this,o=new gp(r),s=new Df(e,o,n);return t.asyncQueue.enqueueAndForget((function(){return At(i,void 0,void 0,(function(){var e;return Dt(this,(function(n){switch(n.label){case 0:return e=_f,[4,Dp(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))})),function(){o.Wo(),t.asyncQueue.enqueueAndForget((function(){return At(i,void 0,void 0,(function(){var e;return Dt(this,(function(n){switch(n.label){case 0:return e=Tf,[4,Dp(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))}))}}(sd(c),h,l,u)}function yy(t,e){return function(t,e){var n=this,r=new xc;return t.asyncQueue.enqueueAndForget((function(){return At(n,void 0,void 0,(function(){var n;return Dt(this,(function(i){switch(i.label){case 0:return n=Vf,[4,Ap(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(sd(t),e)}function gy(t,e,n){var r=n.docs.get(e._key),i=new fy(t);return new Kd(t,i,e._key,r,new $d(n.hasPendingWrites,n.fromCache),e.converter)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var vy=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return St(e,t),e.prototype.get=function(e){var n=this,r=ly(e,this._firestore),i=new fy(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new Kd(n._firestore,i,r._key,t._document,new $d(!1,!1),r.converter)}))},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=wd(t)}return t.prototype.get=function(t){var e=this,n=ly(t,this._firestore),r=new cy(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return Qo();var i=t[0];if(i.isFoundDocument())return new qd(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new qd(e._firestore,r,n._key,null,n.converter);throw Qo()}))},t.prototype.set=function(t,e,n){var r=ly(t,this._firestore),i=uy(r.converter,e,n),o=Ed(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=ly(t,this._firestore);return o="string"==typeof(e=Ht(e))||e instanceof hd?Cd(this._dataReader,"Transaction.update",s._key,e,n,r):Dd(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=ly(t,this._firestore);return this._transaction.delete(e._key),this},t}());
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function my(){if("undefined"==typeof Uint8Array)throw new jo(qo.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function by(){if("undefined"==typeof atob)throw new jo(qo.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var wy=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return by(),new t(ld.fromBase64String(e))},t.fromUint8Array=function(e){return my(),new t(ld.fromUint8Array(e))},t.prototype.toBase64=function(){return by(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return my(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),Ey=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){cd(t=Gp(t,od));var n=sd(t),r=t._freezeSettings(),i=new yp;return ud(n,i,new pp(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){cd(t=Gp(t,od));var e=sd(t),n=t._freezeSettings(),r=new yp;return ud(e,r,new dp(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new jo(qo.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new xc;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return At(e,void 0,void 0,(function(){var e;return Dt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return At(this,void 0,void 0,(function(){var e;return Dt(this,(function(n){switch(n.label){case 0:return Lc.yt()?(e=t+"main",[4,Lc.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(zh(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),Iy=function(){function t(t,e,n){var r=this;this._delegate=e,this.Zc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof Rp||(this.tu=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||Go("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){var i;void 0===r&&(r={});var o=(t=Gp(t,Wp))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==e&&Go("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},o),{host:e+":"+n,ssl:!1})),r.mockUserToken){var s,a;if("string"==typeof r.mockUserToken)s=r.mockUserToken,a=ml.MOCK_USER;else{s=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var o=Nt({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Lt(JSON.stringify({alg:"none",type:"JWT"})),Lt(JSON.stringify(o)),""].join(".")}(r.mockUserToken,null===(i=t._app)||void 0===i?void 0:i.options.projectId);var u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new jo(qo.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new ml(u)}t._credentials=new Fp(new Lp(s,a))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return At(e,void 0,void 0,(function(){var e,n;return Dt(this,(function(r){switch(r.label){case 0:return[4,Tp(t)];case 1:return e=r.sent(),[4,Np(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=Yo(t);return e.Or.delete(0),Kl(e)}(n))]}}))}))}))}(sd(Gp(this._delegate,od)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return At(e,void 0,void 0,(function(){var e,n;return Dt(this,(function(r){switch(r.label){case 0:return[4,Tp(t)];case 1:return e=r.sent(),[4,Np(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return At(this,void 0,void 0,(function(){var e;return Dt(this,(function(n){switch(n.label){case 0:return(e=Yo(t)).Or.add(0),[4,zl(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(sd(Gp(this._delegate,od)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Bp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Zc.enableMultiTabIndexedDbPersistence(this):this.Zc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Zc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.tu&&(this.tu._removeServiceInstance("firestore"),this.tu._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new xc;return t.asyncQueue.enqueueAndForget((function(){return At(e,void 0,void 0,(function(){var e;return Dt(this,(function(r){switch(r.label){case 0:return e=Kf,[4,Ap(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(sd(Gp(this._delegate,od)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new gp(e);return t.asyncQueue.enqueueAndForget((function(){return At(n,void 0,void 0,(function(){var e;return Dt(this,(function(n){switch(n.label){case 0:return e=function(t,e){Yo(t).Gr.add(e),e.next()},[4,Dp(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Wo(),t.asyncQueue.enqueueAndForget((function(){return At(n,void 0,void 0,(function(){var e;return Dt(this,(function(n){switch(n.label){case 0:return e=function(t,e){Yo(t).Gr.delete(e)},[4,Dp(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(sd(t=Gp(t,od)),id(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.tu)throw new jo(qo.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.tu},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Fy(this,Zp(this._delegate,t))}catch(t){throw Dy(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new Ay(this,td(this._delegate,t))}catch(t){throw Dy(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new Oy(this,function(t,e){if(t=Gp(t,Wp),qp("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new jo(qo.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Xp(t,null,function(t){return new aa(us.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw Dy(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new xc;return t.asyncQueue.enqueueAndForget((function(){return At(n,void 0,void 0,(function(){var n;return Dt(this,(function(i){switch(i.label){case 0:return[4,function(t){return _p(t).then((function(t){return t.datastore}))}(t)];case 1:return n=i.sent(),new mp(t.asyncQueue,n,e,r).run(),[2]}}))}))})),r.promise}(sd(t),(function(n){return e(new vy(t,n))}))}(this._delegate,(function(n){return t(new Ty(e,n))}))},t.prototype.batch=function(){var t=this;return sd(this._delegate),new Sy(new hy(this._delegate,(function(e){return yy(t._delegate,e)})))},t.prototype.loadBundle=function(t){throw new jo(qo.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new jo(qo.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),_y=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return St(e,t),e.prototype.convertBytes=function(t){return new wy(new ld(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return Ay.eu(e,this.firestore,null)},e}(ay);var Ty=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new _y(t)}return t.prototype.get=function(t){var e=this,n=My(t);return this._delegate.get(n).then((function(t){return new xy(e._firestore,new Kd(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))}))},t.prototype.set=function(t,e,n){var r=My(t);return n?(jp("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=My(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,xt([s,e,n],i)),this},t.prototype.delete=function(t){var e=My(t);return this._delegate.delete(e),this},t}(),Sy=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=My(t);return n?(jp("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=My(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,xt([s,e,n],i)),this},t.prototype.delete=function(t){var e=My(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),Ny=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new zd(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Ry(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.nu=function(e,n){var r=t.su,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new _y(e),n),i.set(n,o)),o},t}();Ny.su=new WeakMap;var Ay=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new _y(t)}return t.iu=function(e,n,r){if(e.length%2!=0)throw new jo(qo.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new Yp(n._delegate,r,new _s(e)))},t.eu=function(e,n,r){return new t(n,new Yp(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Fy(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Fy(this.firestore,Zp(this._delegate,t))}catch(t){throw Dy(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=Ht(t))instanceof Yp&&ed(this._delegate,t)},t.prototype.set=function(t,e){e=jp("DocumentReference.set",e);try{return function(t,e,n){t=Gp(t,Yp);var r=Gp(t.firestore,od),i=uy(t.converter,e,n);return yy(r,[Ed(wd(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,ja.none())])}(this._delegate,t,e)}catch(t){throw Dy(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?py(this._delegate,t):py.apply(void 0,xt([this._delegate,t,e],n))}catch(t){throw Dy(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return yy(Gp((t=this._delegate).firestore,od),[new nu(t._key,ja.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Cy(e),i=ky(e,(function(e){return new xy(t.firestore,new Kd(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}));return dy(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Gp(t,Yp);var e=Gp(t.firestore,od),n=sd(e),r=new fy(e);return function(t,e){var n=this,r=new xc;return t.asyncQueue.enqueueAndForget((function(){return At(n,void 0,void 0,(function(){var n;return Dt(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return At(this,void 0,void 0,(function(){var r,i;return Dt(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=Yo(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Mn.mn(t,e)}))}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new jo(qo.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=vf(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,Sp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._key).then((function(n){return new Kd(e,r,t._key,n,new $d(null!==n&&n.hasLocalMutations,!0),t.converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Gp(t,Yp);var e=Gp(t.firestore,od);return Cp(sd(e),t._key,{source:"server"}).then((function(n){return gy(e,t,n)}))}(this._delegate):function(t){t=Gp(t,Yp);var e=Gp(t.firestore,od);return Cp(sd(e),t._key).then((function(n){return gy(e,t,n)}))}(this._delegate)).then((function(t){return new xy(e.firestore,new Kd(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}))},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Ny.nu(this.firestore,e)):this._delegate.withConverter(null))},t}();function Dy(t,e,n){return t.message=t.message.replace(e,n),t}function Cy(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!id(r))return r}return{}}function ky(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=id(t[0])?t[0]:id(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var xy=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new Ay(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return Qd(this._delegate,t._delegate)},t}(),Ry=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return St(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(xy),Oy=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new _y(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,Xd(this._delegate,function(t,e,n){var r=e,i=Bd("where",t);return new Jd(i,r,n)}(e,n,r)))}catch(e){throw Dy(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,Xd(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=Bd("orderBy",t);return new Zd(r,n)}(e,n)))}catch(e){throw Dy(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,Xd(this._delegate,function(t){return Hp("limit",t),new ty("limit",t,"F")}(e)))}catch(e){throw Dy(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,Xd(this._delegate,function(t){return Hp("limitToLast",t),new ty("limitToLast",t,"L")}(e)))}catch(e){throw Dy(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Xd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ey("startAt",t,!0)}.apply(void 0,e)))}catch(e){throw Dy(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Xd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ey("startAfter",t,!1)}.apply(void 0,e)))}catch(e){throw Dy(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Xd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ny("endBefore",t,!0)}.apply(void 0,e)))}catch(e){throw Dy(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Xd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ny("endAt",t,!1)}.apply(void 0,e)))}catch(e){throw Dy(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return nd(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Gp(t,Xp);var e=Gp(t.firestore,od),n=sd(e),r=new fy(e);return function(t,e){var n=this,r=new xc;return t.asyncQueue.enqueueAndForget((function(){return At(n,void 0,void 0,(function(){var n;return Dt(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return At(this,void 0,void 0,(function(){var r,i,o,s,a;return Dt(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,il(t,e,!0)];case 1:return a=u.sent(),r=new xf(e,a.Bn),i=r._o(a.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=u.sent(),a=vf(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}}))}))},[4,Sp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._query).then((function(n){return new Gd(e,r,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Gp(t,Xp);var e=Gp(t.firestore,od),n=sd(e),r=new fy(e);return kp(n,t._query,{source:"server"}).then((function(n){return new Gd(e,r,t,n)}))}(this._delegate):function(t){t=Gp(t,Xp);var e=Gp(t.firestore,od),n=sd(e),r=new fy(e);return Wd(t._query),kp(n,t._query).then((function(n){return new Gd(e,r,t,n)}))}(this._delegate)).then((function(t){return new Py(e.firestore,new Gd(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Cy(e),i=ky(e,(function(e){return new Py(t.firestore,new Gd(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return dy(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Ny.nu(this.firestore,e)):this._delegate.withConverter(null))},t}(),Ly=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new Ry(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),Py=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new Oy(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new Ry(t._firestore,e)}))},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new Ly(e._firestore,t)}))},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new Ry(n._firestore,r))}))},t.prototype.isEqual=function(t){return Qd(this._delegate,t._delegate)},t}(),Fy=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return St(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new Ay(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Ay(this.firestore,void 0===t?td(this._delegate):td(this._delegate,t))}catch(t){throw Dy(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Gp(t.firestore,od),r=td(t),i=uy(t.converter,e);return yy(n,[Ed(wd(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,ja.exists(!1))]).then((function(){return r}))}(this._delegate,t).then((function(t){return new Ay(e.firestore,t)}))},e.prototype.isEqual=function(t){return ed(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(Ny.nu(this.firestore,t)):this._delegate.withConverter(null))},e}(Oy);function My(t){return Gp(t,Yp)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Vy,Uy=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(hd.bind.apply(hd,xt([void 0],t)))}return t.documentId=function(){return new t(hs.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=Ht(t))instanceof hd&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),qy=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new Td("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new Id("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Sd("arrayUnion",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Nd("arrayRemove",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new Ad("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),jy={Firestore:Iy,GeoPoint:pd,Timestamp:ns,Blob:wy,Transaction:Ty,WriteBatch:Sy,DocumentReference:Ay,DocumentSnapshot:xy,Query:Oy,QueryDocumentSnapshot:Ry,QuerySnapshot:Py,CollectionReference:Fy,FieldPath:Uy,FieldValue:qy,setLogLevel:function(t){var e;e=t,Bo.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new Qt("firestore",(function(t){return function(t,e){return new Iy(t,new od(t,e),new Ey)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},jy)))})(Vy=Ie),Vy.registerVersion("@firebase/firestore","2.4.0");Ie.initializeApp({projectId:"sample-project-294713"});const By=function(){const t=window.location.search;let e;if(t)e=t.substring(1);else{const t=_t();window.location.hash=t,window.history.replaceState("","","?"+t),e=t}return e}(),$y=Ie.firestore().collection("rooms").doc(By),Ky=function(){const{subscribe:t,set:e}=yt([]);return{subscribe:t,set:e,append:(t,e)=>{$y.get().then((n=>{let r=[],i={closed:!0};if(n&&n.exists){const e=n.data();r=[...e.estimates.filter((e=>e.name!==t))],i=e.tableState}r.push({name:t,point:e,appendedAt:Ie.firestore.Timestamp.now()}),$y.set({estimates:r,tableState:i})}))},remove:(t,e=null)=>{$y.get().then((n=>{if(n&&n.exists){const r=n.data();r.estimates=r.estimates.filter((e=>e.name!==t)),$y.set(r).then(e)}else e()}))},clear:()=>{$y.delete()}}}(),zy=function(){const{subscribe:t,set:e}=yt({closed:!0});return{subscribe:t,set:e,open:()=>{$y.get().then((t=>{if(t&&t.exists){const e=t.data();e.tableState={closed:!1},$y.set(e)}}))},close:()=>{$y.delete()}}}(),Gy=new Promise((t=>{$y.onSnapshot((t=>{if(t&&t.exists){const e=t.data(),n=(t,e)=>t.appendedAt.seconds-e.appendedAt.seconds;Ky.set(e.estimates.sort(n)),zy.set(e.tableState)}else Ky.set([]),zy.set({closed:!0})})),t()}));function Hy(t){const e=t-1;return e*e*e+1}function Qy(t,{delay:e=0,duration:n=400,easing:r=Hy,x:i=0,y:o=0,opacity:s=0}={}){const a=getComputedStyle(t),u=+a.opacity,c="none"===a.transform?"":a.transform,h=u*(1-s);return{delay:e,duration:n,easing:r,css:(t,e)=>`\n\t\t\ttransform: ${c} translate(${(1-t)*i}px, ${(1-t)*o}px);\n\t\t\topacity: ${u-h*e}`}}function Wy(e){let n,r,i,s,a,c=(e[3]?"":e[0])+"";return{c(){n=w("div"),r=E(c),N(n,"class",i=u("card "+e[4])+" svelte-1lt9def"),k(n,"selectable",e[1]),k(n,"closed",e[3]),k(n,"selected",e[2])},m(t,i){v(t,n,i),d(n,r),s||(a=T(n,"click",(function(){o(e[1]?e[5]:void 0)&&(e[1]?e[5]:void 0).apply(this,arguments)})),s=!0)},p(t,[o]){e=t,9&o&&c!==(c=(e[3]?"":e[0])+"")&&A(r,c),16&o&&i!==(i=u("card "+e[4])+" svelte-1lt9def")&&N(n,"class",i),18&o&&k(n,"selectable",e[1]),24&o&&k(n,"closed",e[3]),20&o&&k(n,"selected",e[2])},i:t,o:t,d(t){t&&m(n),s=!1,a()}}}function Yy(t,e,n){let{point:r}=e,{selectable:i=!1}=e,{selected:o=!1}=e,{closed:s=!1}=e,{size:a="medium"}=e;const u=function(){const t=V();return(e,n)=>{const r=t.$$.callbacks[e];if(r){const i=x(e,n);r.slice().forEach((e=>{e.call(t,i)}))}}}();return t.$$set=t=>{"point"in t&&n(0,r=t.point),"selectable"in t&&n(1,i=t.selectable),"selected"in t&&n(2,o=t.selected),"closed"in t&&n(3,s=t.closed),"size"in t&&n(4,a=t.size)},[r,i,o,s,a,function(){u("selectCard",{point:r})}]}class Xy extends pt{constructor(t){super(),ft(this,t,Yy,Wy,s,{point:0,selectable:1,selected:2,closed:3,size:4})}}function Jy(e){let n,r,i,o,s=e[0]?"OPEN":"RETURN";return{c(){n=w("button"),r=E(s),N(n,"class",u("open-button")+" svelte-1i6cetj")},m(t,s){v(t,n,s),d(n,r),i||(o=T(n,"click",e[1]),i=!0)},p(t,[e]){1&e&&s!==(s=t[0]?"OPEN":"RETURN")&&A(r,s)},i:t,o:t,d(t){t&&m(n),i=!1,o()}}}function Zy(t,e,n){let{isClosed:r=!0}=e;return t.$$set=t=>{"isClosed"in t&&n(0,r=t.isClosed)},[r,function(e){U.call(this,t,e)}]}class tg extends pt{constructor(t){super(),ft(this,t,Zy,Jy,s,{isClosed:0})}}function eg(e){let n,r,i,o,s,a,c=e[0]?"COPIED":"COPY";return{c(){n=w("button"),r=E(c),N(n,"class",i=u(["copy-button",e[0]?"copied":""].join(" "))+" svelte-96r1p3"),n.disabled=o=!!e[0]},m(t,i){v(t,n,i),d(n,r),s||(a=T(n,"click",e[1]),s=!0)},p(t,[e]){1&e&&c!==(c=t[0]?"COPIED":"COPY")&&A(r,c),1&e&&i!==(i=u(["copy-button",t[0]?"copied":""].join(" "))+" svelte-96r1p3")&&N(n,"class",i),1&e&&o!==(o=!!t[0])&&(n.disabled=o)},i:t,o:t,d(t){t&&m(n),s=!1,a()}}}function ng(t,e,n){let{isCopied:r=!1}=e;return t.$$set=t=>{"isCopied"in t&&n(0,r=t.isCopied)},[r,function(e){U.call(this,t,e)}]}class rg extends pt{constructor(t){super(),ft(this,t,ng,eg,s,{isCopied:0})}}function ig(t,e,n){const r=t.slice();return r[6]=e[n],r}function og(t,e){let n,r,i,o,s,a,u,c,h=e[6].name+"";return r=new Xy({props:{point:e[6].point,size:"large",selectable:!1,closed:e[1]}}),{key:t,first:null,c(){n=w("div"),ut(r.$$.fragment),i=I(),o=w("div"),s=E(h),a=I(),N(o,"class","name svelte-9nb4u2"),N(n,"class","estimate svelte-9nb4u2"),this.first=n},m(t,e){v(t,n,e),ct(r,n,null),d(n,i),d(n,o),d(o,s),d(n,a),c=!0},p(t,n){e=t;const i={};1&n&&(i.point=e[6].point),2&n&&(i.closed=e[1]),r.$set(i),(!c||1&n)&&h!==(h=e[6].name+"")&&A(s,h)},i(t){c||(rt(r.$$.fragment,t),G((()=>{u||(u=st(n,Qy,{y:100},!0)),u.run(1)})),c=!0)},o(t){it(r.$$.fragment,t),u||(u=st(n,Qy,{y:100},!1)),u.run(0),c=!1},d(t){t&&m(n),ht(r),t&&u&&u.end()}}}function sg(t){let e,n,r;return n=new tg({props:{isClosed:t[1]}}),n.$on("click",(function(){o(t[2])&&t[2].apply(this,arguments)})),{c(){e=w("div"),ut(n.$$.fragment),N(e,"class","open-button-area svelte-9nb4u2")},m(t,i){v(t,e,i),ct(n,e,null),r=!0},p(e,r){t=e;const i={};2&r&&(i.isClosed=t[1]),n.$set(i)},i(t){r||(rt(n.$$.fragment,t),r=!0)},o(t){it(n.$$.fragment,t),r=!1},d(t){t&&m(e),ht(n)}}}function ag(t){let e,n;return e=new rg({props:{isCopied:t[3]}}),e.$on("click",t[4]),{c(){ut(e.$$.fragment)},m(t,r){ct(e,t,r),n=!0},p(t,n){const r={};8&n&&(r.isCopied=t[3]),e.$set(r)},i(t){n||(rt(e.$$.fragment,t),n=!0)},o(t){it(e.$$.fragment,t),n=!1},d(t){ht(e,t)}}}function ug(t){let e,n,r,i,o,s=[],a=new Map,u=t[0];const c=t=>t[6].name;for(let e=0;e<u.length;e+=1){let n=ig(t,u,e),r=c(n);a.set(r,s[e]=og(r,n))}let h=(t[0].length>0||!t[1])&&sg(t),l=!t[1]&&ag(t);return{c(){e=w("div"),n=w("div");for(let t=0;t<s.length;t+=1)s[t].c();r=I(),h&&h.c(),i=I(),l&&l.c(),N(n,"class","estimates svelte-9nb4u2"),N(e,"class","table svelte-9nb4u2")},m(t,a){v(t,e,a),d(e,n);for(let t=0;t<s.length;t+=1)s[t].m(n,null);d(e,r),h&&h.m(e,null),d(e,i),l&&l.m(e,null),o=!0},p(t,[r]){3&r&&(u=t[0],et(),s=function(t,e,n,r,i,o,s,a,u,c,h,l){let f=t.length,p=o.length,d=f;const y={};for(;d--;)y[t[d].key]=d;const g=[],v=new Map,m=new Map;for(d=p;d--;){const t=l(i,o,d),a=n(t);let u=s.get(a);u?r&&u.p(t,e):(u=c(a,t),u.c()),v.set(a,g[d]=u),a in y&&m.set(a,Math.abs(d-y[a]))}const b=new Set,w=new Set;function E(t){rt(t,1),t.m(a,h),s.set(t.key,t),h=t.first,p--}for(;f&&p;){const e=g[p-1],n=t[f-1],r=e.key,i=n.key;e===n?(h=e.first,f--,p--):v.has(i)?!s.has(r)||b.has(r)?E(e):w.has(i)?f--:m.get(r)>m.get(i)?(w.add(r),E(e)):(b.add(i),f--):(u(n,s),f--)}for(;f--;){const e=t[f];v.has(e.key)||u(e,s)}for(;p;)E(g[p-1]);return g}(s,r,c,1,t,u,a,n,at,og,null,ig),nt()),t[0].length>0||!t[1]?h?(h.p(t,r),3&r&&rt(h,1)):(h=sg(t),h.c(),rt(h,1),h.m(e,i)):h&&(et(),it(h,1,1,(()=>{h=null})),nt()),t[1]?l&&(et(),it(l,1,1,(()=>{l=null})),nt()):l?(l.p(t,r),2&r&&rt(l,1)):(l=ag(t),l.c(),rt(l,1),l.m(e,null))},i(t){if(!o){for(let t=0;t<u.length;t+=1)rt(s[t]);rt(h),rt(l),o=!0}},o(t){for(let t=0;t<s.length;t+=1)it(s[t]);it(h),it(l),o=!1},d(t){t&&m(e);for(let t=0;t<s.length;t+=1)s[t].d();h&&h.d(),l&&l.d()}}}function cg(t,e,n){let{estimates:r=[]}=e,{isClosed:i=!0}=e,{handleOpenButtonClick:o=(()=>{})}=e;r=r||[];let s=!1;return t.$$set=t=>{"estimates"in t&&n(0,r=t.estimates),"isClosed"in t&&n(1,i=t.isClosed),"handleOpenButtonClick"in t&&n(2,o=t.handleOpenButtonClick)},[r,i,o,s,function(){const t=function(){if(0===r.length)return"empty.";const t=new Date;return"["+t.toLocaleDateString()+" "+t.toLocaleTimeString()+"] "+r.sort(((t,e)=>t.name>e.name?1:-1)).reduce(((t,e)=>(t?t+" ":"")+`${e.name}(${e.point})`),null)}();navigator.clipboard.writeText(t),n(3,s=!0),setTimeout((()=>{n(3,s=!1)}),1e3)}]}class hg extends pt{constructor(t){super(),ft(this,t,cg,ug,s,{estimates:0,isClosed:1,handleOpenButtonClick:2})}}function lg(e){let n,r,i;return{c(){n=w("button"),n.textContent="OK",N(n,"class",u("ok-button")+" svelte-rmf0e0")},m(t,o){v(t,n,o),r||(i=T(n,"click",function(t){return function(e){return e.stopPropagation(),t.call(this,e)}}(S(e[0]))),r=!0)},p:t,i:t,o:t,d(t){t&&m(n),r=!1,i()}}}function fg(t){return[function(e){U.call(this,t,e)}]}class pg extends pt{constructor(t){super(),ft(this,t,fg,lg,s,{})}}function dg(t,e,n){const r=t.slice();return r[15]=e[n],r}function yg(t,e,n){const r=t.slice();return r[18]=e[n],r}function gg(t){let e,n,r,o,s,a,u,c=t[0]&&mg(t);return{c(){e=w("div"),n=w("form"),r=w("input"),o=I(),c&&c.c(),N(r,"placeholder","your name"),r.autofocus=!0,N(r,"class","svelte-y3ory"),N(e,"class","user-name svelte-y3ory")},m(i,h){v(i,e,h),d(e,n),d(n,r),D(r,t[0]),d(n,o),c&&c.m(n,null),s=!0,r.focus(),a||(u=[T(r,"input",t[10]),T(n,"submit",S(t[12]))],a=!0)},p(t,e){1&e&&r.value!==t[0]&&D(r,t[0]),t[0]?c?(c.p(t,e),1&e&&rt(c,1)):(c=mg(t),c.c(),rt(c,1),c.m(n,null)):c&&(et(),it(c,1,1,(()=>{c=null})),nt())},i(t){s||(rt(c),s=!0)},o(t){it(c),s=!1},d(t){t&&m(e),c&&c.d(),a=!1,i(u)}}}function vg(t){let e,n,r,i,o,s,a,u,c,h,l=t[7],f=[];for(let e=0;e<l.length;e+=1)f[e]=bg(yg(t,l,e));let p=t[5],y=[];for(let e=0;e<p.length;e+=1)y[e]=wg(dg(t,p,e));const g=t=>it(y[t],1,1,(()=>{y[t]=null}));return{c(){e=w("div"),n=E(t[0]),r=I(),i=w("div"),o=w("select");for(let t=0;t<f.length;t+=1)f[t].c();s=I();for(let t=0;t<y.length;t+=1)y[t].c();a=_(),N(e,"class","user-name svelte-y3ory"),void 0===t[4]&&G((()=>t[9].call(o))),N(i,"class","svelte-y3ory")},m(l,p){v(l,e,p),d(e,n),v(l,r,p),v(l,i,p),d(i,o);for(let t=0;t<f.length;t+=1)f[t].m(o,null);C(o,t[4]),v(l,s,p);for(let t=0;t<y.length;t+=1)y[t].m(l,p);v(l,a,p),u=!0,c||(h=T(o,"change",t[9]),c=!0)},p(t,e){if((!u||1&e)&&A(n,t[0]),128&e){let n;for(l=t[7],n=0;n<l.length;n+=1){const r=yg(t,l,n);f[n]?f[n].p(r,e):(f[n]=bg(r),f[n].c(),f[n].m(o,null))}for(;n<f.length;n+=1)f[n].d(1);f.length=l.length}if(144&e&&C(o,t[4]),100&e){let n;for(p=t[5],n=0;n<p.length;n+=1){const r=dg(t,p,n);y[n]?(y[n].p(r,e),rt(y[n],1)):(y[n]=wg(r),y[n].c(),rt(y[n],1),y[n].m(a.parentNode,a))}for(et(),n=p.length;n<y.length;n+=1)g(n);nt()}},i(t){if(!u){for(let t=0;t<p.length;t+=1)rt(y[t]);u=!0}},o(t){y=y.filter(Boolean);for(let t=0;t<y.length;t+=1)it(y[t]);u=!1},d(t){t&&m(e),t&&m(r),t&&m(i),b(f,t),t&&m(s),b(y,t),t&&m(a),c=!1,h()}}}function mg(e){let n,r;return n=new pg({}),n.$on("click",e[11]),{c(){ut(n.$$.fragment)},m(t,e){ct(n,t,e),r=!0},p:t,i(t){r||(rt(n.$$.fragment,t),r=!0)},o(t){it(n.$$.fragment,t),r=!1},d(t){ht(n,t)}}}function bg(e){let n,r,i,o=e[18].id+"";return{c(){n=w("option"),r=E(o),n.__value=i=e[18].id,n.value=n.__value},m(t,e){v(t,n,e),d(n,r)},p:t,d(t){t&&m(n)}}}function wg(t){let e,n;return e=new Xy({props:{point:t[15],selectable:!0,size:"medium",selected:t[6]===t[15]}}),e.$on("selectCard",(function(){o(t[2])&&t[2].apply(this,arguments)})),{c(){ut(e.$$.fragment)},m(t,r){ct(e,t,r),n=!0},p(n,r){t=n;const i={};32&r&&(i.point=t[15]),96&r&&(i.selected=t[6]===t[15]),e.$set(i)},i(t){n||(rt(e.$$.fragment,t),n=!0)},o(t){it(e.$$.fragment,t),n=!1},d(t){ht(e,t)}}}function Eg(t){let e,n,r,i;const o=[vg,gg],s=[];function a(t,e){return t[0]&&t[1]?0:1}return n=a(t),r=s[n]=o[n](t),{c(){e=w("div"),r.c(),N(e,"class",u("user-selection")+" svelte-y3ory")},m(t,r){v(t,e,r),s[n].m(e,null),i=!0},p(t,[i]){let u=n;n=a(t),n===u?s[n].p(t,i):(et(),it(s[u],1,1,(()=>{s[u]=null})),nt(),r=s[n],r?r.p(t,i):(r=s[n]=o[n](t),r.c()),rt(r,1),r.m(e,null))},i(t){i||(rt(r),i=!0)},o(t){it(r),i=!1},d(t){t&&m(e),s[n].d()}}}function Ig(t,e,n){let r,i,{userName:o=""}=e,{isFixedUserName:s=!1}=e,{estimates:a=[]}=e,{handleSelectCard:u}=e,{handleFixName:c}=e;a=a||[];const h=[{id:"fibonacci",points:["0","1","2","3","5","8","13","21","34","55","?",""]},{id:"ten",points:["0","10","20","30","40","50","60","70","80","90","100","?",""]}];let l=h[0].id;return t.$$set=t=>{"userName"in t&&n(0,o=t.userName),"isFixedUserName"in t&&n(1,s=t.isFixedUserName),"estimates"in t&&n(8,a=t.estimates),"handleSelectCard"in t&&n(2,u=t.handleSelectCard),"handleFixName"in t&&n(3,c=t.handleFixName)},t.$$.update=()=>{257&t.$$.dirty&&n(6,r=a.filter((t=>t.name===o)).map((t=>t.point)).pop()),16&t.$$.dirty&&n(5,i=h.filter((t=>l===t.id))[0].points)},[o,s,u,c,l,i,r,h,a,function(){l=function(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}(this),n(4,l),n(7,h)},function(){o=this.value,n(0,o)},()=>c(o),()=>c(o)]}class _g extends pt{constructor(t){super(),ft(this,t,Ig,Eg,s,{userName:0,isFixedUserName:1,estimates:8,handleSelectCard:2,handleFixName:3})}}function Tg(e){let n;return{c(){n=w("div"),n.innerHTML='<a href="https://unsplash.com" target="_blank" rel="noopener noreferrer" title="Photo by Unsplash"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="_1Jlgk" version="1.1" viewBox="0 0 32 32" aria-labelledby="unsplash-home" aria-hidden="false"><path d="M10 9V0h12v9H10zm12 5h10v18H0V14h10v9h12v-9z"></path></svg></a>',N(n,"class","unsplash-credit svelte-1vmngv8")},m(t,e){v(t,n,e)},p:t,i:t,o:t,d(t){t&&m(n)}}}class Sg extends pt{constructor(t){super(),ft(this,t,null,Tg,s,{})}}function Ng(t){let e,n,r,i,o,s,a,u,c,h,l,f,p,y,g;return u=new hg({props:{isClosed:t[2],estimates:t[0],handleOpenButtonClick:t[5]}}),h=new _g({props:{userName:t[3],isFixedUserName:t[4],estimates:t[0],handleFixName:t[6],handleSelectCard:t[7]}}),y=new Sg({}),{c(){e=w("div"),n=w("main"),r=w("h1"),i=E(t[1]),o=I(),s=w("p"),s.textContent="share the URL of this page with your team members.",a=I(),ut(u.$$.fragment),c=I(),ut(h.$$.fragment),l=I(),f=w("div"),f.innerHTML='development: <a href="https://github.com/redfe/planning-poker-svelte" target="_blank" rel="noopener noreferrer" class="svelte-1px3ltw">Source code</a>,<a href="./storybook-static/" target="_blank" rel="noopener noreferrer" class="svelte-1px3ltw">Storybook</a>.',p=I(),ut(y.$$.fragment),N(r,"class","svelte-1px3ltw"),N(s,"class","svelte-1px3ltw"),N(f,"class","devinfo svelte-1px3ltw"),N(n,"class","svelte-1px3ltw"),N(e,"class","container svelte-1px3ltw")},m(t,m){v(t,e,m),d(e,n),d(n,r),d(r,i),d(n,o),d(n,s),d(n,a),ct(u,n,null),d(n,c),ct(h,n,null),d(n,l),d(n,f),d(e,p),ct(y,e,null),g=!0},p(t,[e]){(!g||2&e)&&A(i,t[1]);const n={};4&e&&(n.isClosed=t[2]),1&e&&(n.estimates=t[0]),32&e&&(n.handleOpenButtonClick=t[5]),u.$set(n);const r={};8&e&&(r.userName=t[3]),16&e&&(r.isFixedUserName=t[4]),1&e&&(r.estimates=t[0]),64&e&&(r.handleFixName=t[6]),128&e&&(r.handleSelectCard=t[7]),h.$set(r)},i(t){g||(rt(u.$$.fragment,t),rt(h.$$.fragment,t),rt(y.$$.fragment,t),g=!0)},o(t){it(u.$$.fragment,t),it(h.$$.fragment,t),it(y.$$.fragment,t),g=!1},d(t){t&&m(e),ht(u),ht(h),ht(y)}}}function Ag(t,e,n){let{name:r}=e,{isTableClosed:i=!0}=e,{estimates:o=[]}=e,{userName:s=""}=e,{isFixedUserName:a=!1}=e,{handleOpenButtonClick:u}=e,{handleFixName:c}=e,{handleSelectCard:h}=e;return o=o||[],t.$$set=t=>{"name"in t&&n(1,r=t.name),"isTableClosed"in t&&n(2,i=t.isTableClosed),"estimates"in t&&n(0,o=t.estimates),"userName"in t&&n(3,s=t.userName),"isFixedUserName"in t&&n(4,a=t.isFixedUserName),"handleOpenButtonClick"in t&&n(5,u=t.handleOpenButtonClick),"handleFixName"in t&&n(6,c=t.handleFixName),"handleSelectCard"in t&&n(7,h=t.handleSelectCard)},[o,r,i,s,a,u,c,h]}class Dg extends pt{constructor(t){super(),ft(this,t,Ag,Ng,s,{name:1,isTableClosed:2,estimates:0,userName:3,isFixedUserName:4,handleOpenButtonClick:5,handleFixName:6,handleSelectCard:7})}}function Cg(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function kg(t){let e,n;return e=new Dg({props:{name:t[0],isTableClosed:t[4].closed,estimates:t[2],userName:t[1],isFixedUserName:t[3],handleOpenButtonClick:t[5],handleFixName:t[6],handleSelectCard:t[7]}}),{c(){ut(e.$$.fragment)},m(t,r){ct(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.name=t[0]),16&n&&(r.isTableClosed=t[4].closed),4&n&&(r.estimates=t[2]),2&n&&(r.userName=t[1]),8&n&&(r.isFixedUserName=t[3]),e.$set(r)},i(t){n||(rt(e.$$.fragment,t),n=!0)},o(t){it(e.$$.fragment,t),n=!1},d(t){ht(e,t)}}}function xg(e){let n;return{c(){n=w("p"),n.textContent="...waiting"},m(t,e){v(t,n,e)},p:t,i:t,o:t,d(t){t&&m(n)}}}function Rg(t){let e,n,r,i,o;document.title=e=t[0];let s={ctx:t,current:null,token:null,hasCatch:!1,pending:xg,then:kg,catch:Cg,blocks:[,,,]};return function(t,e){const n=e.token={};function r(t,r,i,o){if(e.token!==n)return;e.resolved=o;let s=e.ctx;void 0!==i&&(s=s.slice(),s[i]=o);const a=t&&(e.current=t)(s);let u=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==r&&t&&(et(),it(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),nt())})):e.block.d(1),a.c(),rt(a,1),a.m(e.mount(),e.anchor),u=!0),e.block=a,e.blocks&&(e.blocks[r]=a),u&&W()}if((i=t)&&"object"==typeof i&&"function"==typeof i.then){const n=V();if(t.then((t=>{M(n),r(e.then,1,e.value,t),M(null)}),(t=>{if(M(n),r(e.catch,2,e.error,t),M(null),!e.hasCatch)throw t})),e.current!==e.pending)return r(e.pending,0),!0}else{if(e.current!==e.then)return r(e.then,1,e.value,t),!0;e.resolved=t}var i}(Gy,s),{c(){n=w("link"),r=I(),i=_(),s.block.c(),N(n,"href","https://fonts.googleapis.com/css?family=M+PLUS+1p"),N(n,"rel","stylesheet")},m(t,e){d(document.head,n),v(t,r,e),v(t,i,e),s.block.m(t,s.anchor=e),s.mount=()=>i.parentNode,s.anchor=i,o=!0},p(n,[r]){t=n,(!o||1&r)&&e!==(e=t[0])&&(document.title=e),function(t,e,n){const r=e.slice(),{resolved:i}=t;t.current===t.then&&(r[t.value]=i),t.current===t.catch&&(r[t.error]=i),t.block.p(r,n)}(s,t,r)},i(t){o||(rt(s.block),o=!0)},o(t){for(let t=0;t<3;t+=1){it(s.blocks[t])}o=!1},d(t){m(n),t&&m(r),t&&m(i),s.block.d(t),s.token=null,s=null}}}function Og(t,e,n){let r,i,o;a(t,Ky,(t=>n(2,i=t))),a(t,zy,(t=>n(4,o=t)));let{name:s}=e,u=window.localStorage.name||"",c=!1;return t.$$set=t=>{"name"in t&&n(0,s=t.name)},t.$$.update=()=>{6&t.$$.dirty&&(r=i.filter((t=>t.name===u)).map((t=>t.point)).pop())},[s,u,i,c,o,function(){o.closed?i.length>0&&zy.open():(Ky.clear(),zy.close())},function(t){t&&(n(1,u=t),window.localStorage.setItem("name",u),n(3,c=!0))},function(t){const e=()=>Ky.append(u,t.detail.point);r?Ky.remove(u,r===t.detail.point?null:()=>setTimeout(e,300)):e()}]}return new class extends pt{constructor(t){super(),ft(this,t,Og,Rg,s,{name:0})}}({target:document.body,props:{name:"Planning Poker"}})}();
//# sourceMappingURL=bundle.js.map
