var app=function(){"use strict";function t(){}const e=t=>t;function n(t,e){for(const n in e)t[n]=e[n];return t}function r(t){return t()}function i(){return Object.create(null)}function o(t){t.forEach(r)}function s(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function u(e,n,r){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function c(t,e,r,i){return t[1]&&i?n(r.ctx.slice(),t[1](i(e))):r.ctx}function h(t){const e={};for(const n in t)"$"!==n[0]&&(e[n]=t[n]);return e}function l(t){return null==t?"":t}const f="undefined"!=typeof window;let p=f?()=>window.performance.now():()=>Date.now(),d=f?t=>requestAnimationFrame(t):t;const y=new Set;function g(t){y.forEach((e=>{e.c(t)||(y.delete(e),e.f())})),0!==y.size&&d(g)}function v(t,e){t.appendChild(e)}function m(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function b(t){const e=I("style");return function(t,e){v(t.head||t,e)}(m(t),e),e}function w(t,e,n){t.insertBefore(e,n||null)}function E(t){t.parentNode.removeChild(t)}function I(t){return document.createElement(t)}function T(t){return document.createTextNode(t)}function _(){return T(" ")}function S(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function A(t){return function(e){return e.preventDefault(),t.call(this,e)}}function N(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function D(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function C(t,e){t.value=null==e?"":e}function k(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}function x(t,e,n){t.classList[n?"add":"remove"](e)}function R(t,e,n=!1){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,!1,e),r}const O=new Set;let L,P=0;function M(t,e,n,r,i,o,s,a=0){const u=16.666/r;let c="{\n";for(let t=0;t<=1;t+=u){const r=e+(n-e)*o(t);c+=100*t+`%{${s(r,1-r)}}\n`}const h=c+`100% {${s(n,1-n)}}\n}`,l=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(h)}_${a}`,f=m(t);O.add(f);const p=f.__svelte_stylesheet||(f.__svelte_stylesheet=b(t).sheet),d=f.__svelte_rules||(f.__svelte_rules={});d[l]||(d[l]=!0,p.insertRule(`@keyframes ${l} ${h}`,p.cssRules.length));const y=t.style.animation||"";return t.style.animation=`${y?`${y}, `:""}${l} ${r}ms linear ${i}ms 1 both`,P+=1,l}function F(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),i=n.length-r.length;i&&(t.style.animation=r.join(", "),P-=i,P||d((()=>{P||(O.forEach((t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}})),O.clear())})))}function V(t){L=t}function U(){if(!L)throw new Error("Function called outside component initialization");return L}function q(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const j=[],B=[],$=[],K=[],z=Promise.resolve();let G=!1;function H(t){$.push(t)}let Q=!1;const W=new Set;function Y(){if(!Q){Q=!0;do{for(let t=0;t<j.length;t+=1){const e=j[t];V(e),X(e.$$)}for(V(null),j.length=0;B.length;)B.pop()();for(let t=0;t<$.length;t+=1){const e=$[t];W.has(e)||(W.add(e),e())}$.length=0}while(j.length);for(;K.length;)K.pop()();G=!1,Q=!1,W.clear()}}function X(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(H)}}let J;function Z(t,e,n){t.dispatchEvent(R(`${e?"intro":"outro"}${n}`))}const tt=new Set;let et;function nt(){et={r:0,c:[],p:et}}function rt(){et.r||o(et.c),et=et.p}function it(t,e){t&&t.i&&(tt.delete(t),t.i(e))}function ot(t,e,n,r){if(t&&t.o){if(tt.has(t))return;tt.add(t),et.c.push((()=>{tt.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}const st={duration:0};function at(n,r,i,a){let u=r(n,i),c=a?0:1,h=null,l=null,f=null;function v(){f&&F(n,f)}function m(t,e){const n=t.b-c;return e*=Math.abs(n),{a:c,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function b(r){const{delay:i=0,duration:s=300,easing:a=e,tick:b=t,css:w}=u||st,E={start:p()+i,b:r};r||(E.group=et,et.r+=1),h||l?l=E:(w&&(v(),f=M(n,c,r,s,i,a,w)),r&&b(0,1),h=m(E,s),H((()=>Z(n,r,"start"))),function(t){let e;0===y.size&&d(g),new Promise((n=>{y.add(e={c:t,f:n})}))}((t=>{if(l&&t>l.start&&(h=m(l,s),l=null,Z(n,h.b,"start"),w&&(v(),f=M(n,c,h.b,h.duration,0,a,u.css))),h)if(t>=h.end)b(c=h.b,1-c),Z(n,h.b,"end"),l||(h.b?v():--h.group.r||o(h.group.c)),h=null;else if(t>=h.start){const e=t-h.start;c=h.a+h.d*a(e/h.duration),b(c,1-c)}return!(!h&&!l)})))}return{run(t){s(u)?(J||(J=Promise.resolve(),J.then((()=>{J=null}))),J).then((()=>{u=u(),b(t)})):b(t)},end(){v(),h=l=null}}}const ut="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function ct(t,e){ot(t,1,1,(()=>{e.delete(t.key)}))}function ht(t){t&&t.c()}function lt(t,e,n,i){const{fragment:a,on_mount:u,on_destroy:c,after_update:h}=t.$$;a&&a.m(e,n),i||H((()=>{const e=u.map(r).filter(s);c?c.push(...e):o(e),t.$$.on_mount=[]})),h.forEach(H)}function ft(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function pt(t,e){-1===t.$$.dirty[0]&&(j.push(t),G||(G=!0,z.then(Y)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function dt(e,n,r,s,a,u,c,h=[-1]){const l=L;V(e);const f=e.$$={fragment:null,ctx:null,props:u,update:t,not_equal:a,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(l?l.$$.context:[])),callbacks:i(),dirty:h,skip_bound:!1,root:n.target||l.$$.root};c&&c(f.root);let p=!1;if(f.ctx=r?r(e,n.props||{},((t,n,...r)=>{const i=r.length?r[0]:n;return f.ctx&&a(f.ctx[t],f.ctx[t]=i)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](i),p&&pt(e,t)),n})):[],f.update(),p=!0,o(f.before_update),f.fragment=!!s&&s(f.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);f.fragment&&f.fragment.l(t),t.forEach(E)}else f.fragment&&f.fragment.c();n.intro&&it(e.$$.fragment),lt(e,n.target,n.anchor,n.customElement),Y()}V(l)}class yt{$destroy(){ft(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function gt(t){const e=t-1;return e*e*e+1}function vt(t,{delay:e=0,duration:n=400,easing:r=gt,x:i=0,y:o=0,opacity:s=0}={}){const a=getComputedStyle(t),u=+a.opacity,c="none"===a.transform?"":a.transform,h=u*(1-s);return{delay:e,duration:n,easing:r,css:(t,e)=>`\n\t\t\ttransform: ${c} translate(${(1-t)*i}px, ${(1-t)*o}px);\n\t\t\topacity: ${u-h*e}`}}const mt=[];function bt(e,n=t){let r;const i=new Set;function o(t){if(a(e,t)&&(e=t,r)){const t=!mt.length;for(const t of i)t[1](),mt.push(t,e);if(t){for(let t=0;t<mt.length;t+=2)mt[t][0](mt[t+1]);mt.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(s,a=t){const u=[s,a];return i.add(u),1===i.size&&(r=n(o)||t),s(e),()=>{i.delete(u),0===i.size&&(r(),r=null)}}}}var wt,Et=new Uint8Array(16);function It(){if(!wt&&!(wt="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return wt(Et)}var Tt=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function _t(t){return"string"==typeof t&&Tt.test(t)}for(var St=[],At=0;At<256;++At)St.push((At+256).toString(16).substr(1));function Nt(t,e,n){var r=(t=t||{}).random||(t.rng||It)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(St[t[e+0]]+St[t[e+1]]+St[t[e+2]]+St[t[e+3]]+"-"+St[t[e+4]]+St[t[e+5]]+"-"+St[t[e+6]]+St[t[e+7]]+"-"+St[t[e+8]]+St[t[e+9]]+"-"+St[t[e+10]]+St[t[e+11]]+St[t[e+12]]+St[t[e+13]]+St[t[e+14]]+St[t[e+15]]).toLowerCase();if(!_t(n))throw TypeError("Stringified UUID is invalid");return n}(r)}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var Dt=function(t,e){return Dt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},Dt(t,e)};function Ct(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Dt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var kt=function(){return kt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},kt.apply(this,arguments)};function xt(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function Rt(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function Ot(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Lt(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function Pt(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Mt=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},Ft={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|a>>4,f=(15&a)<<2|c>>6,p=63&c;u||(p=64,s||(f=64)),r.push(n[h],n[l],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Mt(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();var c=o<<2|s>>4;if(r.push(c),64!==a){var h=s<<4&240|a>>2;if(r.push(h),64!==u){var l=a<<6&192|u;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},Vt=function(t){return function(t){var e=Mt(t);return Ft.encodeByteArray(e,!0)}(t).replace(/\./g,"")};function Ut(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=Ut(t[n],e[n]));return t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var qt=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function jt(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Bt(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var $t=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,Kt.prototype.create),o}return Ct(e,t),e}(Error),Kt=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?zt(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new $t(i,a,r);return u},t}();function zt(t,e){return t.replace(Gt,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var Gt=/\{\$([^}]+)}/g;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ht(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Qt(t,e){var n=new Wt(t,e);return n.subscribe.bind(n)}var Wt=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n},void 0===r.next&&(r.next=Yt),void 0===r.error&&(r.error=Yt),void 0===r.complete&&(r.complete=Yt);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function Yt(){}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Xt(t){return t&&t._delegate?t._delegate:t}var Jt=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),Zt="[DEFAULT]",te=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new qt;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(r)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t))try{this.getOrInitializeService({instanceIdentifier:Zt})}catch(t){}try{for(var r=Ot(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=Lt(i.value,2),s=o[0],a=o[1],u=this.normalizeInstanceIdentifier(s);try{var c=this.getOrInitializeService({instanceIdentifier:u});a.resolve(c)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=Zt),this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return xt(this,void 0,void 0,(function(){var t;return Rt(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(Pt(Pt([],Lt(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),Lt(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=Zt),this.instances.has(t)},t.prototype.getOptions=function(t){return void 0===t&&(t=Zt),this.instancesOptions.get(t)||{}},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var r=t.options,i=void 0===r?{}:r,o=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(o))throw Error(this.name+"("+o+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var s=this.getOrInitializeService({instanceIdentifier:o,options:i});try{for(var a=Ot(this.instancesDeferred.entries()),u=a.next();!u.done;u=a.next()){var c=Lt(u.value,2),h=c[0],l=c[1];o===this.normalizeInstanceIdentifier(h)&&l.resolve(s)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return s},t.prototype.onInit=function(t,e){var n,r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&t(o,r),function(){i.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,r,i=this.onInitCallbacks.get(e);if(i)try{for(var o=Ot(i),s=o.next();!s.done;s=o.next()){var a=s.value;try{a(t,e)}catch(t){}}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===Zt?void 0:e),options:i}),this.instances.set(n,o),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(o,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(t){}return o||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=Zt),this.component?this.component.multipleInstances?t:Zt:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ee,ne=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new te(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function re(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ie,oe=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(ie||(ie={}));var se,ae={debug:ie.DEBUG,verbose:ie.VERBOSE,info:ie.INFO,warn:ie.WARN,error:ie.ERROR,silent:ie.SILENT},ue=ie.INFO,ce=((ee={})[ie.DEBUG]="log",ee[ie.VERBOSE]="log",ee[ie.INFO]="info",ee[ie.WARN]="warn",ee[ie.ERROR]="error",ee),he=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=ce[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,re(["["+i+"]  "+t.name+":"],n))}},le=function(){function t(t){this.name=t,this._logLevel=ue,this._logHandler=he,this._userLogHandler=null,oe.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in ie))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?ae[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,re([this,ie.DEBUG],t)),this._logHandler.apply(this,re([this,ie.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,re([this,ie.VERBOSE],t)),this._logHandler.apply(this,re([this,ie.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,re([this,ie.INFO],t)),this._logHandler.apply(this,re([this,ie.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,re([this,ie.WARN],t)),this._logHandler.apply(this,re([this,ie.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,re([this,ie.ERROR],t)),this._logHandler.apply(this,re([this,ie.ERROR],t))},t}();function fe(t){oe.forEach((function(e){e.setLogLevel(t)}))}var pe,de=((se={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",se["bad-app-name"]="Illegal App name: '{$appName}",se["duplicate-app"]="Firebase App named '{$appName}' already exists",se["app-deleted"]="Firebase App named '{$appName}' already deleted",se["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",se["invalid-log-argument"]="First argument to `onLog` must be null or a function.",se),ye=new Kt("app","Firebase",de),ge="@firebase/app",ve="[DEFAULT]",me=((pe={})[ge]="fire-core",pe["@firebase/analytics"]="fire-analytics",pe["@firebase/app-check"]="fire-app-check",pe["@firebase/auth"]="fire-auth",pe["@firebase/database"]="fire-rtdb",pe["@firebase/functions"]="fire-fn",pe["@firebase/installations"]="fire-iid",pe["@firebase/messaging"]="fire-fcm",pe["@firebase/performance"]="fire-perf",pe["@firebase/remote-config"]="fire-rc",pe["@firebase/storage"]="fire-gcs",pe["@firebase/firestore"]="fire-fst",pe["fire-js"]="fire-js",pe["firebase-wrapper"]="fire-js-all",pe),be=new le("@firebase/app"),we=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=Ut(void 0,t),this.container=new ne(e.name),this._addComponent(new Jt("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){var n;void 0===e&&(e=ve),this.checkDestroyed_();var r=this.container.getProvider(t);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=ve),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){be.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw ye.create("app-deleted",{appName:this.name_})},t}();we.prototype.name&&we.prototype.options||we.prototype.delete||console.log("dc");
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Ee(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var o=i;void 0===o.name&&(o.name=ve);var s=o.name;if("string"!=typeof s||!s)throw ye.create("bad-app-name",{appName:String(s)});if(Ht(e,s))throw ye.create("duplicate-app",{appName:s});var a=new t(n,o,r);return e[s]=a,a},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=me[t])&&void 0!==r?r:t;n&&(i+="-"+n);var s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return s&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),s&&a&&u.push("and"),a&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void be.warn(u.join(" "))}o(new Jt(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:fe,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw ye.create("invalid-log-argument");!function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=ae[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:ie[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=oe;r<i.length;r++)n(i[r])}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t,e)},apps:null,SDK_VERSION:"8.10.0",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){if("serverAuth"===e)return null;return e}}};function i(t){if(!Ht(e,t=t||ve))throw ye.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return be.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var a=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[s])throw ye.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&Ut(a,o.serviceProps),r[s]=a,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,s);return n.apply(this,o.multipleInstances?t:[])}}for(var u=0,c=Object.keys(e);u<c.length;u++){var h=c[u];e[h]._addComponent(o)}return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ie=function t(){var e=Ee(we);return e.INTERNAL=kt(kt({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){Ut(e,t)},createSubscribe:Qt,ErrorFactory:Kt,deepExtend:Ut}),e}(),Te=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){be.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var _e=self.firebase.SDK_VERSION;_e&&_e.indexOf("LITE")>=0&&be.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Se=Ie.initializeApp;Ie.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Bt()&&be.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),Se.apply(void 0,t)};var Ae=Ie;!function(t,e){t.INTERNAL.registerComponent(new Jt("platform-logger",(function(t){return new Te(t)}),"PRIVATE")),t.registerVersion(ge,"0.6.30",e),t.registerVersion("fire-js","")}(Ae);var Ne="8.10.0";
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
Ae.registerVersion("firebase",Ne,"app"),Ae.SDK_VERSION=Ne;
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var De=function(t,e){return De=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},De(t,e)};function Ce(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var ke,xe="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Re=Re||{},Oe=xe||self;function Le(){}function Pe(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Me(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Fe="closure_uid_"+(1e9*Math.random()>>>0),Ve=0;function Ue(t,e,n){return t.call.apply(t.bind,arguments)}function qe(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function je(t,e,n){return(je=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Ue:qe).apply(null,arguments)}function Be(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function $e(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function Ke(){this.s=this.s,this.o=this.o}var ze={};Ke.prototype.s=!1,Ke.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,Fe)&&t[Fe]||(t[Fe]=++Ve)}(this);delete ze[t]}},Ke.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Ge=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},He=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function Qe(t){return Array.prototype.concat.apply([],arguments)}function We(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Ye(t){return/^[\s\xa0]*$/.test(t)}var Xe,Je=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Ze(t,e){return-1!=t.indexOf(e)}function tn(t,e){return t<e?-1:t>e?1:0}t:{var en=Oe.navigator;if(en){var nn=en.userAgent;if(nn){Xe=nn;break t}}Xe=""}function rn(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function on(t){var e={};for(var n in t)e[n]=t[n];return e}var sn="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function an(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<sn.length;o++)n=sn[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function un(t){return un[" "](t),t}un[" "]=Le;var cn,hn,ln=Ze(Xe,"Opera"),fn=Ze(Xe,"Trident")||Ze(Xe,"MSIE"),pn=Ze(Xe,"Edge"),dn=pn||fn,yn=Ze(Xe,"Gecko")&&!(Ze(Xe.toLowerCase(),"webkit")&&!Ze(Xe,"Edge"))&&!(Ze(Xe,"Trident")||Ze(Xe,"MSIE"))&&!Ze(Xe,"Edge"),gn=Ze(Xe.toLowerCase(),"webkit")&&!Ze(Xe,"Edge");function vn(){var t=Oe.document;return t?t.documentMode:void 0}t:{var mn="",bn=(hn=Xe,yn?/rv:([^\);]+)(\)|;)/.exec(hn):pn?/Edge\/([\d\.]+)/.exec(hn):fn?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(hn):gn?/WebKit\/(\S+)/.exec(hn):ln?/(?:Version)[ \/]?(\S+)/.exec(hn):void 0);if(bn&&(mn=bn?bn[1]:""),fn){var wn=vn();if(null!=wn&&wn>parseFloat(mn)){cn=String(wn);break t}}cn=mn}var En,In={};function Tn(){return function(t){var e=In;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}((function(){for(var t=0,e=Je(String(cn)).split("."),n=Je("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=tn(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||tn(0==o[2].length,0==s[2].length)||tn(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t}))}if(Oe.document&&fn){var _n=vn();En=_n||(parseInt(cn,10)||void 0)}else En=void 0;var Sn=En,An=function(){if(!Oe.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Oe.addEventListener("test",Le,e),Oe.removeEventListener("test",Le,e)}catch(t){}return t}();function Nn(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function Dn(t,e){if(Nn.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(yn){t:{try{un(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Cn[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Dn.Z.h.call(this)}}Nn.prototype.h=function(){this.defaultPrevented=!0},$e(Dn,Nn);var Cn={2:"touch",3:"pen",4:"mouse"};Dn.prototype.h=function(){Dn.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var kn="closure_listenable_"+(1e6*Math.random()|0),xn=0;function Rn(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++xn,this.ca=this.fa=!1}function On(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function Ln(t){this.src=t,this.g={},this.h=0}function Pn(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],o=Ge(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(On(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Mn(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ca&&o.listener==e&&o.capture==!!n&&o.ia==r)return i}return-1}Ln.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var s=Mn(t,e,r,i);return-1<s?(e=t[s],n||(e.fa=!1)):((e=new Rn(e,this.src,o,!!r,i)).fa=n,t.push(e)),e};var Fn="closure_lm_"+(1e6*Math.random()|0),Vn={};function Un(t,e,n,r,i){if(r&&r.once)return jn(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Un(t,e[o],n,r,i);return null}return n=Qn(n),t&&t[kn]?t.N(e,n,Me(r)?!!r.capture:!!r,i):qn(t,e,n,!1,r,i)}function qn(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=Me(i)?!!i.capture:!!i,a=Gn(t);if(a||(t[Fn]=a=new Ln(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){function t(n){return e.call(t.src,t.listener,n)}var e=zn;return t}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)An||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Kn(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function jn(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)jn(t,e[o],n,r,i);return null}return n=Qn(n),t&&t[kn]?t.O(e,n,Me(r)?!!r.capture:!!r,i):qn(t,e,n,!0,r,i)}function Bn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Bn(t,e[o],n,r,i);else r=Me(r)?!!r.capture:!!r,n=Qn(n),t&&t[kn]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=Mn(o=t.g[e],n,r,i))&&(On(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.g[e],t.h--)))):t&&(t=Gn(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Mn(e,n,r,i)),(n=-1<t?e[t]:null)&&$n(n))}function $n(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[kn])Pn(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Kn(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Gn(e))?(Pn(n,t),0==n.h&&(n.src=null,e[Fn]=null)):On(t)}}}function Kn(t){return t in Vn?Vn[t]:Vn[t]="on"+t}function zn(t,e){if(t.ca)t=!0;else{e=new Dn(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&$n(t),t=n.call(r,e)}return t}function Gn(t){return(t=t[Fn])instanceof Ln?t:null}var Hn="__closure_events_fn_"+(1e9*Math.random()>>>0);function Qn(t){return"function"==typeof t?t:(t[Hn]||(t[Hn]=function(e){return t.handleEvent(e)}),t[Hn])}function Wn(){Ke.call(this),this.i=new Ln(this),this.P=this,this.I=null}function Yn(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"==typeof e)e=new Nn(e,t);else if(e instanceof Nn)e.target=e.target||t;else{var i=e;an(e=new Nn(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.g=n[o];i=Xn(s,r,!0,e)&&i}if(i=Xn(s=e.g=t,r,!0,e)&&i,i=Xn(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Xn(s=e.g=n[o],r,!1,e)&&i}function Xn(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.ca&&s.capture==n){var a=s.listener,u=s.ia||s.src;s.fa&&Pn(t.i,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}$e(Wn,Ke),Wn.prototype[kn]=!0,Wn.prototype.removeEventListener=function(t,e,n,r){Bn(this,t,e,n,r)},Wn.prototype.M=function(){if(Wn.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)On(n[r]);delete e.g[t],e.h--}}this.I=null},Wn.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},Wn.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var Jn=Oe.JSON.stringify;function Zn(){var t=ar,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var tr,er=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=nr.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),nr=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t},t}())((function(){return new rr}),(function(t){return t.reset()})),rr=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function ir(t){Oe.setTimeout((function(){throw t}),0)}function or(t,e){tr||function(){var t=Oe.Promise.resolve(void 0);tr=function(){t.then(ur)}}(),sr||(tr(),sr=!0),ar.add(t,e)}var sr=!1,ar=new er;function ur(){for(var t;t=Zn();){try{t.h.call(t.g)}catch(t){ir(t)}var e=nr;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}sr=!1}function cr(t,e){Wn.call(this),this.h=t||1,this.g=e||Oe,this.j=je(this.kb,this),this.l=Date.now()}function hr(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function lr(t,e,n){if("function"==typeof t)n&&(t=je(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=je(t.handleEvent,t)}return 2147483647<Number(e)?-1:Oe.setTimeout(t,e||0)}function fr(t){t.g=lr((function(){t.g=null,t.i&&(t.i=!1,fr(t))}),t.j);var e=t.h;t.h=null,t.m.apply(null,e)}$e(cr,Wn),(ke=cr.prototype).da=!1,ke.S=null,ke.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Yn(this,"tick"),this.da&&(hr(this),this.start()))}},ke.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},ke.M=function(){cr.Z.M.call(this),hr(this),delete this.g};var pr=function(t){function e(e,n){var r=t.call(this)||this;return r.m=e,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}De(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:fr(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(Oe.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(Ke);function dr(t){Ke.call(this),this.h=t,this.g={}}$e(dr,Ke);var yr=[];function gr(t,e,n,r){Array.isArray(n)||(n&&(yr[0]=n.toString()),n=yr);for(var i=0;i<n.length;i++){var o=Un(e,n[i],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function vr(t){rn(t.g,(function(t,e){this.g.hasOwnProperty(e)&&$n(t)}),t),t.g={}}function mr(){this.g=!0}function br(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Jn(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}dr.prototype.M=function(){dr.Z.M.call(this),vr(this)},dr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},mr.prototype.Aa=function(){this.g=!1},mr.prototype.info=function(){};var wr={},Er=null;function Ir(){return Er=Er||new Wn}function Tr(t){Nn.call(this,wr.Ma,t)}function _r(t){var e=Ir();Yn(e,new Tr(e,t))}function Sr(t,e){Nn.call(this,wr.STAT_EVENT,t),this.stat=e}function Ar(t){var e=Ir();Yn(e,new Sr(e,t))}function Nr(t,e){Nn.call(this,wr.Na,t),this.size=e}function Dr(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Oe.setTimeout((function(){t()}),e)}wr.Ma="serverreachability",$e(Tr,Nn),wr.STAT_EVENT="statevent",$e(Sr,Nn),wr.Na="timingevent",$e(Nr,Nn);var Cr={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},kr={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function xr(){}function Rr(t){return t.h||(t.h=t.i())}function Or(){}xr.prototype.h=null;var Lr,Pr={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Mr(){Nn.call(this,"d")}function Fr(){Nn.call(this,"c")}function Vr(){}function Ur(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new dr(this),this.P=jr,t=dn?125:void 0,this.W=new cr(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new qr}function qr(){this.i=null,this.g="",this.h=!1}$e(Mr,Nn),$e(Fr,Nn),$e(Vr,xr),Vr.prototype.g=function(){return new XMLHttpRequest},Vr.prototype.i=function(){return{}},Lr=new Vr;var jr=45e3,Br={},$r={};function Kr(t,e,n){t.K=1,t.v=pi(ai(e)),t.s=n,t.U=!0,zr(t,null)}function zr(t,e){t.F=Date.now(),Wr(t),t.A=ai(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),Ai(n.h,"t",r),t.C=0,n=t.l.H,t.h=new qr,t.g=Do(t.l,n?e:null,!t.s),0<t.O&&(t.L=new pr(je(t.Ia,t,t.g),t.O)),gr(t.V,t.g,"readystatechange",t.gb),e=t.H?on(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),_r(1),function(t,e,n,r,i,o){t.info((function(){if(t.g)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&"type"==l[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function Gr(t){return!!t.g&&("GET"==t.u&&2!=t.K&&t.l.Ba)}function Hr(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;){if((r=Qr(t,n))==$r){4==e&&(t.o=4,Ar(14),i=!1),br(t.j,t.m,null,"[Incomplete Response]");break}if(r==Br){t.o=4,Ar(15),br(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}br(t.j,t.m,r,null),ti(t,r)}Gr(t)&&r!=$r&&r!=Br&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,Ar(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),wo(e),e.L=!0,Ar(11))):(br(t.j,t.m,n,"[Invalid Chunked Response]"),Zr(t),Jr(t))}function Qr(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?$r:(n=Number(e.substring(n,r)),isNaN(n)?Br:(r+=1)+n>e.length?$r:(e=e.substr(r,n),t.C=r+n,e))}function Wr(t){t.Y=Date.now()+t.P,Yr(t,t.P)}function Yr(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Dr(je(t.eb,t),e)}function Xr(t){t.B&&(Oe.clearTimeout(t.B),t.B=null)}function Jr(t){0==t.l.G||t.I||To(t.l,t)}function Zr(t){Xr(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,hr(t.W),vr(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function ti(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||Oi(n.i,t)))if(n.I=t.N,!t.J&&Oi(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(o){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;Io(n),ho(n)}bo(n),Ar(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=Dr(je(n.ab,n),6e3));if(1>=Ri(n.i)&&n.ka){try{n.ka()}catch(o){}n.ka=void 0}}else So(n,11)}else if((t.J||n.g==t)&&Io(n),!Ye(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var o=i[e];if(n.U=o[0],o=o[1],2==n.G)if("c"==o[0]){n.J=o[1],n.la=o[2];var s=o[3];null!=s&&(n.ma=s,n.h.info("VER="+n.ma));var a=o[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var u=o[5];null!=u&&"number"==typeof u&&0<u&&(r=1.5*u,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=t.g;if(c){var h=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=r.i;!l.g&&(Ze(h,"spdy")||Ze(h,"quic")||Ze(h,"h2"))&&(l.j=l.l,l.g=new Set,l.h&&(Li(l,l.h),l.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,fi(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var p=t;if((r=n).oa=No(r,r.H?r.la:null,r.W),p.J){Pi(r.i,p);var d=p,y=r.K;y&&d.setTimeout(y),d.B&&(Xr(d),Wr(d)),r.g=p}else mo(r);0<n.l.length&&po(n)}else"stop"!=o[0]&&"close"!=o[0]||So(n,7);else 3==n.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?So(n,7):co(n):"noop"!=o[0]&&n.j&&n.j.wa(o),n.A=0)}_r(4)}catch(o){}}function ei(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Pe(t)||"string"==typeof t)He(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(Pe(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;r=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(Pe(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),i=r.length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ni(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ni)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ri(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];ii(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)ii(i,r=t.g[e])||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}function ii(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(ke=Ur.prototype).setTimeout=function(t){this.P=t},ke.gb=function(t){t=t.target;var e=this.L;e&&3==io(t)?e.l():this.Ia(t)},ke.Ia=function(t){try{if(t==this.g)t:{var e=io(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||dn||this.g&&(this.h.h||this.g.ga()||oo(this.g)))){this.I||4!=e||7==n||_r(8==n||0>=r?3:2),Xr(this);var i=this.g.ba();this.N=i;e:if(Gr(this)){var o=oo(this.g);t="";var s=o.length,a=4==io(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Zr(this),Jr(this);var u="";break e}this.h.i=new Oe.TextDecoder}for(n=0;n<s;n++)this.h.h=!0,t+=this.h.i.decode(o[n],{stream:a&&n==s-1});o.splice(0,s),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,h=this.g;if((c=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ye(c)){var l=c;break e}}l=null}if(!(i=l)){this.i=!1,this.o=3,Ar(12),Zr(this),Jr(this);break t}br(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,ti(this,i)}this.U?(Hr(this,e,u),dn&&this.i&&3==e&&(gr(this.V,this.W,"tick",this.fb),this.W.start())):(br(this.j,this.m,u,null),ti(this,u)),4==e&&Zr(this),this.i&&!this.I&&(4==e?To(this.l,this):(this.i=!1,Wr(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,Ar(12)):(this.o=0,Ar(13)),Zr(this),Jr(this)}}}catch(e){}},ke.fb=function(){if(this.g){var t=io(this.g),e=this.g.ga();this.C<e.length&&(Xr(this),Hr(this,t,e),this.i&&4!=t&&Wr(this))}},ke.cancel=function(){this.I=!0,Zr(this)},ke.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(_r(3),Ar(17)),Zr(this),this.o=2,Jr(this)):Yr(this,this.Y-t)},(ke=ni.prototype).R=function(){ri(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},ke.T=function(){return ri(this),this.g.concat()},ke.get=function(t,e){return ii(this.h,t)?this.h[t]:e},ke.set=function(t,e){ii(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},ke.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var oi=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function si(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof si){this.g=void 0!==e?e:t.g,ui(this,t.j),this.s=t.s,ci(this,t.i),hi(this,t.m),this.l=t.l,e=t.h;var n=new Ii;n.i=e.i,e.g&&(n.g=new ni(e.g),n.h=e.h),li(this,n),this.o=t.o}else t&&(n=String(t).match(oi))?(this.g=!!e,ui(this,n[1]||"",!0),this.s=di(n[2]||""),ci(this,n[3]||"",!0),hi(this,n[4]),this.l=di(n[5]||"",!0),li(this,n[6]||"",!0),this.o=di(n[7]||"")):(this.g=!!e,this.h=new Ii(null,this.g))}function ai(t){return new si(t)}function ui(t,e,n){t.j=n?di(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function ci(t,e,n){t.i=n?di(e,!0):e}function hi(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function li(t,e,n){e instanceof Ii?(t.h=e,function(t,e){e&&!t.j&&(Ti(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(_i(this,e),Ai(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=yi(e,wi)),t.h=new Ii(e,t.g))}function fi(t,e,n){t.h.set(e,n)}function pi(t){return fi(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function di(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function yi(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,gi),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function gi(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}si.prototype.toString=function(){var t=[],e=this.j;e&&t.push(yi(e,vi,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(yi(e,vi,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(yi(n,"/"==n.charAt(0)?bi:mi,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",yi(n,Ei)),t.join("")};var vi=/[#\/\?@]/g,mi=/[#\?:]/g,bi=/[#\?]/g,wi=/[#\?@]/g,Ei=/#/g;function Ii(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ti(t){t.g||(t.g=new ni,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function _i(t,e){Ti(t),e=Ni(t,e),ii(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,ii((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&ri(t)))}function Si(t,e){return Ti(t),e=Ni(t,e),ii(t.g.h,e)}function Ai(t,e,n){_i(t,e),0<n.length&&(t.i=null,t.g.set(Ni(t,e),We(n)),t.h+=n.length)}function Ni(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(ke=Ii.prototype).add=function(t,e){Ti(this),this.i=null,t=Ni(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},ke.forEach=function(t,e){Ti(this),this.g.forEach((function(n,r){He(n,(function(n){t.call(e,n,r,this)}),this)}),this)},ke.T=function(){Ti(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},ke.R=function(t){Ti(this);var e=[];if("string"==typeof t)Si(this,t)&&(e=Qe(e,this.g.get(Ni(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=Qe(e,t[n])}return e},ke.set=function(t,e){return Ti(this),this.i=null,Si(this,t=Ni(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},ke.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},ke.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.i=t.join("&")};var Di=function(t,e){this.h=t,this.g=e};function Ci(t){this.l=t||ki,Oe.PerformanceNavigationTiming?t=0<(t=Oe.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(Oe.g&&Oe.g.Ea&&Oe.g.Ea()&&Oe.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var ki=10;function xi(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Ri(t){return t.h?1:t.g?t.g.size:0}function Oi(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Li(t,e){t.g?t.g.add(e):t.h=e}function Pi(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Mi(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var r=t.i;try{for(var i=Ce(t.g.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.D)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return We(t.i)}function Fi(){}function Vi(){this.g=new Fi}function Ui(t,e,n){var r=n||"";try{ei(t,(function(t,n){var i=t;Me(t)&&(i=Jn(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function qi(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function ji(t){this.l=t.$b||null,this.j=t.ib||!1}function Bi(t,e){Wn.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=$i,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ci.prototype.cancel=function(){var t,e;if(this.i=Mi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=Ce(this.g.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},Fi.prototype.stringify=function(t){return Oe.JSON.stringify(t,void 0)},Fi.prototype.parse=function(t){return Oe.JSON.parse(t,void 0)},$e(ji,xr),ji.prototype.g=function(){return new Bi(this.l,this.j)},ji.prototype.i=function(t){return function(){return t}}({}),$e(Bi,Wn);var $i=0;function Ki(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function zi(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Gi(t)}function Gi(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(ke=Bi.prototype).open=function(t,e){if(this.readyState!=$i)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Gi(this)},ke.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||Oe).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},ke.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,zi(this)),this.readyState=$i},ke.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Gi(this)),this.g&&(this.readyState=3,Gi(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==Oe.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Ki(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},ke.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?zi(this):Gi(this),3==this.readyState&&Ki(this)}},ke.Ua=function(t){this.g&&(this.response=this.responseText=t,zi(this))},ke.Ta=function(t){this.g&&(this.response=t,zi(this))},ke.ha=function(){this.g&&zi(this)},ke.setRequestHeader=function(t,e){this.v.append(t,e)},ke.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},ke.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Bi.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Hi=Oe.JSON.parse;function Qi(t){Wn.call(this),this.headers=new ni,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Wi,this.K=this.L=!1}$e(Qi,Wn);var Wi="",Yi=/^https?$/i,Xi=["POST","PUT"];function Ji(t){return"content-type"==t.toLowerCase()}function Zi(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,to(t),no(t)}function to(t){t.D||(t.D=!0,Yn(t,"complete"),Yn(t,"error"))}function eo(t){if(t.h&&void 0!==Re&&(!t.C[1]||4!=io(t)||2!=t.ba()))if(t.v&&4==io(t))lr(t.Fa,0,t);else if(Yn(t,"readystatechange"),4==io(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.H).match(oi)[1]||null;if(!o&&Oe.self&&Oe.self.location){var s=Oe.self.location.protocol;o=s.substr(0,s.length-1)}i=!Yi.test(o?o.toLowerCase():"")}e=i}if(e)Yn(t,"complete"),Yn(t,"success");else{t.m=6;try{var a=2<io(t)?t.g.statusText:""}catch(t){a=""}t.j=a+" ["+t.ba()+"]",to(t)}}finally{no(t)}}}function no(t,e){if(t.g){ro(t);var n=t.g,r=t.C[0]?Le:null;t.g=null,t.C=null,e||Yn(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function ro(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(Oe.clearTimeout(t.A),t.A=null)}function io(t){return t.g?t.g.readyState:0}function oo(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Wi:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function so(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return rn(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):fi(t,e,n))}function ao(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function uo(t){this.za=0,this.l=[],this.h=new mr,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=ao("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=ao("baseRetryDelayMs",5e3,t),this.$a=ao("retryDelaySeedMs",1e4,t),this.Ya=ao("forwardChannelMaxRetries",2,t),this.ra=ao("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new Ci(t&&t.concurrentRequestLimit),this.Ca=new Vi,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function co(t){if(lo(t),3==t.G){var e=t.V++,n=ai(t.F);fi(n,"SID",t.J),fi(n,"RID",e),fi(n,"TYPE","terminate"),go(t,n),(e=new Ur(t,t.h,e,void 0)).K=2,e.v=pi(ai(n)),n=!1,Oe.navigator&&Oe.navigator.sendBeacon&&(n=Oe.navigator.sendBeacon(e.v.toString(),"")),!n&&Oe.Image&&((new Image).src=e.v,n=!0),n||(e.g=Do(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Wr(e)}Ao(t)}function ho(t){t.g&&(wo(t),t.g.cancel(),t.g=null)}function lo(t){ho(t),t.u&&(Oe.clearTimeout(t.u),t.u=null),Io(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Oe.clearTimeout(t.m),t.m=null)}function fo(t,e){t.l.push(new Di(t.Za++,e)),3==t.G&&po(t)}function po(t){xi(t.i)||t.m||(t.m=!0,or(t.Ha,t),t.C=0)}function yo(t,e){var n;n=e?e.m:t.V++;var r=ai(t.F);fi(r,"SID",t.J),fi(r,"RID",n),fi(r,"AID",t.U),go(t,r),t.o&&t.s&&so(r,t.o,t.s),n=new Ur(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=vo(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),Li(t.i,n),Kr(n,r,e)}function go(t,e){t.j&&ei({},(function(t,n){fi(e,n,t)}))}function vo(t,e,n){n=Math.min(t.l.length,n);var r=t.j?je(t.j.Oa,t.j,t):null;t:for(var i=t.l,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].h,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].h,h=i[u].g;if(0>(c-=o))o=Math.max(0,i[u].h-100),a=!1;else try{Ui(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function mo(t){t.g||t.u||(t.Y=1,or(t.Ga,t),t.A=0)}function bo(t){return!(t.g||t.u||3<=t.A)&&(t.Y++,t.u=Dr(je(t.Ga,t),_o(t,t.A)),t.A++,!0)}function wo(t){null!=t.B&&(Oe.clearTimeout(t.B),t.B=null)}function Eo(t){t.g=new Ur(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=ai(t.oa);fi(e,"RID","rpc"),fi(e,"SID",t.J),fi(e,"CI",t.N?"0":"1"),fi(e,"AID",t.U),go(t,e),fi(e,"TYPE","xmlhttp"),t.o&&t.s&&so(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=pi(ai(e)),n.s=null,n.U=!0,zr(n,t)}function Io(t){null!=t.v&&(Oe.clearTimeout(t.v),t.v=null)}function To(t,e){var n=null;if(t.g==e){Io(t),wo(t),t.g=null;var r=2}else{if(!Oi(t.i,e))return;n=e.D,Pi(t.i,e),r=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;Yn(r=Ir(),new Nr(r,n,e,i)),po(t)}else mo(t);else if(3==(i=e.o)||0==i&&0<t.I||!(1==r&&function(t,e){return!(Ri(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=Dr(je(t.Ha,t,e),_o(t,t.C)),t.C++,0)))}(t,e)||2==r&&bo(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:So(t,5);break;case 4:So(t,10);break;case 3:So(t,6);break;default:So(t,2)}}function _o(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function So(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var r=je(t.jb,t);n||(n=new si("//www.google.com/images/cleardot.gif"),Oe.location&&"http"==Oe.location.protocol||ui(n,"https"),pi(n)),function(t,e){var n=new mr;if(Oe.Image){var r=new Image;r.onload=Be(qi,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Be(qi,n,r,"TestLoadImage: error",!1,e),r.onabort=Be(qi,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Be(qi,n,r,"TestLoadImage: timeout",!1,e),Oe.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Ar(2);t.G=0,t.j&&t.j.va(e),Ao(t),lo(t)}function Ao(t){t.G=0,t.I=-1,t.j&&(0==Mi(t.i).length&&0==t.l.length||(t.i.i.length=0,We(t.l),t.l.length=0),t.j.ua())}function No(t,e,n){var r=function(t){return t instanceof si?ai(t):new si(t,void 0)}(n);if(""!=r.i)e&&ci(r,e+"."+r.i),hi(r,r.m);else{var i=Oe.location;r=function(t,e,n,r){var i=new si(null,void 0);return t&&ui(i,t),e&&ci(i,e),n&&hi(i,n),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&rn(t.aa,(function(t,e){fi(r,e,t)})),e=t.D,n=t.sa,e&&n&&fi(r,e,n),fi(r,"VER",t.ma),go(t,r),r}function Do(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new Qi(new ji({ib:!0})):new Qi(t.qa)).L=t.H,e}function Co(){}function ko(){if(fn&&!(10<=Number(Sn)))throw Error("Environmental error: no available transport.")}function xo(t,e){Wn.call(this),this.g=new uo(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!Ye(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Ye(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new Lo(this)}function Ro(t){Mr.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Oo(){Fr.call(this),this.status=1}function Lo(t){this.g=t}(ke=Qi.prototype).ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Lr.g(),this.C=this.u?Rr(this.u):Rr(Lr),this.g.onreadystatechange=je(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void Zi(this,t)}t=n||"";var i=new ni(this.headers);r&&ei(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=Ji,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.T()),n=Oe.FormData&&t instanceof Oe.FormData,!(0<=Ge(Xi,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{ro(this),0<this.B&&((this.K=function(t){return fn&&Tn()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=je(this.pa,this)):this.A=lr(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Zi(this,t)}},ke.pa=function(){void 0!==Re&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Yn(this,"timeout"),this.abort(8))},ke.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Yn(this,"complete"),Yn(this,"abort"),no(this))},ke.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),no(this,!0)),Qi.Z.M.call(this)},ke.Fa=function(){this.s||(this.F||this.v||this.l?eo(this):this.cb())},ke.cb=function(){eo(this)},ke.ba=function(){try{return 2<io(this)?this.g.status:-1}catch(t){return-1}},ke.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},ke.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Hi(e)}},ke.Da=function(){return this.m},ke.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(ke=uo.prototype).ma=8,ke.G=1,ke.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(t){}},ke.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new Ur(this,this.h,t,void 0),n=this.s;if(this.P&&(n?an(n=on(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var o=this.l[i];if(void 0===(o="__data__"in o.g&&"string"==typeof(o=o.g.__data__)?o.length:void 0))break;if(4096<(r+=o)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=vo(this,e,r),fi(i=ai(this.F),"RID",t),fi(i,"CVER",22),this.D&&fi(i,"X-HTTP-Session-Id",this.D),go(this,i),this.o&&n&&so(i,this.o,n),Li(this.i,e),this.Ra&&fi(i,"TYPE","init"),this.ja?(fi(i,"$req",r),fi(i,"SID","null"),e.$=!0,Kr(e,i,null)):Kr(e,i,r),this.G=2}}else 3==this.G&&(t?yo(this,t):0==this.l.length||xi(this.i)||yo(this))},ke.Ga=function(){if(this.u=null,Eo(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Dr(je(this.bb,this),t)}},ke.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Ar(10),ho(this),Eo(this))},ke.ab=function(){null!=this.v&&(this.v=null,ho(this),bo(this),Ar(19))},ke.jb=function(t){t?(this.h.info("Successfully pinged google.com"),Ar(2)):(this.h.info("Failed to ping google.com"),Ar(1))},(ke=Co.prototype).xa=function(){},ke.wa=function(){},ke.va=function(){},ke.ua=function(){},ke.Oa=function(){},ko.prototype.g=function(t,e){return new xo(t,e)},$e(xo,Wn),xo.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),or(je(t.hb,t,e))),Ar(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=No(t,null,t.W),po(t)},xo.prototype.close=function(){co(this.g)},xo.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,fo(this.g,e)}else this.v?((e={}).__data__=Jn(t),fo(this.g,e)):fo(this.g,t)},xo.prototype.M=function(){this.g.j=null,delete this.j,co(this.g),delete this.g,xo.Z.M.call(this)},$e(Ro,Mr),$e(Oo,Fr),$e(Lo,Co),Lo.prototype.xa=function(){Yn(this.g,"a")},Lo.prototype.wa=function(t){Yn(this.g,new Ro(t))},Lo.prototype.va=function(t){Yn(this.g,new Oo(t))},Lo.prototype.ua=function(){Yn(this.g,"b")},ko.prototype.createWebChannel=ko.prototype.g,xo.prototype.send=xo.prototype.u,xo.prototype.open=xo.prototype.m,xo.prototype.close=xo.prototype.close,Cr.NO_ERROR=0,Cr.TIMEOUT=8,Cr.HTTP_ERROR=6,kr.COMPLETE="complete",Or.EventType=Pr,Pr.OPEN="a",Pr.CLOSE="b",Pr.ERROR="c",Pr.MESSAGE="d",Wn.prototype.listen=Wn.prototype.N,Qi.prototype.listenOnce=Qi.prototype.O,Qi.prototype.getLastError=Qi.prototype.La,Qi.prototype.getLastErrorCode=Qi.prototype.Da,Qi.prototype.getStatus=Qi.prototype.ba,Qi.prototype.getResponseJson=Qi.prototype.Qa,Qi.prototype.getResponseText=Qi.prototype.ga,Qi.prototype.send=Qi.prototype.ea;var Po=Cr,Mo=kr,Fo=wr,Vo=10,Uo=11,qo=ji,jo=Or,Bo=Qi,$o=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();$o.o=-1;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Ko={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},zo=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Ct(e,t),e}(Error),Go=new le("@firebase/firestore");function Ho(){return Go.logLevel}function Qo(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Go.logLevel<=ie.DEBUG){var r=e.map(Xo);Go.debug.apply(Go,Pt(["Firestore (8.10.0): "+t],r))}}function Wo(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Go.logLevel<=ie.ERROR){var r=e.map(Xo);Go.error.apply(Go,Pt(["Firestore (8.10.0): "+t],r))}}function Yo(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Go.logLevel<=ie.WARN){var r=e.map(Xo);Go.warn.apply(Go,Pt(["Firestore (8.10.0): "+t],r))}}function Xo(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Jo(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.10.0) INTERNAL ASSERTION FAILED: "+t;throw Wo(e),new Error(e)}function Zo(t,e){t||Jo()}function ts(t,e){return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function es(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ns=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=es(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function rs(t,e){return t<e?-1:t>e?1:0}function is(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function os(t){return t+"\0"}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ss=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new zo(Ko.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new zo(Ko.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new zo(Ko.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new zo(Ko.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?rs(this.nanoseconds,t.nanoseconds):rs(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),as=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new ss(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function us(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function cs(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function hs(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ls=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Jo(),void 0===n?n=t.length-e:n>t.length-e&&Jo(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),fs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ct(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new zo(Ko.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.emptyPath=function(){return new e([])},e}(ls),ps=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ds=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ct(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return ps.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new zo(Ko.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new zo(Ko.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new zo(Ko.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new zo(Ko.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(ls),ys=function(){function t(t){this.fields=t,t.sort(ds.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return is(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),gs=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return rs(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();gs.EMPTY_BYTE_STRING=new gs("");var vs=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ms(t){if(Zo(!!t),"string"==typeof t){var e=0,n=vs.exec(t);if(Zo(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:bs(t.seconds),nanos:bs(t.nanos)}}function bs(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function ws(t){return"string"==typeof t?gs.fromBase64String(t):gs.fromUint8Array(t)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Es(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Is(t){var e=t.mapValue.fields.__previous_value__;return Es(e)?Is(e):e}function Ts(t){var e=ms(t.mapValue.fields.__local_write_time__.timestampValue);return new ss(e.seconds,e.nanos)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function _s(t){return null==t}function Ss(t){return 0===t&&1/t==-1/0}function As(t){return"number"==typeof t&&Number.isInteger(t)&&!Ss(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ns=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(fs.fromString(e))},t.fromName=function(e){return new t(fs.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===fs.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return fs.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new fs(e.slice()))},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ds(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Es(t)?4:10:Jo()}function Cs(t,e){var n=Ds(t);if(n!==Ds(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ts(t).isEqual(Ts(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=ms(t.timestampValue),r=ms(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return ws(t.bytesValue).isEqual(ws(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return bs(t.geoPointValue.latitude)===bs(e.geoPointValue.latitude)&&bs(t.geoPointValue.longitude)===bs(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return bs(t.integerValue)===bs(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=bs(t.doubleValue),r=bs(e.doubleValue);return n===r?Ss(n)===Ss(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return is(t.arrayValue.values||[],e.arrayValue.values||[],Cs);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(us(n)!==us(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Cs(n[i],r[i])))return!1;return!0}(t,e);default:return Jo()}}function ks(t,e){return void 0!==(t.values||[]).find((function(t){return Cs(t,e)}))}function xs(t,e){var n=Ds(t),r=Ds(e);if(n!==r)return rs(n,r);switch(n){case 0:return 0;case 1:return rs(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=bs(t.integerValue||t.doubleValue),r=bs(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Rs(t.timestampValue,e.timestampValue);case 4:return Rs(Ts(t),Ts(e));case 5:return rs(t.stringValue,e.stringValue);case 6:return function(t,e){var n=ws(t),r=ws(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=rs(n[i],r[i]);if(0!==o)return o}return rs(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=rs(bs(t.latitude),bs(e.latitude));return 0!==n?n:rs(bs(t.longitude),bs(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=xs(n[i],r[i]);if(o)return o}return rs(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=rs(r[s],o[s]);if(0!==a)return a;var u=xs(n[r[s]],i[o[s]]);if(0!==u)return u}return rs(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Jo()}}function Rs(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return rs(t,e);var n=ms(t),r=ms(e),i=rs(n.seconds,r.seconds);return 0!==i?i:rs(n.nanos,r.nanos)}function Os(t){return Ls(t)}function Ls(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=ms(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?ws(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Ns.fromName(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Ls(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Ls(t.fields[o])}return e+"}"}(t.mapValue):Jo();var e,n}function Ps(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function Ms(t){return!!t&&"integerValue"in t}function Fs(t){return!!t&&"arrayValue"in t}function Vs(t){return!!t&&"nullValue"in t}function Us(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function qs(t){return!!t&&"mapValue"in t}function js(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){var e={mapValue:{fields:{}}};return cs(t.mapValue.fields,(function(t,n){return e.mapValue.fields[t]=js(n)})),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=js(t.arrayValue.values[r]);return n}return Object.assign({},t)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Bs=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!qs(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=js(e)},t.prototype.setAll=function(t){var e=this,n=ds.emptyPath(),r={},i=[];t.forEach((function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=js(t):i.push(o.lastSegment())}));var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());qs(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return Cs(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];qs(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){cs(e,(function(e,n){return t[e]=n}));for(var r=0,i=n;r<i.length;r++){var o=i[r];delete t[o]}},t.prototype.clone=function(){return new t(js(this.value))},t}();function $s(t){var e=[];return cs(t.fields,(function(t,n){var r=new ds([t]);if(qs(n)){var i=$s(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var a=s[o];e.push(r.child(a))}}else e.push(r)})),new ys(e)
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var Ks=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,as.min(),Bs.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,Bs.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,Bs.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=Bs.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=Bs.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),zs=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Gs(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new zs(t,e,n,r,i,o,s)}function Hs(t){var e=ts(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+Os(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),_s(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=sa(e.startAt)),e.endAt&&(n+="|ub:",n+=sa(e.endAt)),e.h=n}return e.h}function Qs(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!ua(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!Cs(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ha(t.startAt,e.startAt)&&ha(t.endAt,e.endAt)}function Ws(t){return Ns.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ys=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return Ct(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new Xs(t,n,r):"array-contains"===n?new ea(t,r):"in"===n?new na(t,r):"not-in"===n?new ra(t,r):"array-contains-any"===n?new ia(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new Js(t,n):new Zs(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(xs(e,this.value)):null!==e&&Ds(this.value)===Ds(e)&&this.m(xs(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Jo()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),Xs=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Ns.fromName(r.referenceValue),i}return Ct(e,t),e.prototype.matches=function(t){var e=Ns.comparator(t.key,this.key);return this.m(e)},e}(Ys),Js=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=ta("in",n),r}return Ct(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Ys),Zs=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=ta("not-in",n),r}return Ct(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Ys);function ta(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return Ns.fromName(t.referenceValue)}))}var ea=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return Ct(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return Fs(e)&&ks(e.arrayValue,this.value)},e}(Ys),na=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return Ct(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&ks(this.value.arrayValue,e)},e}(Ys),ra=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return Ct(e,t),e.prototype.matches=function(t){if(ks(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!ks(this.value.arrayValue,e)},e}(Ys),ia=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return Ct(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!Fs(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return ks(e.value.arrayValue,t)}))},e}(Ys),oa=function(t,e){this.position=t,this.before=e};function sa(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return Os(t)})).join(",")}var aa=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function ua(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function ca(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?Ns.comparator(Ns.fromName(s.referenceValue),n.key):xs(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ha(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Cs(t.position[n],e.position[n]))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var la=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt};function fa(t,e,n,r,i,o,s,a){return new la(t,e,n,r,i,o,s,a)}function pa(t){return new la(t)}function da(t){return!_s(t.limit)&&"F"===t.limitType}function ya(t){return!_s(t.limit)&&"L"===t.limitType}function ga(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function va(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function ma(t){return null!==t.collectionGroup}function ba(t){var e=ts(t);if(null===e.p){e.p=[];var n=va(e),r=ga(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new aa(n)),e.p.push(new aa(ds.keyField(),"asc"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var a=s[o];e.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new aa(ds.keyField(),u))}}}return e.p}function wa(t){var e=ts(t);if(!e.T)if("F"===e.limitType)e.T=Gs(e.path,e.collectionGroup,ba(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=ba(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new aa(o.field,s))}var a=e.endAt?new oa(e.endAt.position,!e.endAt.before):null,u=e.startAt?new oa(e.startAt.position,!e.startAt.before):null;e.T=Gs(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.T}function Ea(t,e,n){return new la(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ia(t,e){return Qs(wa(t),wa(e))&&t.limitType===e.limitType}function Ta(t){return Hs(wa(t))+"|lt:"+t.limitType}function _a(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+Os(e.value);var e})).join(", ")+"]"),_s(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+sa(t.startAt)),t.endAt&&(e+=", endAt: "+sa(t.endAt)),"Target("+e+")"}(wa(t))+"; limitType="+t.limitType+")"}function Sa(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Ns.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!ca(t.startAt,ba(t),e)||t.endAt&&ca(t.endAt,ba(t),e))}(t,e)}function Aa(t){return function(e,n){for(var r=!1,i=0,o=ba(t);i<o.length;i++){var s=o[i],a=Na(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function Na(t,e,n){var r=t.field.isKeyField()?Ns.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?xs(r,i):Jo()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Jo()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Da(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ss(e)?"-0":e}}function Ca(t){return{integerValue:""+t}}function ka(t,e){return As(e)?Ca(e):Da(t,e)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var xa=function(){this._=void 0};function Ra(t,e,n){return t instanceof Pa?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Ma?Fa(t,e):t instanceof Va?Ua(t,e):function(t,e){var n=La(t,e),r=ja(n)+ja(t.A);return Ms(n)&&Ms(t.A)?Ca(r):Da(t.R,r)}(t,e)}function Oa(t,e,n){return t instanceof Ma?Fa(t,e):t instanceof Va?Ua(t,e):n}function La(t,e){return t instanceof qa?Ms(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Pa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ct(e,t),e}(xa),Ma=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Ct(e,t),e}(xa);function Fa(t,e){for(var n=Ba(e),r=function(t){n.some((function(e){return Cs(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Va=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return Ct(e,t),e}(xa);function Ua(t,e){for(var n=Ba(e),r=function(t){n=n.filter((function(e){return!Cs(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var qa=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return Ct(e,t),e}(xa);function ja(t){return bs(t.integerValue||t.doubleValue)}function Ba(t){return Fs(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var $a=function(t,e){this.field=t,this.transform=e},Ka=function(t,e){this.version=t,this.transformResults=e},za=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Ga(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var Ha=function(){};function Qa(t,e,n){t instanceof Za?function(t,e,n){var r=t.value.clone(),i=nu(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof tu?function(t,e,n){if(Ga(t.precondition,e)){var r=nu(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(eu(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Wa(t,e,n){t instanceof Za?function(t,e,n){if(Ga(t.precondition,e)){var r=t.value.clone(),i=ru(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(Ja(e),r).setHasLocalMutations()}}(t,e,n):t instanceof tu?function(t,e,n){if(Ga(t.precondition,e)){var r=ru(t.fieldTransforms,n,e),i=e.data;i.setAll(eu(t)),i.setAll(r),e.convertToFoundDocument(Ja(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){Ga(t.precondition,e)&&e.convertToNoDocument(as.min())}(t,e)}function Ya(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=La(o.transform,s||null);null!=a&&(null==n&&(n=Bs.empty()),n.set(o.field,a))}return n||null}function Xa(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&is(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Ma&&e instanceof Ma||t instanceof Va&&e instanceof Va?is(t.elements,e.elements,Cs):t instanceof qa&&e instanceof qa?Cs(t.A,e.A):t instanceof Pa&&e instanceof Pa}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Ja(t){return t.isFoundDocument()?t.version:as.min()}var Za=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return Ct(e,t),e}(Ha),tu=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return Ct(e,t),e}(Ha);function eu(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function nu(t,e,n){var r=new Map;Zo(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,Oa(s,a,n[i]))}return r}function ru(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=n.data.field(s.field);r.set(s.field,Ra(a,u,e))}return r}var iu,ou,su=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return Ct(e,t),e}(Ha),au=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return Ct(e,t),e}(Ha),uu=function(t){this.count=t};function cu(t){switch(t){default:return Jo();case Ko.CANCELLED:case Ko.UNKNOWN:case Ko.DEADLINE_EXCEEDED:case Ko.RESOURCE_EXHAUSTED:case Ko.INTERNAL:case Ko.UNAVAILABLE:case Ko.UNAUTHENTICATED:return!1;case Ko.INVALID_ARGUMENT:case Ko.NOT_FOUND:case Ko.ALREADY_EXISTS:case Ko.PERMISSION_DENIED:case Ko.FAILED_PRECONDITION:case Ko.ABORTED:case Ko.OUT_OF_RANGE:case Ko.UNIMPLEMENTED:case Ko.DATA_LOSS:return!0}}function hu(t){if(void 0===t)return Wo("GRPC error has no .code"),Ko.UNKNOWN;switch(t){case iu.OK:return Ko.OK;case iu.CANCELLED:return Ko.CANCELLED;case iu.UNKNOWN:return Ko.UNKNOWN;case iu.DEADLINE_EXCEEDED:return Ko.DEADLINE_EXCEEDED;case iu.RESOURCE_EXHAUSTED:return Ko.RESOURCE_EXHAUSTED;case iu.INTERNAL:return Ko.INTERNAL;case iu.UNAVAILABLE:return Ko.UNAVAILABLE;case iu.UNAUTHENTICATED:return Ko.UNAUTHENTICATED;case iu.INVALID_ARGUMENT:return Ko.INVALID_ARGUMENT;case iu.NOT_FOUND:return Ko.NOT_FOUND;case iu.ALREADY_EXISTS:return Ko.ALREADY_EXISTS;case iu.PERMISSION_DENIED:return Ko.PERMISSION_DENIED;case iu.FAILED_PRECONDITION:return Ko.FAILED_PRECONDITION;case iu.ABORTED:return Ko.ABORTED;case iu.OUT_OF_RANGE:return Ko.OUT_OF_RANGE;case iu.UNIMPLEMENTED:return Ko.UNIMPLEMENTED;case iu.DATA_LOSS:return Ko.DATA_LOSS;default:return Jo()}}(ou=iu||(iu={}))[ou.OK=0]="OK",ou[ou.CANCELLED=1]="CANCELLED",ou[ou.UNKNOWN=2]="UNKNOWN",ou[ou.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ou[ou.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ou[ou.NOT_FOUND=5]="NOT_FOUND",ou[ou.ALREADY_EXISTS=6]="ALREADY_EXISTS",ou[ou.PERMISSION_DENIED=7]="PERMISSION_DENIED",ou[ou.UNAUTHENTICATED=16]="UNAUTHENTICATED",ou[ou.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ou[ou.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ou[ou.ABORTED=10]="ABORTED",ou[ou.OUT_OF_RANGE=11]="OUT_OF_RANGE",ou[ou.UNIMPLEMENTED=12]="UNIMPLEMENTED",ou[ou.INTERNAL=13]="INTERNAL",ou[ou.UNAVAILABLE=14]="UNAVAILABLE",ou[ou.DATA_LOSS=15]="DATA_LOSS";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var lu=function(){function t(t,e){this.comparator=t,this.root=e||pu.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,pu.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,pu.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new fu(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new fu(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new fu(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new fu(this.root,t,this.comparator,!0)},t}(),fu=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),pu=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Jo();if(this.right.isRed())throw Jo();var t=this.left.check();if(t!==this.right.check())throw Jo();return t+(this.isRed()?0:1)},t}();pu.EMPTY=null,pu.RED=!0,pu.BLACK=!1,pu.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Jo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Jo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Jo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Jo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Jo()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new pu(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var du=function(){function t(t){this.comparator=t,this.data=new lu(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new yu(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new yu(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),yu=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),gu=new lu(Ns.comparator);function vu(){return gu}var mu=new lu(Ns.comparator);function bu(){return mu}var wu=new lu(Ns.comparator);var Eu=new du(Ns.comparator);function Iu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Eu,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Tu=new du(rs);function _u(){return Tu}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Su=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,Au.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(as.min(),r,_u(),vu(),Iu())},t}(),Au=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(gs.EMPTY_BYTE_STRING,n,Iu(),Iu(),Iu())},t}(),Nu=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},Du=function(t,e){this.targetId=t,this.V=e},Cu=function(t,e,n,r){void 0===n&&(n=gs.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},ku=function(){function t(){this.S=0,this.D=Ou(),this.C=gs.EMPTY_BYTE_STRING,this.N=!1,this.k=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"F",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.k},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.k=!0,this.C=t)},t.prototype.M=function(){var t=Iu(),e=Iu(),n=Iu();return this.D.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Jo()}})),new Au(this.C,this.N,t,e,n)},t.prototype.L=function(){this.k=!1,this.D=Ou()},t.prototype.B=function(t,e){this.k=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.k=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.k=!0,this.N=!0},t}(),xu=function(){function t(t){this.W=t,this.G=new Map,this.H=vu(),this.J=Ru(),this.Y=new du(rs)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.F||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.F||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:Jo()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach((function(t,r){n.st(r)&&e(r)}))},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(Ws(i))if(0===n){var o=new Ns(i.path);this.tt(e,o,Ks.newNoDocument(o,as.min()))}else Zo(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach((function(r,i){var o=e.ot(i);if(o){if(r.current&&Ws(o.target)){var s=new Ns(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,Ks.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}}));var r=Iu();this.J.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Su(t,n,this.Y,this.H,r);return this.H=vu(),this.J=Ru(),this.Y=new du(rs),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new ku,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new du(rs),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||Qo("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.F?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new ku),this.W.getRemoteKeysForTarget(t).forEach((function(n){e.tt(t,n,null)}))},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function Ru(){return new lu(Ns.comparator)}function Ou(){return new lu(Ns.comparator)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Lu={asc:"ASCENDING",desc:"DESCENDING"},Pu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Mu=function(t,e){this.databaseId=t,this.I=e};function Fu(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Vu(t,e){return t.I?e.toBase64():e.toUint8Array()}function Uu(t,e){return Fu(t,e.toTimestamp())}function qu(t){return Zo(!!t),as.fromTimestamp(function(t){var e=ms(t);return new ss(e.seconds,e.nanos)}(t))}function ju(t,e){return function(t){return new fs(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Bu(t){var e=fs.fromString(t);return Zo(lc(e)),e}function $u(t,e){return ju(t.databaseId,e.path)}function Ku(t,e){var n=Bu(e);if(n.get(1)!==t.databaseId.projectId)throw new zo(Ko.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new zo(Ko.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ns(Qu(n))}function zu(t,e){return ju(t.databaseId,e)}function Gu(t){var e=Bu(t);return 4===e.length?fs.emptyPath():Qu(e)}function Hu(t){return new fs(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Qu(t){return Zo(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Wu(t,e,n){return{name:$u(t,e),fields:n.value.mapValue.fields}}function Yu(t,e){var n;if(e instanceof Za)n={update:Wu(t,e.key,e.value)};else if(e instanceof su)n={delete:$u(t,e.key)};else if(e instanceof tu)n={update:Wu(t,e.key,e.data),updateMask:hc(e.fieldMask)};else{if(!(e instanceof au))return Jo();n={verify:$u(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof Pa)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ma)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Va)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof qa)return{fieldPath:e.field.canonicalString(),increment:n.A};throw Jo()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Uu(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Jo()}(t,e.precondition)),n}function Xu(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?za.updateTime(qu(t.updateTime)):void 0!==t.exists?za.exists(t.exists):za.none()}(e.currentDocument):za.none(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)Zo("REQUEST_TIME"===e.setToServerValue),n=new Pa;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new Ma(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new Va(i)}else"increment"in e?n=new qa(t,e.increment):Jo();var o=ds.fromServerFormat(e.fieldPath);return new $a(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=Ku(t,e.update.name),o=new Bs({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){var e=t.fieldPaths||[];return new ys(e.map((function(t){return ds.fromServerFormat(t)})))}(e.updateMask);return new tu(i,o,s,n,r)}return new Za(i,o,n,r)}if(e.delete){var a=Ku(t,e.delete);return new su(a,n)}if(e.verify){var u=Ku(t,e.verify);return new au(u,n)}return Jo()}function Ju(t,e){return{documents:[zu(t,e.path)]}}function Zu(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=zu(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=zu(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(Us(t.value))return{unaryFilter:{field:sc(t.field),op:"IS_NAN"}};if(Vs(t.value))return{unaryFilter:{field:sc(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Us(t.value))return{unaryFilter:{field:sc(t.field),op:"IS_NOT_NAN"}};if(Vs(t.value))return{unaryFilter:{field:sc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:sc(t.field),op:oc(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:sc(t.field),direction:ic(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.I||_s(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=nc(e.startAt)),e.endAt&&(n.structuredQuery.endAt=nc(e.endAt)),n}function tc(t){var e=Gu(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Zo(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=ec(n.where));var a=[];n.orderBy&&(a=n.orderBy.map((function(t){return function(t){return new aa(ac(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return _s(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=rc(n.startAt));var h=null;return n.endAt&&(h=rc(n.endAt)),fa(e,i,a,s,u,"F",c,h)}function ec(t){return t?void 0!==t.unaryFilter?[cc(t)]:void 0!==t.fieldFilter?[uc(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return ec(t)})).reduce((function(t,e){return t.concat(e)})):Jo():[]}function nc(t){return{before:t.before,values:t.position}}function rc(t){var e=!!t.before,n=t.values||[];return new oa(n,e)}function ic(t){return Lu[t]}function oc(t){return Pu[t]}function sc(t){return{fieldPath:t.canonicalString()}}function ac(t){return ds.fromServerFormat(t.fieldPath)}function uc(t){return Ys.create(ac(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Jo()}}(t.fieldFilter.op),t.fieldFilter.value)}function cc(t){switch(t.unaryFilter.op){case"IS_NAN":var e=ac(t.unaryFilter.field);return Ys.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=ac(t.unaryFilter.field);return Ys.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=ac(t.unaryFilter.field);return Ys.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=ac(t.unaryFilter.field);return Ys.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Jo()}}function hc(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function lc(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function fc(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=dc(e)),e=pc(t.get(n),e);return dc(e)}function pc(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function dc(t){return t+""}function yc(t){var e=t.length;if(Zo(e>=2),2===e)return Zo(""===t.charAt(0)&&""===t.charAt(1)),fs.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&Jo(),t.charAt(s+1)){case"":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Jo()}o=s+2}return new fs(r)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var gc=function(t,e){this.seconds=t,this.nanoseconds=e},vc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};vc.store="owner",vc.key="owner";var mc=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};mc.store="mutationQueues",mc.keyPath="userId";var bc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};bc.store="mutations",bc.keyPath="batchId",bc.userMutationsIndex="userMutationsIndex",bc.userMutationsKeyPath=["userId","batchId"];var wc=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,fc(e)]},t.key=function(t,e,n){return[t,fc(e),n]},t}();wc.store="documentMutations",wc.PLACEHOLDER=new wc;var Ec=function(t,e){this.path=t,this.readTime=e},Ic=function(t,e){this.path=t,this.version=e},Tc=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Tc.store="remoteDocuments",Tc.readTimeIndex="readTimeIndex",Tc.readTimeIndexPath="readTime",Tc.collectionReadTimeIndex="collectionReadTimeIndex",Tc.collectionReadTimeIndexPath=["parentPath","readTime"];var _c=function(t){this.byteSize=t};_c.store="remoteDocumentGlobal",_c.key="remoteDocumentGlobalKey";var Sc=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Sc.store="targets",Sc.keyPath="targetId",Sc.queryTargetsIndexName="queryTargetsIndex",Sc.queryTargetsKeyPath=["canonicalId","targetId"];var Ac=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ac.store="targetDocuments",Ac.keyPath=["targetId","path"],Ac.documentTargetsIndex="documentTargetsIndex",Ac.documentTargetsKeyPath=["path","targetId"];var Nc=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Nc.key="targetGlobalKey",Nc.store="targetGlobal";var Dc=function(t,e){this.collectionId=t,this.parent=e};Dc.store="collectionParents",Dc.keyPath=["collectionId","parent"];var Cc=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Cc.store="clientMetadata",Cc.keyPath="clientId";var kc=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};kc.store="bundles",kc.keyPath="bundleId";var xc=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};xc.store="namedQueries",xc.keyPath="name";var Rc=Pt(Pt([],Pt(Pt([],Pt(Pt([],Pt(Pt([],[mc.store,bc.store,wc.store,Tc.store,Sc.store,vc.store,Nc.store,Ac.store]),[Cc.store])),[_c.store])),[Dc.store])),[kc.store,xc.store]),Oc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Lc=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),Pc=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},Mc=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&Jo(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),Fc=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new Pc,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new qc(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=zc(e.target.error);n.ft.reject(new qc(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new qc(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(Qo("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Bc(e)},t}(),Vc=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(jt())&&Wo("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Qo("SimpleDb","Removing database:",t),$c(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=jt(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return xt(this,void 0,void 0,(function(){var e,n=this;return Rt(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(Qo("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new qc(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new zo(Ko.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new qc(t,n))},i.onupgradeneeded=function(t){Qo("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.wt.Rt(e,i.transaction,t.oldVersion,n.version).next((function(){Qo("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}}))}))},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return xt(this,void 0,void 0,(function(){var i,o,s,a,u;return Rt(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,h;return Rt(this,(function(l){switch(l.label){case 0:++o,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,a.At(t)];case 2:return a.db=l.sent(),e=Fc.open(a.db,t,i?"readonly":"readwrite",n),s=r(e).catch((function(t){return e.abort(t),Mc.reject(t)})).toPromise(),u={},s.catch((function(){})),[4,e.dt];case 3:return[2,(u.value=(l.sent(),s),u)];case 4:return c=l.sent(),h="FirebaseError"!==c.name&&o<3,Qo("SimpleDb","Transaction failed with error:",c.message,"Retrying:",h),a.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Uc=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return $c(this.Pt.delete())},t}(),qc=function(t){function e(e,n){var r=this;return(r=t.call(this,Ko.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Ct(e,t),e}(zo);function jc(t){return"IndexedDbTransactionError"===t.name}var Bc=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Qo("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Qo("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),$c(n)},t.prototype.add=function(t){return Qo("SimpleDb","ADD",this.store.name,t,t),$c(this.store.add(t))},t.prototype.get=function(t){var e=this;return $c(this.store.get(t)).next((function(n){return void 0===n&&(n=null),Qo("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return Qo("SimpleDb","DELETE",this.store.name,t),$c(this.store.delete(t))},t.prototype.count=function(){return Qo("SimpleDb","COUNT",this.store.name),$c(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.kt=function(t,e){Qo("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Ft=!1;var r=this.cursor(n);return this.xt(r,(function(t,e,n){return n.delete()}))},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new Mc((function(n,r){e.onerror=function(t){var e=zc(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.xt=function(t,e){var n=[];return new Mc((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Uc(i),s=e(i.primaryKey,i.value,o);if(s instanceof Mc){var a=s.catch((function(t){return o.done(),Mc.reject(t)}));n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return Mc.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Ft?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function $c(t){return new Mc((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=zc(t.target.error);n(e)}}))}var Kc=!1;function zc(t){var e=Vc._t(jt());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new zo("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Kc||(Kc=!0,setTimeout((function(){throw r}),0)),r}}return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Gc=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return Ct(e,t),e}(Lc);function Hc(t,e){var n=ts(t);return Vc.It(n.Mt,e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Qc=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&Qa(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&Wa(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&Wa(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(as.min())}))},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Iu())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&is(this.mutations,t.mutations,(function(t,e){return Xa(t,e)}))&&is(this.baseMutations,t.baseMutations,(function(t,e){return Xa(t,e)}))},t}(),Wc=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){Zo(e.mutations.length===r.length);for(var i=wu,o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Yc=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=as.min()),void 0===o&&(o=as.min()),void 0===s&&(s=gs.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),Xc=function(t){this.Lt=t};function Jc(t,e){if(e.document)return function(t,e,n){var r=Ku(t,e.name),i=qu(e.updateTime),o=new Bs({mapValue:{fields:e.fields}}),s=Ks.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Ns.fromSegments(e.noDocument.path),r=rh(e.noDocument.readTime),i=Ks.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=Ns.fromSegments(e.unknownDocument.path);return r=rh(e.unknownDocument.version),Ks.newUnknownDocument(o,r)}return Jo()}function Zc(t,e,n){var r=th(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:$u(t,e.key),fields:e.data.value.mapValue.fields,updateTime:Fu(t,e.version.toTimestamp())}}(t.Lt,e),s=e.hasCommittedMutations;return new Tc(null,null,o,s,r,i)}if(e.isNoDocument()){var a=e.key.path.toArray(),u=nh(e.version);return s=e.hasCommittedMutations,new Tc(null,new Ec(a,u),null,s,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),h=nh(e.version);return new Tc(new Ic(c,h),null,null,!0,r,i)}return Jo()}function th(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function eh(t){var e=new ss(t[0],t[1]);return as.fromTimestamp(e)}function nh(t){var e=t.toTimestamp();return new gc(e.seconds,e.nanoseconds)}function rh(t){var e=new ss(t.seconds,t.nanoseconds);return as.fromTimestamp(e)}function ih(t,e){for(var n=(e.baseMutations||[]).map((function(e){return Xu(t.Lt,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var s=e.mutations.map((function(e){return Xu(t.Lt,e)})),a=ss.fromMillis(e.localWriteTimeMs);return new Qc(e.batchId,a,n,s)}function oh(t){var e,n,r=rh(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?rh(t.lastLimboFreeSnapshotVersion):as.min();return void 0!==t.query.documents?(Zo(1===(n=t.query).documents.length),e=wa(pa(Gu(n.documents[0])))):e=function(t){return wa(tc(t))}(t.query),new Yc(e,t.targetId,0,t.lastListenSequenceNumber,r,i,gs.fromBase64String(t.resumeToken))}function sh(t,e){var n,r=nh(e.snapshotVersion),i=nh(e.lastLimboFreeSnapshotVersion);n=Ws(e.target)?Ju(t.Lt,e.target):Zu(t.Lt,e.target);var o=e.resumeToken.toBase64();return new Sc(e.targetId,Hs(e.target),r,o,e.sequenceNumber,i,n)}function ah(t){var e=tc({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Ea(e,e.limit,"L"):e}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var uh=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return ch(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:rh(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return ch(t).put({bundleId:(n=e).id,createTime:nh(qu(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return hh(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:ah(e.bundledQuery),readTime:rh(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return hh(t).put(function(t){return{name:t.name,readTime:nh(qu(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function ch(t){return Hc(t,kc.store)}function hh(t){return Hc(t,xc.store)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var lh=function(){function t(){this.Bt=new fh}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),Mc.resolve()},t.prototype.getCollectionParents=function(t,e){return Mc.resolve(this.Bt.getEntries(e))},t}(),fh=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new du(fs.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new du(fs.comparator)).toArray()},t}(),ph=function(){function t(){this.qt=new fh}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.qt.add(e)}));var o={collectionId:r,parent:fc(i)};return dh(t).put(o)}return Mc.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[os(e),""],!1,!0);return dh(t).Nt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(yc(o.parent))}return n}))},t}();function dh(t){return Hc(t,Dc.store)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var yh={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},gh=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function vh(t,e,n){var r=t.store(bc.store),i=t.store(wc.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},(function(t,e,n){return a++,n.delete()}));o.push(u.next((function(){Zo(1===a)})));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],p=wc.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return Mc.waitFor(o).next((function(){return c}))}function mh(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Jo();e=t.noDocument}return JSON.stringify(e).length}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */gh.DEFAULT_COLLECTION_PERCENTILE=10,gh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,gh.DEFAULT=new gh(41943040,gh.DEFAULT_COLLECTION_PERCENTILE,gh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),gh.DISABLED=new gh(-1,0,0);var bh=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Kt={}}return t.Qt=function(e,n,r,i){return Zo(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Eh(t).$t({index:bc.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=Ih(t),s=Eh(t);return s.add({}).next((function(a){Zo("number"==typeof a);for(var u=new Qc(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return Yu(t.Lt,e)})),i=n.mutations.map((function(e){return Yu(t.Lt,e)}));return new bc(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),h=[],l=new du((function(t,e){return rs(t.canonicalString(),e.canonicalString())})),f=0,p=r;f<p.length;f++){var d=p[f],y=wc.key(i.userId,d.key.path,a);l=l.add(d.key.path.popLast()),h.push(s.put(c)),h.push(o.put(y,wc.PLACEHOLDER))}return l.forEach((function(e){h.push(i.Ut.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.Kt[a]=u.keys()})),Mc.waitFor(h).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return Eh(t).get(e).next((function(t){return t?(Zo(t.userId===n.userId),ih(n.R,t)):null}))},t.prototype.jt=function(t,e){var n=this;return this.Kt[e]?Mc.resolve(this.Kt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.Kt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Eh(t).$t({index:bc.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(Zo(e.batchId>=r),o=ih(n.R,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Eh(t).$t({index:bc.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Eh(t).Nt(bc.userMutationsIndex,n).next((function(t){return t.map((function(t){return ih(e.R,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=wc.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Ih(t).$t({range:i},(function(r,i,s){var a=r[0],u=r[1],c=r[2],h=yc(u);if(a===n.userId&&e.path.isEqual(h))return Eh(t).get(c).next((function(t){if(!t)throw Jo();Zo(t.userId===n.userId),o.push(ih(n.R,t))}));s.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new du(rs),i=[];return e.forEach((function(e){var o=wc.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=Ih(t).$t({range:s},(function(t,i,o){var s=t[0],a=t[1],u=t[2],c=yc(a);s===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(a)})),Mc.waitFor(i).next((function(){return n.Wt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=wc.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new du(rs);return Ih(t).$t({range:s},(function(t,e,o){var s=t[0],u=t[1],c=t[2],h=yc(u);s===n.userId&&r.isPrefixOf(h)?h.length===i&&(a=a.add(c)):o.done()})).next((function(){return n.Wt(t,a)}))},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Eh(t).get(e).next((function(t){if(null===t)throw Jo();Zo(t.userId===n.userId),r.push(ih(n.R,t))})))})),Mc.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return vh(t.Mt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Gt(e.batchId)})),Mc.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Gt=function(t){delete this.Kt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return Mc.resolve();var r=IDBKeyRange.lowerBound(wc.prefixForUser(e.userId)),i=[];return Ih(t).$t({range:r},(function(t,n,r){if(t[0]===e.userId){var o=yc(t[1]);i.push(o)}else r.done()})).next((function(){Zo(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return wh(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return Th(t).get(this.userId).next((function(t){return t||new mc(e.userId,-1,"")}))},t}();function wh(t,e,n){var r=wc.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Ih(t).$t({range:o,Ft:!0},(function(t,n,r){var o=t[0],a=t[1];t[2],o===e&&a===i&&(s=!0),r.done()})).next((function(){return s}))}function Eh(t){return Hc(t,bc.store)}function Ih(t){return Hc(t,wc.store)}function Th(t){return Hc(t,mc.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var _h=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),Sh=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next((function(n){var r=new _h(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next((function(t){return as.fromTimestamp(new ss(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next((function(){return n.Xt(t).next((function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return Ah(t).delete(e.targetId)})).next((function(){return n.Xt(t)})).next((function(e){return Zo(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Ah(t).$t((function(s,a){var u=oh(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return Mc.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return Ah(t).$t((function(t,n){var r=oh(n);e(r)}))},t.prototype.Xt=function(t){return Nh(t).get(Nc.key).next((function(t){return Zo(null!==t),t}))},t.prototype.Zt=function(t,e){return Nh(t).put(Nc.key,e)},t.prototype.te=function(t,e){return Ah(t).put(sh(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=Hs(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Ah(t).$t({range:r,index:Sc.queryTargetsIndexName},(function(t,n,r){var o=oh(n);Qs(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Dh(t);return e.forEach((function(e){var s=fc(e.path);i.push(o.put(new Ac(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))})),Mc.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Dh(t);return Mc.forEach(e,(function(e){var o=fc(e.path);return Mc.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Dh(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Dh(t),i=Iu();return r.$t({range:n,Ft:!0},(function(t,e,n){var r=yc(t[1]),o=new Ns(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=fc(e.path),r=IDBKeyRange.bound([n],[os(n)],!1,!0),i=0;return Dh(t).$t({index:Ac.documentTargetsIndex,Ft:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.lt=function(t,e){return Ah(t).get(e).next((function(t){return t?oh(t):null}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ah(t){return Hc(t,Sc.store)}function Nh(t){return Hc(t,Nc.store)}function Dh(t){return Hc(t,Ac.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ch(t){return xt(this,void 0,void 0,(function(){return Rt(this,(function(e){if(t.code!==Ko.FAILED_PRECONDITION||t.message!==Oc)throw t;return Qo("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function kh(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=rs(n,i);return 0===s?rs(r,o):s}var xh=function(){function t(t){this.ne=t,this.buffer=new du(kh),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();kh(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Rh=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;Qo("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return xt(e,void 0,void 0,(function(){var e;return Rt(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return jc(e=n.sent())?(Qo("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Ch(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),Oh=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return Mc.resolve($o.o);var r=new xh(e);return this.ae.forEachTarget(t,(function(t){return r.re(t.sequenceNumber)})).next((function(){return n.ae.le(t,(function(t){return r.re(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Qo("LruGarbageCollector","Garbage collection skipped; disabled"),Mc.resolve(yh)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(Qo("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),yh):n.fe(t,e)}))},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,a,u,c=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>c.params.maximumSequenceNumbersToCollect?(Qo("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)})).next((function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)})).next((function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)})).next((function(t){return u=Date.now(),Ho()<=ie.DEBUG&&Qo("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-h)+"ms"),Mc.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),Lh=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new Oh(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.de=function(t){var e=0;return this.le(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return Ph(t,n)},t.prototype.removeReference=function(t,e,n){return Ph(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return Ph(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return Th(t).Ot((function(r){return wh(t,r,e).next((function(t){return t&&(n=!0),Mc.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,(function(s,a){if(a<=e){var u=n._e(t,s).next((function(e){if(!e)return o++,r.getEntry(t,s).next((function(){return r.removeEntry(s),Dh(t).delete([0,fc(s.path)])}))}));i.push(u)}})).next((function(){return Mc.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Ph(t,e)},t.prototype.we=function(t,e){var n,r=Dh(t),i=$o.o;return r.$t({index:Ac.documentTargetsIndex},(function(t,r){var o=t[0];t[1];var s=r.path,a=r.sequenceNumber;0===o?(i!==$o.o&&e(new Ns(yc(n)),i),i=a,n=s):i=$o.o})).next((function(){i!==$o.o&&e(new Ns(yc(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function Ph(t,e){return Dh(t).put(function(t,e){return new Ac(0,fc(t.path),e)}(e,t.currentSequenceNumber))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Mh=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.equalsFn(s,t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){cs(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];t(s,a)}}))},t.prototype.isEmpty=function(){return hs(this.inner)},t}(),Fh=function(){function t(){this.changes=new Mh((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:as.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:Ks.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?Mc.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),Vh=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return jh(t).put(Bh(e),n)},t.prototype.removeEntry=function(t,e){var n=jh(t),r=Bh(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.me(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return jh(t).get(Bh(e)).next((function(t){return n.ye(e,t)}))},t.prototype.ge=function(t,e){var n=this;return jh(t).get(Bh(e)).next((function(t){return{document:n.ye(e,t),size:mh(t)}}))},t.prototype.getEntries=function(t,e){var n=this,r=vu();return this.pe(t,e,(function(t,e){var i=n.ye(t,e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.Ee=function(t,e){var n=this,r=vu(),i=new lu(Ns.comparator);return this.pe(t,e,(function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,mh(e))})).next((function(){return{documents:r,Te:i}}))},t.prototype.pe=function(t,e,n){if(e.isEmpty())return Mc.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return jh(t).$t({range:r},(function(t,e,r){for(var s=Ns.fromSegments(t);o&&Ns.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=vu(),o=e.path.length+1,s={};if(n.isEqual(as.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=th(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=Tc.collectionReadTimeIndex}return jh(t).$t(s,(function(t,n,s){if(t.length===o){var a=Jc(r.R,n);e.path.isPrefixOf(a.key.path)?Sa(e,a)&&(i=i.insert(a.key,a)):s.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new Uh(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return qh(t).get(_c.key).next((function(t){return Zo(!!t),t}))},t.prototype.me=function(t,e){return qh(t).put(_c.key,e)},t.prototype.ye=function(t,e){if(e){var n=Jc(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(as.min()))return n}return Ks.newInvalidDocument(t)},t}(),Uh=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new Mh((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return Ct(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new du((function(t,e){return rs(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=Zc(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=mh(u);r+=c-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var h=Zc(e.Ie.R,Ks.newNoDocument(o,as.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,h))}else n.push(e.Ie.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))})),n.push(this.Ie.updateMetadata(t,r)),Mc.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next((function(t){return n.Ae.set(e,t.size),t.document}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next((function(t){var e=t.documents;return t.Te.forEach((function(t,e){n.Ae.set(t,e)})),e}))},e}(Fh);
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function qh(t){return Hc(t,_c.store)}function jh(t){return Hc(t,Tc.store)}function Bh(t){return t.path.toArray()}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var $h=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;Zo(n<r&&n>=0&&r<=11);var o=new Fc("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(vc.store)}(t),function(t){t.createObjectStore(mc.store,{keyPath:mc.keyPath}),t.createObjectStore(bc.store,{keyPath:bc.keyPath,autoIncrement:!0}).createIndex(bc.userMutationsIndex,bc.userMutationsKeyPath,{unique:!0}),t.createObjectStore(wc.store)}(t),Kh(t),function(t){t.createObjectStore(Tc.store)}(t));var s=Mc.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Ac.store),t.deleteObjectStore(Sc.store),t.deleteObjectStore(Nc.store)}(t),Kh(t)),s=s.next((function(){return function(t){var e=t.store(Nc.store),n=new Nc(0,0,as.min().toTimestamp(),0);return e.put(Nc.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(bc.store).Nt().next((function(n){t.deleteObjectStore(bc.store),t.createObjectStore(bc.store,{keyPath:bc.keyPath,autoIncrement:!0}).createIndex(bc.userMutationsIndex,bc.userMutationsKeyPath,{unique:!0});var r=e.store(bc.store),i=n.map((function(t){return r.put(t)}));return Mc.waitFor(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Cc.store,{keyPath:Cc.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.Re(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(_c.store)}(t),i.be(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ve(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.Pe(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Tc.store);e.createIndex(Tc.readTimeIndex,Tc.readTimeIndexPath,{unique:!1}),e.createIndex(Tc.collectionReadTimeIndex,Tc.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(kc.store,{keyPath:kc.keyPath})}(t),function(t){t.createObjectStore(xc.store,{keyPath:xc.keyPath})}(t)}))),s},t.prototype.be=function(t){var e=0;return t.store(Tc.store).$t((function(t,n){e+=mh(n)})).next((function(){var n=new _c(e);return t.store(_c.store).put(_c.key,n)}))},t.prototype.Re=function(t){var e=this,n=t.store(mc.store),r=t.store(bc.store);return n.Nt().next((function(n){return Mc.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(bc.userMutationsIndex,i).next((function(r){return Mc.forEach(r,(function(r){Zo(r.userId===n.userId);var i=ih(e.R,r);return vh(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ve=function(t){var e=t.store(Ac.store),n=t.store(Tc.store);return t.store(Nc.store).get(Nc.key).next((function(t){var r=[];return n.$t((function(n,i){var o=new fs(n),s=function(t){return[0,fc(t)]}(o);r.push(e.get(s).next((function(n){return n?Mc.resolve():function(n){return e.put(new Ac(0,fc(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return Mc.waitFor(r)}))}))},t.prototype.Pe=function(t,e){t.createObjectStore(Dc.store,{keyPath:Dc.keyPath});var n=e.store(Dc.store),r=new fh,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:fc(i)})}};return e.store(Tc.store).$t({Ft:!0},(function(t,e){var n=new fs(t);return i(n.popLast())})).next((function(){return e.store(wc.store).$t({Ft:!0},(function(t,e){t[0];var n=t[1];t[2];var r=yc(n);return i(r.popLast())}))}))},t.prototype.Ve=function(t){var e=this,n=t.store(Sc.store);return n.$t((function(t,r){var i=oh(r),o=sh(e.R,i);return n.put(o)}))},t}();function Kh(t){t.createObjectStore(Ac.store,{keyPath:Ac.keyPath}).createIndex(Ac.documentTargetsIndex,Ac.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Sc.store,{keyPath:Sc.keyPath}).createIndex(Sc.queryTargetsIndexName,Sc.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Nc.store)}var zh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Gh=function(){function t(e,n,r,i,o,s,a,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=c,this.Ce=h,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ke=null,this.inForeground=!1,this.Fe=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new zo(Ko.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Lh(this,i),this.Le=n+"main",this.R=new Xc(u),this.Be=new Vc(this.Le,11,new $h(this.R)),this.qe=new Sh(this.referenceDelegate,this.R),this.Ut=new ph,this.Ue=function(t,e){return new Vh(t,e)}(this.R,this.Ut),this.Ke=new uh,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===h&&Wo("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new zo(Ko.FAILED_PRECONDITION,zh);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.qe.getHighestSequenceNumber(e)}))})).then((function(e){t.Ne=new $o(e,t.De)})).then((function(){t.xe=!0})).catch((function(e){return t.Be&&t.Be.close(),Promise.reject(e)}))},t.prototype.He=function(t){var e=this;return this.Me=function(n){return xt(e,void 0,void 0,(function(){return Rt(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt((function(n){return xt(e,void 0,void 0,(function(){return Rt(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget((function(){return xt(e,void 0,void 0,(function(){return Rt(this,(function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return Qh(e).put(new Cc(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Je(e).next((function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable((function(){return t.Me(!1)})))}))})).next((function(){return t.Ye(e)})).next((function(n){return t.isPrimary&&!n?t.Xe(e).next((function(){return!1})):!!n&&t.Ze(e).next((function(){return!0}))}))})).catch((function(e){if(jc(e))return Qo("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Qo("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Se.enqueueRetryable((function(){return t.Me(e)})),t.isPrimary=e}))},t.prototype.Je=function(t){var e=this;return Hh(t).get(vc.key).next((function(t){return Mc.resolve(e.tn(t))}))},t.prototype.en=function(t){return Qh(t).delete(this.clientId)},t.prototype.nn=function(){return xt(this,void 0,void 0,(function(){var t,e,n,r,i=this;return Rt(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=Hc(t,Cc.store);return e.Nt().next((function(t){var n=i.rn(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return Mc.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Qe)for(e=0,n=t;e<n.length;e++)r=n[e],this.Qe.removeItem(this.on(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.je().then((function(){return t.nn()})).then((function(){return t.ze()}))}))},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?Mc.resolve(!0):Hh(t).get(vc.key).next((function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new zo(Ko.FAILED_PRECONDITION,zh);return!1}}return!(!e.networkEnabled||!e.inForeground)||Qh(t).Nt().next((function(t){return void 0===e.rn(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&Qo("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return xt(this,void 0,void 0,(function(){var t=this;return Rt(this,(function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[vc.store,Cc.store],(function(e){var n=new Gc(e,$o.o);return t.Xe(n).next((function(){return t.en(n)}))}))];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}}))}))},t.prototype.rn=function(t,e){var n=this;return t.filter((function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)}))},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return Qh(e).Nt().next((function(e){return t.rn(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return bh.Qt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;Qo("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Be.runTransaction(t,o,Rc,(function(o){return i=new Gc(o,r.Ne?r.Ne.next():$o.o),"readwrite-primary"===e?r.Je(i).next((function(t){return!!t||r.Ye(i)})).next((function(e){if(!e)throw Wo("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new zo(Ko.FAILED_PRECONDITION,Oc);return n(i)})).next((function(t){return r.Ze(i).next((function(){return t}))})):r.dn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.dn=function(t){var e=this;return Hh(t).get(vc.key).next((function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new zo(Ko.FAILED_PRECONDITION,zh)}))},t.prototype.Ze=function(t){var e=new vc(this.clientId,this.allowTabSynchronization,Date.now());return Hh(t).put(vc.key,e)},t.yt=function(){return Vc.yt()},t.prototype.Xe=function(t){var e=this,n=Hh(t);return n.get(vc.key).next((function(t){return e.tn(t)?(Qo("IndexedDbPersistence","Releasing primary lease."),n.delete(vc.key)):Mc.resolve()}))},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Wo("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Fe=function(){t.Se.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.je()}))},this.document.addEventListener("visibilitychange",this.Fe),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.Fe&&(this.document.removeEventListener("visibilitychange",this.Fe),this.Fe=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.ke=function(){e.un(),!Bt()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")&&navigator.appVersion.match("Version/14")&&e.Se.enterRestrictedMode(!0),e.Se.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.ke))},t.prototype.hn=function(){this.ke&&(this.window.removeEventListener("pagehide",this.ke),this.ke=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Qe)||void 0===e?void 0:e.getItem(this.on(t)));return Qo("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Wo("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(t){Wo("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Hh(t){return Hc(t,vc.store)}function Qh(t){return Hc(t,Cc.store)}function Wh(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var Yh=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.yn(t,e,r)}))},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next((function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t}))},t.prototype.gn=function(t,e){t.forEach((function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)}))},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next((function(e){return n.En(t,e).next((function(){return e}))}))},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.gn(e,t)}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return Ns.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):ma(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new Ns(e)).next((function(t){var e=bu();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=bu();return this.Ut.getCollectionParents(t,i).next((function(s){return Mc.forEach(s,(function(s){var a=function(t,e){return new la(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.An(t,a,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.Rn(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,h=r.get(c);null==h&&(h=Ks.newInvalidDocument(c),r=r.insert(c,h)),Wa(u,h,o.localWriteTime),h.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(t,n){Sa(e,n)||(r=r.remove(t))})),r}))},t.prototype.Rn=function(t,e,n){for(var r=Iu(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof tu&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))})),c}))},t}(),Xh=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=Iu(),i=Iu(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Jh=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(as.min())?this.Dn(t,e):this.Sn.pn(t,r).next((function(o){var s=i.Cn(e,o);return(da(e)||ya(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(Ho()<=ie.DEBUG&&Qo("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),_a(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next((function(t){return s.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.Cn=function(t,e){var n=new du(Aa(t));return e.forEach((function(e,r){Sa(t,r)&&(n=n.add(r))})),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return Ho()<=ie.DEBUG&&Qo("QueryEngine","Using full collection scan to execute query:",_a(e)),this.Sn.getDocumentsMatchingQuery(t,e,as.min())},t}(),Zh=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.kn=new lu(rs),this.Fn=new Mh((function(t){return Hs(t)}),Qs),this.$n=as.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new Yh(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.kn)}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function tl(t,e,n,r){return new Zh(t,e,n,r)}function el(t,e){return xt(this,void 0,void 0,(function(){var n,r,i,o;return Rt(this,(function(s){switch(s.label){case 0:return n=ts(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n._n.getAllMutationBatches(t).next((function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new Yh(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],s=Iu(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];s=s.add(f.key)}}for(var p=0,d=e;p<d.length;p++){var y=d[p];r.push(y.batchId);for(var g=0,v=y.mutations;g<v.length;g++){var m=v[g];s=s.add(m.key)}}return i.pn(t,s).next((function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}}))}))}function nl(t,e){var n=ts(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=Mc.resolve();return o.forEach((function(t){s=s.next((function(){return r.getEntry(e,t)})).next((function(e){var o=n.docVersions.get(t);Zo(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))}))})),s.next((function(){return t._n.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}function rl(t){var e=ts(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.qe.getLastRemoteSnapshotVersion(t)}))}function il(t,e){var n=ts(t),r=e.snapshotVersion,i=n.kn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.kn;var s=[];e.targetChanges.forEach((function(e,o){var a=i.get(o);if(a){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)})));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=a.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return Zo(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,c,e)&&s.push(n.qe.updateTargetData(t,c))}}}));var a=vu();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),s.push(function(t,e,n,r,i){var o=Iu();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=vu();return n.forEach((function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(as.min())?(e.removeEntry(n,u),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):Qo("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)})),o}))}(t,o,e.documentUpdates,r,void 0).next((function(t){a=t}))),!r.isEqual(as.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next((function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)}));s.push(u)}return Mc.waitFor(s).next((function(){return o.apply(t)})).next((function(){return n.Mn.En(t,a)})).next((function(){return a}))})).then((function(t){return n.kn=i,t}))}function ol(t,e){var n=ts(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)}))}function sl(t,e){var n=ts(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.qe.getTargetData(t,e).next((function(i){return i?(r=i,Mc.resolve(r)):n.qe.allocateTargetId(t).next((function(i){return r=new Yc(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.kn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.kn=n.kn.insert(t.targetId,t),n.Fn.set(e,t.targetId)),t}))}function al(t,e,n){return xt(this,void 0,void 0,(function(){var r,i,o,s;return Rt(this,(function(a){switch(a.label){case 0:r=ts(t),i=r.kn.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.referenceDelegate.removeTarget(t,i)}))];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!jc(s=a.sent()))throw s;return Qo("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.kn=r.kn.remove(e),r.Fn.delete(i.target),[2]}}))}))}function ul(t,e,n){var r=ts(t),i=as.min(),o=Iu();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=ts(t),i=r.Fn.get(n);return void 0!==i?Mc.resolve(r.kn.get(i)):r.qe.getTargetData(e,n)}(r,t,wa(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:as.min(),n?o:Iu())})).next((function(t){return{documents:t,Bn:o}}))}))}function cl(t,e){var n=ts(t),r=ts(n.qe),i=n.kn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.lt(t,e).next((function(t){return t?t.target:null}))}))}function hl(t){var e=ts(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=ts(t),i=vu(),o=th(n),s=jh(e),a=IDBKeyRange.lowerBound(o,!0);return s.$t({index:Tc.readTimeIndex,range:a},(function(t,e){var n=Jc(r.R,e);i=i.insert(n.key,n),o=e.readTime})).next((function(){return{wn:i,readTime:eh(o)}}))}(e.On,t,e.$n)})).then((function(t){var n=t.wn,r=t.readTime;return e.$n=r,n}))}function ll(t){return xt(this,void 0,void 0,(function(){var e;return Rt(this,(function(n){return[2,(e=ts(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=jh(t),n=as.min();return e.$t({index:Tc.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=eh(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.$n=t}))]}))}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var fl=function(){function t(t){this.R=t,this.Qn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return Mc.resolve(this.Qn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Qn.set(e.id,{id:(n=e).id,version:n.version,createTime:qu(n.createTime)}),Mc.resolve()},t.prototype.getNamedQuery=function(t,e){return Mc.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:ah(t.bundledQuery),readTime:qu(t.readTime)}}(e)),Mc.resolve()},t}(),pl=function(){function t(){this.Wn=new du(dl.Gn),this.zn=new du(dl.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new dl(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.Yn(new dl(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.Zn=function(t){var e=this,n=new Ns(new fs([])),r=new dl(n,t),i=new dl(n,t+1),o=[];return this.zn.forEachInRange([r,i],(function(t){e.Yn(t),o.push(t.key)})),o},t.prototype.ts=function(){var t=this;this.Wn.forEach((function(e){return t.Yn(e)}))},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new Ns(new fs([])),n=new dl(e,t),r=new dl(e,t+1),i=Iu();return this.zn.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new dl(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),dl=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return Ns.comparator(t.key,e.key)||rs(t.ns,e.ns)},t.Hn=function(t,e){return rs(t.ns,e.ns)||Ns.comparator(t.key,e.key)},t}(),yl=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new du(dl.Gn)}return t.prototype.checkEmpty=function(t){return Mc.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new Qc(i,e,n,r);this._n.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.rs=this.rs.add(new dl(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return Mc.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return Mc.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.cs(n),i=r<0?0:r;return Mc.resolve(this._n.length>i?this._n[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return Mc.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return Mc.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new dl(e,0),i=new dl(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(t){var e=n.os(t.ns);o.push(e)})),Mc.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new du(rs);return e.forEach((function(t){var e=new dl(t,0),i=new dl(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],(function(t){r=r.add(t.ns)}))})),Mc.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;Ns.isDocumentKey(i)||(i=i.child(""));var o=new dl(new Ns(i),0),s=new du(rs);return this.rs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)}),o),Mc.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.os(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;Zo(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return Mc.forEach(e.mutations,(function(i){var o=new dl(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.rs=r}))},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new dl(e,0),r=this.rs.firstAfterOrEqual(n);return Mc.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return this._n.length,Mc.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),gl=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new lu(Ns.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Mc.resolve(n?n.document.clone():Ks.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=vu();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():Ks.newInvalidDocument(t))})),Mc.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=vu(),i=new Ns(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.key,u=s.value,c=u.document,h=u.readTime;if(!e.path.isPrefixOf(a.path))break;h.compareTo(n)<=0||Sa(e,c)&&(r=r.insert(c.key,c.clone()))}return Mc.resolve(r)},t.prototype.fs=function(t,e){return Mc.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new vl(this)},t.prototype.getSize=function(t){return Mc.resolve(this.size)},t}(),vl=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return Ct(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)})),Mc.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(Fh),ml=function(){function t(t){this.persistence=t,this.ds=new Mh((function(t){return Hs(t)}),Qs),this.lastRemoteSnapshotVersion=as.min(),this.highestTargetId=0,this.ws=0,this._s=new pl,this.targetCount=0,this.ys=_h.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach((function(t,n){return e(n)})),Mc.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return Mc.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return Mc.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),Mc.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),Mc.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new _h(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,Mc.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),Mc.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,Mc.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach((function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)})),Mc.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return Mc.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return Mc.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),Mc.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),Mc.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),Mc.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return Mc.resolve(n)},t.prototype.containsKey=function(t,e){return Mc.resolve(this._s.containsKey(e))},t}(),bl=function(){function t(t,e){var n=this;this.gs={},this.Ne=new $o(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new ml(this),this.Ut=new lh,this.Ue=function(t,e){return new gl(t,(function(t){return n.referenceDelegate.ps(t)}))}(this.Ut),this.R=new Xc(e),this.Ke=new fl(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new yl(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;Qo("MemoryPersistence","Starting transaction:",t);var i=new wl(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(t){return r.referenceDelegate.Ts(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Is=function(t,e){return Mc.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),wl=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return Ct(e,t),e}(Lc),El=function(){function t(t){this.persistence=t,this.As=new pl,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw Jo()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),Mc.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),Mc.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),Mc.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach((function(t){return n.vs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.vs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Mc.forEach(this.vs,(function(r){var i=Ns.fromPath(r);return e.Ps(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Rs=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next((function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())}))},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return Mc.or([function(){return Mc.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),Il=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Tl(t,e){return"firestore_clients_"+t+"_"+e}function _l(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function Sl(t,e){return"firestore_targets_"+t+"_"+e}Il.UNAUTHENTICATED=new Il(null),Il.GOOGLE_CREDENTIALS=new Il("google-credentials-uid"),Il.FIRST_PARTY=new Il("first-party-uid"),Il.MOCK_USER=new Il("mock-user");var Al=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new zo(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(Wo("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Nl=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new zo(i.error.code,i.error.message)),o?new t(e,i.state,r):(Wo("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Dl=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=_u(),s=0;i&&s<r.activeTargetIds.length;++s)i=As(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(Wo("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Cl=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Wo("SharedClientState","Failed to parse online state: "+e),null)},t}(),kl=function(){function t(){this.activeTargetIds=_u()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),xl=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.ks.bind(this),this.Fs=new lu(rs),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=Tl(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Fs=this.Fs.insert(this.Ns,new kl),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Ks=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return xt(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,a,u,c,h,l=this;return Rt(this,(function(f){switch(f.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(Tl(this.persistenceKey,r)))&&(o=Dl.Vs(r,i))&&(this.Fs=this.Fs.insert(o.clientId,o));for(this.Qs(),(s=this.storage.getItem(this.Us))&&(a=this.js(s))&&this.Ws(a),u=0,c=this.$s;u<c.length;u++)h=c[u],this.ks(h);return this.$s=[],this.window.addEventListener("pagehide",(function(){return l.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.Fs)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.Fs.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(Sl(this.persistenceKey,t));if(n){var r=Nl.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Qs(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(Sl(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.Hs(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Qo("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Qo("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Qo("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.ks=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Qo("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void Wo("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return xt(e,void 0,void 0,(function(){var t,e,r,i,o,s;return Rt(this,(function(a){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(s=function(t){var e=$o.o;if(null!=t)try{var n=JSON.parse(t);Zo("number"==typeof n),e=n}catch(t){Wo("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==$o.o&&this.sequenceNumberHandler(s);else if(n.key===this.Ks)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.Fs.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new Al(this.currentUser,t,e,n),i=_l(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=_l(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){var e={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(e))},t.prototype.Ys=function(t,e,n){var r=Sl(this.persistenceKey,t),i=new Nl(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return Dl.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Al.Vs(new Il(i),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return Nl.Vs(r,e)},t.prototype.js=function(t){return Cl.Vs(t)},t.prototype.ii=function(t){return xt(this,void 0,void 0,(function(){return Rt(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(Qo("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.Fs.insert(t,e):this.Fs.remove(t),i=this.Gs(this.Fs),o=this.Gs(r),s=[],a=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||a.push(t)})),this.syncEngine.hi(s,a).then((function(){n.Fs=r}))},t.prototype.Ws=function(t){this.Fs.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=_u();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),Rl=function(){function t(){this.li=new kl,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new kl,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),Ol=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),Ll=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){Qo("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){Qo("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Pl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Ml=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),Fl=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return Ct(e,t),e.prototype.Fi=function(t,e,n,r){return new Promise((function(i,o){var s=new Bo;s.listenOnce(Mo.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case Po.NO_ERROR:var e=s.getResponseJson();Qo("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Po.TIMEOUT:Qo("Connection",'RPC "'+t+'" timed out'),o(new zo(Ko.DEADLINE_EXCEEDED,"Request time out"));break;case Po.HTTP_ERROR:var n=s.getStatus();if(Qo("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Ko).indexOf(e)>=0?e:Ko.UNKNOWN}(r.status);o(new zo(a,r.message))}else o(new zo(Ko.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new zo(Ko.UNAVAILABLE,"Connection failed."));break;default:Jo()}}finally{Qo("Connection",'RPC "'+t+'" completed.')}}));var a=JSON.stringify(r);s.send(e,"POST",a,n,15)}))},e.prototype.Oi=function(t,e){var n,r=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new ko,o=Ir(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(s.xmlHttpFactory=new qo({})),this.ki(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(jt())||"object"==typeof navigator&&"ReactNative"===navigator.product||jt().indexOf("Electron/")>=0||function(){var t=jt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||jt().indexOf("MSAppHost/")>=0||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=r.join("");Qo("Connection","Creating WebChannel: "+a,s);var u=i.createWebChannel(a,s),c=!1,h=!1,l=new Ml({Ei:function(t){h?Qo("Connection","Not sending because WebChannel is closed:",t):(c||(Qo("Connection","Opening WebChannel transport."),u.open(),c=!0),Qo("Connection","WebChannel sending:",t),u.send(t))},Ti:function(){return u.close()}}),f=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(u,jo.EventType.OPEN,(function(){h||Qo("Connection","WebChannel transport opened.")})),f(u,jo.EventType.CLOSE,(function(){h||(h=!0,Qo("Connection","WebChannel transport closed"),l.Vi())})),f(u,jo.EventType.ERROR,(function(t){h||(h=!0,Yo("Connection","WebChannel transport errored:",t),l.Vi(new zo(Ko.UNAVAILABLE,"The operation could not be completed")))})),f(u,jo.EventType.MESSAGE,(function(t){var e;if(!h){var n=t.data[0];Zo(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){Qo("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=iu[t];if(void 0!==e)return hu(e)}(o),a=i.message;void 0===s&&(s=Ko.INTERNAL,a="Unknown error status: "+o+" with message "+i.message),h=!0,l.Vi(new zo(s,a)),u.close()}else Qo("Connection","WebChannel received:",n),l.Si(n)}})),f(o,Fo.STAT_EVENT,(function(t){t.stat===Vo?Qo("Connection","Detected buffering proxy"):t.stat===Uo&&Qo("Connection","Detected no buffering proxy")})),setTimeout((function(){l.Pi()}),0),l},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);Qo("RestConnection","Sending: ",i,n);var o={};return this.ki(o,r),this.Fi(t,i,o,n).then((function(t){return Qo("RestConnection","Received: ",t),t}),(function(e){throw Yo("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.ki=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.10.0",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){var n=Pl[t];return this.Di+"/v1/"+e+":"+n},t}());
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Vl(){return"undefined"!=typeof window?window:null}function Ul(){return"undefined"!=typeof document?document:null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ql(t){return new Mu(t,!0)}var jl=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Qi=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Ki),i=Math.max(0,n-r);i>0&&Qo("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return e.Ki=Date.now(),t()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),Bl=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new jl(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return xt(this,void 0,void 0,(function(){return Rt(this,(function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return t.rr()})))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return xt(this,void 0,void 0,(function(){return Rt(this,(function(t){return this.er()?[2,this.close(0)]:[2]}))}))},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return xt(this,void 0,void 0,(function(){return Rt(this,(function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===Ko.RESOURCE_EXHAUSTED?(Wo(e.toString()),Wo("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):e&&e.code===Ko.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(e){t.Yi===n&&t.lr(e)}),(function(n){e((function(){var e=new zo(Ko.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)}))}))},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii((function(){n((function(){return e.state=2,e.listener.Ii()}))})),this.stream.Ri((function(t){n((function(){return e.dr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji((function(){return xt(t,void 0,void 0,(function(){return Rt(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.dr=function(t){return Qo("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget((function(){return e.Yi===t?n():(Qo("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),$l=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return Ct(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Jo()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(Zo(void 0===e||"string"==typeof e),gs.fromBase64String(e||"")):(Zo(void 0===e||e instanceof Uint8Array),gs.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?Ko.UNKNOWN:hu(t.code);return new zo(e,t.message||"")}(a);n=new Cu(r,i,o,s||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=Ku(t,r.document.name),o=qu(r.document.updateTime);var a=new Bs({mapValue:{fields:r.document.fields}}),u=(s=Ks.newFoundDocument(i,o,a),r.targetIds||[]),c=r.removedTargetIds||[];n=new Nu(u,c,s.key,s)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=Ku(t,r.document),o=r.readTime?qu(r.readTime):as.min(),a=Ks.newNoDocument(i,o),s=r.removedTargetIds||[],n=new Nu([],s,a.key,a);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=Ku(t,r.document),o=r.removedTargetIds||[],n=new Nu([],o,i,null);else{if(!("filter"in e))return Jo();e.filter;var h=e.filter;h.targetId,r=h.count||0,i=new uu(r),o=h.targetId,n=new Du(o,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return as.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?as.min():e.readTime?qu(e.readTime):as.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=Hu(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=Ws(r)?{documents:Ju(t,r)}:{query:Zu(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Vu(t,e.resumeToken):e.snapshotVersion.compareTo(as.min())>0&&(n.readTime=Fu(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Jo()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=Hu(this.R),e.removeTarget=t,this.cr(e)},e}(Bl),Kl=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return Ct(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(Zo(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(Zo(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?qu(t.updateTime):qu(e);return n.isEqual(as.min())&&(n=qu(e)),new Ka(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=qu(t.commitTime);return this.listener.Tr(n,e)}return Zo(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=Hu(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Yu(e.R,t)}))};this.cr(n)},e}(Bl),zl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return Ct(e,t),e.prototype.br=function(){if(this.Rr)throw new zo(Ko.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===Ko.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new zo(Ko.UNKNOWN,t.toString())}))},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.$i(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===Ko.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new zo(Ko.UNKNOWN,t.toString())}))},e.prototype.terminate=function(){this.Rr=!0},e}((function(){})),Gl=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()})))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.kr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.kr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(Wo(e),this.Vr=!1):Qo("OnlineStateTracker",e)},t.prototype.kr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),Hl=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Fr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di((function(t){n.enqueueAndForget((function(){return xt(o,void 0,void 0,(function(){return Rt(this,(function(t){switch(t.label){case 0:return nf(this)?(Qo("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return xt(this,void 0,void 0,(function(){var e;return Rt(this,(function(n){switch(n.label){case 0:return(e=ts(t)).Or.add(4),[4,Wl(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,Ql(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Br=new Gl(n,r)};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ql(t){return xt(this,void 0,void 0,(function(){var e,n;return Rt(this,(function(r){switch(r.label){case 0:if(!nf(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Wl(t){return xt(this,void 0,void 0,(function(){var e,n;return Rt(this,(function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Yl(t,e){var n=ts(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),ef(n)?tf(n):mf(n).er()&&Jl(n,e))}function Xl(t,e){var n=ts(t),r=mf(n);n.$r.delete(e),r.er()&&Zl(n,e),0===n.$r.size&&(r.er()?r.ir():nf(n)&&n.Br.set("Unknown"))}function Jl(t,e){t.qr.U(e.targetId),mf(t).mr(e)}function Zl(t,e){t.qr.U(e),mf(t).yr(e)}function tf(t){t.qr=new xu({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),mf(t).start(),t.Br.Sr()}function ef(t){return nf(t)&&!mf(t).tr()&&t.$r.size>0}function nf(t){return 0===ts(t).Or.size}function rf(t){t.qr=void 0}function of(t){return xt(this,void 0,void 0,(function(){return Rt(this,(function(e){return t.$r.forEach((function(e,n){Jl(t,e)})),[2]}))}))}function sf(t,e){return xt(this,void 0,void 0,(function(){return Rt(this,(function(n){return rf(t),ef(t)?(t.Br.Nr(e),tf(t)):t.Br.set("Unknown"),[2]}))}))}function af(t,e,n){return xt(this,void 0,void 0,(function(){var r,i,o;return Rt(this,(function(s){switch(s.label){case 0:if(t.Br.set("Online"),!(e instanceof Cu&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return xt(this,void 0,void 0,(function(){var n,r,i,o;return Rt(this,(function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?(o=i[r],t.$r.has(o)?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]):[3,5];case 2:s.sent(),t.$r.delete(o),t.qr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),Qo("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,uf(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Nu?t.qr.X(e):e instanceof Du?t.qr.rt(e):t.qr.et(e),n.isEqual(as.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,rl(t.localStore)];case 8:return i=s.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(gs.EMPTY_BYTE_STRING,n.snapshotVersion)),Zl(t,e);var r=new Yc(n.target,e,1,n.sequenceNumber);Jl(t,r)}})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return Qo("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,uf(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}}))}))}function uf(t,e,n){return xt(this,void 0,void 0,(function(){var r=this;return Rt(this,(function(i){switch(i.label){case 0:if(!jc(e))throw e;return t.Or.add(1),[4,Wl(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return rl(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return xt(r,void 0,void 0,(function(){return Rt(this,(function(e){switch(e.label){case 0:return Qo("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,Ql(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function cf(t,e){return e().catch((function(n){return uf(t,n,e)}))}function hf(t){return xt(this,void 0,void 0,(function(){var e,n,r,i,o;return Rt(this,(function(s){switch(s.label){case 0:e=ts(t),n=bf(e),r=e.Fr.length>0?e.Fr[e.Fr.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return nf(t)&&t.Fr.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,ol(e.localStore,r)];case 3:return null===(i=s.sent())?(0===e.Fr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.Fr.push(e);var n=bf(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,uf(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return lf(e)&&ff(e),[2]}}))}))}function lf(t){return nf(t)&&!bf(t).tr()&&t.Fr.length>0}function ff(t){bf(t).start()}function pf(t){return xt(this,void 0,void 0,(function(){return Rt(this,(function(e){return bf(t).Ar(),[2]}))}))}function df(t){return xt(this,void 0,void 0,(function(){var e,n,r,i;return Rt(this,(function(o){for(e=bf(t),n=0,r=t.Fr;n<r.length;n++)i=r[n],e.Er(i.mutations);return[2]}))}))}function yf(t,e,n){return xt(this,void 0,void 0,(function(){var r,i;return Rt(this,(function(o){switch(o.label){case 0:return r=t.Fr.shift(),i=Wc.from(r,e,n),[4,cf(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,hf(t)];case 2:return o.sent(),[2]}}))}))}function gf(t,e){return xt(this,void 0,void 0,(function(){return Rt(this,(function(n){switch(n.label){case 0:return e&&bf(t).pr?[4,function(t,e){return xt(this,void 0,void 0,(function(){var n,r;return Rt(this,(function(i){switch(i.label){case 0:return cu(r=e.code)&&r!==Ko.ABORTED?(n=t.Fr.shift(),bf(t).sr(),[4,cf(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,hf(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return lf(t)&&ff(t),[2]}}))}))}function vf(t,e){return xt(this,void 0,void 0,(function(){var n;return Rt(this,(function(r){switch(r.label){case 0:return n=ts(t),e?(n.Or.delete(2),[4,Ql(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,Wl(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function mf(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=ts(t);return r.br(),new $l(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:of.bind(null,t),Ri:sf.bind(null,t),_r:af.bind(null,t)}),t.Mr.push((function(n){return xt(e,void 0,void 0,(function(){return Rt(this,(function(e){switch(e.label){case 0:return n?(t.Ur.sr(),ef(t)?tf(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),rf(t),e.label=3;case 3:return[2]}}))}))}))),t.Ur}function bf(t){var e=this;return t.Kr||(t.Kr=function(t,e,n){var r=ts(t);return r.br(),new Kl(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:pf.bind(null,t),Ri:gf.bind(null,t),Ir:df.bind(null,t),Tr:yf.bind(null,t)}),t.Mr.push((function(n){return xt(e,void 0,void 0,(function(){return Rt(this,(function(e){switch(e.label){case 0:return n?(t.Kr.sr(),[4,hf(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kr.stop()];case 3:e.sent(),t.Fr.length>0&&(Qo("RemoteStore","Stopping write stream with "+t.Fr.length+" pending writes"),t.Fr=[]),e.label=4;case 4:return[2]}}))}))}))),t.Kr
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var wf=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Pc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new zo(Ko.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function Ef(t,e){if(Wo("AsyncQueue",e+": "+t),jc(t))return new zo(Ko.UNAVAILABLE,e+": "+t);throw t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var If=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||Ns.comparator(e.key,n.key)}:function(t,e){return Ns.comparator(t.key,e.key)},this.keyedMap=bu(),this.sortedSet=new lu(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),Tf=function(){function t(){this.Qr=new lu(Ns.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Qr.get(e);n?0!==t.type&&3===n.type?this.Qr=this.Qr.insert(e,t):3===t.type&&1!==n.type?this.Qr=this.Qr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Qr=this.Qr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Qr=this.Qr.remove(e):1===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):Jo():this.Qr=this.Qr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Qr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),_f=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,If.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Ia(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Sf=function(){this.Wr=void 0,this.listeners=[]},Af=function(){this.queries=new Mh((function(t){return Ta(t)}),Ia),this.onlineState="Unknown",this.Gr=new Set};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Nf(t,e){return xt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u;return Rt(this,(function(c){switch(c.label){case 0:if(n=ts(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new Sf),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=c.sent(),[3,4];case 3:return a=c.sent(),u=Ef(a,"Initialization of query '"+_a(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&xf(n),[2]}}))}))}function Df(t,e){return xt(this,void 0,void 0,(function(){var n,r,i,o,s;return Rt(this,(function(a){return n=ts(t),r=e.query,i=!1,(o=n.queries.get(r))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function Cf(t,e){for(var n=ts(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,u=n.queries.get(a);if(u){for(var c=0,h=u.listeners;c<h.length;c++)h[c].Hr(s)&&(r=!0);u.Wr=s}}r&&xf(n)}function kf(t,e,n){var r=ts(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function xf(t){t.Gr.forEach((function(t){t.next()}))}var Rf=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new _f(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.so&&n||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=_f.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),Of=function(t){this.key=t},Lf=function(t){this.key=t},Pf=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=Iu(),this.mutatedKeys=Iu(),this.lo=Aa(t),this.fo=new If(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new Tf,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=da(this.query)&&i.size===this.query.limit?i.last():null,c=ya(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var h=i.get(t),l=Sa(n.query,e)?e:null,f=!!h&&n.mutatedKeys.has(h.key),p=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),d=!1;h&&l?h.data.isEqual(l.data)?f!==p&&(r.track({type:3,doc:l}),d=!0):n.yo(h,l)||(r.track({type:2,doc:l}),d=!0,(u&&n.lo(l,u)>0||c&&n.lo(l,c)<0)&&(a=!0)):!h&&l?(r.track({type:0,doc:l}),d=!0):h&&!l&&(r.track({type:1,doc:h}),d=!0,(u||c)&&(a=!0)),d&&(l?(s=s.add(l),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),da(this.query)||ya(this.query))for(;s.size>this.query.limit;){var h=da(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Jo()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)})),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new _f(this.query,t.fo,i,o,t.mutatedKeys,0===a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new Tf,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.uo=e.uo.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.uo=e.uo.delete(t)})),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=Iu(),this.fo.forEach((function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))}));var n=[];return e.forEach((function(e){t.ho.has(e)||n.push(new Lf(e))})),this.ho.forEach((function(t){e.has(t)||n.push(new Of(t))})),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=Iu();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return _f.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),Mf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Ff=function(t){this.key=t,this.bo=!1},Vf=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new Mh((function(t){return Ta(t)}),Ia),this.Vo=new Map,this.So=new Set,this.Do=new lu(Ns.comparator),this.Co=new Map,this.No=new pl,this.xo={},this.ko=new Map,this.Fo=_h.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Uf(t,e){return xt(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Rt(this,(function(u){switch(u.label){case 0:return n=dp(t),(o=n.Po.get(e))?(r=o.targetId,n.sharedClientState.addLocalQueryTarget(r),i=o.view.Ro(),[3,4]):[3,1];case 1:return[4,sl(n.localStore,wa(e))];case 2:return s=u.sent(),a=n.sharedClientState.addLocalQueryTarget(s.targetId),r=s.targetId,[4,qf(n,e,r,"current"===a)];case 3:i=u.sent(),n.isPrimaryClient&&Yl(n.remoteStore,s),u.label=4;case 4:return[2,i]}}))}))}function qf(t,e,n,r){return xt(this,void 0,void 0,(function(){var i,o,s,a,u,c;return Rt(this,(function(h){switch(h.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return xt(this,void 0,void 0,(function(){var i,o,s;return Rt(this,(function(a){switch(a.label){case 0:return(i=e.view._o(n)).Nn?[4,ul(t.localStore,e.query,!1).then((function(t){var n=t.documents;return e.view._o(n,i)}))]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(Zf(t,e.targetId,s.To),s.snapshot)]}}))}))}(t,e,n,r)},[4,ul(t.localStore,e,!0)];case 1:return i=h.sent(),o=new Pf(e,i.Bn),s=o._o(i.documents),a=Au.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(s,t.isPrimaryClient,a),Zf(t,n,u.To),c=new Mf(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}}))}))}function jf(t,e){return xt(this,void 0,void 0,(function(){var n,r,i;return Rt(this,(function(o){switch(o.label){case 0:return n=ts(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter((function(t){return!Ia(t,e)}))),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,al(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),Xl(n.remoteStore,r.targetId),Xf(n,r.targetId)})).catch(Ch)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Xf(n,r.targetId),[4,al(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function Bf(t,e,n){return xt(this,void 0,void 0,(function(){var r,i,o,s;return Rt(this,(function(a){switch(a.label){case 0:r=yp(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=ts(t),i=ss.now(),o=e.reduce((function(t,e){return t.add(e.key)}),Iu());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Mn.pn(t,o).next((function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],h=Ya(c,n.get(c.key));null!=h&&s.push(new tu(c.key,h,$s(h.value.mapValue),za.exists(!0)))}return r._n.addMutationBatch(t,i,s,e)}))})).then((function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}}))}(r.localStore,e)];case 2:return i=a.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new lu(rs)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,np(r,i.changes)];case 3:return a.sent(),[4,hf(r.remoteStore)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=Ef(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}}))}))}function $f(t,e){return xt(this,void 0,void 0,(function(){var n,r;return Rt(this,(function(i){switch(i.label){case 0:n=ts(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,il(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.Co.get(e);r&&(Zo(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?Zo(r.bo):t.removedDocuments.size>0&&(Zo(r.bo),r.bo=!1))})),[4,np(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Ch(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function Kf(t,e,n){var r=ts(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=ts(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)})),r&&xf(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function zf(t,e,n){return xt(this,void 0,void 0,(function(){var r,i,o,s,a,u;return Rt(this,(function(c){switch(c.label){case 0:return(r=ts(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(s=(s=new lu(Ns.comparator)).insert(o,Ks.newNoDocument(o,as.min())),a=Iu().add(o),u=new Su(as.min(),new Map,new du(rs),s,a),[4,$f(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),ep(r),[3,4];case 2:return[4,al(r.localStore,e,!1).then((function(){return Xf(r,e,n)})).catch(Ch)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function Gf(t,e){return xt(this,void 0,void 0,(function(){var n,r,i;return Rt(this,(function(o){switch(o.label){case 0:n=ts(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,nl(n.localStore,e)];case 2:return i=o.sent(),Yf(n,r,null),Wf(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,np(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ch(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Hf(t,e,n){return xt(this,void 0,void 0,(function(){var r,i;return Rt(this,(function(o){switch(o.label){case 0:r=ts(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=ts(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n._n.lookupMutationBatch(t,e).next((function(e){return Zo(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}(r.localStore,e)];case 2:return i=o.sent(),Yf(r,e,n),Wf(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,np(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ch(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Qf(t,e){return xt(this,void 0,void 0,(function(){var n,r,i,o,s;return Rt(this,(function(a){switch(a.label){case 0:nf((n=ts(t)).remoteStore)||Qo("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=ts(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e._n.getHighestUnacknowledgedBatchId(t)}))}(n.localStore)];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.ko.get(r)||[]).push(e),n.ko.set(r,i),[3,4]);case 3:return o=a.sent(),s=Ef(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}}))}))}function Wf(t,e){(t.ko.get(e)||[]).forEach((function(t){t.resolve()})),t.ko.delete(e)}function Yf(t,e,n){var r=ts(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function Xf(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach((function(e){t.No.containsKey(e)||Jf(t,e)}))}function Jf(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(Xl(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),ep(t))}function Zf(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Of?(t.No.addReference(o.key,e),tp(t,o)):o instanceof Lf?(Qo("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||Jf(t,o.key)):Jo()}}function tp(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(Qo("SyncEngine","New document in limbo: "+n),t.So.add(r),ep(t))}function ep(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new Ns(fs.fromString(e)),r=t.Fo.next();t.Co.set(r,new Ff(n)),t.Do=t.Do.insert(n,r),Yl(t.remoteStore,new Yc(wa(pa(n.path)),r,2,$o.o))}}function np(t,e,n){return xt(this,void 0,void 0,(function(){var r,i,o,s;return Rt(this,(function(a){switch(a.label){case 0:return r=ts(t),i=[],o=[],s=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach((function(t,a){s.push(r.Oo(a,e,n).then((function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Xh.Pn(a.targetId,t);o.push(e)}})))})),[4,Promise.all(s)]);case 1:return a.sent(),r.vo._r(i),[4,function(t,e){return xt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,h;return Rt(this,(function(l){switch(l.label){case 0:n=ts(t),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return Mc.forEach(e,(function(e){return Mc.forEach(e.bn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return Mc.forEach(e.vn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return l.sent(),[3,4];case 3:if(!jc(r=l.sent()))throw r;return Qo("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)s=o[i],a=s.targetId,s.fromCache||(u=n.kn.get(a),c=u.snapshotVersion,h=u.withLastLimboFreeSnapshotVersion(c),n.kn=n.kn.insert(a,h));return[2]}}))}))}(r.localStore,o)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function rp(t,e){return xt(this,void 0,void 0,(function(){var n,r;return Rt(this,(function(i){switch(i.label){case 0:return(n=ts(t)).currentUser.isEqual(e)?[3,3]:(Qo("SyncEngine","User change. New user:",e.toKey()),[4,el(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.ko.forEach((function(t){t.forEach((function(t){t.reject(new zo(Ko.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.ko.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,np(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function ip(t,e){var n=ts(t),r=n.Co.get(e);if(r&&r.bo)return Iu().add(r.key);var i=Iu(),o=n.Vo.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=a[s],c=n.Po.get(u);i=i.unionWith(c.view.wo)}return i}function op(t,e){return xt(this,void 0,void 0,(function(){var n,r,i;return Rt(this,(function(o){switch(o.label){case 0:return[4,ul((n=ts(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&Zf(n,e.targetId,i.To),i)]}}))}))}function sp(t){return xt(this,void 0,void 0,(function(){var e;return Rt(this,(function(n){return[2,hl((e=ts(t)).localStore).then((function(t){return np(e,t)}))]}))}))}function ap(t,e,n,r){return xt(this,void 0,void 0,(function(){var i,o;return Rt(this,(function(s){switch(s.label){case 0:return[4,function(t,e){var n=ts(t),r=ts(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.jt(t,e).next((function(e){return e?n.Mn.pn(t,e):Mc.resolve(null)}))}))}((i=ts(t)).localStore,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,hf(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Yf(i,e,r||null),Wf(i,e),function(t,e){ts(ts(t)._n).Gt(e)}(i.localStore,e)):Jo(),s.label=4;case 4:return[4,np(i,o)];case 5:return s.sent(),[3,7];case 6:Qo("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}}))}))}function up(t,e){return xt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c;return Rt(this,(function(h){switch(h.label){case 0:return dp(n=ts(t)),yp(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,cp(n,r.toArray())]);case 1:return i=h.sent(),n.$o=!0,[4,vf(n.remoteStore,!0)];case 2:for(h.sent(),o=0,s=i;o<s.length;o++)a=s[o],Yl(n.remoteStore,a);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(u=[],c=Promise.resolve(),n.Vo.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?u.push(e):c=c.then((function(){return Xf(n,e),al(n.localStore,e,!0)})),Xl(n.remoteStore,e)})),[4,c]);case 4:return h.sent(),[4,cp(n,u)];case 5:return h.sent(),function(t){var e=ts(t);e.Co.forEach((function(t,n){Xl(e.remoteStore,n)})),e.No.ts(),e.Co=new Map,e.Do=new lu(Ns.comparator)}(n),n.$o=!1,[4,vf(n.remoteStore,!1)];case 6:h.sent(),h.label=7;case 7:return[2]}}))}))}function cp(t,e,n){return xt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,h,l,f,p,d,y;return Rt(this,(function(g){switch(g.label){case 0:n=ts(t),r=[],i=[],o=0,s=e,g.label=1;case 1:return o<s.length?(a=s[o],u=void 0,(c=n.Vo.get(a))&&0!==c.length?[4,sl(n.localStore,wa(c[0]))]:[3,7]):[3,13];case 2:u=g.sent(),h=0,l=c,g.label=3;case 3:return h<l.length?(f=l[h],p=n.Po.get(f),[4,op(n,p)]):[3,6];case 4:(d=g.sent()).snapshot&&i.push(d.snapshot),g.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,cl(n.localStore,a)];case 8:return y=g.sent(),[4,sl(n.localStore,y)];case 9:return u=g.sent(),[4,qf(n,hp(y),a,!1)];case 10:g.sent(),g.label=11;case 11:r.push(u),g.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}}))}))}function hp(t){return fa(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function lp(t){var e=ts(t);return ts(ts(e.localStore).persistence).fn()}function fp(t,e,n,r){return xt(this,void 0,void 0,(function(){var i,o,s;return Rt(this,(function(a){switch(a.label){case 0:return(i=ts(t)).$o?(Qo("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,hl(i.localStore)];case 3:return o=a.sent(),s=Su.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,np(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,al(i.localStore,e,!0)];case 6:return a.sent(),Xf(i,e,r),[3,8];case 7:Jo(),a.label=8;case 8:return[2]}}))}))}function pp(t,e,n){return xt(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,h,l,f;return Rt(this,(function(p){switch(p.label){case 0:if(!(r=dp(t)).$o)return[3,10];i=0,o=e,p.label=1;case 1:return i<o.length?(s=o[i],r.Vo.has(s)?(Qo("SyncEngine","Adding an already active target "+s),[3,5]):[4,cl(r.localStore,s)]):[3,6];case 2:return a=p.sent(),[4,sl(r.localStore,a)];case 3:return u=p.sent(),[4,qf(r,hp(a),u.targetId,!1)];case 4:p.sent(),Yl(r.remoteStore,u),p.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Rt(this,(function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,al(r.localStore,t,!1).then((function(){Xl(r.remoteStore,t),Xf(r,t)})).catch(Ch)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},h=0,l=n,p.label=7;case 7:return h<l.length?(f=l[h],[5,c(f)]):[3,10];case 8:p.sent(),p.label=9;case 9:return h++,[3,7];case 10:return[2]}}))}))}function dp(t){var e=ts(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=$f.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ip.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=zf.bind(null,e),e.vo._r=Cf.bind(null,e.eventManager),e.vo.Mo=kf.bind(null,e.eventManager),e}function yp(t){var e=ts(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Gf.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Hf.bind(null,e),e}var gp=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return xt(this,void 0,void 0,(function(){return Rt(this,(function(e){switch(e.label){case 0:return this.R=ql(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Ko(t),[2]}}))}))},t.prototype.Uo=function(t){return null},t.prototype.Ko=function(t){return tl(this.persistence,new Jh,t.initialUser,this.R)},t.prototype.qo=function(t){return new bl(El.bs,this.R)},t.prototype.Bo=function(t){return new Rl},t.prototype.terminate=function(){return xt(this,void 0,void 0,(function(){return Rt(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),vp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qo=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Ct(e,t),e.prototype.initialize=function(e){return xt(this,void 0,void 0,(function(){var n=this;return Rt(this,(function(r){switch(r.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return r.sent(),[4,ll(this.localStore)];case 2:return r.sent(),[4,this.Qo.initialize(this,e)];case 3:return r.sent(),[4,yp(this.Qo.syncEngine)];case 4:return r.sent(),[4,hf(this.Qo.remoteStore)];case 5:return r.sent(),[4,this.persistence.He((function(){return n.gcScheduler&&!n.gcScheduler.started&&n.gcScheduler.start(n.localStore),Promise.resolve()}))];case 6:return r.sent(),[2]}}))}))},e.prototype.Ko=function(t){return tl(this.persistence,new Jh,t.initialUser,this.R)},e.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new Rh(e,t.asyncQueue)},e.prototype.qo=function(t){var e=Wh(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?gh.withCacheSize(this.cacheSizeBytes):gh.DEFAULT;return new Gh(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,Vl(),Ul(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new Rl},e}(gp),mp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Qo=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Ct(e,t),e.prototype.initialize=function(e){return xt(this,void 0,void 0,(function(){var n,r=this;return Rt(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Qo.syncEngine,this.sharedClientState instanceof xl?(this.sharedClientState.syncEngine={ui:ap.bind(null,n),ai:fp.bind(null,n),hi:pp.bind(null,n),fn:lp.bind(null,n),ci:sp.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He((function(t){return xt(r,void 0,void 0,(function(){return Rt(this,(function(e){switch(e.label){case 0:return[4,up(this.Qo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Bo=function(t){var e=Vl();if(!xl.yt(e))throw new zo(Ko.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Wh(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new xl(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(vp),bp=function(){function t(){}return t.prototype.initialize=function(t,e){return xt(this,void 0,void 0,(function(){var n=this;return Rt(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return Kf(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=rp.bind(null,this.syncEngine),[4,vf(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new Af},t.prototype.createDatastore=function(t){var e,n=ql(t.databaseInfo.databaseId),r=(e=t.databaseInfo,new Fl(e));return function(t,e,n){return new zl(t,e,n)}(t.credentials,r,n)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return Kf(s.syncEngine,t,0)},o=Ll.yt()?new Ll:new Ol,new Hl(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){var a=new Vf(t,e,n,r,i,o);return s&&(a.$o=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return xt(this,void 0,void 0,(function(){var e;return Rt(this,(function(n){switch(n.label){case 0:return e=ts(t),Qo("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,Wl(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}(),wp=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),Ep=function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return xt(this,void 0,void 0,(function(){var e,n=this;return Rt(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new zo(Ko.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return xt(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Rt(this,(function(u){switch(u.label){case 0:return n=ts(t),r=Hu(n.R)+"/documents",i={documents:e.map((function(t){return $u(n.R,t)}))},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){Zo(!!e.found),e.found.name,e.found.updateTime;var n=Ku(t,e.found.name),r=qu(e.found.updateTime),i=new Bs({mapValue:{fields:e.found.fields}});return Ks.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){Zo(!!e.missing),Zo(!!e.readTime);var n=Ku(t,e.missing),r=qu(e.readTime);return Ks.newNoDocument(n,r)}(t,e):Jo()}(n.R,t);s.set(e.key.toString(),e)})),a=[],[2,(e.forEach((function(t){var e=s.get(t.toString());Zo(!!e),a.push(e)})),a)]}}))}))}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach((function(t){return n.recordVersion(t)})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new su(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return xt(this,void 0,void 0,(function(){var t,e=this;return Rt(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=Ns.fromPath(n);e.mutations.push(new au(r,e.precondition(r)))})),[4,function(t,e){return xt(this,void 0,void 0,(function(){var n,r,i;return Rt(this,(function(o){switch(o.label){case 0:return n=ts(t),r=Hu(n.R)+"/documents",i={writes:e.map((function(t){return Yu(n.R,t)}))},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw Jo();e=as.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new zo(Ko.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?za.updateTime(e):za.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(as.min()))throw new zo(Ko.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return za.updateTime(e)}return za.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}(),Ip=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new jl(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.ec-=1,this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji((function(){return xt(t,void 0,void 0,(function(){var t,e,n=this;return Rt(this,(function(r){return t=new Ep(this.datastore),(e=this.sc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.ic(t)}))}))})).catch((function(t){n.ic(t)})),[2]}))}))}))},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!_s(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return e.nc(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!cu(e)}return!1},t}(),Tp=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=Il.UNAUTHENTICATED,this.clientId=ns.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,(function(t){return xt(r,void 0,void 0,(function(){return Rt(this,(function(e){switch(e.label){case 0:return Qo("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}}))}))}))}return t.prototype.getConfiguration=function(){return xt(this,void 0,void 0,(function(){return Rt(this,(function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}))}))},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new zo(Ko.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new Pc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return xt(t,void 0,void 0,(function(){var t,n;return Rt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Ef(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function _p(t,e){return xt(this,void 0,void 0,(function(){var n,r,i=this;return Rt(this,(function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),Qo("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener((function(t){return xt(i,void 0,void 0,(function(){return Rt(this,(function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,el(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}}))}))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function Sp(t,e){return xt(this,void 0,void 0,(function(){var n,r;return Rt(this,(function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,Ap(t)];case 1:return n=i.sent(),Qo("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener((function(t){return function(t,e){return xt(this,void 0,void 0,(function(){var n,r;return Rt(this,(function(i){switch(i.label){case 0:return(n=ts(t)).asyncQueue.verifyOperationInProgress(),Qo("RemoteStore","RemoteStore received new credentials"),r=nf(n),n.Or.add(3),[4,Wl(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,Ql(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,t)})),t.onlineComponents=e,[2]}}))}))}function Ap(t){return xt(this,void 0,void 0,(function(){return Rt(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(Qo("FirestoreClient","Using default OfflineComponentProvider"),[4,_p(t,new gp)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function Np(t){return xt(this,void 0,void 0,(function(){return Rt(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(Qo("FirestoreClient","Using default OnlineComponentProvider"),[4,Sp(t,new bp)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function Dp(t){return Ap(t).then((function(t){return t.persistence}))}function Cp(t){return Ap(t).then((function(t){return t.localStore}))}function kp(t){return Np(t).then((function(t){return t.remoteStore}))}function xp(t){return Np(t).then((function(t){return t.syncEngine}))}function Rp(t){return xt(this,void 0,void 0,(function(){var e,n;return Rt(this,(function(r){switch(r.label){case 0:return[4,Np(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=Uf.bind(null,e.syncEngine),n.onUnlisten=jf.bind(null,e.syncEngine),n)]}}))}))}function Op(t,e,n){var r=this;void 0===n&&(n={});var i=new Pc;return t.asyncQueue.enqueueAndForget((function(){return xt(r,void 0,void 0,(function(){var r;return Rt(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new wp({next:function(o){e.enqueueAndForget((function(){return Df(t,s)}));var a=o.docs.has(n);!a&&o.fromCache?i.reject(new zo(Ko.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new zo(Ko.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Rf(pa(n.path),o,{includeMetadataChanges:!0,so:!0});return Nf(t,s)},[4,Rp(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}function Lp(t,e,n){var r=this;void 0===n&&(n={});var i=new Pc;return t.asyncQueue.enqueueAndForget((function(){return xt(r,void 0,void 0,(function(){var r;return Rt(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new wp({next:function(n){e.enqueueAndForget((function(){return Df(t,s)})),n.fromCache&&"server"===r.source?i.reject(new zo(Ko.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Rf(n,o,{includeMetadataChanges:!0,so:!0});return Nf(t,s)},[4,Rp(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}var Pp=function(t,e,n,r,i,o,s,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},Mp=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Fp=new Map,Vp=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},Up=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable((function(){return e(Il.UNAUTHENTICATED)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),qp=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),jp=function(){function t(t){var e=this;this.currentUser=Il.UNAUTHENTICATED,this.oc=new Pc,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)}))};var n=function(t){Qo("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit((function(t){return n(t)})),setTimeout((function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(Qo("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}}),0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.cc!==e?(Qo("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Zo("string"==typeof n.accessToken),new Vp(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable((function(){return xt(n,void 0,void 0,(function(){return Rt(this,(function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}}))}))}))},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return Zo(null===t||"string"==typeof t),new Il(t)},t}(),Bp=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=Il.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),$p=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new Bp(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable((function(){return e(Il.FIRST_PARTY)}))},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Kp(t,e,n){if(!n)throw new zo(Ko.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function zp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new zo(Ko.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Gp(t,e,n,r){if(!0===e&&!0===r)throw new zo(Ko.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Hp(t){if(!Ns.isDocumentKey(t))throw new zo(Ko.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Qp(t){if(Ns.isDocumentKey(t))throw new zo(Ko.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Wp(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Jo()}function Yp(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new zo(Ko.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Wp(t);throw new zo(Ko.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Xp(t,e){if(e<=0)throw new zo(Ko.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Jp=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new zo(Ko.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new zo(Ko.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,Gp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),Zp=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Jp({}),this._settingsFrozen=!1,t instanceof Mp?(this._databaseId=t,this._credentials=new Up):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new zo(Ko.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Mp(t.options.projectId)}(t),this._credentials=new jp(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new zo(Ko.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new zo(Ko.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Jp(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new Up;switch(t.type){case"gapi":var e=t.client;return Zo(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new $p(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new zo(Ko.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return this,(t=Fp.get(this))&&(Qo("ComponentProvider","Removing Datastore"),Fp.delete(this),t.terminate()),Promise.resolve();var t},t}(),td=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new nd(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),ed=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),nd=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,pa(r))||this)._path=r,i.type="collection",i}return Ct(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new td(this.firestore,null,new Ns(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(ed);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function rd(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Xt(t),Kp("collection","path",e),t instanceof Zp)return Qp(n=fs.fromString.apply(fs,Pt([e],r))),new nd(t,null,n);if(!(t instanceof td||t instanceof nd))throw new zo(Ko.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Qp(n=fs.fromString.apply(fs,Pt([t.path],r)).child(fs.fromString(e))),new nd(t.firestore,null,n)}function id(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Xt(t),1===arguments.length&&(e=ns.u()),Kp("doc","path",e),t instanceof Zp)return Hp(n=fs.fromString.apply(fs,Pt([e],r))),new td(t,null,new Ns(n));if(!(t instanceof td||t instanceof nd))throw new zo(Ko.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Hp(n=t._path.child(fs.fromString.apply(fs,Pt([e],r)))),new td(t.firestore,t instanceof nd?t.converter:null,new Ns(n))}function od(t,e){return t=Xt(t),e=Xt(e),(t instanceof td||t instanceof nd)&&(e instanceof td||e instanceof nd)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function sd(t,e){return t=Xt(t),e=Xt(e),t instanceof ed&&e instanceof ed&&t.firestore===e.firestore&&Ia(t._query,e._query)&&t.converter===e.converter
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var ad=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=!1,this.Tc=[],this.Zi=new jl(this,"async_queue_retry"),this.Ic=function(){var e=Ul();e&&Qo("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=Ul();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ic)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ac(),this.Rc(t)},t.prototype.enterRestrictedMode=function(t){if(!this._c){this._c=!0,this.Ec=t||!1;var e=Ul();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Ic)}},t.prototype.enqueue=function(t){var e=this;if(this.Ac(),this._c)return new Promise((function(){}));var n=new Pc;return this.Rc((function(){return e._c&&e.Ec?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.wc.push(t),e.bc()}))},t.prototype.bc=function(){return xt(this,void 0,void 0,(function(){var t,e=this;return Rt(this,(function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!jc(t=n.sent()))throw t;return Qo("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji((function(){return e.bc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Rc=function(t){var e=this,n=this.dc.then((function(){return e.gc=!0,t().catch((function(t){throw e.yc=t,e.gc=!1,Wo("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.gc=!1,t}))}));return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ac(),this.Tc.indexOf(t)>-1&&(e=0);var i=wf.createAndSchedule(this,t,e,n,(function(t){return r.vc(t)}));return this.mc.push(i),i},t.prototype.Ac=function(){this.yc&&Jo()},t.prototype.verifyOperationInProgress=function(){},t.prototype.Pc=function(){return xt(this,void 0,void 0,(function(){var t;return Rt(this,(function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Vc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Sc=function(t){var e=this;return this.Pc().then((function(){e.mc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.Pc()}))},t.prototype.Dc=function(t){this.Tc.push(t)},t.prototype.vc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function ud(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var cd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new ad,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return Ct(e,t),e.prototype._terminate=function(){return this._firestoreClient||ld(this),this._firestoreClient.terminate()},e}(Zp);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function hd(t){return t._firestoreClient||ld(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function ld(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new Pp(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Tp(t._credentials,t._queue,r)}function fd(t,e,n){var r=this,i=new Pc;return t.asyncQueue.enqueue((function(){return xt(r,void 0,void 0,(function(){var r;return Rt(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,_p(t,n)];case 1:return o.sent(),[4,Sp(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Ko.FAILED_PRECONDITION||t.code===Ko.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function pd(t){if(t._initialized||t._terminated)throw new zo(Ko.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var dd=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new zo(Ko.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ds(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),yd=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(gs.fromBase64String(e))}catch(e){throw new zo(Ko.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(gs.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),gd=function(t){this._methodName=t},vd=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new zo(Ko.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new zo(Ko.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return rs(this._lat,t._lat)||rs(this._long,t._long)},t}(),md=/^__.*__$/,bd=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new tu(t,this.data,this.fieldMask,e,this.fieldTransforms):new Za(t,this.data,e,this.fieldTransforms)},t}(),wd=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new tu(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ed(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Jo()}}var Id=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Cc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Nc",{get:function(){return this.settings.Nc},enumerable:!1,configurable:!0}),t.prototype.xc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.kc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,Fc:!1});return r.$c(t),r},t.prototype.Oc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,Fc:!1});return r.Cc(),r},t.prototype.Mc=function(t){return this.xc({path:void 0,Fc:!0})},t.prototype.Lc=function(t){return Bd(t,this.settings.methodName,this.settings.Bc||!1,this.path,this.settings.qc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.Cc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.$c(this.path.get(t))},t.prototype.$c=function(t){if(0===t.length)throw this.Lc("Document fields must not be empty");if(Ed(this.Nc)&&md.test(t))throw this.Lc('Document fields cannot begin and end with "__"')},t}(),Td=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||ql(t)}return t.prototype.Uc=function(t,e,n,r){return void 0===r&&(r=!1),new Id({Nc:t,methodName:e,qc:n,path:ds.emptyPath(),Fc:!1,Bc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function _d(t){var e=t._freezeSettings(),n=ql(t._databaseId);return new Td(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Sd(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Uc(o.merge||o.mergeFields?2:0,e,n,i);Vd("Data must be an object, but it was:",s,r);var a,u,c=Md(r,s);if(o.merge)a=new ys(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var p=Ud(e,f[l],n);if(!s.contains(p))throw new zo(Ko.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");$d(h,p)||h.push(p)}a=new ys(h),u=s.fieldTransforms.filter((function(t){return a.covers(t.field)}))}else a=null,u=s.fieldTransforms;return new bd(new Bs(c),a,u)}var Ad=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ct(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Nc)throw 1===t.Nc?t.Lc(this._methodName+"() can only appear at the top level of your update data"):t.Lc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(gd);function Nd(t,e,n){return new Id({Nc:3,qc:e.settings.qc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var Dd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ct(e,t),e.prototype._toFieldTransform=function(t){return new $a(t.path,new Pa)},e.prototype.isEqual=function(t){return t instanceof e},e}(gd),Cd=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return Ct(e,t),e.prototype._toFieldTransform=function(t){var e=Nd(this,t,!0),n=this.Kc.map((function(t){return Pd(t,e)})),r=new Ma(n);return new $a(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(gd),kd=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return Ct(e,t),e.prototype._toFieldTransform=function(t){var e=Nd(this,t,!0),n=this.Kc.map((function(t){return Pd(t,e)})),r=new Va(n);return new $a(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(gd),xd=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Qc=n,r}return Ct(e,t),e.prototype._toFieldTransform=function(t){var e=new qa(t.R,ka(t.R,this.Qc));return new $a(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(gd);function Rd(t,e,n,r){var i=t.Uc(1,e,n);Vd("Data must be an object, but it was:",i,r);var o=[],s=Bs.empty();cs(r,(function(t,r){var a=jd(e,t,n);r=Xt(r);var u=i.Oc(a);if(r instanceof Ad)o.push(a);else{var c=Pd(r,u);null!=c&&(o.push(a),s.set(a,c))}}));var a=new ys(o);return new wd(s,a,i.fieldTransforms)}function Od(t,e,n,r,i,o){var s=t.Uc(1,e,n),a=[Ud(e,r,n)],u=[i];if(o.length%2!=0)throw new zo(Ko.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(Ud(e,o[c])),u.push(o[c+1]);for(var h=[],l=Bs.empty(),f=a.length-1;f>=0;--f)if(!$d(h,a[f])){var p=a[f],d=u[f];d=Xt(d);var y=s.Oc(p);if(d instanceof Ad)h.push(p);else{var g=Pd(d,y);null!=g&&(h.push(p),l.set(p,g))}}var v=new ys(h);return new wd(l,v,s.fieldTransforms)}function Ld(t,e,n,r){return void 0===r&&(r=!1),Pd(n,t.Uc(r?4:3,e))}function Pd(t,e){if(Fd(t=Xt(t)))return Vd("Unsupported field value:",e,t),Md(t,e);if(t instanceof gd)return function(t,e){if(!Ed(e.Nc))throw e.Lc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Lc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&4!==e.Nc)throw e.Lc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Pd(o[i],e.Mc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=Xt(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ka(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ss.fromDate(t);return{timestampValue:Fu(e.R,n)}}if(t instanceof ss)return n=new ss(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Fu(e.R,n)};if(t instanceof vd)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof yd)return{bytesValue:Vu(e.R,t._byteString)};if(t instanceof td){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Lc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:ju(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Lc("Unsupported field value: "+Wp(t))}(t,e)}function Md(t,e){var n={};return hs(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):cs(t,(function(t,r){var i=Pd(r,e.kc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Fd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ss||t instanceof vd||t instanceof yd||t instanceof td||t instanceof gd)}function Vd(t,e,n){if(!Fd(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Wp(n);throw"an object"===r?e.Lc(t+" a custom object"):e.Lc(t+" "+r)}}function Ud(t,e,n){if((e=Xt(e))instanceof dd)return e._internalPath;if("string"==typeof e)return jd(t,e);throw Bd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var qd=new RegExp("[~\\*/\\[\\]]");function jd(t,e,n){if(e.search(qd)>=0)throw Bd("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(dd.bind.apply(dd,Pt([void 0],e.split(".")))))._internalPath}catch(r){throw Bd("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Bd(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new zo(Ko.INVALID_ARGUMENT,(a+=". ")+t+u)}function $d(t,e){return t.some((function(t){return t.isEqual(e)}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Kd=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new td(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new zd(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(Gd("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),zd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ct(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Kd);function Gd(t,e){return"string"==typeof e?jd(t,e):e instanceof dd?e._internalPath:e._delegate._internalPath}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Hd=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Qd=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return Ct(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new Wd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(Gd("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(Kd),Wd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ct(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Qd),Yd=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new Hd(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new Wd(n._firestore,n._userDataWriter,r.key,r,new Hd(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new zo(Ko.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){return{type:"added",doc:new Wd(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Hd(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new Wd(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Hd(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Xd(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function Xd(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Jo()}}function Jd(t,e){return t instanceof Qd&&e instanceof Qd?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Yd&&e instanceof Yd&&t._firestore===e._firestore&&sd(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Zd(t){if(ya(t)&&0===t.explicitOrderBy.length)throw new zo(Ko.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ty=function(){};function ey(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var ny=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).jc=e,i.Wc=n,i.Gc=r,i.type="where",i}return Ct(e,t),e.prototype._apply=function(t){var e=_d(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new zo(Ko.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){cy(s,o);for(var u=[],c=0,h=s;c<h.length;c++){var l=h[c];u.push(uy(r,t,l))}a={arrayValue:{values:u}}}else a=uy(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||cy(s,o),a=Ld(n,"where",s,"in"===o||"not-in"===o);var f=Ys.create(i,o,a);return function(t,e){if(e.g()){var n=va(t);if(null!==n&&!n.isEqual(e.field))throw new zo(Ko.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=ga(t);null!==r&&hy(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new zo(Ko.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new zo(Ko.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t._query,0,e,t.firestore._databaseId,this.jc,this.Wc,this.Gc);return new ed(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new la(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(ty),ry=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).jc=e,r.zc=n,r.type="orderBy",r}return Ct(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new zo(Ko.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new zo(Ko.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new aa(e,n);return function(t,e){if(null===ga(t)){var n=va(t);null!==n&&hy(t,n,e.field)}}(t,r),r}(t._query,this.jc,this.zc);return new ed(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new la(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(ty),iy=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Hc=n,i.Jc=r,i}return Ct(e,t),e.prototype._apply=function(t){return new ed(t.firestore,t.converter,Ea(t._query,this.Hc,this.Jc))},e}(ty),oy=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return Ct(e,t),e.prototype._apply=function(t){var e=ay(t,this.type,this.Yc,this.Xc);return new ed(t.firestore,t.converter,function(t,e){return new la(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(ty),sy=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return Ct(e,t),e.prototype._apply=function(t){var e=ay(t,this.type,this.Yc,this.Xc);return new ed(t.firestore,t.converter,function(t,e){return new la(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(ty);function ay(t,e,n,r){if(n[0]=Xt(n[0]),n[0]instanceof Kd)return function(t,e,n,r,i){if(!r)throw new zo(Ko.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=ba(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(Ps(e,r.key));else{var c=r.data.field(u.field);if(Es(c))throw new zo(Ko.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.canonicalString();throw new zo(Ko.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new oa(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=_d(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new zo(Ko.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new zo(Ko.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!ma(t)&&-1!==c.indexOf("/"))throw new zo(Ko.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(fs.fromString(c));if(!Ns.isDocumentKey(h))throw new zo(Ko.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new Ns(h);a.push(Ps(e,l))}else{var f=Ld(n,r,c);a.push(f)}}return new oa(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function uy(t,e,n){if("string"==typeof(n=Xt(n))){if(""===n)throw new zo(Ko.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ma(e)&&-1!==n.indexOf("/"))throw new zo(Ko.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(fs.fromString(n));if(!Ns.isDocumentKey(r))throw new zo(Ko.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Ps(t,new Ns(r))}if(n instanceof td)return Ps(t,n._key);throw new zo(Ko.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Wp(n)+".")}function cy(t,e){if(!Array.isArray(t)||0===t.length)throw new zo(Ko.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new zo(Ko.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function hy(t,e,n){if(!n.isEqual(e))throw new zo(Ko.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ly=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),Ds(t)){case 0:return null;case 1:return t.booleanValue;case 2:return bs(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(ws(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Jo()}},t.prototype.convertObject=function(t,e){var n=this,r={};return cs(t.fields,(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new vd(bs(t.latitude),bs(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=Is(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Ts(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=ms(t);return new ss(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=fs.fromString(t);Zo(lc(n));var r=new Mp(n.get(1),n.get(3)),i=new Ns(n.popFirst(5));return r.isEqual(e)||Wo("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function fy(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var py=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Ct(e,t),e.prototype.convertBytes=function(t){return new yd(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new td(this.firestore,null,e)},e}(ly),dy=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=_d(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=yy(t,this._firestore),i=fy(r.converter,e,n),o=Sd(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,za.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=yy(t,this._firestore);return o="string"==typeof(e=Xt(e))||e instanceof dd?Od(this._dataReader,"WriteBatch.update",s._key,e,n,r):Rd(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,za.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=yy(t,this._firestore);return this._mutations=this._mutations.concat(new su(e._key,za.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new zo(Ko.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function yy(t,e){if((t=Xt(t)).firestore!==e)throw new zo(Ko.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var gy=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Ct(e,t),e.prototype.convertBytes=function(t){return new yd(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new td(this.firestore,null,e)},e}(ly);function vy(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Yp(t,td);var o=Yp(t.firestore,cd),s=_d(o);return by(o,[("string"==typeof(e=Xt(e))||e instanceof dd?Od(s,"updateDoc",t._key,e,n,r):Rd(s,"updateDoc",t._key,e)).toMutation(t._key,za.exists(!0))])}function my(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=Xt(t);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||ud(i[a])||(s=i[a],a++);var u,c,h,l={includeMetadataChanges:s.includeMetadataChanges};if(ud(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof td)c=Yp(t.firestore,cd),h=pa(t._key.path),u={next:function(e){i[a]&&i[a](wy(c,t,e))},error:i[a+1],complete:i[a+2]};else{var p=Yp(t,ed);c=Yp(p.firestore,cd),h=p._query;var d=new gy(c);u={next:function(t){i[a]&&i[a](new Yd(c,d,p,t))},error:i[a+1],complete:i[a+2]},Zd(t._query)}return function(t,e,n,r){var i=this,o=new wp(r),s=new Rf(e,o,n);return t.asyncQueue.enqueueAndForget((function(){return xt(i,void 0,void 0,(function(){var e;return Rt(this,(function(n){switch(n.label){case 0:return e=Nf,[4,Rp(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))})),function(){o.Wo(),t.asyncQueue.enqueueAndForget((function(){return xt(i,void 0,void 0,(function(){var e;return Rt(this,(function(n){switch(n.label){case 0:return e=Df,[4,Rp(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))}))}}(hd(c),h,l,u)}function by(t,e){return function(t,e){var n=this,r=new Pc;return t.asyncQueue.enqueueAndForget((function(){return xt(n,void 0,void 0,(function(){var n;return Rt(this,(function(i){switch(i.label){case 0:return n=Bf,[4,xp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(hd(t),e)}function wy(t,e,n){var r=n.docs.get(e._key),i=new gy(t);return new Qd(t,i,e._key,r,new Hd(n.hasPendingWrites,n.fromCache),e.converter)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ey=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return Ct(e,t),e.prototype.get=function(e){var n=this,r=yy(e,this._firestore),i=new gy(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new Qd(n._firestore,i,r._key,t._document,new Hd(!1,!1),r.converter)}))},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=_d(t)}return t.prototype.get=function(t){var e=this,n=yy(t,this._firestore),r=new py(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return Jo();var i=t[0];if(i.isFoundDocument())return new Kd(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new Kd(e._firestore,r,n._key,null,n.converter);throw Jo()}))},t.prototype.set=function(t,e,n){var r=yy(t,this._firestore),i=fy(r.converter,e,n),o=Sd(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=yy(t,this._firestore);return o="string"==typeof(e=Xt(e))||e instanceof dd?Od(this._dataReader,"Transaction.update",s._key,e,n,r):Rd(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=yy(t,this._firestore);return this._transaction.delete(e._key),this},t}());
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Iy(){if("undefined"==typeof Uint8Array)throw new zo(Ko.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ty(){if("undefined"==typeof atob)throw new zo(Ko.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var _y=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return Ty(),new t(yd.fromBase64String(e))},t.fromUint8Array=function(e){return Iy(),new t(yd.fromUint8Array(e))},t.prototype.toBase64=function(){return Ty(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return Iy(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),Sy=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){pd(t=Yp(t,cd));var n=hd(t),r=t._freezeSettings(),i=new bp;return fd(n,i,new vp(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){pd(t=Yp(t,cd));var e=hd(t),n=t._freezeSettings(),r=new bp;return fd(e,r,new mp(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new zo(Ko.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Pc;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return xt(e,void 0,void 0,(function(){var e;return Rt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return xt(this,void 0,void 0,(function(){var e;return Rt(this,(function(n){switch(n.label){case 0:return Vc.yt()?(e=t+"main",[4,Vc.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(Wh(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),Ay=function(){function t(t,e,n){var r=this;this._delegate=e,this.Zc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof Mp||(this.tu=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||Yo("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){var i;void 0===r&&(r={});var o=(t=Yp(t,Zp))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==e&&Yo("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},o),{host:e+":"+n,ssl:!1})),r.mockUserToken){var s,a;if("string"==typeof r.mockUserToken)s=r.mockUserToken,a=Il.MOCK_USER;else{s=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var o=kt({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Vt(JSON.stringify({alg:"none",type:"JWT"})),Vt(JSON.stringify(o)),""].join(".")}(r.mockUserToken,null===(i=t._app)||void 0===i?void 0:i.options.projectId);var u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new zo(Ko.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new Il(u)}t._credentials=new qp(new Vp(s,a))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return xt(e,void 0,void 0,(function(){var e,n;return Rt(this,(function(r){switch(r.label){case 0:return[4,Dp(t)];case 1:return e=r.sent(),[4,kp(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=ts(t);return e.Or.delete(0),Ql(e)}(n))]}}))}))}))}(hd(Yp(this._delegate,cd)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return xt(e,void 0,void 0,(function(){var e,n;return Rt(this,(function(r){switch(r.label){case 0:return[4,Dp(t)];case 1:return e=r.sent(),[4,kp(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return xt(this,void 0,void 0,(function(){var e;return Rt(this,(function(n){switch(n.label){case 0:return(e=ts(t)).Or.add(0),[4,Wl(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(hd(Yp(this._delegate,cd)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Gp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Zc.enableMultiTabIndexedDbPersistence(this):this.Zc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Zc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.tu&&(this.tu._removeServiceInstance("firestore"),this.tu._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Pc;return t.asyncQueue.enqueueAndForget((function(){return xt(e,void 0,void 0,(function(){var e;return Rt(this,(function(r){switch(r.label){case 0:return e=Qf,[4,xp(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(hd(Yp(this._delegate,cd)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new wp(e);return t.asyncQueue.enqueueAndForget((function(){return xt(n,void 0,void 0,(function(){var e;return Rt(this,(function(n){switch(n.label){case 0:return e=function(t,e){ts(t).Gr.add(e),e.next()},[4,Rp(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Wo(),t.asyncQueue.enqueueAndForget((function(){return xt(n,void 0,void 0,(function(){var e;return Rt(this,(function(n){switch(n.label){case 0:return e=function(t,e){ts(t).Gr.delete(e)},[4,Rp(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(hd(t=Yp(t,cd)),ud(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.tu)throw new zo(Ko.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.tu},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new qy(this,rd(this._delegate,t))}catch(t){throw Ry(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new xy(this,id(this._delegate,t))}catch(t){throw Ry(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new Fy(this,function(t,e){if(t=Yp(t,Zp),Kp("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new zo(Ko.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new ed(t,null,function(t){return new la(fs.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw Ry(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Pc;return t.asyncQueue.enqueueAndForget((function(){return xt(n,void 0,void 0,(function(){var n;return Rt(this,(function(i){switch(i.label){case 0:return[4,function(t){return Np(t).then((function(t){return t.datastore}))}(t)];case 1:return n=i.sent(),new Ip(t.asyncQueue,n,e,r).run(),[2]}}))}))})),r.promise}(hd(t),(function(n){return e(new Ey(t,n))}))}(this._delegate,(function(n){return t(new Dy(e,n))}))},t.prototype.batch=function(){var t=this;return hd(this._delegate),new Cy(new dy(this._delegate,(function(e){return by(t._delegate,e)})))},t.prototype.loadBundle=function(t){throw new zo(Ko.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new zo(Ko.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),Ny=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return Ct(e,t),e.prototype.convertBytes=function(t){return new _y(new yd(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return xy.eu(e,this.firestore,null)},e}(ly);var Dy=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Ny(t)}return t.prototype.get=function(t){var e=this,n=jy(t);return this._delegate.get(n).then((function(t){return new Py(e._firestore,new Qd(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))}))},t.prototype.set=function(t,e,n){var r=jy(t);return n?(zp("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=jy(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Pt([s,e,n],i)),this},t.prototype.delete=function(t){var e=jy(t);return this._delegate.delete(e),this},t}(),Cy=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=jy(t);return n?(zp("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=jy(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Pt([s,e,n],i)),this},t.prototype.delete=function(t){var e=jy(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),ky=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new Wd(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new My(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.nu=function(e,n){var r=t.su,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new Ny(e),n),i.set(n,o)),o},t}();ky.su=new WeakMap;var xy=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Ny(t)}return t.iu=function(e,n,r){if(e.length%2!=0)throw new zo(Ko.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new td(n._delegate,r,new Ns(e)))},t.eu=function(e,n,r){return new t(n,new td(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new qy(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new qy(this.firestore,rd(this._delegate,t))}catch(t){throw Ry(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=Xt(t))instanceof td&&od(this._delegate,t)},t.prototype.set=function(t,e){e=zp("DocumentReference.set",e);try{return function(t,e,n){t=Yp(t,td);var r=Yp(t.firestore,cd),i=fy(t.converter,e,n);return by(r,[Sd(_d(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,za.none())])}(this._delegate,t,e)}catch(t){throw Ry(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?vy(this._delegate,t):vy.apply(void 0,Pt([this._delegate,t,e],n))}catch(t){throw Ry(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return by(Yp((t=this._delegate).firestore,cd),[new su(t._key,za.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Oy(e),i=Ly(e,(function(e){return new Py(t.firestore,new Qd(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}));return my(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Yp(t,td);var e=Yp(t.firestore,cd),n=hd(e),r=new gy(e);return function(t,e){var n=this,r=new Pc;return t.asyncQueue.enqueueAndForget((function(){return xt(n,void 0,void 0,(function(){var n;return Rt(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return xt(this,void 0,void 0,(function(){var r,i;return Rt(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=ts(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Mn.mn(t,e)}))}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new zo(Ko.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=Ef(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,Cp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._key).then((function(n){return new Qd(e,r,t._key,n,new Hd(null!==n&&n.hasLocalMutations,!0),t.converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Yp(t,td);var e=Yp(t.firestore,cd);return Op(hd(e),t._key,{source:"server"}).then((function(n){return wy(e,t,n)}))}(this._delegate):function(t){t=Yp(t,td);var e=Yp(t.firestore,cd);return Op(hd(e),t._key).then((function(n){return wy(e,t,n)}))}(this._delegate)).then((function(t){return new Py(e.firestore,new Qd(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}))},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(ky.nu(this.firestore,e)):this._delegate.withConverter(null))},t}();function Ry(t,e,n){return t.message=t.message.replace(e,n),t}function Oy(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!ud(r))return r}return{}}function Ly(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=ud(t[0])?t[0]:ud(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Py=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new xy(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return Jd(this._delegate,t._delegate)},t}(),My=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ct(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(Py),Fy=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Ny(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,ey(this._delegate,function(t,e,n){var r=e,i=Gd("where",t);return new ny(i,r,n)}(e,n,r)))}catch(e){throw Ry(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,ey(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=Gd("orderBy",t);return new ry(r,n)}(e,n)))}catch(e){throw Ry(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,ey(this._delegate,function(t){return Xp("limit",t),new iy("limit",t,"F")}(e)))}catch(e){throw Ry(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,ey(this._delegate,function(t){return Xp("limitToLast",t),new iy("limitToLast",t,"L")}(e)))}catch(e){throw Ry(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,ey(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new oy("startAt",t,!0)}.apply(void 0,e)))}catch(e){throw Ry(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,ey(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new oy("startAfter",t,!1)}.apply(void 0,e)))}catch(e){throw Ry(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,ey(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new sy("endBefore",t,!0)}.apply(void 0,e)))}catch(e){throw Ry(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,ey(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new sy("endAt",t,!1)}.apply(void 0,e)))}catch(e){throw Ry(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return sd(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Yp(t,ed);var e=Yp(t.firestore,cd),n=hd(e),r=new gy(e);return function(t,e){var n=this,r=new Pc;return t.asyncQueue.enqueueAndForget((function(){return xt(n,void 0,void 0,(function(){var n;return Rt(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return xt(this,void 0,void 0,(function(){var r,i,o,s,a;return Rt(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,ul(t,e,!0)];case 1:return a=u.sent(),r=new Pf(e,a.Bn),i=r._o(a.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=u.sent(),a=Ef(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}}))}))},[4,Cp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._query).then((function(n){return new Yd(e,r,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Yp(t,ed);var e=Yp(t.firestore,cd),n=hd(e),r=new gy(e);return Lp(n,t._query,{source:"server"}).then((function(n){return new Yd(e,r,t,n)}))}(this._delegate):function(t){t=Yp(t,ed);var e=Yp(t.firestore,cd),n=hd(e),r=new gy(e);return Zd(t._query),Lp(n,t._query).then((function(n){return new Yd(e,r,t,n)}))}(this._delegate)).then((function(t){return new Uy(e.firestore,new Yd(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Oy(e),i=Ly(e,(function(e){return new Uy(t.firestore,new Yd(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return my(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(ky.nu(this.firestore,e)):this._delegate.withConverter(null))},t}(),Vy=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new My(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),Uy=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new Fy(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new My(t._firestore,e)}))},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new Vy(e._firestore,t)}))},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new My(n._firestore,r))}))},t.prototype.isEqual=function(t){return Jd(this._delegate,t._delegate)},t}(),qy=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return Ct(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new xy(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new xy(this.firestore,void 0===t?id(this._delegate):id(this._delegate,t))}catch(t){throw Ry(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Yp(t.firestore,cd),r=id(t),i=fy(t.converter,e);return by(n,[Sd(_d(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,za.exists(!1))]).then((function(){return r}))}(this._delegate,t).then((function(t){return new xy(e.firestore,t)}))},e.prototype.isEqual=function(t){return od(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(ky.nu(this.firestore,t)):this._delegate.withConverter(null))},e}(Fy);function jy(t){return Yp(t,td)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var By,$y=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(dd.bind.apply(dd,Pt([void 0],t)))}return t.documentId=function(){return new t(ds.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=Xt(t))instanceof dd&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),Ky=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new Dd("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new Ad("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Cd("arrayUnion",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new kd("arrayRemove",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new xd("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),zy={Firestore:Ay,GeoPoint:vd,Timestamp:ss,Blob:_y,Transaction:Dy,WriteBatch:Cy,DocumentReference:xy,DocumentSnapshot:Py,Query:Fy,QueryDocumentSnapshot:My,QuerySnapshot:Uy,CollectionReference:qy,FieldPath:$y,FieldValue:Ky,setLogLevel:function(t){var e;e=t,Go.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new Jt("firestore",(function(t){return function(t,e){return new Ay(t,new cd(t,e),new Sy)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},zy)))})(By=Ae),By.registerVersion("@firebase/firestore","2.4.0");Ae.initializeApp({projectId:"sample-project-294713"});const Gy=function(){const t=window.location.search;let e;if(t)e=t.substring(1);else{const t=Nt();window.location.hash=t,window.history.replaceState("","","?"+t),e=t}return e}(),Hy=Ae.firestore().collection("rooms").doc(Gy),Qy=function(){const{subscribe:t,set:e}=bt([]);return{subscribe:t,set:e,append:(t,e)=>{Hy.get().then((n=>{let r=[],i={closed:!0};if(n&&n.exists){const e=n.data();r=[...e.estimates.filter((e=>e.name!==t))],i=e.tableState}r.push({name:t,point:e,appendedAt:Ae.firestore.Timestamp.now()}),Hy.set({estimates:r,tableState:i})}))},remove:(t,e=null)=>{Hy.get().then((n=>{if(n&&n.exists){const r=n.data();r.estimates=r.estimates.filter((e=>e.name!==t)),Hy.set(r).then(e)}else e()}))},clear:()=>{Hy.delete()}}}(),Wy=function(){const{subscribe:t,set:e,update:n}=bt({closed:!0});return{subscribe:t,set:e,open:()=>{Hy.get().then((t=>{if(t&&t.exists){const e=t.data();e.tableState={closed:!1},Hy.set(e)}}))},close:()=>{Hy.delete()}}}(),Yy=new Promise((t=>{Hy.onSnapshot((t=>{if(t&&t.exists){const e=t.data(),n=(t,e)=>t.appendedAt.seconds-e.appendedAt.seconds;Qy.set(e.estimates.sort(n)),Wy.set(e.tableState)}else Qy.set([]),Wy.set({closed:!0})})),t()}));function Xy(e){let n,r,i,o,s=(e[2]?"":e[0])+"";return{c(){n=I("div"),r=T(s),N(n,"class","card svelte-tq9sw8"),x(n,"closed",e[2]),x(n,"selected",e[1])},m(t,s){w(t,n,s),v(n,r),i||(o=S(n,"click",e[3]),i=!0)},p(t,[e]){5&e&&s!==(s=(t[2]?"":t[0])+"")&&D(r,s),4&e&&x(n,"closed",t[2]),2&e&&x(n,"selected",t[1])},i:t,o:t,d(t){t&&E(n),i=!1,o()}}}function Jy(t,e,n){let{point:r}=e,{selected:i=!1}=e,{closed:o=!1}=e;const s=function(){const t=U();return(e,n)=>{const r=t.$$.callbacks[e];if(r){const i=R(e,n);r.slice().forEach((e=>{e.call(t,i)}))}}}();return t.$$set=t=>{"point"in t&&n(0,r=t.point),"selected"in t&&n(1,i=t.selected),"closed"in t&&n(2,o=t.closed)},[r,i,o,function(){s("selectCard",{point:r})}]}class Zy extends yt{constructor(t){super(),dt(this,t,Jy,Xy,a,{point:0,selected:1,closed:2})}}function tg(t){let e,n,r,i,o;const s=t[3].default,a=function(t,e,n,r){if(t){const i=c(t,e,n,r);return t[0](i)}}(s,t,t[2],null);return{c(){e=I("button"),a&&a.c(),N(e,"class",n=l(t[1].class)+" svelte-xozke3"),e.disabled=t[0]},m(n,s){w(n,e,s),a&&a.m(e,null),r=!0,i||(o=S(e,"click",t[4]),i=!0)},p(t,[i]){a&&a.p&&(!r||4&i)&&function(t,e,n,r,i,o){if(i){const s=c(e,n,r,o);t.p(s,i)}}(a,s,t,t[2],r?function(t,e,n,r){if(t[2]&&r){const i=t[2](r(n));if(void 0===e.dirty)return i;if("object"==typeof i){const t=[],n=Math.max(e.dirty.length,i.length);for(let r=0;r<n;r+=1)t[r]=e.dirty[r]|i[r];return t}return e.dirty|i}return e.dirty}(s,t[2],i,null):function(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}(t[2]),null),(!r||2&i&&n!==(n=l(t[1].class)+" svelte-xozke3"))&&N(e,"class",n),(!r||1&i)&&(e.disabled=t[0])},i(t){r||(it(a,t),r=!0)},o(t){ot(a,t),r=!1},d(t){t&&E(e),a&&a.d(t),i=!1,o()}}}function eg(t,e,r){let{$$slots:i={},$$scope:o}=e,{disabled:s=!1}=e;return t.$$set=t=>{r(1,e=n(n({},e),h(t))),"disabled"in t&&r(0,s=t.disabled),"$$scope"in t&&r(2,o=t.$$scope)},e=h(e),[s,e,o,i,function(e){q.call(this,t,e)}]}class ng extends yt{constructor(t){super(),dt(this,t,eg,tg,a,{disabled:0})}}function rg(t,e,n){const r=t.slice();return r[6]=e[n],r}function ig(t,e){let n,r,i,o,s,a,u,c,h=e[6].name+"";return r=new Zy({props:{point:e[6].point,closed:e[2].closed}}),{key:t,first:null,c(){n=I("div"),ht(r.$$.fragment),i=_(),o=I("div"),s=T(h),a=_(),N(o,"class","name svelte-1nazvb7"),N(n,"class","estimate svelte-1nazvb7"),this.first=n},m(t,e){w(t,n,e),lt(r,n,null),v(n,i),v(n,o),v(o,s),v(n,a),c=!0},p(t,n){e=t;const i={};2&n&&(i.point=e[6].point),4&n&&(i.closed=e[2].closed),r.$set(i),(!c||2&n)&&h!==(h=e[6].name+"")&&D(s,h)},i(t){c||(it(r.$$.fragment,t),H((()=>{u||(u=at(n,vt,{y:100},!0)),u.run(1)})),c=!0)},o(t){ot(r.$$.fragment,t),u||(u=at(n,vt,{y:100},!1)),u.run(0),c=!1},d(t){t&&E(n),ft(r),t&&u&&u.end()}}}function og(t){let e,n,r;return n=new ng({props:{class:"open-button",$$slots:{default:[sg]},$$scope:{ctx:t}}}),n.$on("click",t[3]),{c(){e=I("div"),ht(n.$$.fragment),N(e,"class","open-button-area svelte-1nazvb7")},m(t,i){w(t,e,i),lt(n,e,null),r=!0},p(t,e){const r={};516&e&&(r.$$scope={dirty:e,ctx:t}),n.$set(r)},i(t){r||(it(n.$$.fragment,t),r=!0)},o(t){ot(n.$$.fragment,t),r=!1},d(t){t&&E(e),ft(n)}}}function sg(t){let e,n=t[2].closed?"OPEN":"RETURN";return{c(){e=T(n)},m(t,n){w(t,e,n)},p(t,r){4&r&&n!==(n=t[2].closed?"OPEN":"RETURN")&&D(e,n)},d(t){t&&E(e)}}}function ag(t){let e,n;return e=new ng({props:{class:"copy-button",$$slots:{default:[ug]},$$scope:{ctx:t}}}),e.$on("click",t[4]),{c(){ht(e.$$.fragment)},m(t,r){lt(e,t,r),n=!0},p(t,n){const r={};513&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(it(e.$$.fragment,t),n=!0)},o(t){ot(e.$$.fragment,t),n=!1},d(t){ft(e,t)}}}function ug(t){let e;return{c(){e=T(t[0])},m(t,n){w(t,e,n)},p(t,n){1&n&&D(e,t[0])},d(t){t&&E(e)}}}function cg(t){let e,n,r,i,o,s=[],a=new Map,u=t[1];const c=t=>t[6].name;for(let e=0;e<u.length;e+=1){let n=rg(t,u,e),r=c(n);a.set(r,s[e]=ig(r,n))}let h=(t[1].length>0||!t[2].closed)&&og(t),l=!t[2].closed&&ag(t);return{c(){e=I("div"),n=I("div");for(let t=0;t<s.length;t+=1)s[t].c();r=_(),h&&h.c(),i=_(),l&&l.c(),N(n,"class","estimates svelte-1nazvb7"),N(e,"class","table svelte-1nazvb7")},m(t,a){w(t,e,a),v(e,n);for(let t=0;t<s.length;t+=1)s[t].m(n,null);v(e,r),h&&h.m(e,null),v(e,i),l&&l.m(e,null),o=!0},p(t,[r]){6&r&&(u=t[1],nt(),s=function(t,e,n,r,i,o,s,a,u,c,h,l){let f=t.length,p=o.length,d=f;const y={};for(;d--;)y[t[d].key]=d;const g=[],v=new Map,m=new Map;for(d=p;d--;){const t=l(i,o,d),a=n(t);let u=s.get(a);u?r&&u.p(t,e):(u=c(a,t),u.c()),v.set(a,g[d]=u),a in y&&m.set(a,Math.abs(d-y[a]))}const b=new Set,w=new Set;function E(t){it(t,1),t.m(a,h),s.set(t.key,t),h=t.first,p--}for(;f&&p;){const e=g[p-1],n=t[f-1],r=e.key,i=n.key;e===n?(h=e.first,f--,p--):v.has(i)?!s.has(r)||b.has(r)?E(e):w.has(i)?f--:m.get(r)>m.get(i)?(w.add(r),E(e)):(b.add(i),f--):(u(n,s),f--)}for(;f--;){const e=t[f];v.has(e.key)||u(e,s)}for(;p;)E(g[p-1]);return g}(s,r,c,1,t,u,a,n,ct,ig,null,rg),rt()),t[1].length>0||!t[2].closed?h?(h.p(t,r),6&r&&it(h,1)):(h=og(t),h.c(),it(h,1),h.m(e,i)):h&&(nt(),ot(h,1,1,(()=>{h=null})),rt()),t[2].closed?l&&(nt(),ot(l,1,1,(()=>{l=null})),rt()):l?(l.p(t,r),4&r&&it(l,1)):(l=ag(t),l.c(),it(l,1),l.m(e,null))},i(t){if(!o){for(let t=0;t<u.length;t+=1)it(s[t]);it(h),it(l),o=!0}},o(t){for(let t=0;t<s.length;t+=1)ot(s[t]);ot(h),ot(l),o=!1},d(t){t&&E(e);for(let t=0;t<s.length;t+=1)s[t].d();h&&h.d(),l&&l.d()}}}function hg(t,e,n){let r,i;u(t,Qy,(t=>n(1,r=t))),u(t,Wy,(t=>n(2,i=t)));let o="COPY";return[o,r,i,function(t){i.closed?r.length>0&&Wy.open():(Qy.clear(),Wy.close())},function(t){const e=function(){if(0===r.length)return"empty.";const t=new Date;return"["+t.toLocaleDateString()+" "+t.toLocaleTimeString()+"] "+r.sort(((t,e)=>t.name>e.name?1:-1)).reduce(((t,e)=>(t?t+" ":"")+`${e.name}(${e.point})`),null)}();navigator.clipboard.writeText(e),t.target.classList.add("copied"),t.target.disabled=!0;const i=o;n(0,o="COPIED!"),setTimeout((()=>{t.target.classList.remove("copied"),t.target.disabled=!1,n(0,o=i)}),2e3)}]}class lg extends yt{constructor(t){super(),dt(this,t,hg,cg,a,{})}}function fg(t,e,n){const r=t.slice();return r[8]=e[n],r}function pg(t){let e,n,r,i,s,a,u,c=t[1]&&yg(t);return{c(){e=I("div"),n=I("form"),r=I("input"),i=_(),c&&c.c(),N(r,"placeholder","your name"),r.autofocus=!0,N(r,"class","svelte-1pf8moc"),N(e,"class","user-name svelte-1pf8moc")},m(o,h){w(o,e,h),v(e,n),v(n,r),C(r,t[1]),v(n,i),c&&c.m(n,null),s=!0,r.focus(),a||(u=[S(r,"input",t[7]),S(n,"submit",A(t[4]))],a=!0)},p(t,e){2&e&&r.value!==t[1]&&C(r,t[1]),t[1]?c?(c.p(t,e),2&e&&it(c,1)):(c=yg(t),c.c(),it(c,1),c.m(n,null)):c&&(nt(),ot(c,1,1,(()=>{c=null})),rt())},i(t){s||(it(c),s=!0)},o(t){ot(c),s=!1},d(t){t&&E(e),c&&c.d(),a=!1,o(u)}}}function dg(t){let e,n,r,i,o,s=t[3],a=[];for(let e=0;e<s.length;e+=1)a[e]=vg(fg(t,s,e));const u=t=>ot(a[t],1,1,(()=>{a[t]=null}));return{c(){e=I("div"),n=T(t[0]),r=_();for(let t=0;t<a.length;t+=1)a[t].c();i=T(""),N(e,"class","user-name svelte-1pf8moc")},m(t,s){w(t,e,s),v(e,n),w(t,r,s);for(let e=0;e<a.length;e+=1)a[e].m(t,s);w(t,i,s),o=!0},p(t,e){if((!o||1&e)&&D(n,t[0]),44&e){let n;for(s=t[3],n=0;n<s.length;n+=1){const r=fg(t,s,n);a[n]?(a[n].p(r,e),it(a[n],1)):(a[n]=vg(r),a[n].c(),it(a[n],1),a[n].m(i.parentNode,i))}for(nt(),n=s.length;n<a.length;n+=1)u(n);rt()}},i(t){if(!o){for(let t=0;t<s.length;t+=1)it(a[t]);o=!0}},o(t){a=a.filter(Boolean);for(let t=0;t<a.length;t+=1)ot(a[t]);o=!1},d(t){t&&E(e),t&&E(r),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(a,t),t&&E(i)}}}function yg(t){let e,n;return e=new ng({props:{class:"ok-button",$$slots:{default:[gg]},$$scope:{ctx:t}}}),e.$on("click",t[4]),{c(){ht(e.$$.fragment)},m(t,r){lt(e,t,r),n=!0},p(t,n){const r={};2048&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(it(e.$$.fragment,t),n=!0)},o(t){ot(e.$$.fragment,t),n=!1},d(t){ft(e,t)}}}function gg(t){let e;return{c(){e=T("OK")},m(t,n){w(t,e,n)},d(t){t&&E(e)}}}function vg(t){let e,n;return e=new Zy({props:{point:t[8],selected:t[2]===t[8]}}),e.$on("selectCard",t[5]),{c(){ht(e.$$.fragment)},m(t,r){lt(e,t,r),n=!0},p(t,n){const r={};4&n&&(r.selected=t[2]===t[8]),e.$set(r)},i(t){n||(it(e.$$.fragment,t),n=!0)},o(t){ot(e.$$.fragment,t),n=!1},d(t){ft(e,t)}}}function mg(t){let e,n,r,i;const o=[dg,pg],s=[];function a(t,e){return t[0]?0:1}return n=a(t),r=s[n]=o[n](t),{c(){e=I("div"),r.c(),N(e,"class","svelte-1pf8moc")},m(t,r){w(t,e,r),s[n].m(e,null),i=!0},p(t,[i]){let u=n;n=a(t),n===u?s[n].p(t,i):(nt(),ot(s[u],1,1,(()=>{s[u]=null})),rt(),r=s[n],r?r.p(t,i):(r=s[n]=o[n](t),r.c()),it(r,1),r.m(e,null))},i(t){i||(it(r),i=!0)},o(t){ot(r),i=!1},d(t){t&&E(e),s[n].d()}}}function bg(t,e,n){let r,i;u(t,Qy,(t=>n(6,i=t)));let o,s=window.localStorage.name;return t.$$.update=()=>{65&t.$$.dirty&&n(2,r=i.filter((t=>t.name===o)).map((t=>t.point)).pop())},[o,s,r,["0","1","2","3","5","8","13","21","34","55","?","∞"],function(t){s&&(n(0,o=s),window.localStorage.setItem("name",o))},function(t){const e=()=>Qy.append(o,t.detail.point);r?Qy.remove(o,r===t.detail.point?null:()=>setTimeout(e,300)):e()},i,function(){s=this.value,n(1,s)}]}class wg extends yt{constructor(t){super(),dt(this,t,bg,mg,a,{})}}function Eg(e){let n;return{c(){n=I("div"),n.innerHTML='<a href="https://unsplash.com" target="_blank" rel="noopener noreferrer" title="Photo by Unsplash"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="_1Jlgk" version="1.1" viewBox="0 0 32 32" aria-labelledby="unsplash-home" aria-hidden="false"><path d="M10 9V0h12v9H10zm12 5h10v18H0V14h10v9h12v-9z"></path></svg></a>',N(n,"class","unsplash-credit svelte-1vmngv8")},m(t,e){w(t,n,e)},p:t,i:t,o:t,d(t){t&&E(n)}}}class Ig extends yt{constructor(t){super(),dt(this,t,null,Eg,a,{})}}const{document:Tg}=ut;function _g(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function Sg(t){let e,n,r,i,o,s,a,u,c;return s=new lg({}),u=new wg({}),{c(){e=I("h1"),n=T(t[0]),r=_(),i=I("p"),i.textContent="share the URL of this page with your team members.",o=_(),ht(s.$$.fragment),a=_(),ht(u.$$.fragment),N(e,"class","svelte-1d5hlxr"),N(i,"class","svelte-1d5hlxr")},m(t,h){w(t,e,h),v(e,n),w(t,r,h),w(t,i,h),w(t,o,h),lt(s,t,h),w(t,a,h),lt(u,t,h),c=!0},p(t,e){(!c||1&e)&&D(n,t[0])},i(t){c||(it(s.$$.fragment,t),it(u.$$.fragment,t),c=!0)},o(t){ot(s.$$.fragment,t),ot(u.$$.fragment,t),c=!1},d(t){t&&E(e),t&&E(r),t&&E(i),t&&E(o),ft(s,t),t&&E(a),ft(u,t)}}}function Ag(e){let n;return{c(){n=I("p"),n.textContent="...waiting",N(n,"class","svelte-1d5hlxr")},m(t,e){w(t,n,e)},p:t,i:t,o:t,d(t){t&&E(n)}}}function Ng(t){let e,n,r,i,s,a,u,c,h;Tg.title=e=t[0];let l={ctx:t,current:null,token:null,hasCatch:!1,pending:Ag,then:Sg,catch:_g,blocks:[,,,]};return function(t,e){const n=e.token={};function r(t,r,i,o){if(e.token!==n)return;e.resolved=o;let s=e.ctx;void 0!==i&&(s=s.slice(),s[i]=o);const a=t&&(e.current=t)(s);let u=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==r&&t&&(nt(),ot(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),rt())})):e.block.d(1),a.c(),it(a,1),a.m(e.mount(),e.anchor),u=!0),e.block=a,e.blocks&&(e.blocks[r]=a),u&&Y()}if((i=t)&&"object"==typeof i&&"function"==typeof i.then){const n=U();if(t.then((t=>{V(n),r(e.then,1,e.value,t),V(null)}),(t=>{if(V(n),r(e.catch,2,e.error,t),V(null),!e.hasCatch)throw t})),e.current!==e.pending)return r(e.pending,0),!0}else{if(e.current!==e.then)return r(e.then,1,e.value,t),!0;e.resolved=t}var i}(Yy,l),a=new Ig({}),{c(){n=I("link"),r=_(),i=I("main"),l.block.c(),s=_(),ht(a.$$.fragment),N(n,"href","https://fonts.googleapis.com/css?family=M+PLUS+1p"),N(n,"rel","stylesheet"),k(i,"height",t[1]),N(i,"class","svelte-1d5hlxr")},m(e,o){v(Tg.head,n),w(e,r,o),w(e,i,o),l.block.m(i,l.anchor=null),l.mount=()=>i,l.anchor=null,w(e,s,o),lt(a,e,o),u=!0,c||(h=[S(window,"resize",t[2]),S(window,"load",t[2])],c=!0)},p(n,[r]){t=n,(!u||1&r)&&e!==(e=t[0])&&(Tg.title=e),function(t,e,n){const r=e.slice(),{resolved:i}=t;t.current===t.then&&(r[t.value]=i),t.current===t.catch&&(r[t.error]=i),t.block.p(r,n)}(l,t,r),(!u||2&r)&&k(i,"height",t[1])},i(t){u||(it(l.block),it(a.$$.fragment,t),u=!0)},o(t){for(let t=0;t<3;t+=1){ot(l.blocks[t])}ot(a.$$.fragment,t),u=!1},d(t){E(n),t&&E(r),t&&E(i),l.block.d(),l.token=null,l=null,t&&E(s),ft(a,t),c=!1,o(h)}}}function Dg(t,e,n){let{name:r}=e,i=null;return t.$$set=t=>{"name"in t&&n(0,r=t.name)},[r,i,()=>{n(1,i=document.documentElement.offsetHeight<document.documentElement.scrollHeight?"auto":"100%")}]}return new class extends yt{constructor(t){super(),dt(this,t,Dg,Ng,a,{name:0})}}({target:document.body,props:{name:"Planning Poker"}})}();
//# sourceMappingURL=bundle.js.map
