var app=function(){"use strict";function t(){}const e=t=>t;function n(t){return t()}function r(){return Object.create(null)}function i(t){t.forEach(n)}function o(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function a(e,n,r){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function u(t){return null==t?"":t}const c="undefined"!=typeof window;let h=c?()=>window.performance.now():()=>Date.now(),l=c?t=>requestAnimationFrame(t):t;const f=new Set;function p(t){f.forEach((e=>{e.c(t)||(f.delete(e),e.f())})),0!==f.size&&l(p)}function d(t,e){t.appendChild(e)}function y(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function g(t){const e=b("style");return function(t,e){d(t.head||t,e)}(y(t),e),e}function v(t,e,n){t.insertBefore(e,n||null)}function m(t){t.parentNode.removeChild(t)}function b(t){return document.createElement(t)}function w(t){return document.createTextNode(t)}function E(){return w(" ")}function I(){return w("")}function T(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function _(t){return function(e){return e.preventDefault(),t.call(this,e)}}function S(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function N(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function A(t,e){t.value=null==e?"":e}function D(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}function C(t,e,n){t.classList[n?"add":"remove"](e)}function k(t,e,n=!1){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,!1,e),r}const x=new Set;let R,O=0;function L(t,e,n,r,i,o,s,a=0){const u=16.666/r;let c="{\n";for(let t=0;t<=1;t+=u){const r=e+(n-e)*o(t);c+=100*t+`%{${s(r,1-r)}}\n`}const h=c+`100% {${s(n,1-n)}}\n}`,l=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(h)}_${a}`,f=y(t);x.add(f);const p=f.__svelte_stylesheet||(f.__svelte_stylesheet=g(t).sheet),d=f.__svelte_rules||(f.__svelte_rules={});d[l]||(d[l]=!0,p.insertRule(`@keyframes ${l} ${h}`,p.cssRules.length));const v=t.style.animation||"";return t.style.animation=`${v?`${v}, `:""}${l} ${r}ms linear ${i}ms 1 both`,O+=1,l}function P(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),i=n.length-r.length;i&&(t.style.animation=r.join(", "),O-=i,O||l((()=>{O||(x.forEach((t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}})),x.clear())})))}function F(t){R=t}function M(){if(!R)throw new Error("Function called outside component initialization");return R}function V(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const U=[],q=[],j=[],B=[],$=Promise.resolve();let K=!1;function z(t){j.push(t)}let G=!1;const H=new Set;function Q(){if(!G){G=!0;do{for(let t=0;t<U.length;t+=1){const e=U[t];F(e),W(e.$$)}for(F(null),U.length=0;q.length;)q.pop()();for(let t=0;t<j.length;t+=1){const e=j[t];H.has(e)||(H.add(e),e())}j.length=0}while(U.length);for(;B.length;)B.pop()();K=!1,G=!1,H.clear()}}function W(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(z)}}let Y;function X(t,e,n){t.dispatchEvent(k(`${e?"intro":"outro"}${n}`))}const J=new Set;let Z;function tt(){Z={r:0,c:[],p:Z}}function et(){Z.r||i(Z.c),Z=Z.p}function nt(t,e){t&&t.i&&(J.delete(t),t.i(e))}function rt(t,e,n,r){if(t&&t.o){if(J.has(t))return;J.add(t),Z.c.push((()=>{J.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}const it={duration:0};function ot(n,r,s,a){let u=r(n,s),c=a?0:1,d=null,y=null,g=null;function v(){g&&P(n,g)}function m(t,e){const n=t.b-c;return e*=Math.abs(n),{a:c,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function b(r){const{delay:o=0,duration:s=300,easing:a=e,tick:b=t,css:w}=u||it,E={start:h()+o,b:r};r||(E.group=Z,Z.r+=1),d||y?y=E:(w&&(v(),g=L(n,c,r,s,o,a,w)),r&&b(0,1),d=m(E,s),z((()=>X(n,r,"start"))),function(t){let e;0===f.size&&l(p),new Promise((n=>{f.add(e={c:t,f:n})}))}((t=>{if(y&&t>y.start&&(d=m(y,s),y=null,X(n,d.b,"start"),w&&(v(),g=L(n,c,d.b,d.duration,0,a,u.css))),d)if(t>=d.end)b(c=d.b,1-c),X(n,d.b,"end"),y||(d.b?v():--d.group.r||i(d.group.c)),d=null;else if(t>=d.start){const e=t-d.start;c=d.a+d.d*a(e/d.duration),b(c,1-c)}return!(!d&&!y)})))}return{run(t){o(u)?(Y||(Y=Promise.resolve(),Y.then((()=>{Y=null}))),Y).then((()=>{u=u(),b(t)})):b(t)},end(){v(),d=y=null}}}function st(t,e){rt(t,1,1,(()=>{e.delete(t.key)}))}function at(t){t&&t.c()}function ut(t,e,r,s){const{fragment:a,on_mount:u,on_destroy:c,after_update:h}=t.$$;a&&a.m(e,r),s||z((()=>{const e=u.map(n).filter(o);c?c.push(...e):i(e),t.$$.on_mount=[]})),h.forEach(z)}function ct(t,e){const n=t.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ht(t,e){-1===t.$$.dirty[0]&&(U.push(t),K||(K=!0,$.then(Q)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function lt(e,n,o,s,a,u,c,h=[-1]){const l=R;F(e);const f=e.$$={fragment:null,ctx:null,props:u,update:t,not_equal:a,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(l?l.$$.context:[])),callbacks:r(),dirty:h,skip_bound:!1,root:n.target||l.$$.root};c&&c(f.root);let p=!1;if(f.ctx=o?o(e,n.props||{},((t,n,...r)=>{const i=r.length?r[0]:n;return f.ctx&&a(f.ctx[t],f.ctx[t]=i)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](i),p&&ht(e,t)),n})):[],f.update(),p=!0,i(f.before_update),f.fragment=!!s&&s(f.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);f.fragment&&f.fragment.l(t),t.forEach(m)}else f.fragment&&f.fragment.c();n.intro&&nt(e.$$.fragment),ut(e,n.target,n.anchor,n.customElement),Q()}F(l)}class ft{$destroy(){ct(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const pt=[];function dt(e,n=t){let r;const i=new Set;function o(t){if(s(e,t)&&(e=t,r)){const t=!pt.length;for(const t of i)t[1](),pt.push(t,e);if(t){for(let t=0;t<pt.length;t+=2)pt[t][0](pt[t+1]);pt.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(s,a=t){const u=[s,a];return i.add(u),1===i.size&&(r=n(o)||t),s(e),()=>{i.delete(u),0===i.size&&(r(),r=null)}}}}var yt,gt=new Uint8Array(16);function vt(){if(!yt&&!(yt="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return yt(gt)}var mt=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function bt(t){return"string"==typeof t&&mt.test(t)}for(var wt=[],Et=0;Et<256;++Et)wt.push((Et+256).toString(16).substr(1));function It(t,e,n){var r=(t=t||{}).random||(t.rng||vt)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(wt[t[e+0]]+wt[t[e+1]]+wt[t[e+2]]+wt[t[e+3]]+"-"+wt[t[e+4]]+wt[t[e+5]]+"-"+wt[t[e+6]]+wt[t[e+7]]+"-"+wt[t[e+8]]+wt[t[e+9]]+"-"+wt[t[e+10]]+wt[t[e+11]]+wt[t[e+12]]+wt[t[e+13]]+wt[t[e+14]]+wt[t[e+15]]).toLowerCase();if(!bt(n))throw TypeError("Stringified UUID is invalid");return n}(r)}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var Tt=function(t,e){return Tt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},Tt(t,e)};function _t(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Tt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var St=function(){return St=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},St.apply(this,arguments)};function Nt(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function At(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function Dt(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ct(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function kt(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var xt=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},Rt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|a>>4,f=(15&a)<<2|c>>6,p=63&c;u||(p=64,s||(f=64)),r.push(n[h],n[l],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(xt(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();var c=o<<2|s>>4;if(r.push(c),64!==a){var h=s<<4&240|a>>2;if(r.push(h),64!==u){var l=a<<6&192|u;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},Ot=function(t){return function(t){var e=xt(t);return Rt.encodeByteArray(e,!0)}(t).replace(/\./g,"")};function Lt(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=Lt(t[n],e[n]));return t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Pt=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Ft(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Mt(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Vt=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,Ut.prototype.create),o}return _t(e,t),e}(Error),Ut=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?qt(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new Vt(i,a,r);return u},t}();function qt(t,e){return t.replace(jt,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var jt=/\{\$([^}]+)}/g;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Bt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function $t(t,e){var n=new Kt(t,e);return n.subscribe.bind(n)}var Kt=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n},void 0===r.next&&(r.next=zt),void 0===r.error&&(r.error=zt),void 0===r.complete&&(r.complete=zt);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function zt(){}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Gt(t){return t&&t._delegate?t._delegate:t}var Ht=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),Qt="[DEFAULT]",Wt=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new Pt;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(r)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t))try{this.getOrInitializeService({instanceIdentifier:Qt})}catch(t){}try{for(var r=Dt(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=Ct(i.value,2),s=o[0],a=o[1],u=this.normalizeInstanceIdentifier(s);try{var c=this.getOrInitializeService({instanceIdentifier:u});a.resolve(c)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=Qt),this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return Nt(this,void 0,void 0,(function(){var t;return At(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(kt(kt([],Ct(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),Ct(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=Qt),this.instances.has(t)},t.prototype.getOptions=function(t){return void 0===t&&(t=Qt),this.instancesOptions.get(t)||{}},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var r=t.options,i=void 0===r?{}:r,o=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(o))throw Error(this.name+"("+o+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var s=this.getOrInitializeService({instanceIdentifier:o,options:i});try{for(var a=Dt(this.instancesDeferred.entries()),u=a.next();!u.done;u=a.next()){var c=Ct(u.value,2),h=c[0],l=c[1];o===this.normalizeInstanceIdentifier(h)&&l.resolve(s)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return s},t.prototype.onInit=function(t,e){var n,r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&t(o,r),function(){i.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,r,i=this.onInitCallbacks.get(e);if(i)try{for(var o=Dt(i),s=o.next();!s.done;s=o.next()){var a=s.value;try{a(t,e)}catch(t){}}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===Qt?void 0:e),options:i}),this.instances.set(n,o),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(o,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(t){}return o||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=Qt),this.component?this.component.multipleInstances?t:Qt:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Yt,Xt=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new Wt(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function Jt(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Zt,te=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(Zt||(Zt={}));var ee,ne={debug:Zt.DEBUG,verbose:Zt.VERBOSE,info:Zt.INFO,warn:Zt.WARN,error:Zt.ERROR,silent:Zt.SILENT},re=Zt.INFO,ie=((Yt={})[Zt.DEBUG]="log",Yt[Zt.VERBOSE]="log",Yt[Zt.INFO]="info",Yt[Zt.WARN]="warn",Yt[Zt.ERROR]="error",Yt),oe=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=ie[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,Jt(["["+i+"]  "+t.name+":"],n))}},se=function(){function t(t){this.name=t,this._logLevel=re,this._logHandler=oe,this._userLogHandler=null,te.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in Zt))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?ne[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Jt([this,Zt.DEBUG],t)),this._logHandler.apply(this,Jt([this,Zt.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Jt([this,Zt.VERBOSE],t)),this._logHandler.apply(this,Jt([this,Zt.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Jt([this,Zt.INFO],t)),this._logHandler.apply(this,Jt([this,Zt.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Jt([this,Zt.WARN],t)),this._logHandler.apply(this,Jt([this,Zt.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Jt([this,Zt.ERROR],t)),this._logHandler.apply(this,Jt([this,Zt.ERROR],t))},t}();function ae(t){te.forEach((function(e){e.setLogLevel(t)}))}var ue,ce=((ee={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",ee["bad-app-name"]="Illegal App name: '{$appName}",ee["duplicate-app"]="Firebase App named '{$appName}' already exists",ee["app-deleted"]="Firebase App named '{$appName}' already deleted",ee["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",ee["invalid-log-argument"]="First argument to `onLog` must be null or a function.",ee),he=new Ut("app","Firebase",ce),le="@firebase/app",fe="[DEFAULT]",pe=((ue={})[le]="fire-core",ue["@firebase/analytics"]="fire-analytics",ue["@firebase/app-check"]="fire-app-check",ue["@firebase/auth"]="fire-auth",ue["@firebase/database"]="fire-rtdb",ue["@firebase/functions"]="fire-fn",ue["@firebase/installations"]="fire-iid",ue["@firebase/messaging"]="fire-fcm",ue["@firebase/performance"]="fire-perf",ue["@firebase/remote-config"]="fire-rc",ue["@firebase/storage"]="fire-gcs",ue["@firebase/firestore"]="fire-fst",ue["fire-js"]="fire-js",ue["firebase-wrapper"]="fire-js-all",ue),de=new se("@firebase/app"),ye=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=Lt(void 0,t),this.container=new Xt(e.name),this._addComponent(new Ht("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){var n;void 0===e&&(e=fe),this.checkDestroyed_();var r=this.container.getProvider(t);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=fe),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){de.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw he.create("app-deleted",{appName:this.name_})},t}();ye.prototype.name&&ye.prototype.options||ye.prototype.delete||console.log("dc");
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function ge(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var o=i;void 0===o.name&&(o.name=fe);var s=o.name;if("string"!=typeof s||!s)throw he.create("bad-app-name",{appName:String(s)});if(Bt(e,s))throw he.create("duplicate-app",{appName:s});var a=new t(n,o,r);return e[s]=a,a},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=pe[t])&&void 0!==r?r:t;n&&(i+="-"+n);var s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return s&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),s&&a&&u.push("and"),a&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void de.warn(u.join(" "))}o(new Ht(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:ae,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw he.create("invalid-log-argument");!function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=ne[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:Zt[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=te;r<i.length;r++)n(i[r])}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t,e)},apps:null,SDK_VERSION:"8.10.0",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){if("serverAuth"===e)return null;return e}}};function i(t){if(!Bt(e,t=t||fe))throw he.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return de.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var a=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[s])throw he.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&Lt(a,o.serviceProps),r[s]=a,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,s);return n.apply(this,o.multipleInstances?t:[])}}for(var u=0,c=Object.keys(e);u<c.length;u++){var h=c[u];e[h]._addComponent(o)}return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ve=function t(){var e=ge(ye);return e.INTERNAL=St(St({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){Lt(e,t)},createSubscribe:$t,ErrorFactory:Ut,deepExtend:Lt}),e}(),me=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){de.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var be=self.firebase.SDK_VERSION;be&&be.indexOf("LITE")>=0&&de.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var we=ve.initializeApp;ve.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Mt()&&de.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),we.apply(void 0,t)};var Ee=ve;!function(t,e){t.INTERNAL.registerComponent(new Ht("platform-logger",(function(t){return new me(t)}),"PRIVATE")),t.registerVersion(le,"0.6.30",e),t.registerVersion("fire-js","")}(Ee);var Ie="8.10.0";
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
Ee.registerVersion("firebase",Ie,"app"),Ee.SDK_VERSION=Ie;
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var Te=function(t,e){return Te=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},Te(t,e)};function _e(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var Se,Ne="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Ae=Ae||{},De=Ne||self;function Ce(){}function ke(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function xe(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Re="closure_uid_"+(1e9*Math.random()>>>0),Oe=0;function Le(t,e,n){return t.call.apply(t.bind,arguments)}function Pe(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Fe(t,e,n){return(Fe=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Le:Pe).apply(null,arguments)}function Me(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Ve(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function Ue(){this.s=this.s,this.o=this.o}var qe={};Ue.prototype.s=!1,Ue.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,Re)&&t[Re]||(t[Re]=++Oe)}(this);delete qe[t]}},Ue.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var je=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Be=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function $e(t){return Array.prototype.concat.apply([],arguments)}function Ke(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function ze(t){return/^[\s\xa0]*$/.test(t)}var Ge,He=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Qe(t,e){return-1!=t.indexOf(e)}function We(t,e){return t<e?-1:t>e?1:0}t:{var Ye=De.navigator;if(Ye){var Xe=Ye.userAgent;if(Xe){Ge=Xe;break t}}Ge=""}function Je(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Ze(t){var e={};for(var n in t)e[n]=t[n];return e}var tn="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function en(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<tn.length;o++)n=tn[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function nn(t){return nn[" "](t),t}nn[" "]=Ce;var rn,on,sn=Qe(Ge,"Opera"),an=Qe(Ge,"Trident")||Qe(Ge,"MSIE"),un=Qe(Ge,"Edge"),cn=un||an,hn=Qe(Ge,"Gecko")&&!(Qe(Ge.toLowerCase(),"webkit")&&!Qe(Ge,"Edge"))&&!(Qe(Ge,"Trident")||Qe(Ge,"MSIE"))&&!Qe(Ge,"Edge"),ln=Qe(Ge.toLowerCase(),"webkit")&&!Qe(Ge,"Edge");function fn(){var t=De.document;return t?t.documentMode:void 0}t:{var pn="",dn=(on=Ge,hn?/rv:([^\);]+)(\)|;)/.exec(on):un?/Edge\/([\d\.]+)/.exec(on):an?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(on):ln?/WebKit\/(\S+)/.exec(on):sn?/(?:Version)[ \/]?(\S+)/.exec(on):void 0);if(dn&&(pn=dn?dn[1]:""),an){var yn=fn();if(null!=yn&&yn>parseFloat(pn)){rn=String(yn);break t}}rn=pn}var gn,vn={};function mn(){return function(t){var e=vn;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}((function(){for(var t=0,e=He(String(rn)).split("."),n=He("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=We(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||We(0==o[2].length,0==s[2].length)||We(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t}))}if(De.document&&an){var bn=fn();gn=bn||(parseInt(rn,10)||void 0)}else gn=void 0;var wn=gn,En=function(){if(!De.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{De.addEventListener("test",Ce,e),De.removeEventListener("test",Ce,e)}catch(t){}return t}();function In(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function Tn(t,e){if(In.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(hn){t:{try{nn(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:_n[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Tn.Z.h.call(this)}}In.prototype.h=function(){this.defaultPrevented=!0},Ve(Tn,In);var _n={2:"touch",3:"pen",4:"mouse"};Tn.prototype.h=function(){Tn.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Sn="closure_listenable_"+(1e6*Math.random()|0),Nn=0;function An(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++Nn,this.ca=this.fa=!1}function Dn(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function Cn(t){this.src=t,this.g={},this.h=0}function kn(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],o=je(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Dn(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function xn(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ca&&o.listener==e&&o.capture==!!n&&o.ia==r)return i}return-1}Cn.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var s=xn(t,e,r,i);return-1<s?(e=t[s],n||(e.fa=!1)):((e=new An(e,this.src,o,!!r,i)).fa=n,t.push(e)),e};var Rn="closure_lm_"+(1e6*Math.random()|0),On={};function Ln(t,e,n,r,i){if(r&&r.once)return Fn(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ln(t,e[o],n,r,i);return null}return n=$n(n),t&&t[Sn]?t.N(e,n,xe(r)?!!r.capture:!!r,i):Pn(t,e,n,!1,r,i)}function Pn(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=xe(i)?!!i.capture:!!i,a=jn(t);if(a||(t[Rn]=a=new Cn(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){function t(n){return e.call(t.src,t.listener,n)}var e=qn;return t}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)En||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Un(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Fn(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Fn(t,e[o],n,r,i);return null}return n=$n(n),t&&t[Sn]?t.O(e,n,xe(r)?!!r.capture:!!r,i):Pn(t,e,n,!0,r,i)}function Mn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Mn(t,e[o],n,r,i);else r=xe(r)?!!r.capture:!!r,n=$n(n),t&&t[Sn]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=xn(o=t.g[e],n,r,i))&&(Dn(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.g[e],t.h--)))):t&&(t=jn(t))&&(e=t.g[e.toString()],t=-1,e&&(t=xn(e,n,r,i)),(n=-1<t?e[t]:null)&&Vn(n))}function Vn(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[Sn])kn(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Un(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=jn(e))?(kn(n,t),0==n.h&&(n.src=null,e[Rn]=null)):Dn(t)}}}function Un(t){return t in On?On[t]:On[t]="on"+t}function qn(t,e){if(t.ca)t=!0;else{e=new Tn(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&Vn(t),t=n.call(r,e)}return t}function jn(t){return(t=t[Rn])instanceof Cn?t:null}var Bn="__closure_events_fn_"+(1e9*Math.random()>>>0);function $n(t){return"function"==typeof t?t:(t[Bn]||(t[Bn]=function(e){return t.handleEvent(e)}),t[Bn])}function Kn(){Ue.call(this),this.i=new Cn(this),this.P=this,this.I=null}function zn(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"==typeof e)e=new In(e,t);else if(e instanceof In)e.target=e.target||t;else{var i=e;en(e=new In(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.g=n[o];i=Gn(s,r,!0,e)&&i}if(i=Gn(s=e.g=t,r,!0,e)&&i,i=Gn(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Gn(s=e.g=n[o],r,!1,e)&&i}function Gn(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.ca&&s.capture==n){var a=s.listener,u=s.ia||s.src;s.fa&&kn(t.i,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}Ve(Kn,Ue),Kn.prototype[Sn]=!0,Kn.prototype.removeEventListener=function(t,e,n,r){Mn(this,t,e,n,r)},Kn.prototype.M=function(){if(Kn.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)Dn(n[r]);delete e.g[t],e.h--}}this.I=null},Kn.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},Kn.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var Hn=De.JSON.stringify;function Qn(){var t=nr,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Wn,Yn=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=Xn.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),Xn=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t},t}())((function(){return new Jn}),(function(t){return t.reset()})),Jn=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function Zn(t){De.setTimeout((function(){throw t}),0)}function tr(t,e){Wn||function(){var t=De.Promise.resolve(void 0);Wn=function(){t.then(rr)}}(),er||(Wn(),er=!0),nr.add(t,e)}var er=!1,nr=new Yn;function rr(){for(var t;t=Qn();){try{t.h.call(t.g)}catch(t){Zn(t)}var e=Xn;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}er=!1}function ir(t,e){Kn.call(this),this.h=t||1,this.g=e||De,this.j=Fe(this.kb,this),this.l=Date.now()}function or(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function sr(t,e,n){if("function"==typeof t)n&&(t=Fe(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Fe(t.handleEvent,t)}return 2147483647<Number(e)?-1:De.setTimeout(t,e||0)}function ar(t){t.g=sr((function(){t.g=null,t.i&&(t.i=!1,ar(t))}),t.j);var e=t.h;t.h=null,t.m.apply(null,e)}Ve(ir,Kn),(Se=ir.prototype).da=!1,Se.S=null,Se.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),zn(this,"tick"),this.da&&(or(this),this.start()))}},Se.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Se.M=function(){ir.Z.M.call(this),or(this),delete this.g};var ur=function(t){function e(e,n){var r=t.call(this)||this;return r.m=e,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Te(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:ar(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(De.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(Ue);function cr(t){Ue.call(this),this.h=t,this.g={}}Ve(cr,Ue);var hr=[];function lr(t,e,n,r){Array.isArray(n)||(n&&(hr[0]=n.toString()),n=hr);for(var i=0;i<n.length;i++){var o=Ln(e,n[i],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function fr(t){Je(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Vn(t)}),t),t.g={}}function pr(){this.g=!0}function dr(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Hn(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}cr.prototype.M=function(){cr.Z.M.call(this),fr(this)},cr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},pr.prototype.Aa=function(){this.g=!1},pr.prototype.info=function(){};var yr={},gr=null;function vr(){return gr=gr||new Kn}function mr(t){In.call(this,yr.Ma,t)}function br(t){var e=vr();zn(e,new mr(e,t))}function wr(t,e){In.call(this,yr.STAT_EVENT,t),this.stat=e}function Er(t){var e=vr();zn(e,new wr(e,t))}function Ir(t,e){In.call(this,yr.Na,t),this.size=e}function Tr(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return De.setTimeout((function(){t()}),e)}yr.Ma="serverreachability",Ve(mr,In),yr.STAT_EVENT="statevent",Ve(wr,In),yr.Na="timingevent",Ve(Ir,In);var _r={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Sr={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Nr(){}function Ar(t){return t.h||(t.h=t.i())}function Dr(){}Nr.prototype.h=null;var Cr,kr={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function xr(){In.call(this,"d")}function Rr(){In.call(this,"c")}function Or(){}function Lr(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new cr(this),this.P=Fr,t=cn?125:void 0,this.W=new ir(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Pr}function Pr(){this.i=null,this.g="",this.h=!1}Ve(xr,In),Ve(Rr,In),Ve(Or,Nr),Or.prototype.g=function(){return new XMLHttpRequest},Or.prototype.i=function(){return{}},Cr=new Or;var Fr=45e3,Mr={},Vr={};function Ur(t,e,n){t.K=1,t.v=ui(ni(e)),t.s=n,t.U=!0,qr(t,null)}function qr(t,e){t.F=Date.now(),Kr(t),t.A=ni(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),Ei(n.h,"t",r),t.C=0,n=t.l.H,t.h=new Pr,t.g=To(t.l,n?e:null,!t.s),0<t.O&&(t.L=new ur(Fe(t.Ia,t,t.g),t.O)),lr(t.V,t.g,"readystatechange",t.gb),e=t.H?Ze(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),br(1),function(t,e,n,r,i,o){t.info((function(){if(t.g)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&"type"==l[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function jr(t){return!!t.g&&("GET"==t.u&&2!=t.K&&t.l.Ba)}function Br(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;){if((r=$r(t,n))==Vr){4==e&&(t.o=4,Er(14),i=!1),dr(t.j,t.m,null,"[Incomplete Response]");break}if(r==Mr){t.o=4,Er(15),dr(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}dr(t.j,t.m,r,null),Wr(t,r)}jr(t)&&r!=Vr&&r!=Mr&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,Er(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),yo(e),e.L=!0,Er(11))):(dr(t.j,t.m,n,"[Invalid Chunked Response]"),Qr(t),Hr(t))}function $r(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?Vr:(n=Number(e.substring(n,r)),isNaN(n)?Mr:(r+=1)+n>e.length?Vr:(e=e.substr(r,n),t.C=r+n,e))}function Kr(t){t.Y=Date.now()+t.P,zr(t,t.P)}function zr(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Tr(Fe(t.eb,t),e)}function Gr(t){t.B&&(De.clearTimeout(t.B),t.B=null)}function Hr(t){0==t.l.G||t.I||mo(t.l,t)}function Qr(t){Gr(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,or(t.W),fr(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Wr(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||Di(n.i,t)))if(n.I=t.N,!t.J&&Di(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(o){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;vo(n),oo(n)}po(n),Er(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=Tr(Fe(n.ab,n),6e3));if(1>=Ai(n.i)&&n.ka){try{n.ka()}catch(o){}n.ka=void 0}}else wo(n,11)}else if((t.J||n.g==t)&&vo(n),!ze(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var o=i[e];if(n.U=o[0],o=o[1],2==n.G)if("c"==o[0]){n.J=o[1],n.la=o[2];var s=o[3];null!=s&&(n.ma=s,n.h.info("VER="+n.ma));var a=o[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var u=o[5];null!=u&&"number"==typeof u&&0<u&&(r=1.5*u,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=t.g;if(c){var h=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=r.i;!l.g&&(Qe(h,"spdy")||Qe(h,"quic")||Qe(h,"h2"))&&(l.j=l.l,l.g=new Set,l.h&&(Ci(l,l.h),l.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,ai(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var p=t;if((r=n).oa=Io(r,r.H?r.la:null,r.W),p.J){ki(r.i,p);var d=p,y=r.K;y&&d.setTimeout(y),d.B&&(Gr(d),Kr(d)),r.g=p}else fo(r);0<n.l.length&&uo(n)}else"stop"!=o[0]&&"close"!=o[0]||wo(n,7);else 3==n.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?wo(n,7):io(n):"noop"!=o[0]&&n.j&&n.j.wa(o),n.A=0)}br(4)}catch(o){}}function Yr(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(ke(t)||"string"==typeof t)Be(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(ke(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;r=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(ke(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),i=r.length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Xr(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Xr)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Jr(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];Zr(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)Zr(i,r=t.g[e])||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}function Zr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(Se=Lr.prototype).setTimeout=function(t){this.P=t},Se.gb=function(t){t=t.target;var e=this.L;e&&3==Zi(t)?e.l():this.Ia(t)},Se.Ia=function(t){try{if(t==this.g)t:{var e=Zi(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||cn||this.g&&(this.h.h||this.g.ga()||to(this.g)))){this.I||4!=e||7==n||br(8==n||0>=r?3:2),Gr(this);var i=this.g.ba();this.N=i;e:if(jr(this)){var o=to(this.g);t="";var s=o.length,a=4==Zi(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Qr(this),Hr(this);var u="";break e}this.h.i=new De.TextDecoder}for(n=0;n<s;n++)this.h.h=!0,t+=this.h.i.decode(o[n],{stream:a&&n==s-1});o.splice(0,s),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,h=this.g;if((c=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ze(c)){var l=c;break e}}l=null}if(!(i=l)){this.i=!1,this.o=3,Er(12),Qr(this),Hr(this);break t}dr(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Wr(this,i)}this.U?(Br(this,e,u),cn&&this.i&&3==e&&(lr(this.V,this.W,"tick",this.fb),this.W.start())):(dr(this.j,this.m,u,null),Wr(this,u)),4==e&&Qr(this),this.i&&!this.I&&(4==e?mo(this.l,this):(this.i=!1,Kr(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,Er(12)):(this.o=0,Er(13)),Qr(this),Hr(this)}}}catch(e){}},Se.fb=function(){if(this.g){var t=Zi(this.g),e=this.g.ga();this.C<e.length&&(Gr(this),Br(this,t,e),this.i&&4!=t&&Kr(this))}},Se.cancel=function(){this.I=!0,Qr(this)},Se.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(br(3),Er(17)),Qr(this),this.o=2,Hr(this)):zr(this,this.Y-t)},(Se=Xr.prototype).R=function(){Jr(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},Se.T=function(){return Jr(this),this.g.concat()},Se.get=function(t,e){return Zr(this.h,t)?this.h[t]:e},Se.set=function(t,e){Zr(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},Se.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var ti=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function ei(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof ei){this.g=void 0!==e?e:t.g,ri(this,t.j),this.s=t.s,ii(this,t.i),oi(this,t.m),this.l=t.l,e=t.h;var n=new vi;n.i=e.i,e.g&&(n.g=new Xr(e.g),n.h=e.h),si(this,n),this.o=t.o}else t&&(n=String(t).match(ti))?(this.g=!!e,ri(this,n[1]||"",!0),this.s=ci(n[2]||""),ii(this,n[3]||"",!0),oi(this,n[4]),this.l=ci(n[5]||"",!0),si(this,n[6]||"",!0),this.o=ci(n[7]||"")):(this.g=!!e,this.h=new vi(null,this.g))}function ni(t){return new ei(t)}function ri(t,e,n){t.j=n?ci(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function ii(t,e,n){t.i=n?ci(e,!0):e}function oi(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function si(t,e,n){e instanceof vi?(t.h=e,function(t,e){e&&!t.j&&(mi(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(bi(this,e),Ei(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=hi(e,yi)),t.h=new vi(e,t.g))}function ai(t,e,n){t.h.set(e,n)}function ui(t){return ai(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function ci(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function hi(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,li),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function li(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}ei.prototype.toString=function(){var t=[],e=this.j;e&&t.push(hi(e,fi,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(hi(e,fi,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(hi(n,"/"==n.charAt(0)?di:pi,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",hi(n,gi)),t.join("")};var fi=/[#\/\?@]/g,pi=/[#\?:]/g,di=/[#\?]/g,yi=/[#\?@]/g,gi=/#/g;function vi(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function mi(t){t.g||(t.g=new Xr,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function bi(t,e){mi(t),e=Ii(t,e),Zr(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,Zr((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&Jr(t)))}function wi(t,e){return mi(t),e=Ii(t,e),Zr(t.g.h,e)}function Ei(t,e,n){bi(t,e),0<n.length&&(t.i=null,t.g.set(Ii(t,e),Ke(n)),t.h+=n.length)}function Ii(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(Se=vi.prototype).add=function(t,e){mi(this),this.i=null,t=Ii(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},Se.forEach=function(t,e){mi(this),this.g.forEach((function(n,r){Be(n,(function(n){t.call(e,n,r,this)}),this)}),this)},Se.T=function(){mi(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},Se.R=function(t){mi(this);var e=[];if("string"==typeof t)wi(this,t)&&(e=$e(e,this.g.get(Ii(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=$e(e,t[n])}return e},Se.set=function(t,e){return mi(this),this.i=null,wi(this,t=Ii(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},Se.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},Se.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.i=t.join("&")};var Ti=function(t,e){this.h=t,this.g=e};function _i(t){this.l=t||Si,De.PerformanceNavigationTiming?t=0<(t=De.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(De.g&&De.g.Ea&&De.g.Ea()&&De.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Si=10;function Ni(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Ai(t){return t.h?1:t.g?t.g.size:0}function Di(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Ci(t,e){t.g?t.g.add(e):t.h=e}function ki(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function xi(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var r=t.i;try{for(var i=_e(t.g.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.D)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return Ke(t.i)}function Ri(){}function Oi(){this.g=new Ri}function Li(t,e,n){var r=n||"";try{Yr(t,(function(t,n){var i=t;xe(t)&&(i=Hn(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function Pi(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function Fi(t){this.l=t.$b||null,this.j=t.ib||!1}function Mi(t,e){Kn.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Vi,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}_i.prototype.cancel=function(){var t,e;if(this.i=xi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=_e(this.g.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},Ri.prototype.stringify=function(t){return De.JSON.stringify(t,void 0)},Ri.prototype.parse=function(t){return De.JSON.parse(t,void 0)},Ve(Fi,Nr),Fi.prototype.g=function(){return new Mi(this.l,this.j)},Fi.prototype.i=function(t){return function(){return t}}({}),Ve(Mi,Kn);var Vi=0;function Ui(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function qi(t){t.readyState=4,t.l=null,t.j=null,t.A=null,ji(t)}function ji(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(Se=Mi.prototype).open=function(t,e){if(this.readyState!=Vi)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,ji(this)},Se.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||De).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},Se.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,qi(this)),this.readyState=Vi},Se.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,ji(this)),this.g&&(this.readyState=3,ji(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==De.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Ui(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},Se.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?qi(this):ji(this),3==this.readyState&&Ui(this)}},Se.Ua=function(t){this.g&&(this.response=this.responseText=t,qi(this))},Se.Ta=function(t){this.g&&(this.response=t,qi(this))},Se.ha=function(){this.g&&qi(this)},Se.setRequestHeader=function(t,e){this.v.append(t,e)},Se.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},Se.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Mi.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Bi=De.JSON.parse;function $i(t){Kn.call(this),this.headers=new Xr,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Ki,this.K=this.L=!1}Ve($i,Kn);var Ki="",zi=/^https?$/i,Gi=["POST","PUT"];function Hi(t){return"content-type"==t.toLowerCase()}function Qi(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Wi(t),Xi(t)}function Wi(t){t.D||(t.D=!0,zn(t,"complete"),zn(t,"error"))}function Yi(t){if(t.h&&void 0!==Ae&&(!t.C[1]||4!=Zi(t)||2!=t.ba()))if(t.v&&4==Zi(t))sr(t.Fa,0,t);else if(zn(t,"readystatechange"),4==Zi(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.H).match(ti)[1]||null;if(!o&&De.self&&De.self.location){var s=De.self.location.protocol;o=s.substr(0,s.length-1)}i=!zi.test(o?o.toLowerCase():"")}e=i}if(e)zn(t,"complete"),zn(t,"success");else{t.m=6;try{var a=2<Zi(t)?t.g.statusText:""}catch(t){a=""}t.j=a+" ["+t.ba()+"]",Wi(t)}}finally{Xi(t)}}}function Xi(t,e){if(t.g){Ji(t);var n=t.g,r=t.C[0]?Ce:null;t.g=null,t.C=null,e||zn(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Ji(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(De.clearTimeout(t.A),t.A=null)}function Zi(t){return t.g?t.g.readyState:0}function to(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Ki:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function eo(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return Je(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):ai(t,e,n))}function no(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function ro(t){this.za=0,this.l=[],this.h=new pr,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=no("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=no("baseRetryDelayMs",5e3,t),this.$a=no("retryDelaySeedMs",1e4,t),this.Ya=no("forwardChannelMaxRetries",2,t),this.ra=no("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new _i(t&&t.concurrentRequestLimit),this.Ca=new Oi,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function io(t){if(so(t),3==t.G){var e=t.V++,n=ni(t.F);ai(n,"SID",t.J),ai(n,"RID",e),ai(n,"TYPE","terminate"),ho(t,n),(e=new Lr(t,t.h,e,void 0)).K=2,e.v=ui(ni(n)),n=!1,De.navigator&&De.navigator.sendBeacon&&(n=De.navigator.sendBeacon(e.v.toString(),"")),!n&&De.Image&&((new Image).src=e.v,n=!0),n||(e.g=To(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Kr(e)}Eo(t)}function oo(t){t.g&&(yo(t),t.g.cancel(),t.g=null)}function so(t){oo(t),t.u&&(De.clearTimeout(t.u),t.u=null),vo(t),t.i.cancel(),t.m&&("number"==typeof t.m&&De.clearTimeout(t.m),t.m=null)}function ao(t,e){t.l.push(new Ti(t.Za++,e)),3==t.G&&uo(t)}function uo(t){Ni(t.i)||t.m||(t.m=!0,tr(t.Ha,t),t.C=0)}function co(t,e){var n;n=e?e.m:t.V++;var r=ni(t.F);ai(r,"SID",t.J),ai(r,"RID",n),ai(r,"AID",t.U),ho(t,r),t.o&&t.s&&eo(r,t.o,t.s),n=new Lr(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=lo(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),Ci(t.i,n),Ur(n,r,e)}function ho(t,e){t.j&&Yr({},(function(t,n){ai(e,n,t)}))}function lo(t,e,n){n=Math.min(t.l.length,n);var r=t.j?Fe(t.j.Oa,t.j,t):null;t:for(var i=t.l,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].h,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].h,h=i[u].g;if(0>(c-=o))o=Math.max(0,i[u].h-100),a=!1;else try{Li(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function fo(t){t.g||t.u||(t.Y=1,tr(t.Ga,t),t.A=0)}function po(t){return!(t.g||t.u||3<=t.A)&&(t.Y++,t.u=Tr(Fe(t.Ga,t),bo(t,t.A)),t.A++,!0)}function yo(t){null!=t.B&&(De.clearTimeout(t.B),t.B=null)}function go(t){t.g=new Lr(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=ni(t.oa);ai(e,"RID","rpc"),ai(e,"SID",t.J),ai(e,"CI",t.N?"0":"1"),ai(e,"AID",t.U),ho(t,e),ai(e,"TYPE","xmlhttp"),t.o&&t.s&&eo(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=ui(ni(e)),n.s=null,n.U=!0,qr(n,t)}function vo(t){null!=t.v&&(De.clearTimeout(t.v),t.v=null)}function mo(t,e){var n=null;if(t.g==e){vo(t),yo(t),t.g=null;var r=2}else{if(!Di(t.i,e))return;n=e.D,ki(t.i,e),r=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;zn(r=vr(),new Ir(r,n,e,i)),uo(t)}else fo(t);else if(3==(i=e.o)||0==i&&0<t.I||!(1==r&&function(t,e){return!(Ai(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=Tr(Fe(t.Ha,t,e),bo(t,t.C)),t.C++,0)))}(t,e)||2==r&&po(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:wo(t,5);break;case 4:wo(t,10);break;case 3:wo(t,6);break;default:wo(t,2)}}function bo(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function wo(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var r=Fe(t.jb,t);n||(n=new ei("//www.google.com/images/cleardot.gif"),De.location&&"http"==De.location.protocol||ri(n,"https"),ui(n)),function(t,e){var n=new pr;if(De.Image){var r=new Image;r.onload=Me(Pi,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Me(Pi,n,r,"TestLoadImage: error",!1,e),r.onabort=Me(Pi,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Me(Pi,n,r,"TestLoadImage: timeout",!1,e),De.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Er(2);t.G=0,t.j&&t.j.va(e),Eo(t),so(t)}function Eo(t){t.G=0,t.I=-1,t.j&&(0==xi(t.i).length&&0==t.l.length||(t.i.i.length=0,Ke(t.l),t.l.length=0),t.j.ua())}function Io(t,e,n){var r=function(t){return t instanceof ei?ni(t):new ei(t,void 0)}(n);if(""!=r.i)e&&ii(r,e+"."+r.i),oi(r,r.m);else{var i=De.location;r=function(t,e,n,r){var i=new ei(null,void 0);return t&&ri(i,t),e&&ii(i,e),n&&oi(i,n),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&Je(t.aa,(function(t,e){ai(r,e,t)})),e=t.D,n=t.sa,e&&n&&ai(r,e,n),ai(r,"VER",t.ma),ho(t,r),r}function To(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new $i(new Fi({ib:!0})):new $i(t.qa)).L=t.H,e}function _o(){}function So(){if(an&&!(10<=Number(wn)))throw Error("Environmental error: no available transport.")}function No(t,e){Kn.call(this),this.g=new ro(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!ze(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!ze(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new Co(this)}function Ao(t){xr.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Do(){Rr.call(this),this.status=1}function Co(t){this.g=t}(Se=$i.prototype).ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Cr.g(),this.C=this.u?Ar(this.u):Ar(Cr),this.g.onreadystatechange=Fe(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void Qi(this,t)}t=n||"";var i=new Xr(this.headers);r&&Yr(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=Hi,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.T()),n=De.FormData&&t instanceof De.FormData,!(0<=je(Gi,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Ji(this),0<this.B&&((this.K=function(t){return an&&mn()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Fe(this.pa,this)):this.A=sr(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Qi(this,t)}},Se.pa=function(){void 0!==Ae&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,zn(this,"timeout"),this.abort(8))},Se.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,zn(this,"complete"),zn(this,"abort"),Xi(this))},Se.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Xi(this,!0)),$i.Z.M.call(this)},Se.Fa=function(){this.s||(this.F||this.v||this.l?Yi(this):this.cb())},Se.cb=function(){Yi(this)},Se.ba=function(){try{return 2<Zi(this)?this.g.status:-1}catch(t){return-1}},Se.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},Se.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Bi(e)}},Se.Da=function(){return this.m},Se.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(Se=ro.prototype).ma=8,Se.G=1,Se.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(t){}},Se.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new Lr(this,this.h,t,void 0),n=this.s;if(this.P&&(n?en(n=Ze(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var o=this.l[i];if(void 0===(o="__data__"in o.g&&"string"==typeof(o=o.g.__data__)?o.length:void 0))break;if(4096<(r+=o)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=lo(this,e,r),ai(i=ni(this.F),"RID",t),ai(i,"CVER",22),this.D&&ai(i,"X-HTTP-Session-Id",this.D),ho(this,i),this.o&&n&&eo(i,this.o,n),Ci(this.i,e),this.Ra&&ai(i,"TYPE","init"),this.ja?(ai(i,"$req",r),ai(i,"SID","null"),e.$=!0,Ur(e,i,null)):Ur(e,i,r),this.G=2}}else 3==this.G&&(t?co(this,t):0==this.l.length||Ni(this.i)||co(this))},Se.Ga=function(){if(this.u=null,go(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Tr(Fe(this.bb,this),t)}},Se.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Er(10),oo(this),go(this))},Se.ab=function(){null!=this.v&&(this.v=null,oo(this),po(this),Er(19))},Se.jb=function(t){t?(this.h.info("Successfully pinged google.com"),Er(2)):(this.h.info("Failed to ping google.com"),Er(1))},(Se=_o.prototype).xa=function(){},Se.wa=function(){},Se.va=function(){},Se.ua=function(){},Se.Oa=function(){},So.prototype.g=function(t,e){return new No(t,e)},Ve(No,Kn),No.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),tr(Fe(t.hb,t,e))),Er(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=Io(t,null,t.W),uo(t)},No.prototype.close=function(){io(this.g)},No.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,ao(this.g,e)}else this.v?((e={}).__data__=Hn(t),ao(this.g,e)):ao(this.g,t)},No.prototype.M=function(){this.g.j=null,delete this.j,io(this.g),delete this.g,No.Z.M.call(this)},Ve(Ao,xr),Ve(Do,Rr),Ve(Co,_o),Co.prototype.xa=function(){zn(this.g,"a")},Co.prototype.wa=function(t){zn(this.g,new Ao(t))},Co.prototype.va=function(t){zn(this.g,new Do(t))},Co.prototype.ua=function(){zn(this.g,"b")},So.prototype.createWebChannel=So.prototype.g,No.prototype.send=No.prototype.u,No.prototype.open=No.prototype.m,No.prototype.close=No.prototype.close,_r.NO_ERROR=0,_r.TIMEOUT=8,_r.HTTP_ERROR=6,Sr.COMPLETE="complete",Dr.EventType=kr,kr.OPEN="a",kr.CLOSE="b",kr.ERROR="c",kr.MESSAGE="d",Kn.prototype.listen=Kn.prototype.N,$i.prototype.listenOnce=$i.prototype.O,$i.prototype.getLastError=$i.prototype.La,$i.prototype.getLastErrorCode=$i.prototype.Da,$i.prototype.getStatus=$i.prototype.ba,$i.prototype.getResponseJson=$i.prototype.Qa,$i.prototype.getResponseText=$i.prototype.ga,$i.prototype.send=$i.prototype.ea;var ko=_r,xo=Sr,Ro=yr,Oo=10,Lo=11,Po=Fi,Fo=Dr,Mo=$i,Vo=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();Vo.o=-1;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Uo={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},qo=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return _t(e,t),e}(Error),jo=new se("@firebase/firestore");function Bo(){return jo.logLevel}function $o(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(jo.logLevel<=Zt.DEBUG){var r=e.map(Go);jo.debug.apply(jo,kt(["Firestore (8.10.0): "+t],r))}}function Ko(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(jo.logLevel<=Zt.ERROR){var r=e.map(Go);jo.error.apply(jo,kt(["Firestore (8.10.0): "+t],r))}}function zo(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(jo.logLevel<=Zt.WARN){var r=e.map(Go);jo.warn.apply(jo,kt(["Firestore (8.10.0): "+t],r))}}function Go(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ho(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.10.0) INTERNAL ASSERTION FAILED: "+t;throw Ko(e),new Error(e)}function Qo(t,e){t||Ho()}function Wo(t,e){return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Yo(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Xo=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Yo(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Jo(t,e){return t<e?-1:t>e?1:0}function Zo(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function ts(t){return t+"\0"}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var es=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new qo(Uo.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new qo(Uo.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new qo(Uo.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new qo(Uo.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?Jo(this.nanoseconds,t.nanoseconds):Jo(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),ns=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new es(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function rs(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function is(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function os(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ss=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Ho(),void 0===n?n=t.length-e:n>t.length-e&&Ho(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),as=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _t(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new qo(Uo.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.emptyPath=function(){return new e([])},e}(ss),us=/^[_a-zA-Z][_a-zA-Z0-9]*$/,cs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _t(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return us.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new qo(Uo.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new qo(Uo.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new qo(Uo.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new qo(Uo.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(ss),hs=function(){function t(t){this.fields=t,t.sort(cs.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return Zo(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),ls=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return Jo(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();ls.EMPTY_BYTE_STRING=new ls("");var fs=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ps(t){if(Qo(!!t),"string"==typeof t){var e=0,n=fs.exec(t);if(Qo(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ds(t.seconds),nanos:ds(t.nanos)}}function ds(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function ys(t){return"string"==typeof t?ls.fromBase64String(t):ls.fromUint8Array(t)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function gs(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function vs(t){var e=t.mapValue.fields.__previous_value__;return gs(e)?vs(e):e}function ms(t){var e=ps(t.mapValue.fields.__local_write_time__.timestampValue);return new es(e.seconds,e.nanos)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function bs(t){return null==t}function ws(t){return 0===t&&1/t==-1/0}function Es(t){return"number"==typeof t&&Number.isInteger(t)&&!ws(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Is=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(as.fromString(e))},t.fromName=function(e){return new t(as.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===as.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return as.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new as(e.slice()))},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ts(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?gs(t)?4:10:Ho()}function _s(t,e){var n=Ts(t);if(n!==Ts(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ms(t).isEqual(ms(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=ps(t.timestampValue),r=ps(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return ys(t.bytesValue).isEqual(ys(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return ds(t.geoPointValue.latitude)===ds(e.geoPointValue.latitude)&&ds(t.geoPointValue.longitude)===ds(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return ds(t.integerValue)===ds(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=ds(t.doubleValue),r=ds(e.doubleValue);return n===r?ws(n)===ws(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Zo(t.arrayValue.values||[],e.arrayValue.values||[],_s);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(rs(n)!==rs(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!_s(n[i],r[i])))return!1;return!0}(t,e);default:return Ho()}}function Ss(t,e){return void 0!==(t.values||[]).find((function(t){return _s(t,e)}))}function Ns(t,e){var n=Ts(t),r=Ts(e);if(n!==r)return Jo(n,r);switch(n){case 0:return 0;case 1:return Jo(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=ds(t.integerValue||t.doubleValue),r=ds(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return As(t.timestampValue,e.timestampValue);case 4:return As(ms(t),ms(e));case 5:return Jo(t.stringValue,e.stringValue);case 6:return function(t,e){var n=ys(t),r=ys(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Jo(n[i],r[i]);if(0!==o)return o}return Jo(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Jo(ds(t.latitude),ds(e.latitude));return 0!==n?n:Jo(ds(t.longitude),ds(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Ns(n[i],r[i]);if(o)return o}return Jo(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=Jo(r[s],o[s]);if(0!==a)return a;var u=Ns(n[r[s]],i[o[s]]);if(0!==u)return u}return Jo(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Ho()}}function As(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Jo(t,e);var n=ps(t),r=ps(e),i=Jo(n.seconds,r.seconds);return 0!==i?i:Jo(n.nanos,r.nanos)}function Ds(t){return Cs(t)}function Cs(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=ps(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?ys(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Is.fromName(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Cs(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Cs(t.fields[o])}return e+"}"}(t.mapValue):Ho();var e,n}function ks(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function xs(t){return!!t&&"integerValue"in t}function Rs(t){return!!t&&"arrayValue"in t}function Os(t){return!!t&&"nullValue"in t}function Ls(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ps(t){return!!t&&"mapValue"in t}function Fs(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){var e={mapValue:{fields:{}}};return is(t.mapValue.fields,(function(t,n){return e.mapValue.fields[t]=Fs(n)})),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Fs(t.arrayValue.values[r]);return n}return Object.assign({},t)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ms=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!Ps(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Fs(e)},t.prototype.setAll=function(t){var e=this,n=cs.emptyPath(),r={},i=[];t.forEach((function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=Fs(t):i.push(o.lastSegment())}));var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());Ps(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return _s(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];Ps(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){is(e,(function(e,n){return t[e]=n}));for(var r=0,i=n;r<i.length;r++){var o=i[r];delete t[o]}},t.prototype.clone=function(){return new t(Fs(this.value))},t}();function Vs(t){var e=[];return is(t.fields,(function(t,n){var r=new cs([t]);if(Ps(n)){var i=Vs(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var a=s[o];e.push(r.child(a))}}else e.push(r)})),new hs(e)
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var Us=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,ns.min(),Ms.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,Ms.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,Ms.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=Ms.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=Ms.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),qs=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function js(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new qs(t,e,n,r,i,o,s)}function Bs(t){var e=Wo(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+Ds(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),bs(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=ea(e.startAt)),e.endAt&&(n+="|ub:",n+=ea(e.endAt)),e.h=n}return e.h}function $s(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!ra(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!_s(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!oa(t.startAt,e.startAt)&&oa(t.endAt,e.endAt)}function Ks(t){return Is.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var zs=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return _t(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new Gs(t,n,r):"array-contains"===n?new Ys(t,r):"in"===n?new Xs(t,r):"not-in"===n?new Js(t,r):"array-contains-any"===n?new Zs(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new Hs(t,n):new Qs(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(Ns(e,this.value)):null!==e&&Ts(this.value)===Ts(e)&&this.m(Ns(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Ho()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),Gs=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Is.fromName(r.referenceValue),i}return _t(e,t),e.prototype.matches=function(t){var e=Is.comparator(t.key,this.key);return this.m(e)},e}(zs),Hs=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Ws("in",n),r}return _t(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(zs),Qs=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Ws("not-in",n),r}return _t(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(zs);function Ws(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return Is.fromName(t.referenceValue)}))}var Ys=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return _t(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return Rs(e)&&Ss(e.arrayValue,this.value)},e}(zs),Xs=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return _t(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&Ss(this.value.arrayValue,e)},e}(zs),Js=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return _t(e,t),e.prototype.matches=function(t){if(Ss(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!Ss(this.value.arrayValue,e)},e}(zs),Zs=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return _t(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!Rs(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return Ss(e.value.arrayValue,t)}))},e}(zs),ta=function(t,e){this.position=t,this.before=e};function ea(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return Ds(t)})).join(",")}var na=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function ra(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function ia(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?Is.comparator(Is.fromName(s.referenceValue),n.key):Ns(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function oa(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!_s(t.position[n],e.position[n]))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var sa=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt};function aa(t,e,n,r,i,o,s,a){return new sa(t,e,n,r,i,o,s,a)}function ua(t){return new sa(t)}function ca(t){return!bs(t.limit)&&"F"===t.limitType}function ha(t){return!bs(t.limit)&&"L"===t.limitType}function la(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function fa(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function pa(t){return null!==t.collectionGroup}function da(t){var e=Wo(t);if(null===e.p){e.p=[];var n=fa(e),r=la(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new na(n)),e.p.push(new na(cs.keyField(),"asc"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var a=s[o];e.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new na(cs.keyField(),u))}}}return e.p}function ya(t){var e=Wo(t);if(!e.T)if("F"===e.limitType)e.T=js(e.path,e.collectionGroup,da(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=da(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new na(o.field,s))}var a=e.endAt?new ta(e.endAt.position,!e.endAt.before):null,u=e.startAt?new ta(e.startAt.position,!e.startAt.before):null;e.T=js(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.T}function ga(t,e,n){return new sa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function va(t,e){return $s(ya(t),ya(e))&&t.limitType===e.limitType}function ma(t){return Bs(ya(t))+"|lt:"+t.limitType}function ba(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+Ds(e.value);var e})).join(", ")+"]"),bs(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+ea(t.startAt)),t.endAt&&(e+=", endAt: "+ea(t.endAt)),"Target("+e+")"}(ya(t))+"; limitType="+t.limitType+")"}function wa(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Is.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!ia(t.startAt,da(t),e)||t.endAt&&ia(t.endAt,da(t),e))}(t,e)}function Ea(t){return function(e,n){for(var r=!1,i=0,o=da(t);i<o.length;i++){var s=o[i],a=Ia(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function Ia(t,e,n){var r=t.field.isKeyField()?Is.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?Ns(r,i):Ho()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ho()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ta(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ws(e)?"-0":e}}function _a(t){return{integerValue:""+t}}function Sa(t,e){return Es(e)?_a(e):Ta(t,e)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Na=function(){this._=void 0};function Aa(t,e,n){return t instanceof ka?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof xa?Ra(t,e):t instanceof Oa?La(t,e):function(t,e){var n=Ca(t,e),r=Fa(n)+Fa(t.A);return xs(n)&&xs(t.A)?_a(r):Ta(t.R,r)}(t,e)}function Da(t,e,n){return t instanceof xa?Ra(t,e):t instanceof Oa?La(t,e):n}function Ca(t,e){return t instanceof Pa?xs(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var ka=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _t(e,t),e}(Na),xa=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return _t(e,t),e}(Na);function Ra(t,e){for(var n=Ma(e),r=function(t){n.some((function(e){return _s(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Oa=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return _t(e,t),e}(Na);function La(t,e){for(var n=Ma(e),r=function(t){n=n.filter((function(e){return!_s(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Pa=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return _t(e,t),e}(Na);function Fa(t){return ds(t.integerValue||t.doubleValue)}function Ma(t){return Rs(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Va=function(t,e){this.field=t,this.transform=e},Ua=function(t,e){this.version=t,this.transformResults=e},qa=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function ja(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var Ba=function(){};function $a(t,e,n){t instanceof Qa?function(t,e,n){var r=t.value.clone(),i=Xa(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof Wa?function(t,e,n){if(ja(t.precondition,e)){var r=Xa(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(Ya(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Ka(t,e,n){t instanceof Qa?function(t,e,n){if(ja(t.precondition,e)){var r=t.value.clone(),i=Ja(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(Ha(e),r).setHasLocalMutations()}}(t,e,n):t instanceof Wa?function(t,e,n){if(ja(t.precondition,e)){var r=Ja(t.fieldTransforms,n,e),i=e.data;i.setAll(Ya(t)),i.setAll(r),e.convertToFoundDocument(Ha(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){ja(t.precondition,e)&&e.convertToNoDocument(ns.min())}(t,e)}function za(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=Ca(o.transform,s||null);null!=a&&(null==n&&(n=Ms.empty()),n.set(o.field,a))}return n||null}function Ga(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Zo(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof xa&&e instanceof xa||t instanceof Oa&&e instanceof Oa?Zo(t.elements,e.elements,_s):t instanceof Pa&&e instanceof Pa?_s(t.A,e.A):t instanceof ka&&e instanceof ka}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Ha(t){return t.isFoundDocument()?t.version:ns.min()}var Qa=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return _t(e,t),e}(Ba),Wa=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return _t(e,t),e}(Ba);function Ya(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function Xa(t,e,n){var r=new Map;Qo(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,Da(s,a,n[i]))}return r}function Ja(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=n.data.field(s.field);r.set(s.field,Aa(a,u,e))}return r}var Za,tu,eu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return _t(e,t),e}(Ba),nu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return _t(e,t),e}(Ba),ru=function(t){this.count=t};function iu(t){switch(t){default:return Ho();case Uo.CANCELLED:case Uo.UNKNOWN:case Uo.DEADLINE_EXCEEDED:case Uo.RESOURCE_EXHAUSTED:case Uo.INTERNAL:case Uo.UNAVAILABLE:case Uo.UNAUTHENTICATED:return!1;case Uo.INVALID_ARGUMENT:case Uo.NOT_FOUND:case Uo.ALREADY_EXISTS:case Uo.PERMISSION_DENIED:case Uo.FAILED_PRECONDITION:case Uo.ABORTED:case Uo.OUT_OF_RANGE:case Uo.UNIMPLEMENTED:case Uo.DATA_LOSS:return!0}}function ou(t){if(void 0===t)return Ko("GRPC error has no .code"),Uo.UNKNOWN;switch(t){case Za.OK:return Uo.OK;case Za.CANCELLED:return Uo.CANCELLED;case Za.UNKNOWN:return Uo.UNKNOWN;case Za.DEADLINE_EXCEEDED:return Uo.DEADLINE_EXCEEDED;case Za.RESOURCE_EXHAUSTED:return Uo.RESOURCE_EXHAUSTED;case Za.INTERNAL:return Uo.INTERNAL;case Za.UNAVAILABLE:return Uo.UNAVAILABLE;case Za.UNAUTHENTICATED:return Uo.UNAUTHENTICATED;case Za.INVALID_ARGUMENT:return Uo.INVALID_ARGUMENT;case Za.NOT_FOUND:return Uo.NOT_FOUND;case Za.ALREADY_EXISTS:return Uo.ALREADY_EXISTS;case Za.PERMISSION_DENIED:return Uo.PERMISSION_DENIED;case Za.FAILED_PRECONDITION:return Uo.FAILED_PRECONDITION;case Za.ABORTED:return Uo.ABORTED;case Za.OUT_OF_RANGE:return Uo.OUT_OF_RANGE;case Za.UNIMPLEMENTED:return Uo.UNIMPLEMENTED;case Za.DATA_LOSS:return Uo.DATA_LOSS;default:return Ho()}}(tu=Za||(Za={}))[tu.OK=0]="OK",tu[tu.CANCELLED=1]="CANCELLED",tu[tu.UNKNOWN=2]="UNKNOWN",tu[tu.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",tu[tu.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",tu[tu.NOT_FOUND=5]="NOT_FOUND",tu[tu.ALREADY_EXISTS=6]="ALREADY_EXISTS",tu[tu.PERMISSION_DENIED=7]="PERMISSION_DENIED",tu[tu.UNAUTHENTICATED=16]="UNAUTHENTICATED",tu[tu.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",tu[tu.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",tu[tu.ABORTED=10]="ABORTED",tu[tu.OUT_OF_RANGE=11]="OUT_OF_RANGE",tu[tu.UNIMPLEMENTED=12]="UNIMPLEMENTED",tu[tu.INTERNAL=13]="INTERNAL",tu[tu.UNAVAILABLE=14]="UNAVAILABLE",tu[tu.DATA_LOSS=15]="DATA_LOSS";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var su=function(){function t(t,e){this.comparator=t,this.root=e||uu.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,uu.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,uu.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new au(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new au(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new au(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new au(this.root,t,this.comparator,!0)},t}(),au=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),uu=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Ho();if(this.right.isRed())throw Ho();var t=this.left.check();if(t!==this.right.check())throw Ho();return t+(this.isRed()?0:1)},t}();uu.EMPTY=null,uu.RED=!0,uu.BLACK=!1,uu.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Ho()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Ho()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Ho()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Ho()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Ho()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new uu(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var cu=function(){function t(t){this.comparator=t,this.data=new su(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new hu(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new hu(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),hu=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),lu=new su(Is.comparator);function fu(){return lu}var pu=new su(Is.comparator);function du(){return pu}var yu=new su(Is.comparator);var gu=new cu(Is.comparator);function vu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=gu,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var mu=new cu(Jo);function bu(){return mu}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var wu=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,Eu.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(ns.min(),r,bu(),fu(),vu())},t}(),Eu=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(ls.EMPTY_BYTE_STRING,n,vu(),vu(),vu())},t}(),Iu=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},Tu=function(t,e){this.targetId=t,this.V=e},_u=function(t,e,n,r){void 0===n&&(n=ls.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Su=function(){function t(){this.S=0,this.D=Du(),this.C=ls.EMPTY_BYTE_STRING,this.N=!1,this.k=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"F",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.k},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.k=!0,this.C=t)},t.prototype.M=function(){var t=vu(),e=vu(),n=vu();return this.D.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Ho()}})),new Eu(this.C,this.N,t,e,n)},t.prototype.L=function(){this.k=!1,this.D=Du()},t.prototype.B=function(t,e){this.k=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.k=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.k=!0,this.N=!0},t}(),Nu=function(){function t(t){this.W=t,this.G=new Map,this.H=fu(),this.J=Au(),this.Y=new cu(Jo)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.F||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.F||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:Ho()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach((function(t,r){n.st(r)&&e(r)}))},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(Ks(i))if(0===n){var o=new Is(i.path);this.tt(e,o,Us.newNoDocument(o,ns.min()))}else Qo(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach((function(r,i){var o=e.ot(i);if(o){if(r.current&&Ks(o.target)){var s=new Is(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,Us.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}}));var r=vu();this.J.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new wu(t,n,this.Y,this.H,r);return this.H=fu(),this.J=Au(),this.Y=new cu(Jo),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new Su,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new cu(Jo),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||$o("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.F?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new Su),this.W.getRemoteKeysForTarget(t).forEach((function(n){e.tt(t,n,null)}))},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function Au(){return new su(Is.comparator)}function Du(){return new su(Is.comparator)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Cu={asc:"ASCENDING",desc:"DESCENDING"},ku={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},xu=function(t,e){this.databaseId=t,this.I=e};function Ru(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ou(t,e){return t.I?e.toBase64():e.toUint8Array()}function Lu(t,e){return Ru(t,e.toTimestamp())}function Pu(t){return Qo(!!t),ns.fromTimestamp(function(t){var e=ps(t);return new es(e.seconds,e.nanos)}(t))}function Fu(t,e){return function(t){return new as(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Mu(t){var e=as.fromString(t);return Qo(sc(e)),e}function Vu(t,e){return Fu(t.databaseId,e.path)}function Uu(t,e){var n=Mu(e);if(n.get(1)!==t.databaseId.projectId)throw new qo(Uo.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new qo(Uo.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Is($u(n))}function qu(t,e){return Fu(t.databaseId,e)}function ju(t){var e=Mu(t);return 4===e.length?as.emptyPath():$u(e)}function Bu(t){return new as(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function $u(t){return Qo(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Ku(t,e,n){return{name:Vu(t,e),fields:n.value.mapValue.fields}}function zu(t,e){var n;if(e instanceof Qa)n={update:Ku(t,e.key,e.value)};else if(e instanceof eu)n={delete:Vu(t,e.key)};else if(e instanceof Wa)n={update:Ku(t,e.key,e.data),updateMask:oc(e.fieldMask)};else{if(!(e instanceof nu))return Ho();n={verify:Vu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof ka)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof xa)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Oa)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Pa)return{fieldPath:e.field.canonicalString(),increment:n.A};throw Ho()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Lu(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Ho()}(t,e.precondition)),n}function Gu(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?qa.updateTime(Pu(t.updateTime)):void 0!==t.exists?qa.exists(t.exists):qa.none()}(e.currentDocument):qa.none(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)Qo("REQUEST_TIME"===e.setToServerValue),n=new ka;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new xa(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new Oa(i)}else"increment"in e?n=new Pa(t,e.increment):Ho();var o=cs.fromServerFormat(e.fieldPath);return new Va(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=Uu(t,e.update.name),o=new Ms({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){var e=t.fieldPaths||[];return new hs(e.map((function(t){return cs.fromServerFormat(t)})))}(e.updateMask);return new Wa(i,o,s,n,r)}return new Qa(i,o,n,r)}if(e.delete){var a=Uu(t,e.delete);return new eu(a,n)}if(e.verify){var u=Uu(t,e.verify);return new nu(u,n)}return Ho()}function Hu(t,e){return{documents:[qu(t,e.path)]}}function Qu(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=qu(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=qu(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(Ls(t.value))return{unaryFilter:{field:ec(t.field),op:"IS_NAN"}};if(Os(t.value))return{unaryFilter:{field:ec(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ls(t.value))return{unaryFilter:{field:ec(t.field),op:"IS_NOT_NAN"}};if(Os(t.value))return{unaryFilter:{field:ec(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ec(t.field),op:tc(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:ec(t.field),direction:Zu(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.I||bs(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=Xu(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Xu(e.endAt)),n}function Wu(t){var e=ju(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Qo(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=Yu(n.where));var a=[];n.orderBy&&(a=n.orderBy.map((function(t){return function(t){return new na(nc(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return bs(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Ju(n.startAt));var h=null;return n.endAt&&(h=Ju(n.endAt)),aa(e,i,a,s,u,"F",c,h)}function Yu(t){return t?void 0!==t.unaryFilter?[ic(t)]:void 0!==t.fieldFilter?[rc(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return Yu(t)})).reduce((function(t,e){return t.concat(e)})):Ho():[]}function Xu(t){return{before:t.before,values:t.position}}function Ju(t){var e=!!t.before,n=t.values||[];return new ta(n,e)}function Zu(t){return Cu[t]}function tc(t){return ku[t]}function ec(t){return{fieldPath:t.canonicalString()}}function nc(t){return cs.fromServerFormat(t.fieldPath)}function rc(t){return zs.create(nc(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ho()}}(t.fieldFilter.op),t.fieldFilter.value)}function ic(t){switch(t.unaryFilter.op){case"IS_NAN":var e=nc(t.unaryFilter.field);return zs.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=nc(t.unaryFilter.field);return zs.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=nc(t.unaryFilter.field);return zs.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=nc(t.unaryFilter.field);return zs.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Ho()}}function oc(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function sc(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ac(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=cc(e)),e=uc(t.get(n),e);return cc(e)}function uc(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function cc(t){return t+""}function hc(t){var e=t.length;if(Qo(e>=2),2===e)return Qo(""===t.charAt(0)&&""===t.charAt(1)),as.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&Ho(),t.charAt(s+1)){case"":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Ho()}o=s+2}return new as(r)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var lc=function(t,e){this.seconds=t,this.nanoseconds=e},fc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};fc.store="owner",fc.key="owner";var pc=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};pc.store="mutationQueues",pc.keyPath="userId";var dc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};dc.store="mutations",dc.keyPath="batchId",dc.userMutationsIndex="userMutationsIndex",dc.userMutationsKeyPath=["userId","batchId"];var yc=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,ac(e)]},t.key=function(t,e,n){return[t,ac(e),n]},t}();yc.store="documentMutations",yc.PLACEHOLDER=new yc;var gc=function(t,e){this.path=t,this.readTime=e},vc=function(t,e){this.path=t,this.version=e},mc=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};mc.store="remoteDocuments",mc.readTimeIndex="readTimeIndex",mc.readTimeIndexPath="readTime",mc.collectionReadTimeIndex="collectionReadTimeIndex",mc.collectionReadTimeIndexPath=["parentPath","readTime"];var bc=function(t){this.byteSize=t};bc.store="remoteDocumentGlobal",bc.key="remoteDocumentGlobalKey";var wc=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};wc.store="targets",wc.keyPath="targetId",wc.queryTargetsIndexName="queryTargetsIndex",wc.queryTargetsKeyPath=["canonicalId","targetId"];var Ec=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ec.store="targetDocuments",Ec.keyPath=["targetId","path"],Ec.documentTargetsIndex="documentTargetsIndex",Ec.documentTargetsKeyPath=["path","targetId"];var Ic=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Ic.key="targetGlobalKey",Ic.store="targetGlobal";var Tc=function(t,e){this.collectionId=t,this.parent=e};Tc.store="collectionParents",Tc.keyPath=["collectionId","parent"];var _c=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};_c.store="clientMetadata",_c.keyPath="clientId";var Sc=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Sc.store="bundles",Sc.keyPath="bundleId";var Nc=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Nc.store="namedQueries",Nc.keyPath="name";var Ac=kt(kt([],kt(kt([],kt(kt([],kt(kt([],[pc.store,dc.store,yc.store,mc.store,wc.store,fc.store,Ic.store,Ec.store]),[_c.store])),[bc.store])),[Tc.store])),[Sc.store,Nc.store]),Dc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Cc=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),kc=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},xc=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&Ho(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),Rc=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new kc,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new Pc(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=qc(e.target.error);n.ft.reject(new Pc(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Pc(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||($o("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Mc(e)},t}(),Oc=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(Ft())&&Ko("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return $o("SimpleDb","Removing database:",t),Vc(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=Ft(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return Nt(this,void 0,void 0,(function(){var e,n=this;return At(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:($o("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new Pc(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new qo(Uo.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new Pc(t,n))},i.onupgradeneeded=function(t){$o("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.wt.Rt(e,i.transaction,t.oldVersion,n.version).next((function(){$o("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}}))}))},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Nt(this,void 0,void 0,(function(){var i,o,s,a,u;return At(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,h;return At(this,(function(l){switch(l.label){case 0:++o,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,a.At(t)];case 2:return a.db=l.sent(),e=Rc.open(a.db,t,i?"readonly":"readwrite",n),s=r(e).catch((function(t){return e.abort(t),xc.reject(t)})).toPromise(),u={},s.catch((function(){})),[4,e.dt];case 3:return[2,(u.value=(l.sent(),s),u)];case 4:return c=l.sent(),h="FirebaseError"!==c.name&&o<3,$o("SimpleDb","Transaction failed with error:",c.message,"Retrying:",h),a.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Lc=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return Vc(this.Pt.delete())},t}(),Pc=function(t){function e(e,n){var r=this;return(r=t.call(this,Uo.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return _t(e,t),e}(qo);function Fc(t){return"IndexedDbTransactionError"===t.name}var Mc=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?($o("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):($o("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Vc(n)},t.prototype.add=function(t){return $o("SimpleDb","ADD",this.store.name,t,t),Vc(this.store.add(t))},t.prototype.get=function(t){var e=this;return Vc(this.store.get(t)).next((function(n){return void 0===n&&(n=null),$o("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return $o("SimpleDb","DELETE",this.store.name,t),Vc(this.store.delete(t))},t.prototype.count=function(){return $o("SimpleDb","COUNT",this.store.name),Vc(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.kt=function(t,e){$o("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Ft=!1;var r=this.cursor(n);return this.xt(r,(function(t,e,n){return n.delete()}))},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new xc((function(n,r){e.onerror=function(t){var e=qc(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.xt=function(t,e){var n=[];return new xc((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Lc(i),s=e(i.primaryKey,i.value,o);if(s instanceof xc){var a=s.catch((function(t){return o.done(),xc.reject(t)}));n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return xc.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Ft?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Vc(t){return new xc((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=qc(t.target.error);n(e)}}))}var Uc=!1;function qc(t){var e=Oc._t(Ft());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new qo("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Uc||(Uc=!0,setTimeout((function(){throw r}),0)),r}}return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var jc=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return _t(e,t),e}(Cc);function Bc(t,e){var n=Wo(t);return Oc.It(n.Mt,e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var $c=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&$a(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&Ka(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&Ka(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(ns.min())}))},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),vu())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Zo(this.mutations,t.mutations,(function(t,e){return Ga(t,e)}))&&Zo(this.baseMutations,t.baseMutations,(function(t,e){return Ga(t,e)}))},t}(),Kc=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){Qo(e.mutations.length===r.length);for(var i=yu,o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),zc=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=ns.min()),void 0===o&&(o=ns.min()),void 0===s&&(s=ls.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),Gc=function(t){this.Lt=t};function Hc(t,e){if(e.document)return function(t,e,n){var r=Uu(t,e.name),i=Pu(e.updateTime),o=new Ms({mapValue:{fields:e.fields}}),s=Us.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Is.fromSegments(e.noDocument.path),r=Jc(e.noDocument.readTime),i=Us.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=Is.fromSegments(e.unknownDocument.path);return r=Jc(e.unknownDocument.version),Us.newUnknownDocument(o,r)}return Ho()}function Qc(t,e,n){var r=Wc(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:Vu(t,e.key),fields:e.data.value.mapValue.fields,updateTime:Ru(t,e.version.toTimestamp())}}(t.Lt,e),s=e.hasCommittedMutations;return new mc(null,null,o,s,r,i)}if(e.isNoDocument()){var a=e.key.path.toArray(),u=Xc(e.version);return s=e.hasCommittedMutations,new mc(null,new gc(a,u),null,s,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),h=Xc(e.version);return new mc(new vc(c,h),null,null,!0,r,i)}return Ho()}function Wc(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Yc(t){var e=new es(t[0],t[1]);return ns.fromTimestamp(e)}function Xc(t){var e=t.toTimestamp();return new lc(e.seconds,e.nanoseconds)}function Jc(t){var e=new es(t.seconds,t.nanoseconds);return ns.fromTimestamp(e)}function Zc(t,e){for(var n=(e.baseMutations||[]).map((function(e){return Gu(t.Lt,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var s=e.mutations.map((function(e){return Gu(t.Lt,e)})),a=es.fromMillis(e.localWriteTimeMs);return new $c(e.batchId,a,n,s)}function th(t){var e,n,r=Jc(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Jc(t.lastLimboFreeSnapshotVersion):ns.min();return void 0!==t.query.documents?(Qo(1===(n=t.query).documents.length),e=ya(ua(ju(n.documents[0])))):e=function(t){return ya(Wu(t))}(t.query),new zc(e,t.targetId,0,t.lastListenSequenceNumber,r,i,ls.fromBase64String(t.resumeToken))}function eh(t,e){var n,r=Xc(e.snapshotVersion),i=Xc(e.lastLimboFreeSnapshotVersion);n=Ks(e.target)?Hu(t.Lt,e.target):Qu(t.Lt,e.target);var o=e.resumeToken.toBase64();return new wc(e.targetId,Bs(e.target),r,o,e.sequenceNumber,i,n)}function nh(t){var e=Wu({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?ga(e,e.limit,"L"):e}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var rh=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return ih(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:Jc(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return ih(t).put({bundleId:(n=e).id,createTime:Xc(Pu(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return oh(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:nh(e.bundledQuery),readTime:Jc(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return oh(t).put(function(t){return{name:t.name,readTime:Xc(Pu(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function ih(t){return Bc(t,Sc.store)}function oh(t){return Bc(t,Nc.store)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var sh=function(){function t(){this.Bt=new ah}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),xc.resolve()},t.prototype.getCollectionParents=function(t,e){return xc.resolve(this.Bt.getEntries(e))},t}(),ah=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new cu(as.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new cu(as.comparator)).toArray()},t}(),uh=function(){function t(){this.qt=new ah}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.qt.add(e)}));var o={collectionId:r,parent:ac(i)};return ch(t).put(o)}return xc.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[ts(e),""],!1,!0);return ch(t).Nt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(hc(o.parent))}return n}))},t}();function ch(t){return Bc(t,Tc.store)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var hh={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},lh=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function fh(t,e,n){var r=t.store(dc.store),i=t.store(yc.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},(function(t,e,n){return a++,n.delete()}));o.push(u.next((function(){Qo(1===a)})));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],p=yc.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return xc.waitFor(o).next((function(){return c}))}function ph(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Ho();e=t.noDocument}return JSON.stringify(e).length}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */lh.DEFAULT_COLLECTION_PERCENTILE=10,lh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,lh.DEFAULT=new lh(41943040,lh.DEFAULT_COLLECTION_PERCENTILE,lh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),lh.DISABLED=new lh(-1,0,0);var dh=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Kt={}}return t.Qt=function(e,n,r,i){return Qo(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return gh(t).$t({index:dc.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=vh(t),s=gh(t);return s.add({}).next((function(a){Qo("number"==typeof a);for(var u=new $c(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return zu(t.Lt,e)})),i=n.mutations.map((function(e){return zu(t.Lt,e)}));return new dc(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),h=[],l=new cu((function(t,e){return Jo(t.canonicalString(),e.canonicalString())})),f=0,p=r;f<p.length;f++){var d=p[f],y=yc.key(i.userId,d.key.path,a);l=l.add(d.key.path.popLast()),h.push(s.put(c)),h.push(o.put(y,yc.PLACEHOLDER))}return l.forEach((function(e){h.push(i.Ut.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.Kt[a]=u.keys()})),xc.waitFor(h).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return gh(t).get(e).next((function(t){return t?(Qo(t.userId===n.userId),Zc(n.R,t)):null}))},t.prototype.jt=function(t,e){var n=this;return this.Kt[e]?xc.resolve(this.Kt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.Kt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return gh(t).$t({index:dc.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(Qo(e.batchId>=r),o=Zc(n.R,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return gh(t).$t({index:dc.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return gh(t).Nt(dc.userMutationsIndex,n).next((function(t){return t.map((function(t){return Zc(e.R,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=yc.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return vh(t).$t({range:i},(function(r,i,s){var a=r[0],u=r[1],c=r[2],h=hc(u);if(a===n.userId&&e.path.isEqual(h))return gh(t).get(c).next((function(t){if(!t)throw Ho();Qo(t.userId===n.userId),o.push(Zc(n.R,t))}));s.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new cu(Jo),i=[];return e.forEach((function(e){var o=yc.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=vh(t).$t({range:s},(function(t,i,o){var s=t[0],a=t[1],u=t[2],c=hc(a);s===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(a)})),xc.waitFor(i).next((function(){return n.Wt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=yc.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new cu(Jo);return vh(t).$t({range:s},(function(t,e,o){var s=t[0],u=t[1],c=t[2],h=hc(u);s===n.userId&&r.isPrefixOf(h)?h.length===i&&(a=a.add(c)):o.done()})).next((function(){return n.Wt(t,a)}))},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(gh(t).get(e).next((function(t){if(null===t)throw Ho();Qo(t.userId===n.userId),r.push(Zc(n.R,t))})))})),xc.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return fh(t.Mt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Gt(e.batchId)})),xc.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Gt=function(t){delete this.Kt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return xc.resolve();var r=IDBKeyRange.lowerBound(yc.prefixForUser(e.userId)),i=[];return vh(t).$t({range:r},(function(t,n,r){if(t[0]===e.userId){var o=hc(t[1]);i.push(o)}else r.done()})).next((function(){Qo(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return yh(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return mh(t).get(this.userId).next((function(t){return t||new pc(e.userId,-1,"")}))},t}();function yh(t,e,n){var r=yc.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return vh(t).$t({range:o,Ft:!0},(function(t,n,r){var o=t[0],a=t[1];t[2],o===e&&a===i&&(s=!0),r.done()})).next((function(){return s}))}function gh(t){return Bc(t,dc.store)}function vh(t){return Bc(t,yc.store)}function mh(t){return Bc(t,pc.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var bh=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),wh=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next((function(n){var r=new bh(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next((function(t){return ns.fromTimestamp(new es(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next((function(){return n.Xt(t).next((function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return Eh(t).delete(e.targetId)})).next((function(){return n.Xt(t)})).next((function(e){return Qo(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Eh(t).$t((function(s,a){var u=th(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return xc.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return Eh(t).$t((function(t,n){var r=th(n);e(r)}))},t.prototype.Xt=function(t){return Ih(t).get(Ic.key).next((function(t){return Qo(null!==t),t}))},t.prototype.Zt=function(t,e){return Ih(t).put(Ic.key,e)},t.prototype.te=function(t,e){return Eh(t).put(eh(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=Bs(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Eh(t).$t({range:r,index:wc.queryTargetsIndexName},(function(t,n,r){var o=th(n);$s(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Th(t);return e.forEach((function(e){var s=ac(e.path);i.push(o.put(new Ec(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))})),xc.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Th(t);return xc.forEach(e,(function(e){var o=ac(e.path);return xc.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Th(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Th(t),i=vu();return r.$t({range:n,Ft:!0},(function(t,e,n){var r=hc(t[1]),o=new Is(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=ac(e.path),r=IDBKeyRange.bound([n],[ts(n)],!1,!0),i=0;return Th(t).$t({index:Ec.documentTargetsIndex,Ft:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.lt=function(t,e){return Eh(t).get(e).next((function(t){return t?th(t):null}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Eh(t){return Bc(t,wc.store)}function Ih(t){return Bc(t,Ic.store)}function Th(t){return Bc(t,Ec.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function _h(t){return Nt(this,void 0,void 0,(function(){return At(this,(function(e){if(t.code!==Uo.FAILED_PRECONDITION||t.message!==Dc)throw t;return $o("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Sh(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Jo(n,i);return 0===s?Jo(r,o):s}var Nh=function(){function t(t){this.ne=t,this.buffer=new cu(Sh),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Sh(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Ah=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;$o("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return Nt(e,void 0,void 0,(function(){var e;return At(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return Fc(e=n.sent())?($o("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,_h(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),Dh=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return xc.resolve(Vo.o);var r=new Nh(e);return this.ae.forEachTarget(t,(function(t){return r.re(t.sequenceNumber)})).next((function(){return n.ae.le(t,(function(t){return r.re(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?($o("LruGarbageCollector","Garbage collection skipped; disabled"),xc.resolve(hh)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?($o("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),hh):n.fe(t,e)}))},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,a,u,c=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>c.params.maximumSequenceNumbersToCollect?($o("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)})).next((function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)})).next((function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)})).next((function(t){return u=Date.now(),Bo()<=Zt.DEBUG&&$o("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-h)+"ms"),xc.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),Ch=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new Dh(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.de=function(t){var e=0;return this.le(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return kh(t,n)},t.prototype.removeReference=function(t,e,n){return kh(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return kh(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return mh(t).Ot((function(r){return yh(t,r,e).next((function(t){return t&&(n=!0),xc.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,(function(s,a){if(a<=e){var u=n._e(t,s).next((function(e){if(!e)return o++,r.getEntry(t,s).next((function(){return r.removeEntry(s),Th(t).delete([0,ac(s.path)])}))}));i.push(u)}})).next((function(){return xc.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return kh(t,e)},t.prototype.we=function(t,e){var n,r=Th(t),i=Vo.o;return r.$t({index:Ec.documentTargetsIndex},(function(t,r){var o=t[0];t[1];var s=r.path,a=r.sequenceNumber;0===o?(i!==Vo.o&&e(new Is(hc(n)),i),i=a,n=s):i=Vo.o})).next((function(){i!==Vo.o&&e(new Is(hc(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function kh(t,e){return Th(t).put(function(t,e){return new Ec(0,ac(t.path),e)}(e,t.currentSequenceNumber))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var xh=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.equalsFn(s,t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){is(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];t(s,a)}}))},t.prototype.isEmpty=function(){return os(this.inner)},t}(),Rh=function(){function t(){this.changes=new xh((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:ns.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:Us.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?xc.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),Oh=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return Fh(t).put(Mh(e),n)},t.prototype.removeEntry=function(t,e){var n=Fh(t),r=Mh(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.me(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return Fh(t).get(Mh(e)).next((function(t){return n.ye(e,t)}))},t.prototype.ge=function(t,e){var n=this;return Fh(t).get(Mh(e)).next((function(t){return{document:n.ye(e,t),size:ph(t)}}))},t.prototype.getEntries=function(t,e){var n=this,r=fu();return this.pe(t,e,(function(t,e){var i=n.ye(t,e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.Ee=function(t,e){var n=this,r=fu(),i=new su(Is.comparator);return this.pe(t,e,(function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,ph(e))})).next((function(){return{documents:r,Te:i}}))},t.prototype.pe=function(t,e,n){if(e.isEmpty())return xc.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return Fh(t).$t({range:r},(function(t,e,r){for(var s=Is.fromSegments(t);o&&Is.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=fu(),o=e.path.length+1,s={};if(n.isEqual(ns.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=Wc(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=mc.collectionReadTimeIndex}return Fh(t).$t(s,(function(t,n,s){if(t.length===o){var a=Hc(r.R,n);e.path.isPrefixOf(a.key.path)?wa(e,a)&&(i=i.insert(a.key,a)):s.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new Lh(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return Ph(t).get(bc.key).next((function(t){return Qo(!!t),t}))},t.prototype.me=function(t,e){return Ph(t).put(bc.key,e)},t.prototype.ye=function(t,e){if(e){var n=Hc(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(ns.min()))return n}return Us.newInvalidDocument(t)},t}(),Lh=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new xh((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return _t(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new cu((function(t,e){return Jo(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=Qc(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=ph(u);r+=c-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var h=Qc(e.Ie.R,Us.newNoDocument(o,ns.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,h))}else n.push(e.Ie.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))})),n.push(this.Ie.updateMetadata(t,r)),xc.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next((function(t){return n.Ae.set(e,t.size),t.document}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next((function(t){var e=t.documents;return t.Te.forEach((function(t,e){n.Ae.set(t,e)})),e}))},e}(Rh);
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ph(t){return Bc(t,bc.store)}function Fh(t){return Bc(t,mc.store)}function Mh(t){return t.path.toArray()}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Vh=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;Qo(n<r&&n>=0&&r<=11);var o=new Rc("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(fc.store)}(t),function(t){t.createObjectStore(pc.store,{keyPath:pc.keyPath}),t.createObjectStore(dc.store,{keyPath:dc.keyPath,autoIncrement:!0}).createIndex(dc.userMutationsIndex,dc.userMutationsKeyPath,{unique:!0}),t.createObjectStore(yc.store)}(t),Uh(t),function(t){t.createObjectStore(mc.store)}(t));var s=xc.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Ec.store),t.deleteObjectStore(wc.store),t.deleteObjectStore(Ic.store)}(t),Uh(t)),s=s.next((function(){return function(t){var e=t.store(Ic.store),n=new Ic(0,0,ns.min().toTimestamp(),0);return e.put(Ic.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(dc.store).Nt().next((function(n){t.deleteObjectStore(dc.store),t.createObjectStore(dc.store,{keyPath:dc.keyPath,autoIncrement:!0}).createIndex(dc.userMutationsIndex,dc.userMutationsKeyPath,{unique:!0});var r=e.store(dc.store),i=n.map((function(t){return r.put(t)}));return xc.waitFor(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(_c.store,{keyPath:_c.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.Re(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(bc.store)}(t),i.be(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ve(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.Pe(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(mc.store);e.createIndex(mc.readTimeIndex,mc.readTimeIndexPath,{unique:!1}),e.createIndex(mc.collectionReadTimeIndex,mc.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(Sc.store,{keyPath:Sc.keyPath})}(t),function(t){t.createObjectStore(Nc.store,{keyPath:Nc.keyPath})}(t)}))),s},t.prototype.be=function(t){var e=0;return t.store(mc.store).$t((function(t,n){e+=ph(n)})).next((function(){var n=new bc(e);return t.store(bc.store).put(bc.key,n)}))},t.prototype.Re=function(t){var e=this,n=t.store(pc.store),r=t.store(dc.store);return n.Nt().next((function(n){return xc.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(dc.userMutationsIndex,i).next((function(r){return xc.forEach(r,(function(r){Qo(r.userId===n.userId);var i=Zc(e.R,r);return fh(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ve=function(t){var e=t.store(Ec.store),n=t.store(mc.store);return t.store(Ic.store).get(Ic.key).next((function(t){var r=[];return n.$t((function(n,i){var o=new as(n),s=function(t){return[0,ac(t)]}(o);r.push(e.get(s).next((function(n){return n?xc.resolve():function(n){return e.put(new Ec(0,ac(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return xc.waitFor(r)}))}))},t.prototype.Pe=function(t,e){t.createObjectStore(Tc.store,{keyPath:Tc.keyPath});var n=e.store(Tc.store),r=new ah,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:ac(i)})}};return e.store(mc.store).$t({Ft:!0},(function(t,e){var n=new as(t);return i(n.popLast())})).next((function(){return e.store(yc.store).$t({Ft:!0},(function(t,e){t[0];var n=t[1];t[2];var r=hc(n);return i(r.popLast())}))}))},t.prototype.Ve=function(t){var e=this,n=t.store(wc.store);return n.$t((function(t,r){var i=th(r),o=eh(e.R,i);return n.put(o)}))},t}();function Uh(t){t.createObjectStore(Ec.store,{keyPath:Ec.keyPath}).createIndex(Ec.documentTargetsIndex,Ec.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(wc.store,{keyPath:wc.keyPath}).createIndex(wc.queryTargetsIndexName,wc.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Ic.store)}var qh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",jh=function(){function t(e,n,r,i,o,s,a,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=c,this.Ce=h,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ke=null,this.inForeground=!1,this.Fe=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new qo(Uo.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Ch(this,i),this.Le=n+"main",this.R=new Gc(u),this.Be=new Oc(this.Le,11,new Vh(this.R)),this.qe=new wh(this.referenceDelegate,this.R),this.Ut=new uh,this.Ue=function(t,e){return new Oh(t,e)}(this.R,this.Ut),this.Ke=new rh,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===h&&Ko("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new qo(Uo.FAILED_PRECONDITION,qh);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.qe.getHighestSequenceNumber(e)}))})).then((function(e){t.Ne=new Vo(e,t.De)})).then((function(){t.xe=!0})).catch((function(e){return t.Be&&t.Be.close(),Promise.reject(e)}))},t.prototype.He=function(t){var e=this;return this.Me=function(n){return Nt(e,void 0,void 0,(function(){return At(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt((function(n){return Nt(e,void 0,void 0,(function(){return At(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget((function(){return Nt(e,void 0,void 0,(function(){return At(this,(function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return $h(e).put(new _c(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Je(e).next((function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable((function(){return t.Me(!1)})))}))})).next((function(){return t.Ye(e)})).next((function(n){return t.isPrimary&&!n?t.Xe(e).next((function(){return!1})):!!n&&t.Ze(e).next((function(){return!0}))}))})).catch((function(e){if(Fc(e))return $o("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return $o("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Se.enqueueRetryable((function(){return t.Me(e)})),t.isPrimary=e}))},t.prototype.Je=function(t){var e=this;return Bh(t).get(fc.key).next((function(t){return xc.resolve(e.tn(t))}))},t.prototype.en=function(t){return $h(t).delete(this.clientId)},t.prototype.nn=function(){return Nt(this,void 0,void 0,(function(){var t,e,n,r,i=this;return At(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=Bc(t,_c.store);return e.Nt().next((function(t){var n=i.rn(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return xc.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Qe)for(e=0,n=t;e<n.length;e++)r=n[e],this.Qe.removeItem(this.on(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.je().then((function(){return t.nn()})).then((function(){return t.ze()}))}))},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?xc.resolve(!0):Bh(t).get(fc.key).next((function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new qo(Uo.FAILED_PRECONDITION,qh);return!1}}return!(!e.networkEnabled||!e.inForeground)||$h(t).Nt().next((function(t){return void 0===e.rn(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&$o("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return Nt(this,void 0,void 0,(function(){var t=this;return At(this,(function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[fc.store,_c.store],(function(e){var n=new jc(e,Vo.o);return t.Xe(n).next((function(){return t.en(n)}))}))];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}}))}))},t.prototype.rn=function(t,e){var n=this;return t.filter((function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)}))},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return $h(e).Nt().next((function(e){return t.rn(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return dh.Qt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;$o("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Be.runTransaction(t,o,Ac,(function(o){return i=new jc(o,r.Ne?r.Ne.next():Vo.o),"readwrite-primary"===e?r.Je(i).next((function(t){return!!t||r.Ye(i)})).next((function(e){if(!e)throw Ko("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new qo(Uo.FAILED_PRECONDITION,Dc);return n(i)})).next((function(t){return r.Ze(i).next((function(){return t}))})):r.dn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.dn=function(t){var e=this;return Bh(t).get(fc.key).next((function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new qo(Uo.FAILED_PRECONDITION,qh)}))},t.prototype.Ze=function(t){var e=new fc(this.clientId,this.allowTabSynchronization,Date.now());return Bh(t).put(fc.key,e)},t.yt=function(){return Oc.yt()},t.prototype.Xe=function(t){var e=this,n=Bh(t);return n.get(fc.key).next((function(t){return e.tn(t)?($o("IndexedDbPersistence","Releasing primary lease."),n.delete(fc.key)):xc.resolve()}))},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Ko("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Fe=function(){t.Se.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.je()}))},this.document.addEventListener("visibilitychange",this.Fe),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.Fe&&(this.document.removeEventListener("visibilitychange",this.Fe),this.Fe=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.ke=function(){e.un(),!Mt()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")&&navigator.appVersion.match("Version/14")&&e.Se.enterRestrictedMode(!0),e.Se.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.ke))},t.prototype.hn=function(){this.ke&&(this.window.removeEventListener("pagehide",this.ke),this.ke=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Qe)||void 0===e?void 0:e.getItem(this.on(t)));return $o("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Ko("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(t){Ko("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Bh(t){return Bc(t,fc.store)}function $h(t){return Bc(t,_c.store)}function Kh(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var zh=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.yn(t,e,r)}))},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next((function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t}))},t.prototype.gn=function(t,e){t.forEach((function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)}))},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next((function(e){return n.En(t,e).next((function(){return e}))}))},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.gn(e,t)}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return Is.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):pa(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new Is(e)).next((function(t){var e=du();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=du();return this.Ut.getCollectionParents(t,i).next((function(s){return xc.forEach(s,(function(s){var a=function(t,e){return new sa(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.An(t,a,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.Rn(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,h=r.get(c);null==h&&(h=Us.newInvalidDocument(c),r=r.insert(c,h)),Ka(u,h,o.localWriteTime),h.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(t,n){wa(e,n)||(r=r.remove(t))})),r}))},t.prototype.Rn=function(t,e,n){for(var r=vu(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof Wa&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))})),c}))},t}(),Gh=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=vu(),i=vu(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Hh=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(ns.min())?this.Dn(t,e):this.Sn.pn(t,r).next((function(o){var s=i.Cn(e,o);return(ca(e)||ha(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(Bo()<=Zt.DEBUG&&$o("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),ba(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next((function(t){return s.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.Cn=function(t,e){var n=new cu(Ea(t));return e.forEach((function(e,r){wa(t,r)&&(n=n.add(r))})),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return Bo()<=Zt.DEBUG&&$o("QueryEngine","Using full collection scan to execute query:",ba(e)),this.Sn.getDocumentsMatchingQuery(t,e,ns.min())},t}(),Qh=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.kn=new su(Jo),this.Fn=new xh((function(t){return Bs(t)}),$s),this.$n=ns.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new zh(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.kn)}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Wh(t,e,n,r){return new Qh(t,e,n,r)}function Yh(t,e){return Nt(this,void 0,void 0,(function(){var n,r,i,o;return At(this,(function(s){switch(s.label){case 0:return n=Wo(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n._n.getAllMutationBatches(t).next((function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new zh(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],s=vu(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];s=s.add(f.key)}}for(var p=0,d=e;p<d.length;p++){var y=d[p];r.push(y.batchId);for(var g=0,v=y.mutations;g<v.length;g++){var m=v[g];s=s.add(m.key)}}return i.pn(t,s).next((function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}}))}))}function Xh(t,e){var n=Wo(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=xc.resolve();return o.forEach((function(t){s=s.next((function(){return r.getEntry(e,t)})).next((function(e){var o=n.docVersions.get(t);Qo(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))}))})),s.next((function(){return t._n.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}function Jh(t){var e=Wo(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.qe.getLastRemoteSnapshotVersion(t)}))}function Zh(t,e){var n=Wo(t),r=e.snapshotVersion,i=n.kn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.kn;var s=[];e.targetChanges.forEach((function(e,o){var a=i.get(o);if(a){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)})));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=a.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return Qo(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,c,e)&&s.push(n.qe.updateTargetData(t,c))}}}));var a=fu();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),s.push(function(t,e,n,r,i){var o=vu();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=fu();return n.forEach((function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(ns.min())?(e.removeEntry(n,u),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):$o("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)})),o}))}(t,o,e.documentUpdates,r,void 0).next((function(t){a=t}))),!r.isEqual(ns.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next((function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)}));s.push(u)}return xc.waitFor(s).next((function(){return o.apply(t)})).next((function(){return n.Mn.En(t,a)})).next((function(){return a}))})).then((function(t){return n.kn=i,t}))}function tl(t,e){var n=Wo(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)}))}function el(t,e){var n=Wo(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.qe.getTargetData(t,e).next((function(i){return i?(r=i,xc.resolve(r)):n.qe.allocateTargetId(t).next((function(i){return r=new zc(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.kn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.kn=n.kn.insert(t.targetId,t),n.Fn.set(e,t.targetId)),t}))}function nl(t,e,n){return Nt(this,void 0,void 0,(function(){var r,i,o,s;return At(this,(function(a){switch(a.label){case 0:r=Wo(t),i=r.kn.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.referenceDelegate.removeTarget(t,i)}))];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!Fc(s=a.sent()))throw s;return $o("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.kn=r.kn.remove(e),r.Fn.delete(i.target),[2]}}))}))}function rl(t,e,n){var r=Wo(t),i=ns.min(),o=vu();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=Wo(t),i=r.Fn.get(n);return void 0!==i?xc.resolve(r.kn.get(i)):r.qe.getTargetData(e,n)}(r,t,ya(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:ns.min(),n?o:vu())})).next((function(t){return{documents:t,Bn:o}}))}))}function il(t,e){var n=Wo(t),r=Wo(n.qe),i=n.kn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.lt(t,e).next((function(t){return t?t.target:null}))}))}function ol(t){var e=Wo(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=Wo(t),i=fu(),o=Wc(n),s=Fh(e),a=IDBKeyRange.lowerBound(o,!0);return s.$t({index:mc.readTimeIndex,range:a},(function(t,e){var n=Hc(r.R,e);i=i.insert(n.key,n),o=e.readTime})).next((function(){return{wn:i,readTime:Yc(o)}}))}(e.On,t,e.$n)})).then((function(t){var n=t.wn,r=t.readTime;return e.$n=r,n}))}function sl(t){return Nt(this,void 0,void 0,(function(){var e;return At(this,(function(n){return[2,(e=Wo(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=Fh(t),n=ns.min();return e.$t({index:mc.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=Yc(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.$n=t}))]}))}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var al=function(){function t(t){this.R=t,this.Qn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return xc.resolve(this.Qn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Qn.set(e.id,{id:(n=e).id,version:n.version,createTime:Pu(n.createTime)}),xc.resolve()},t.prototype.getNamedQuery=function(t,e){return xc.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:nh(t.bundledQuery),readTime:Pu(t.readTime)}}(e)),xc.resolve()},t}(),ul=function(){function t(){this.Wn=new cu(cl.Gn),this.zn=new cu(cl.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new cl(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.Yn(new cl(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.Zn=function(t){var e=this,n=new Is(new as([])),r=new cl(n,t),i=new cl(n,t+1),o=[];return this.zn.forEachInRange([r,i],(function(t){e.Yn(t),o.push(t.key)})),o},t.prototype.ts=function(){var t=this;this.Wn.forEach((function(e){return t.Yn(e)}))},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new Is(new as([])),n=new cl(e,t),r=new cl(e,t+1),i=vu();return this.zn.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new cl(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),cl=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return Is.comparator(t.key,e.key)||Jo(t.ns,e.ns)},t.Hn=function(t,e){return Jo(t.ns,e.ns)||Is.comparator(t.key,e.key)},t}(),hl=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new cu(cl.Gn)}return t.prototype.checkEmpty=function(t){return xc.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new $c(i,e,n,r);this._n.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.rs=this.rs.add(new cl(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return xc.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return xc.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.cs(n),i=r<0?0:r;return xc.resolve(this._n.length>i?this._n[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return xc.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return xc.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new cl(e,0),i=new cl(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(t){var e=n.os(t.ns);o.push(e)})),xc.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new cu(Jo);return e.forEach((function(t){var e=new cl(t,0),i=new cl(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],(function(t){r=r.add(t.ns)}))})),xc.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;Is.isDocumentKey(i)||(i=i.child(""));var o=new cl(new Is(i),0),s=new cu(Jo);return this.rs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)}),o),xc.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.os(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;Qo(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return xc.forEach(e.mutations,(function(i){var o=new cl(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.rs=r}))},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new cl(e,0),r=this.rs.firstAfterOrEqual(n);return xc.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return this._n.length,xc.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),ll=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new su(Is.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return xc.resolve(n?n.document.clone():Us.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=fu();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():Us.newInvalidDocument(t))})),xc.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=fu(),i=new Is(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.key,u=s.value,c=u.document,h=u.readTime;if(!e.path.isPrefixOf(a.path))break;h.compareTo(n)<=0||wa(e,c)&&(r=r.insert(c.key,c.clone()))}return xc.resolve(r)},t.prototype.fs=function(t,e){return xc.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new fl(this)},t.prototype.getSize=function(t){return xc.resolve(this.size)},t}(),fl=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return _t(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)})),xc.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(Rh),pl=function(){function t(t){this.persistence=t,this.ds=new xh((function(t){return Bs(t)}),$s),this.lastRemoteSnapshotVersion=ns.min(),this.highestTargetId=0,this.ws=0,this._s=new ul,this.targetCount=0,this.ys=bh.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach((function(t,n){return e(n)})),xc.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return xc.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return xc.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),xc.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),xc.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new bh(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,xc.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),xc.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,xc.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach((function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)})),xc.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return xc.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return xc.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),xc.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),xc.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),xc.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return xc.resolve(n)},t.prototype.containsKey=function(t,e){return xc.resolve(this._s.containsKey(e))},t}(),dl=function(){function t(t,e){var n=this;this.gs={},this.Ne=new Vo(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new pl(this),this.Ut=new sh,this.Ue=function(t,e){return new ll(t,(function(t){return n.referenceDelegate.ps(t)}))}(this.Ut),this.R=new Gc(e),this.Ke=new al(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new hl(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;$o("MemoryPersistence","Starting transaction:",t);var i=new yl(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(t){return r.referenceDelegate.Ts(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Is=function(t,e){return xc.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),yl=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return _t(e,t),e}(Cc),gl=function(){function t(t){this.persistence=t,this.As=new ul,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw Ho()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),xc.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),xc.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),xc.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach((function(t){return n.vs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.vs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return xc.forEach(this.vs,(function(r){var i=Is.fromPath(r);return e.Ps(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Rs=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next((function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())}))},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return xc.or([function(){return xc.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),vl=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ml(t,e){return"firestore_clients_"+t+"_"+e}function bl(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function wl(t,e){return"firestore_targets_"+t+"_"+e}vl.UNAUTHENTICATED=new vl(null),vl.GOOGLE_CREDENTIALS=new vl("google-credentials-uid"),vl.FIRST_PARTY=new vl("first-party-uid"),vl.MOCK_USER=new vl("mock-user");var El=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new qo(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(Ko("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Il=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new qo(i.error.code,i.error.message)),o?new t(e,i.state,r):(Ko("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Tl=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=bu(),s=0;i&&s<r.activeTargetIds.length;++s)i=Es(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(Ko("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),_l=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Ko("SharedClientState","Failed to parse online state: "+e),null)},t}(),Sl=function(){function t(){this.activeTargetIds=bu()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Nl=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.ks.bind(this),this.Fs=new su(Jo),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=ml(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Fs=this.Fs.insert(this.Ns,new Sl),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Ks=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Nt(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,a,u,c,h,l=this;return At(this,(function(f){switch(f.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(ml(this.persistenceKey,r)))&&(o=Tl.Vs(r,i))&&(this.Fs=this.Fs.insert(o.clientId,o));for(this.Qs(),(s=this.storage.getItem(this.Us))&&(a=this.js(s))&&this.Ws(a),u=0,c=this.$s;u<c.length;u++)h=c[u],this.ks(h);return this.$s=[],this.window.addEventListener("pagehide",(function(){return l.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.Fs)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.Fs.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(wl(this.persistenceKey,t));if(n){var r=Il.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Qs(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(wl(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.Hs(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return $o("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){$o("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){$o("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.ks=function(t){var e=this,n=t;if(n.storageArea===this.storage){if($o("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void Ko("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return Nt(e,void 0,void 0,(function(){var t,e,r,i,o,s;return At(this,(function(a){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(s=function(t){var e=Vo.o;if(null!=t)try{var n=JSON.parse(t);Qo("number"==typeof n),e=n}catch(t){Ko("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Vo.o&&this.sequenceNumberHandler(s);else if(n.key===this.Ks)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.Fs.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new El(this.currentUser,t,e,n),i=bl(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=bl(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){var e={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(e))},t.prototype.Ys=function(t,e,n){var r=wl(this.persistenceKey,t),i=new Il(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return Tl.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return El.Vs(new vl(i),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return Il.Vs(r,e)},t.prototype.js=function(t){return _l.Vs(t)},t.prototype.ii=function(t){return Nt(this,void 0,void 0,(function(){return At(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:($o("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.Fs.insert(t,e):this.Fs.remove(t),i=this.Gs(this.Fs),o=this.Gs(r),s=[],a=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||a.push(t)})),this.syncEngine.hi(s,a).then((function(){n.Fs=r}))},t.prototype.Ws=function(t){this.Fs.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=bu();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),Al=function(){function t(){this.li=new Sl,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new Sl,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),Dl=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),Cl=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){$o("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){$o("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),kl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},xl=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),Rl=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return _t(e,t),e.prototype.Fi=function(t,e,n,r){return new Promise((function(i,o){var s=new Mo;s.listenOnce(xo.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case ko.NO_ERROR:var e=s.getResponseJson();$o("Connection","XHR received:",JSON.stringify(e)),i(e);break;case ko.TIMEOUT:$o("Connection",'RPC "'+t+'" timed out'),o(new qo(Uo.DEADLINE_EXCEEDED,"Request time out"));break;case ko.HTTP_ERROR:var n=s.getStatus();if($o("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Uo).indexOf(e)>=0?e:Uo.UNKNOWN}(r.status);o(new qo(a,r.message))}else o(new qo(Uo.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new qo(Uo.UNAVAILABLE,"Connection failed."));break;default:Ho()}}finally{$o("Connection",'RPC "'+t+'" completed.')}}));var a=JSON.stringify(r);s.send(e,"POST",a,n,15)}))},e.prototype.Oi=function(t,e){var n,r=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new So,o=vr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(s.xmlHttpFactory=new Po({})),this.ki(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ft())||"object"==typeof navigator&&"ReactNative"===navigator.product||Ft().indexOf("Electron/")>=0||function(){var t=Ft();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||Ft().indexOf("MSAppHost/")>=0||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=r.join("");$o("Connection","Creating WebChannel: "+a,s);var u=i.createWebChannel(a,s),c=!1,h=!1,l=new xl({Ei:function(t){h?$o("Connection","Not sending because WebChannel is closed:",t):(c||($o("Connection","Opening WebChannel transport."),u.open(),c=!0),$o("Connection","WebChannel sending:",t),u.send(t))},Ti:function(){return u.close()}}),f=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(u,Fo.EventType.OPEN,(function(){h||$o("Connection","WebChannel transport opened.")})),f(u,Fo.EventType.CLOSE,(function(){h||(h=!0,$o("Connection","WebChannel transport closed"),l.Vi())})),f(u,Fo.EventType.ERROR,(function(t){h||(h=!0,zo("Connection","WebChannel transport errored:",t),l.Vi(new qo(Uo.UNAVAILABLE,"The operation could not be completed")))})),f(u,Fo.EventType.MESSAGE,(function(t){var e;if(!h){var n=t.data[0];Qo(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){$o("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=Za[t];if(void 0!==e)return ou(e)}(o),a=i.message;void 0===s&&(s=Uo.INTERNAL,a="Unknown error status: "+o+" with message "+i.message),h=!0,l.Vi(new qo(s,a)),u.close()}else $o("Connection","WebChannel received:",n),l.Si(n)}})),f(o,Ro.STAT_EVENT,(function(t){t.stat===Oo?$o("Connection","Detected buffering proxy"):t.stat===Lo&&$o("Connection","Detected no buffering proxy")})),setTimeout((function(){l.Pi()}),0),l},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);$o("RestConnection","Sending: ",i,n);var o={};return this.ki(o,r),this.Fi(t,i,o,n).then((function(t){return $o("RestConnection","Received: ",t),t}),(function(e){throw zo("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.ki=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.10.0",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){var n=kl[t];return this.Di+"/v1/"+e+":"+n},t}());
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ol(){return"undefined"!=typeof window?window:null}function Ll(){return"undefined"!=typeof document?document:null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Pl(t){return new xu(t,!0)}var Fl=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Qi=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Ki),i=Math.max(0,n-r);i>0&&$o("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return e.Ki=Date.now(),t()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),Ml=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Fl(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return Nt(this,void 0,void 0,(function(){return At(this,(function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return t.rr()})))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return Nt(this,void 0,void 0,(function(){return At(this,(function(t){return this.er()?[2,this.close(0)]:[2]}))}))},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return Nt(this,void 0,void 0,(function(){return At(this,(function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===Uo.RESOURCE_EXHAUSTED?(Ko(e.toString()),Ko("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):e&&e.code===Uo.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(e){t.Yi===n&&t.lr(e)}),(function(n){e((function(){var e=new qo(Uo.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)}))}))},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii((function(){n((function(){return e.state=2,e.listener.Ii()}))})),this.stream.Ri((function(t){n((function(){return e.dr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji((function(){return Nt(t,void 0,void 0,(function(){return At(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.dr=function(t){return $o("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget((function(){return e.Yi===t?n():($o("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Vl=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return _t(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Ho()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(Qo(void 0===e||"string"==typeof e),ls.fromBase64String(e||"")):(Qo(void 0===e||e instanceof Uint8Array),ls.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?Uo.UNKNOWN:ou(t.code);return new qo(e,t.message||"")}(a);n=new _u(r,i,o,s||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=Uu(t,r.document.name),o=Pu(r.document.updateTime);var a=new Ms({mapValue:{fields:r.document.fields}}),u=(s=Us.newFoundDocument(i,o,a),r.targetIds||[]),c=r.removedTargetIds||[];n=new Iu(u,c,s.key,s)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=Uu(t,r.document),o=r.readTime?Pu(r.readTime):ns.min(),a=Us.newNoDocument(i,o),s=r.removedTargetIds||[],n=new Iu([],s,a.key,a);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=Uu(t,r.document),o=r.removedTargetIds||[],n=new Iu([],o,i,null);else{if(!("filter"in e))return Ho();e.filter;var h=e.filter;h.targetId,r=h.count||0,i=new ru(r),o=h.targetId,n=new Tu(o,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return ns.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?ns.min():e.readTime?Pu(e.readTime):ns.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=Bu(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=Ks(r)?{documents:Hu(t,r)}:{query:Qu(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Ou(t,e.resumeToken):e.snapshotVersion.compareTo(ns.min())>0&&(n.readTime=Ru(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Ho()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=Bu(this.R),e.removeTarget=t,this.cr(e)},e}(Ml),Ul=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return _t(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(Qo(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(Qo(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?Pu(t.updateTime):Pu(e);return n.isEqual(ns.min())&&(n=Pu(e)),new Ua(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=Pu(t.commitTime);return this.listener.Tr(n,e)}return Qo(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=Bu(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return zu(e.R,t)}))};this.cr(n)},e}(Ml),ql=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return _t(e,t),e.prototype.br=function(){if(this.Rr)throw new qo(Uo.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===Uo.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new qo(Uo.UNKNOWN,t.toString())}))},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.$i(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===Uo.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new qo(Uo.UNKNOWN,t.toString())}))},e.prototype.terminate=function(){this.Rr=!0},e}((function(){})),jl=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()})))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.kr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.kr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(Ko(e),this.Vr=!1):$o("OnlineStateTracker",e)},t.prototype.kr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),Bl=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Fr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di((function(t){n.enqueueAndForget((function(){return Nt(o,void 0,void 0,(function(){return At(this,(function(t){switch(t.label){case 0:return Xl(this)?($o("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Nt(this,void 0,void 0,(function(){var e;return At(this,(function(n){switch(n.label){case 0:return(e=Wo(t)).Or.add(4),[4,Kl(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,$l(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Br=new jl(n,r)};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function $l(t){return Nt(this,void 0,void 0,(function(){var e,n;return At(this,(function(r){switch(r.label){case 0:if(!Xl(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Kl(t){return Nt(this,void 0,void 0,(function(){var e,n;return At(this,(function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function zl(t,e){var n=Wo(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),Yl(n)?Wl(n):pf(n).er()&&Hl(n,e))}function Gl(t,e){var n=Wo(t),r=pf(n);n.$r.delete(e),r.er()&&Ql(n,e),0===n.$r.size&&(r.er()?r.ir():Xl(n)&&n.Br.set("Unknown"))}function Hl(t,e){t.qr.U(e.targetId),pf(t).mr(e)}function Ql(t,e){t.qr.U(e),pf(t).yr(e)}function Wl(t){t.qr=new Nu({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),pf(t).start(),t.Br.Sr()}function Yl(t){return Xl(t)&&!pf(t).tr()&&t.$r.size>0}function Xl(t){return 0===Wo(t).Or.size}function Jl(t){t.qr=void 0}function Zl(t){return Nt(this,void 0,void 0,(function(){return At(this,(function(e){return t.$r.forEach((function(e,n){Hl(t,e)})),[2]}))}))}function tf(t,e){return Nt(this,void 0,void 0,(function(){return At(this,(function(n){return Jl(t),Yl(t)?(t.Br.Nr(e),Wl(t)):t.Br.set("Unknown"),[2]}))}))}function ef(t,e,n){return Nt(this,void 0,void 0,(function(){var r,i,o;return At(this,(function(s){switch(s.label){case 0:if(t.Br.set("Online"),!(e instanceof _u&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Nt(this,void 0,void 0,(function(){var n,r,i,o;return At(this,(function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?(o=i[r],t.$r.has(o)?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]):[3,5];case 2:s.sent(),t.$r.delete(o),t.qr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),$o("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,nf(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Iu?t.qr.X(e):e instanceof Tu?t.qr.rt(e):t.qr.et(e),n.isEqual(ns.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,Jh(t.localStore)];case 8:return i=s.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(ls.EMPTY_BYTE_STRING,n.snapshotVersion)),Ql(t,e);var r=new zc(n.target,e,1,n.sequenceNumber);Hl(t,r)}})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return $o("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,nf(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}}))}))}function nf(t,e,n){return Nt(this,void 0,void 0,(function(){var r=this;return At(this,(function(i){switch(i.label){case 0:if(!Fc(e))throw e;return t.Or.add(1),[4,Kl(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return Jh(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return Nt(r,void 0,void 0,(function(){return At(this,(function(e){switch(e.label){case 0:return $o("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,$l(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function rf(t,e){return e().catch((function(n){return nf(t,n,e)}))}function of(t){return Nt(this,void 0,void 0,(function(){var e,n,r,i,o;return At(this,(function(s){switch(s.label){case 0:e=Wo(t),n=df(e),r=e.Fr.length>0?e.Fr[e.Fr.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return Xl(t)&&t.Fr.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,tl(e.localStore,r)];case 3:return null===(i=s.sent())?(0===e.Fr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.Fr.push(e);var n=df(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,nf(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return sf(e)&&af(e),[2]}}))}))}function sf(t){return Xl(t)&&!df(t).tr()&&t.Fr.length>0}function af(t){df(t).start()}function uf(t){return Nt(this,void 0,void 0,(function(){return At(this,(function(e){return df(t).Ar(),[2]}))}))}function cf(t){return Nt(this,void 0,void 0,(function(){var e,n,r,i;return At(this,(function(o){for(e=df(t),n=0,r=t.Fr;n<r.length;n++)i=r[n],e.Er(i.mutations);return[2]}))}))}function hf(t,e,n){return Nt(this,void 0,void 0,(function(){var r,i;return At(this,(function(o){switch(o.label){case 0:return r=t.Fr.shift(),i=Kc.from(r,e,n),[4,rf(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,of(t)];case 2:return o.sent(),[2]}}))}))}function lf(t,e){return Nt(this,void 0,void 0,(function(){return At(this,(function(n){switch(n.label){case 0:return e&&df(t).pr?[4,function(t,e){return Nt(this,void 0,void 0,(function(){var n,r;return At(this,(function(i){switch(i.label){case 0:return iu(r=e.code)&&r!==Uo.ABORTED?(n=t.Fr.shift(),df(t).sr(),[4,rf(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,of(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return sf(t)&&af(t),[2]}}))}))}function ff(t,e){return Nt(this,void 0,void 0,(function(){var n;return At(this,(function(r){switch(r.label){case 0:return n=Wo(t),e?(n.Or.delete(2),[4,$l(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,Kl(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function pf(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=Wo(t);return r.br(),new Vl(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Zl.bind(null,t),Ri:tf.bind(null,t),_r:ef.bind(null,t)}),t.Mr.push((function(n){return Nt(e,void 0,void 0,(function(){return At(this,(function(e){switch(e.label){case 0:return n?(t.Ur.sr(),Yl(t)?Wl(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),Jl(t),e.label=3;case 3:return[2]}}))}))}))),t.Ur}function df(t){var e=this;return t.Kr||(t.Kr=function(t,e,n){var r=Wo(t);return r.br(),new Ul(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:uf.bind(null,t),Ri:lf.bind(null,t),Ir:cf.bind(null,t),Tr:hf.bind(null,t)}),t.Mr.push((function(n){return Nt(e,void 0,void 0,(function(){return At(this,(function(e){switch(e.label){case 0:return n?(t.Kr.sr(),[4,of(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kr.stop()];case 3:e.sent(),t.Fr.length>0&&($o("RemoteStore","Stopping write stream with "+t.Fr.length+" pending writes"),t.Fr=[]),e.label=4;case 4:return[2]}}))}))}))),t.Kr
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var yf=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new kc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new qo(Uo.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function gf(t,e){if(Ko("AsyncQueue",e+": "+t),Fc(t))return new qo(Uo.UNAVAILABLE,e+": "+t);throw t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var vf=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||Is.comparator(e.key,n.key)}:function(t,e){return Is.comparator(t.key,e.key)},this.keyedMap=du(),this.sortedSet=new su(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),mf=function(){function t(){this.Qr=new su(Is.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Qr.get(e);n?0!==t.type&&3===n.type?this.Qr=this.Qr.insert(e,t):3===t.type&&1!==n.type?this.Qr=this.Qr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Qr=this.Qr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Qr=this.Qr.remove(e):1===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):Ho():this.Qr=this.Qr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Qr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),bf=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,vf.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&va(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),wf=function(){this.Wr=void 0,this.listeners=[]},Ef=function(){this.queries=new xh((function(t){return ma(t)}),va),this.onlineState="Unknown",this.Gr=new Set};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function If(t,e){return Nt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u;return At(this,(function(c){switch(c.label){case 0:if(n=Wo(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new wf),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=c.sent(),[3,4];case 3:return a=c.sent(),u=gf(a,"Initialization of query '"+ba(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&Nf(n),[2]}}))}))}function Tf(t,e){return Nt(this,void 0,void 0,(function(){var n,r,i,o,s;return At(this,(function(a){return n=Wo(t),r=e.query,i=!1,(o=n.queries.get(r))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function _f(t,e){for(var n=Wo(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,u=n.queries.get(a);if(u){for(var c=0,h=u.listeners;c<h.length;c++)h[c].Hr(s)&&(r=!0);u.Wr=s}}r&&Nf(n)}function Sf(t,e,n){var r=Wo(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Nf(t){t.Gr.forEach((function(t){t.next()}))}var Af=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new bf(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.so&&n||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=bf.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),Df=function(t){this.key=t},Cf=function(t){this.key=t},kf=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=vu(),this.mutatedKeys=vu(),this.lo=Ea(t),this.fo=new vf(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new mf,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=ca(this.query)&&i.size===this.query.limit?i.last():null,c=ha(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var h=i.get(t),l=wa(n.query,e)?e:null,f=!!h&&n.mutatedKeys.has(h.key),p=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),d=!1;h&&l?h.data.isEqual(l.data)?f!==p&&(r.track({type:3,doc:l}),d=!0):n.yo(h,l)||(r.track({type:2,doc:l}),d=!0,(u&&n.lo(l,u)>0||c&&n.lo(l,c)<0)&&(a=!0)):!h&&l?(r.track({type:0,doc:l}),d=!0):h&&!l&&(r.track({type:1,doc:h}),d=!0,(u||c)&&(a=!0)),d&&(l?(s=s.add(l),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),ca(this.query)||ha(this.query))for(;s.size>this.query.limit;){var h=ca(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ho()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)})),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new bf(this.query,t.fo,i,o,t.mutatedKeys,0===a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new mf,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.uo=e.uo.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.uo=e.uo.delete(t)})),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=vu(),this.fo.forEach((function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))}));var n=[];return e.forEach((function(e){t.ho.has(e)||n.push(new Cf(e))})),this.ho.forEach((function(t){e.has(t)||n.push(new Df(t))})),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=vu();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return bf.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),xf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Rf=function(t){this.key=t,this.bo=!1},Of=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new xh((function(t){return ma(t)}),va),this.Vo=new Map,this.So=new Set,this.Do=new su(Is.comparator),this.Co=new Map,this.No=new ul,this.xo={},this.ko=new Map,this.Fo=bh.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Lf(t,e){return Nt(this,void 0,void 0,(function(){var n,r,i,o,s,a;return At(this,(function(u){switch(u.label){case 0:return n=cp(t),(o=n.Po.get(e))?(r=o.targetId,n.sharedClientState.addLocalQueryTarget(r),i=o.view.Ro(),[3,4]):[3,1];case 1:return[4,el(n.localStore,ya(e))];case 2:return s=u.sent(),a=n.sharedClientState.addLocalQueryTarget(s.targetId),r=s.targetId,[4,Pf(n,e,r,"current"===a)];case 3:i=u.sent(),n.isPrimaryClient&&zl(n.remoteStore,s),u.label=4;case 4:return[2,i]}}))}))}function Pf(t,e,n,r){return Nt(this,void 0,void 0,(function(){var i,o,s,a,u,c;return At(this,(function(h){switch(h.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return Nt(this,void 0,void 0,(function(){var i,o,s;return At(this,(function(a){switch(a.label){case 0:return(i=e.view._o(n)).Nn?[4,rl(t.localStore,e.query,!1).then((function(t){var n=t.documents;return e.view._o(n,i)}))]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(Qf(t,e.targetId,s.To),s.snapshot)]}}))}))}(t,e,n,r)},[4,rl(t.localStore,e,!0)];case 1:return i=h.sent(),o=new kf(e,i.Bn),s=o._o(i.documents),a=Eu.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(s,t.isPrimaryClient,a),Qf(t,n,u.To),c=new xf(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}}))}))}function Ff(t,e){return Nt(this,void 0,void 0,(function(){var n,r,i;return At(this,(function(o){switch(o.label){case 0:return n=Wo(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter((function(t){return!va(t,e)}))),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,nl(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),Gl(n.remoteStore,r.targetId),Gf(n,r.targetId)})).catch(_h)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Gf(n,r.targetId),[4,nl(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function Mf(t,e,n){return Nt(this,void 0,void 0,(function(){var r,i,o,s;return At(this,(function(a){switch(a.label){case 0:r=hp(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=Wo(t),i=es.now(),o=e.reduce((function(t,e){return t.add(e.key)}),vu());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Mn.pn(t,o).next((function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],h=za(c,n.get(c.key));null!=h&&s.push(new Wa(c.key,h,Vs(h.value.mapValue),qa.exists(!0)))}return r._n.addMutationBatch(t,i,s,e)}))})).then((function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}}))}(r.localStore,e)];case 2:return i=a.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new su(Jo)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,Xf(r,i.changes)];case 3:return a.sent(),[4,of(r.remoteStore)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=gf(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}}))}))}function Vf(t,e){return Nt(this,void 0,void 0,(function(){var n,r;return At(this,(function(i){switch(i.label){case 0:n=Wo(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Zh(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.Co.get(e);r&&(Qo(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?Qo(r.bo):t.removedDocuments.size>0&&(Qo(r.bo),r.bo=!1))})),[4,Xf(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,_h(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function Uf(t,e,n){var r=Wo(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=Wo(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)})),r&&Nf(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function qf(t,e,n){return Nt(this,void 0,void 0,(function(){var r,i,o,s,a,u;return At(this,(function(c){switch(c.label){case 0:return(r=Wo(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(s=(s=new su(Is.comparator)).insert(o,Us.newNoDocument(o,ns.min())),a=vu().add(o),u=new wu(ns.min(),new Map,new cu(Jo),s,a),[4,Vf(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),Yf(r),[3,4];case 2:return[4,nl(r.localStore,e,!1).then((function(){return Gf(r,e,n)})).catch(_h)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function jf(t,e){return Nt(this,void 0,void 0,(function(){var n,r,i;return At(this,(function(o){switch(o.label){case 0:n=Wo(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,Xh(n.localStore,e)];case 2:return i=o.sent(),zf(n,r,null),Kf(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,Xf(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,_h(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Bf(t,e,n){return Nt(this,void 0,void 0,(function(){var r,i;return At(this,(function(o){switch(o.label){case 0:r=Wo(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Wo(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n._n.lookupMutationBatch(t,e).next((function(e){return Qo(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}(r.localStore,e)];case 2:return i=o.sent(),zf(r,e,n),Kf(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,Xf(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,_h(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function $f(t,e){return Nt(this,void 0,void 0,(function(){var n,r,i,o,s;return At(this,(function(a){switch(a.label){case 0:Xl((n=Wo(t)).remoteStore)||$o("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=Wo(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e._n.getHighestUnacknowledgedBatchId(t)}))}(n.localStore)];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.ko.get(r)||[]).push(e),n.ko.set(r,i),[3,4]);case 3:return o=a.sent(),s=gf(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}}))}))}function Kf(t,e){(t.ko.get(e)||[]).forEach((function(t){t.resolve()})),t.ko.delete(e)}function zf(t,e,n){var r=Wo(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function Gf(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach((function(e){t.No.containsKey(e)||Hf(t,e)}))}function Hf(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(Gl(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),Yf(t))}function Qf(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Df?(t.No.addReference(o.key,e),Wf(t,o)):o instanceof Cf?($o("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||Hf(t,o.key)):Ho()}}function Wf(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||($o("SyncEngine","New document in limbo: "+n),t.So.add(r),Yf(t))}function Yf(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new Is(as.fromString(e)),r=t.Fo.next();t.Co.set(r,new Rf(n)),t.Do=t.Do.insert(n,r),zl(t.remoteStore,new zc(ya(ua(n.path)),r,2,Vo.o))}}function Xf(t,e,n){return Nt(this,void 0,void 0,(function(){var r,i,o,s;return At(this,(function(a){switch(a.label){case 0:return r=Wo(t),i=[],o=[],s=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach((function(t,a){s.push(r.Oo(a,e,n).then((function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Gh.Pn(a.targetId,t);o.push(e)}})))})),[4,Promise.all(s)]);case 1:return a.sent(),r.vo._r(i),[4,function(t,e){return Nt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,h;return At(this,(function(l){switch(l.label){case 0:n=Wo(t),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return xc.forEach(e,(function(e){return xc.forEach(e.bn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return xc.forEach(e.vn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return l.sent(),[3,4];case 3:if(!Fc(r=l.sent()))throw r;return $o("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)s=o[i],a=s.targetId,s.fromCache||(u=n.kn.get(a),c=u.snapshotVersion,h=u.withLastLimboFreeSnapshotVersion(c),n.kn=n.kn.insert(a,h));return[2]}}))}))}(r.localStore,o)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function Jf(t,e){return Nt(this,void 0,void 0,(function(){var n,r;return At(this,(function(i){switch(i.label){case 0:return(n=Wo(t)).currentUser.isEqual(e)?[3,3]:($o("SyncEngine","User change. New user:",e.toKey()),[4,Yh(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.ko.forEach((function(t){t.forEach((function(t){t.reject(new qo(Uo.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.ko.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,Xf(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function Zf(t,e){var n=Wo(t),r=n.Co.get(e);if(r&&r.bo)return vu().add(r.key);var i=vu(),o=n.Vo.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=a[s],c=n.Po.get(u);i=i.unionWith(c.view.wo)}return i}function tp(t,e){return Nt(this,void 0,void 0,(function(){var n,r,i;return At(this,(function(o){switch(o.label){case 0:return[4,rl((n=Wo(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&Qf(n,e.targetId,i.To),i)]}}))}))}function ep(t){return Nt(this,void 0,void 0,(function(){var e;return At(this,(function(n){return[2,ol((e=Wo(t)).localStore).then((function(t){return Xf(e,t)}))]}))}))}function np(t,e,n,r){return Nt(this,void 0,void 0,(function(){var i,o;return At(this,(function(s){switch(s.label){case 0:return[4,function(t,e){var n=Wo(t),r=Wo(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.jt(t,e).next((function(e){return e?n.Mn.pn(t,e):xc.resolve(null)}))}))}((i=Wo(t)).localStore,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,of(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(zf(i,e,r||null),Kf(i,e),function(t,e){Wo(Wo(t)._n).Gt(e)}(i.localStore,e)):Ho(),s.label=4;case 4:return[4,Xf(i,o)];case 5:return s.sent(),[3,7];case 6:$o("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}}))}))}function rp(t,e){return Nt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c;return At(this,(function(h){switch(h.label){case 0:return cp(n=Wo(t)),hp(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,ip(n,r.toArray())]);case 1:return i=h.sent(),n.$o=!0,[4,ff(n.remoteStore,!0)];case 2:for(h.sent(),o=0,s=i;o<s.length;o++)a=s[o],zl(n.remoteStore,a);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(u=[],c=Promise.resolve(),n.Vo.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?u.push(e):c=c.then((function(){return Gf(n,e),nl(n.localStore,e,!0)})),Gl(n.remoteStore,e)})),[4,c]);case 4:return h.sent(),[4,ip(n,u)];case 5:return h.sent(),function(t){var e=Wo(t);e.Co.forEach((function(t,n){Gl(e.remoteStore,n)})),e.No.ts(),e.Co=new Map,e.Do=new su(Is.comparator)}(n),n.$o=!1,[4,ff(n.remoteStore,!1)];case 6:h.sent(),h.label=7;case 7:return[2]}}))}))}function ip(t,e,n){return Nt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,h,l,f,p,d,y;return At(this,(function(g){switch(g.label){case 0:n=Wo(t),r=[],i=[],o=0,s=e,g.label=1;case 1:return o<s.length?(a=s[o],u=void 0,(c=n.Vo.get(a))&&0!==c.length?[4,el(n.localStore,ya(c[0]))]:[3,7]):[3,13];case 2:u=g.sent(),h=0,l=c,g.label=3;case 3:return h<l.length?(f=l[h],p=n.Po.get(f),[4,tp(n,p)]):[3,6];case 4:(d=g.sent()).snapshot&&i.push(d.snapshot),g.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,il(n.localStore,a)];case 8:return y=g.sent(),[4,el(n.localStore,y)];case 9:return u=g.sent(),[4,Pf(n,op(y),a,!1)];case 10:g.sent(),g.label=11;case 11:r.push(u),g.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}}))}))}function op(t){return aa(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function sp(t){var e=Wo(t);return Wo(Wo(e.localStore).persistence).fn()}function ap(t,e,n,r){return Nt(this,void 0,void 0,(function(){var i,o,s;return At(this,(function(a){switch(a.label){case 0:return(i=Wo(t)).$o?($o("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,ol(i.localStore)];case 3:return o=a.sent(),s=wu.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,Xf(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,nl(i.localStore,e,!0)];case 6:return a.sent(),Gf(i,e,r),[3,8];case 7:Ho(),a.label=8;case 8:return[2]}}))}))}function up(t,e,n){return Nt(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,h,l,f;return At(this,(function(p){switch(p.label){case 0:if(!(r=cp(t)).$o)return[3,10];i=0,o=e,p.label=1;case 1:return i<o.length?(s=o[i],r.Vo.has(s)?($o("SyncEngine","Adding an already active target "+s),[3,5]):[4,il(r.localStore,s)]):[3,6];case 2:return a=p.sent(),[4,el(r.localStore,a)];case 3:return u=p.sent(),[4,Pf(r,op(a),u.targetId,!1)];case 4:p.sent(),zl(r.remoteStore,u),p.label=5;case 5:return i++,[3,1];case 6:c=function(t){return At(this,(function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,nl(r.localStore,t,!1).then((function(){Gl(r.remoteStore,t),Gf(r,t)})).catch(_h)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},h=0,l=n,p.label=7;case 7:return h<l.length?(f=l[h],[5,c(f)]):[3,10];case 8:p.sent(),p.label=9;case 9:return h++,[3,7];case 10:return[2]}}))}))}function cp(t){var e=Wo(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Vf.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Zf.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=qf.bind(null,e),e.vo._r=_f.bind(null,e.eventManager),e.vo.Mo=Sf.bind(null,e.eventManager),e}function hp(t){var e=Wo(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=jf.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Bf.bind(null,e),e}var lp=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Nt(this,void 0,void 0,(function(){return At(this,(function(e){switch(e.label){case 0:return this.R=Pl(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Ko(t),[2]}}))}))},t.prototype.Uo=function(t){return null},t.prototype.Ko=function(t){return Wh(this.persistence,new Hh,t.initialUser,this.R)},t.prototype.qo=function(t){return new dl(gl.bs,this.R)},t.prototype.Bo=function(t){return new Al},t.prototype.terminate=function(){return Nt(this,void 0,void 0,(function(){return At(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),fp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qo=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return _t(e,t),e.prototype.initialize=function(e){return Nt(this,void 0,void 0,(function(){var n=this;return At(this,(function(r){switch(r.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return r.sent(),[4,sl(this.localStore)];case 2:return r.sent(),[4,this.Qo.initialize(this,e)];case 3:return r.sent(),[4,hp(this.Qo.syncEngine)];case 4:return r.sent(),[4,of(this.Qo.remoteStore)];case 5:return r.sent(),[4,this.persistence.He((function(){return n.gcScheduler&&!n.gcScheduler.started&&n.gcScheduler.start(n.localStore),Promise.resolve()}))];case 6:return r.sent(),[2]}}))}))},e.prototype.Ko=function(t){return Wh(this.persistence,new Hh,t.initialUser,this.R)},e.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new Ah(e,t.asyncQueue)},e.prototype.qo=function(t){var e=Kh(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?lh.withCacheSize(this.cacheSizeBytes):lh.DEFAULT;return new jh(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,Ol(),Ll(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new Al},e}(lp),pp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Qo=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return _t(e,t),e.prototype.initialize=function(e){return Nt(this,void 0,void 0,(function(){var n,r=this;return At(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Qo.syncEngine,this.sharedClientState instanceof Nl?(this.sharedClientState.syncEngine={ui:np.bind(null,n),ai:ap.bind(null,n),hi:up.bind(null,n),fn:sp.bind(null,n),ci:ep.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He((function(t){return Nt(r,void 0,void 0,(function(){return At(this,(function(e){switch(e.label){case 0:return[4,rp(this.Qo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Bo=function(t){var e=Ol();if(!Nl.yt(e))throw new qo(Uo.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Kh(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new Nl(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(fp),dp=function(){function t(){}return t.prototype.initialize=function(t,e){return Nt(this,void 0,void 0,(function(){var n=this;return At(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return Uf(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=Jf.bind(null,this.syncEngine),[4,ff(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new Ef},t.prototype.createDatastore=function(t){var e,n=Pl(t.databaseInfo.databaseId),r=(e=t.databaseInfo,new Rl(e));return function(t,e,n){return new ql(t,e,n)}(t.credentials,r,n)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return Uf(s.syncEngine,t,0)},o=Cl.yt()?new Cl:new Dl,new Bl(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){var a=new Of(t,e,n,r,i,o);return s&&(a.$o=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return Nt(this,void 0,void 0,(function(){var e;return At(this,(function(n){switch(n.label){case 0:return e=Wo(t),$o("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,Kl(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}(),yp=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),gp=function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return Nt(this,void 0,void 0,(function(){var e,n=this;return At(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new qo(Uo.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Nt(this,void 0,void 0,(function(){var n,r,i,o,s,a;return At(this,(function(u){switch(u.label){case 0:return n=Wo(t),r=Bu(n.R)+"/documents",i={documents:e.map((function(t){return Vu(n.R,t)}))},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){Qo(!!e.found),e.found.name,e.found.updateTime;var n=Uu(t,e.found.name),r=Pu(e.found.updateTime),i=new Ms({mapValue:{fields:e.found.fields}});return Us.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){Qo(!!e.missing),Qo(!!e.readTime);var n=Uu(t,e.missing),r=Pu(e.readTime);return Us.newNoDocument(n,r)}(t,e):Ho()}(n.R,t);s.set(e.key.toString(),e)})),a=[],[2,(e.forEach((function(t){var e=s.get(t.toString());Qo(!!e),a.push(e)})),a)]}}))}))}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach((function(t){return n.recordVersion(t)})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new eu(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return Nt(this,void 0,void 0,(function(){var t,e=this;return At(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=Is.fromPath(n);e.mutations.push(new nu(r,e.precondition(r)))})),[4,function(t,e){return Nt(this,void 0,void 0,(function(){var n,r,i;return At(this,(function(o){switch(o.label){case 0:return n=Wo(t),r=Bu(n.R)+"/documents",i={writes:e.map((function(t){return zu(n.R,t)}))},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw Ho();e=ns.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new qo(Uo.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?qa.updateTime(e):qa.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(ns.min()))throw new qo(Uo.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return qa.updateTime(e)}return qa.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}(),vp=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new Fl(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.ec-=1,this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji((function(){return Nt(t,void 0,void 0,(function(){var t,e,n=this;return At(this,(function(r){return t=new gp(this.datastore),(e=this.sc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.ic(t)}))}))})).catch((function(t){n.ic(t)})),[2]}))}))}))},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!bs(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return e.nc(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!iu(e)}return!1},t}(),mp=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=vl.UNAUTHENTICATED,this.clientId=Xo.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,(function(t){return Nt(r,void 0,void 0,(function(){return At(this,(function(e){switch(e.label){case 0:return $o("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}}))}))}))}return t.prototype.getConfiguration=function(){return Nt(this,void 0,void 0,(function(){return At(this,(function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}))}))},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new qo(Uo.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new kc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return Nt(t,void 0,void 0,(function(){var t,n;return At(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=gf(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function bp(t,e){return Nt(this,void 0,void 0,(function(){var n,r,i=this;return At(this,(function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),$o("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener((function(t){return Nt(i,void 0,void 0,(function(){return At(this,(function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,Yh(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}}))}))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function wp(t,e){return Nt(this,void 0,void 0,(function(){var n,r;return At(this,(function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,Ep(t)];case 1:return n=i.sent(),$o("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener((function(t){return function(t,e){return Nt(this,void 0,void 0,(function(){var n,r;return At(this,(function(i){switch(i.label){case 0:return(n=Wo(t)).asyncQueue.verifyOperationInProgress(),$o("RemoteStore","RemoteStore received new credentials"),r=Xl(n),n.Or.add(3),[4,Kl(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,$l(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,t)})),t.onlineComponents=e,[2]}}))}))}function Ep(t){return Nt(this,void 0,void 0,(function(){return At(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:($o("FirestoreClient","Using default OfflineComponentProvider"),[4,bp(t,new lp)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function Ip(t){return Nt(this,void 0,void 0,(function(){return At(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:($o("FirestoreClient","Using default OnlineComponentProvider"),[4,wp(t,new dp)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function Tp(t){return Ep(t).then((function(t){return t.persistence}))}function _p(t){return Ep(t).then((function(t){return t.localStore}))}function Sp(t){return Ip(t).then((function(t){return t.remoteStore}))}function Np(t){return Ip(t).then((function(t){return t.syncEngine}))}function Ap(t){return Nt(this,void 0,void 0,(function(){var e,n;return At(this,(function(r){switch(r.label){case 0:return[4,Ip(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=Lf.bind(null,e.syncEngine),n.onUnlisten=Ff.bind(null,e.syncEngine),n)]}}))}))}function Dp(t,e,n){var r=this;void 0===n&&(n={});var i=new kc;return t.asyncQueue.enqueueAndForget((function(){return Nt(r,void 0,void 0,(function(){var r;return At(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new yp({next:function(o){e.enqueueAndForget((function(){return Tf(t,s)}));var a=o.docs.has(n);!a&&o.fromCache?i.reject(new qo(Uo.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new qo(Uo.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Af(ua(n.path),o,{includeMetadataChanges:!0,so:!0});return If(t,s)},[4,Ap(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}function Cp(t,e,n){var r=this;void 0===n&&(n={});var i=new kc;return t.asyncQueue.enqueueAndForget((function(){return Nt(r,void 0,void 0,(function(){var r;return At(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new yp({next:function(n){e.enqueueAndForget((function(){return Tf(t,s)})),n.fromCache&&"server"===r.source?i.reject(new qo(Uo.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Af(n,o,{includeMetadataChanges:!0,so:!0});return If(t,s)},[4,Ap(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}var kp=function(t,e,n,r,i,o,s,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},xp=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Rp=new Map,Op=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},Lp=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable((function(){return e(vl.UNAUTHENTICATED)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Pp=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Fp=function(){function t(t){var e=this;this.currentUser=vl.UNAUTHENTICATED,this.oc=new kc,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)}))};var n=function(t){$o("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit((function(t){return n(t)})),setTimeout((function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):($o("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}}),0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.cc!==e?($o("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Qo("string"==typeof n.accessToken),new Op(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable((function(){return Nt(n,void 0,void 0,(function(){return At(this,(function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}}))}))}))},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return Qo(null===t||"string"==typeof t),new vl(t)},t}(),Mp=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=vl.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),Vp=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new Mp(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable((function(){return e(vl.FIRST_PARTY)}))},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Up(t,e,n){if(!n)throw new qo(Uo.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function qp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new qo(Uo.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function jp(t,e,n,r){if(!0===e&&!0===r)throw new qo(Uo.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Bp(t){if(!Is.isDocumentKey(t))throw new qo(Uo.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function $p(t){if(Is.isDocumentKey(t))throw new qo(Uo.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Kp(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Ho()}function zp(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new qo(Uo.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Kp(t);throw new qo(Uo.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Gp(t,e){if(e<=0)throw new qo(Uo.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Hp=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new qo(Uo.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new qo(Uo.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,jp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),Qp=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Hp({}),this._settingsFrozen=!1,t instanceof xp?(this._databaseId=t,this._credentials=new Lp):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new qo(Uo.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xp(t.options.projectId)}(t),this._credentials=new Fp(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new qo(Uo.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new qo(Uo.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Hp(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new Lp;switch(t.type){case"gapi":var e=t.client;return Qo(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Vp(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new qo(Uo.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return this,(t=Rp.get(this))&&($o("ComponentProvider","Removing Datastore"),Rp.delete(this),t.terminate()),Promise.resolve();var t},t}(),Wp=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Xp(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),Yp=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),Xp=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,ua(r))||this)._path=r,i.type="collection",i}return _t(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new Wp(this.firestore,null,new Is(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(Yp);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Jp(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Gt(t),Up("collection","path",e),t instanceof Qp)return $p(n=as.fromString.apply(as,kt([e],r))),new Xp(t,null,n);if(!(t instanceof Wp||t instanceof Xp))throw new qo(Uo.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return $p(n=as.fromString.apply(as,kt([t.path],r)).child(as.fromString(e))),new Xp(t.firestore,null,n)}function Zp(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Gt(t),1===arguments.length&&(e=Xo.u()),Up("doc","path",e),t instanceof Qp)return Bp(n=as.fromString.apply(as,kt([e],r))),new Wp(t,null,new Is(n));if(!(t instanceof Wp||t instanceof Xp))throw new qo(Uo.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Bp(n=t._path.child(as.fromString.apply(as,kt([e],r)))),new Wp(t.firestore,t instanceof Xp?t.converter:null,new Is(n))}function td(t,e){return t=Gt(t),e=Gt(e),(t instanceof Wp||t instanceof Xp)&&(e instanceof Wp||e instanceof Xp)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function ed(t,e){return t=Gt(t),e=Gt(e),t instanceof Yp&&e instanceof Yp&&t.firestore===e.firestore&&va(t._query,e._query)&&t.converter===e.converter
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var nd=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=!1,this.Tc=[],this.Zi=new Fl(this,"async_queue_retry"),this.Ic=function(){var e=Ll();e&&$o("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=Ll();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ic)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ac(),this.Rc(t)},t.prototype.enterRestrictedMode=function(t){if(!this._c){this._c=!0,this.Ec=t||!1;var e=Ll();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Ic)}},t.prototype.enqueue=function(t){var e=this;if(this.Ac(),this._c)return new Promise((function(){}));var n=new kc;return this.Rc((function(){return e._c&&e.Ec?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.wc.push(t),e.bc()}))},t.prototype.bc=function(){return Nt(this,void 0,void 0,(function(){var t,e=this;return At(this,(function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!Fc(t=n.sent()))throw t;return $o("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji((function(){return e.bc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Rc=function(t){var e=this,n=this.dc.then((function(){return e.gc=!0,t().catch((function(t){throw e.yc=t,e.gc=!1,Ko("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.gc=!1,t}))}));return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ac(),this.Tc.indexOf(t)>-1&&(e=0);var i=yf.createAndSchedule(this,t,e,n,(function(t){return r.vc(t)}));return this.mc.push(i),i},t.prototype.Ac=function(){this.yc&&Ho()},t.prototype.verifyOperationInProgress=function(){},t.prototype.Pc=function(){return Nt(this,void 0,void 0,(function(){var t;return At(this,(function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Vc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Sc=function(t){var e=this;return this.Pc().then((function(){e.mc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.Pc()}))},t.prototype.Dc=function(t){this.Tc.push(t)},t.prototype.vc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function rd(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var id=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new nd,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return _t(e,t),e.prototype._terminate=function(){return this._firestoreClient||sd(this),this._firestoreClient.terminate()},e}(Qp);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function od(t){return t._firestoreClient||sd(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function sd(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new kp(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new mp(t._credentials,t._queue,r)}function ad(t,e,n){var r=this,i=new kc;return t.asyncQueue.enqueue((function(){return Nt(r,void 0,void 0,(function(){var r;return At(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,bp(t,n)];case 1:return o.sent(),[4,wp(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Uo.FAILED_PRECONDITION||t.code===Uo.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function ud(t){if(t._initialized||t._terminated)throw new qo(Uo.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var cd=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new qo(Uo.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new cs(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),hd=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(ls.fromBase64String(e))}catch(e){throw new qo(Uo.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(ls.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),ld=function(t){this._methodName=t},fd=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new qo(Uo.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new qo(Uo.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return Jo(this._lat,t._lat)||Jo(this._long,t._long)},t}(),pd=/^__.*__$/,dd=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new Wa(t,this.data,this.fieldMask,e,this.fieldTransforms):new Qa(t,this.data,e,this.fieldTransforms)},t}(),yd=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new Wa(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function gd(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ho()}}var vd=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Cc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Nc",{get:function(){return this.settings.Nc},enumerable:!1,configurable:!0}),t.prototype.xc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.kc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,Fc:!1});return r.$c(t),r},t.prototype.Oc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,Fc:!1});return r.Cc(),r},t.prototype.Mc=function(t){return this.xc({path:void 0,Fc:!0})},t.prototype.Lc=function(t){return Md(t,this.settings.methodName,this.settings.Bc||!1,this.path,this.settings.qc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.Cc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.$c(this.path.get(t))},t.prototype.$c=function(t){if(0===t.length)throw this.Lc("Document fields must not be empty");if(gd(this.Nc)&&pd.test(t))throw this.Lc('Document fields cannot begin and end with "__"')},t}(),md=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||Pl(t)}return t.prototype.Uc=function(t,e,n,r){return void 0===r&&(r=!1),new vd({Nc:t,methodName:e,qc:n,path:cs.emptyPath(),Fc:!1,Bc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function bd(t){var e=t._freezeSettings(),n=Pl(t._databaseId);return new md(t._databaseId,!!e.ignoreUndefinedProperties,n)}function wd(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Uc(o.merge||o.mergeFields?2:0,e,n,i);Od("Data must be an object, but it was:",s,r);var a,u,c=xd(r,s);if(o.merge)a=new hs(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var p=Ld(e,f[l],n);if(!s.contains(p))throw new qo(Uo.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Vd(h,p)||h.push(p)}a=new hs(h),u=s.fieldTransforms.filter((function(t){return a.covers(t.field)}))}else a=null,u=s.fieldTransforms;return new dd(new Ms(c),a,u)}var Ed=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _t(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Nc)throw 1===t.Nc?t.Lc(this._methodName+"() can only appear at the top level of your update data"):t.Lc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(ld);function Id(t,e,n){return new vd({Nc:3,qc:e.settings.qc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var Td=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _t(e,t),e.prototype._toFieldTransform=function(t){return new Va(t.path,new ka)},e.prototype.isEqual=function(t){return t instanceof e},e}(ld),_d=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return _t(e,t),e.prototype._toFieldTransform=function(t){var e=Id(this,t,!0),n=this.Kc.map((function(t){return kd(t,e)})),r=new xa(n);return new Va(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(ld),Sd=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return _t(e,t),e.prototype._toFieldTransform=function(t){var e=Id(this,t,!0),n=this.Kc.map((function(t){return kd(t,e)})),r=new Oa(n);return new Va(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(ld),Nd=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Qc=n,r}return _t(e,t),e.prototype._toFieldTransform=function(t){var e=new Pa(t.R,Sa(t.R,this.Qc));return new Va(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(ld);function Ad(t,e,n,r){var i=t.Uc(1,e,n);Od("Data must be an object, but it was:",i,r);var o=[],s=Ms.empty();is(r,(function(t,r){var a=Fd(e,t,n);r=Gt(r);var u=i.Oc(a);if(r instanceof Ed)o.push(a);else{var c=kd(r,u);null!=c&&(o.push(a),s.set(a,c))}}));var a=new hs(o);return new yd(s,a,i.fieldTransforms)}function Dd(t,e,n,r,i,o){var s=t.Uc(1,e,n),a=[Ld(e,r,n)],u=[i];if(o.length%2!=0)throw new qo(Uo.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(Ld(e,o[c])),u.push(o[c+1]);for(var h=[],l=Ms.empty(),f=a.length-1;f>=0;--f)if(!Vd(h,a[f])){var p=a[f],d=u[f];d=Gt(d);var y=s.Oc(p);if(d instanceof Ed)h.push(p);else{var g=kd(d,y);null!=g&&(h.push(p),l.set(p,g))}}var v=new hs(h);return new yd(l,v,s.fieldTransforms)}function Cd(t,e,n,r){return void 0===r&&(r=!1),kd(n,t.Uc(r?4:3,e))}function kd(t,e){if(Rd(t=Gt(t)))return Od("Unsupported field value:",e,t),xd(t,e);if(t instanceof ld)return function(t,e){if(!gd(e.Nc))throw e.Lc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Lc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&4!==e.Nc)throw e.Lc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=kd(o[i],e.Mc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=Gt(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Sa(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=es.fromDate(t);return{timestampValue:Ru(e.R,n)}}if(t instanceof es)return n=new es(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Ru(e.R,n)};if(t instanceof fd)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof hd)return{bytesValue:Ou(e.R,t._byteString)};if(t instanceof Wp){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Lc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Fu(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Lc("Unsupported field value: "+Kp(t))}(t,e)}function xd(t,e){var n={};return os(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):is(t,(function(t,r){var i=kd(r,e.kc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Rd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof es||t instanceof fd||t instanceof hd||t instanceof Wp||t instanceof ld)}function Od(t,e,n){if(!Rd(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Kp(n);throw"an object"===r?e.Lc(t+" a custom object"):e.Lc(t+" "+r)}}function Ld(t,e,n){if((e=Gt(e))instanceof cd)return e._internalPath;if("string"==typeof e)return Fd(t,e);throw Md("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Pd=new RegExp("[~\\*/\\[\\]]");function Fd(t,e,n){if(e.search(Pd)>=0)throw Md("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(cd.bind.apply(cd,kt([void 0],e.split(".")))))._internalPath}catch(r){throw Md("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Md(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new qo(Uo.INVALID_ARGUMENT,(a+=". ")+t+u)}function Vd(t,e){return t.some((function(t){return t.isEqual(e)}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ud=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Wp(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new qd(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(jd("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),qd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _t(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Ud);function jd(t,e){return"string"==typeof e?Fd(t,e):e instanceof cd?e._internalPath:e._delegate._internalPath}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Bd=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),$d=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return _t(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new Kd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(jd("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(Ud),Kd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _t(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}($d),zd=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new Bd(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new Kd(n._firestore,n._userDataWriter,r.key,r,new Bd(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new qo(Uo.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){return{type:"added",doc:new Kd(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Bd(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new Kd(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Bd(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Gd(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function Gd(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ho()}}function Hd(t,e){return t instanceof $d&&e instanceof $d?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof zd&&e instanceof zd&&t._firestore===e._firestore&&ed(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Qd(t){if(ha(t)&&0===t.explicitOrderBy.length)throw new qo(Uo.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Wd=function(){};function Yd(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var Xd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).jc=e,i.Wc=n,i.Gc=r,i.type="where",i}return _t(e,t),e.prototype._apply=function(t){var e=bd(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new qo(Uo.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){iy(s,o);for(var u=[],c=0,h=s;c<h.length;c++){var l=h[c];u.push(ry(r,t,l))}a={arrayValue:{values:u}}}else a=ry(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||iy(s,o),a=Cd(n,"where",s,"in"===o||"not-in"===o);var f=zs.create(i,o,a);return function(t,e){if(e.g()){var n=fa(t);if(null!==n&&!n.isEqual(e.field))throw new qo(Uo.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=la(t);null!==r&&oy(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new qo(Uo.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new qo(Uo.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t._query,0,e,t.firestore._databaseId,this.jc,this.Wc,this.Gc);return new Yp(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new sa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(Wd),Jd=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).jc=e,r.zc=n,r.type="orderBy",r}return _t(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new qo(Uo.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new qo(Uo.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new na(e,n);return function(t,e){if(null===la(t)){var n=fa(t);null!==n&&oy(t,n,e.field)}}(t,r),r}(t._query,this.jc,this.zc);return new Yp(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new sa(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(Wd),Zd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Hc=n,i.Jc=r,i}return _t(e,t),e.prototype._apply=function(t){return new Yp(t.firestore,t.converter,ga(t._query,this.Hc,this.Jc))},e}(Wd),ty=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return _t(e,t),e.prototype._apply=function(t){var e=ny(t,this.type,this.Yc,this.Xc);return new Yp(t.firestore,t.converter,function(t,e){return new sa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(Wd),ey=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return _t(e,t),e.prototype._apply=function(t){var e=ny(t,this.type,this.Yc,this.Xc);return new Yp(t.firestore,t.converter,function(t,e){return new sa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(Wd);function ny(t,e,n,r){if(n[0]=Gt(n[0]),n[0]instanceof Ud)return function(t,e,n,r,i){if(!r)throw new qo(Uo.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=da(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(ks(e,r.key));else{var c=r.data.field(u.field);if(gs(c))throw new qo(Uo.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.canonicalString();throw new qo(Uo.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new ta(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=bd(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new qo(Uo.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new qo(Uo.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!pa(t)&&-1!==c.indexOf("/"))throw new qo(Uo.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(as.fromString(c));if(!Is.isDocumentKey(h))throw new qo(Uo.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new Is(h);a.push(ks(e,l))}else{var f=Cd(n,r,c);a.push(f)}}return new ta(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function ry(t,e,n){if("string"==typeof(n=Gt(n))){if(""===n)throw new qo(Uo.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!pa(e)&&-1!==n.indexOf("/"))throw new qo(Uo.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(as.fromString(n));if(!Is.isDocumentKey(r))throw new qo(Uo.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return ks(t,new Is(r))}if(n instanceof Wp)return ks(t,n._key);throw new qo(Uo.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Kp(n)+".")}function iy(t,e){if(!Array.isArray(t)||0===t.length)throw new qo(Uo.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new qo(Uo.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function oy(t,e,n){if(!n.isEqual(e))throw new qo(Uo.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var sy=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),Ts(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ds(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(ys(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Ho()}},t.prototype.convertObject=function(t,e){var n=this,r={};return is(t.fields,(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new fd(ds(t.latitude),ds(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=vs(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(ms(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=ps(t);return new es(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=as.fromString(t);Qo(sc(n));var r=new xp(n.get(1),n.get(3)),i=new Is(n.popFirst(5));return r.isEqual(e)||Ko("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ay(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var uy=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return _t(e,t),e.prototype.convertBytes=function(t){return new hd(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Wp(this.firestore,null,e)},e}(sy),cy=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=bd(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=hy(t,this._firestore),i=ay(r.converter,e,n),o=wd(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,qa.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=hy(t,this._firestore);return o="string"==typeof(e=Gt(e))||e instanceof cd?Dd(this._dataReader,"WriteBatch.update",s._key,e,n,r):Ad(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,qa.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=hy(t,this._firestore);return this._mutations=this._mutations.concat(new eu(e._key,qa.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new qo(Uo.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function hy(t,e){if((t=Gt(t)).firestore!==e)throw new qo(Uo.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ly=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return _t(e,t),e.prototype.convertBytes=function(t){return new hd(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Wp(this.firestore,null,e)},e}(sy);function fy(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=zp(t,Wp);var o=zp(t.firestore,id),s=bd(o);return dy(o,[("string"==typeof(e=Gt(e))||e instanceof cd?Dd(s,"updateDoc",t._key,e,n,r):Ad(s,"updateDoc",t._key,e)).toMutation(t._key,qa.exists(!0))])}function py(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=Gt(t);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||rd(i[a])||(s=i[a],a++);var u,c,h,l={includeMetadataChanges:s.includeMetadataChanges};if(rd(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof Wp)c=zp(t.firestore,id),h=ua(t._key.path),u={next:function(e){i[a]&&i[a](yy(c,t,e))},error:i[a+1],complete:i[a+2]};else{var p=zp(t,Yp);c=zp(p.firestore,id),h=p._query;var d=new ly(c);u={next:function(t){i[a]&&i[a](new zd(c,d,p,t))},error:i[a+1],complete:i[a+2]},Qd(t._query)}return function(t,e,n,r){var i=this,o=new yp(r),s=new Af(e,o,n);return t.asyncQueue.enqueueAndForget((function(){return Nt(i,void 0,void 0,(function(){var e;return At(this,(function(n){switch(n.label){case 0:return e=If,[4,Ap(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))})),function(){o.Wo(),t.asyncQueue.enqueueAndForget((function(){return Nt(i,void 0,void 0,(function(){var e;return At(this,(function(n){switch(n.label){case 0:return e=Tf,[4,Ap(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))}))}}(od(c),h,l,u)}function dy(t,e){return function(t,e){var n=this,r=new kc;return t.asyncQueue.enqueueAndForget((function(){return Nt(n,void 0,void 0,(function(){var n;return At(this,(function(i){switch(i.label){case 0:return n=Mf,[4,Np(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(od(t),e)}function yy(t,e,n){var r=n.docs.get(e._key),i=new ly(t);return new $d(t,i,e._key,r,new Bd(n.hasPendingWrites,n.fromCache),e.converter)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var gy=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return _t(e,t),e.prototype.get=function(e){var n=this,r=hy(e,this._firestore),i=new ly(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new $d(n._firestore,i,r._key,t._document,new Bd(!1,!1),r.converter)}))},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=bd(t)}return t.prototype.get=function(t){var e=this,n=hy(t,this._firestore),r=new uy(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return Ho();var i=t[0];if(i.isFoundDocument())return new Ud(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new Ud(e._firestore,r,n._key,null,n.converter);throw Ho()}))},t.prototype.set=function(t,e,n){var r=hy(t,this._firestore),i=ay(r.converter,e,n),o=wd(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=hy(t,this._firestore);return o="string"==typeof(e=Gt(e))||e instanceof cd?Dd(this._dataReader,"Transaction.update",s._key,e,n,r):Ad(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=hy(t,this._firestore);return this._transaction.delete(e._key),this},t}());
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function vy(){if("undefined"==typeof Uint8Array)throw new qo(Uo.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function my(){if("undefined"==typeof atob)throw new qo(Uo.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var by=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return my(),new t(hd.fromBase64String(e))},t.fromUint8Array=function(e){return vy(),new t(hd.fromUint8Array(e))},t.prototype.toBase64=function(){return my(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return vy(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),wy=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){ud(t=zp(t,id));var n=od(t),r=t._freezeSettings(),i=new dp;return ad(n,i,new fp(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){ud(t=zp(t,id));var e=od(t),n=t._freezeSettings(),r=new dp;return ad(e,r,new pp(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new qo(Uo.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new kc;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return Nt(e,void 0,void 0,(function(){var e;return At(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Nt(this,void 0,void 0,(function(){var e;return At(this,(function(n){switch(n.label){case 0:return Oc.yt()?(e=t+"main",[4,Oc.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(Kh(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),Ey=function(){function t(t,e,n){var r=this;this._delegate=e,this.Zc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof xp||(this.tu=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||zo("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){var i;void 0===r&&(r={});var o=(t=zp(t,Qp))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==e&&zo("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},o),{host:e+":"+n,ssl:!1})),r.mockUserToken){var s,a;if("string"==typeof r.mockUserToken)s=r.mockUserToken,a=vl.MOCK_USER;else{s=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var o=St({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Ot(JSON.stringify({alg:"none",type:"JWT"})),Ot(JSON.stringify(o)),""].join(".")}(r.mockUserToken,null===(i=t._app)||void 0===i?void 0:i.options.projectId);var u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new qo(Uo.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new vl(u)}t._credentials=new Pp(new Op(s,a))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return Nt(e,void 0,void 0,(function(){var e,n;return At(this,(function(r){switch(r.label){case 0:return[4,Tp(t)];case 1:return e=r.sent(),[4,Sp(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=Wo(t);return e.Or.delete(0),$l(e)}(n))]}}))}))}))}(od(zp(this._delegate,id)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return Nt(e,void 0,void 0,(function(){var e,n;return At(this,(function(r){switch(r.label){case 0:return[4,Tp(t)];case 1:return e=r.sent(),[4,Sp(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return Nt(this,void 0,void 0,(function(){var e;return At(this,(function(n){switch(n.label){case 0:return(e=Wo(t)).Or.add(0),[4,Kl(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(od(zp(this._delegate,id)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&jp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Zc.enableMultiTabIndexedDbPersistence(this):this.Zc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Zc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.tu&&(this.tu._removeServiceInstance("firestore"),this.tu._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new kc;return t.asyncQueue.enqueueAndForget((function(){return Nt(e,void 0,void 0,(function(){var e;return At(this,(function(r){switch(r.label){case 0:return e=$f,[4,Np(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(od(zp(this._delegate,id)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new yp(e);return t.asyncQueue.enqueueAndForget((function(){return Nt(n,void 0,void 0,(function(){var e;return At(this,(function(n){switch(n.label){case 0:return e=function(t,e){Wo(t).Gr.add(e),e.next()},[4,Ap(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Wo(),t.asyncQueue.enqueueAndForget((function(){return Nt(n,void 0,void 0,(function(){var e;return At(this,(function(n){switch(n.label){case 0:return e=function(t,e){Wo(t).Gr.delete(e)},[4,Ap(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(od(t=zp(t,id)),rd(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.tu)throw new qo(Uo.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.tu},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Py(this,Jp(this._delegate,t))}catch(t){throw Ay(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new Ny(this,Zp(this._delegate,t))}catch(t){throw Ay(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new Ry(this,function(t,e){if(t=zp(t,Qp),Up("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new qo(Uo.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Yp(t,null,function(t){return new sa(as.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw Ay(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new kc;return t.asyncQueue.enqueueAndForget((function(){return Nt(n,void 0,void 0,(function(){var n;return At(this,(function(i){switch(i.label){case 0:return[4,function(t){return Ip(t).then((function(t){return t.datastore}))}(t)];case 1:return n=i.sent(),new vp(t.asyncQueue,n,e,r).run(),[2]}}))}))})),r.promise}(od(t),(function(n){return e(new gy(t,n))}))}(this._delegate,(function(n){return t(new Ty(e,n))}))},t.prototype.batch=function(){var t=this;return od(this._delegate),new _y(new cy(this._delegate,(function(e){return dy(t._delegate,e)})))},t.prototype.loadBundle=function(t){throw new qo(Uo.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new qo(Uo.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),Iy=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return _t(e,t),e.prototype.convertBytes=function(t){return new by(new hd(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return Ny.eu(e,this.firestore,null)},e}(sy);var Ty=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Iy(t)}return t.prototype.get=function(t){var e=this,n=Fy(t);return this._delegate.get(n).then((function(t){return new ky(e._firestore,new $d(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))}))},t.prototype.set=function(t,e,n){var r=Fy(t);return n?(qp("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Fy(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,kt([s,e,n],i)),this},t.prototype.delete=function(t){var e=Fy(t);return this._delegate.delete(e),this},t}(),_y=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=Fy(t);return n?(qp("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Fy(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,kt([s,e,n],i)),this},t.prototype.delete=function(t){var e=Fy(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),Sy=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new Kd(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new xy(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.nu=function(e,n){var r=t.su,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new Iy(e),n),i.set(n,o)),o},t}();Sy.su=new WeakMap;var Ny=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Iy(t)}return t.iu=function(e,n,r){if(e.length%2!=0)throw new qo(Uo.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new Wp(n._delegate,r,new Is(e)))},t.eu=function(e,n,r){return new t(n,new Wp(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Py(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Py(this.firestore,Jp(this._delegate,t))}catch(t){throw Ay(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=Gt(t))instanceof Wp&&td(this._delegate,t)},t.prototype.set=function(t,e){e=qp("DocumentReference.set",e);try{return function(t,e,n){t=zp(t,Wp);var r=zp(t.firestore,id),i=ay(t.converter,e,n);return dy(r,[wd(bd(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,qa.none())])}(this._delegate,t,e)}catch(t){throw Ay(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?fy(this._delegate,t):fy.apply(void 0,kt([this._delegate,t,e],n))}catch(t){throw Ay(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return dy(zp((t=this._delegate).firestore,id),[new eu(t._key,qa.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Dy(e),i=Cy(e,(function(e){return new ky(t.firestore,new $d(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}));return py(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=zp(t,Wp);var e=zp(t.firestore,id),n=od(e),r=new ly(e);return function(t,e){var n=this,r=new kc;return t.asyncQueue.enqueueAndForget((function(){return Nt(n,void 0,void 0,(function(){var n;return At(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Nt(this,void 0,void 0,(function(){var r,i;return At(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=Wo(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Mn.mn(t,e)}))}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new qo(Uo.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=gf(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,_p(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._key).then((function(n){return new $d(e,r,t._key,n,new Bd(null!==n&&n.hasLocalMutations,!0),t.converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=zp(t,Wp);var e=zp(t.firestore,id);return Dp(od(e),t._key,{source:"server"}).then((function(n){return yy(e,t,n)}))}(this._delegate):function(t){t=zp(t,Wp);var e=zp(t.firestore,id);return Dp(od(e),t._key).then((function(n){return yy(e,t,n)}))}(this._delegate)).then((function(t){return new ky(e.firestore,new $d(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}))},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Sy.nu(this.firestore,e)):this._delegate.withConverter(null))},t}();function Ay(t,e,n){return t.message=t.message.replace(e,n),t}function Dy(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!rd(r))return r}return{}}function Cy(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=rd(t[0])?t[0]:rd(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var ky=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new Ny(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return Hd(this._delegate,t._delegate)},t}(),xy=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _t(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(ky),Ry=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Iy(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,Yd(this._delegate,function(t,e,n){var r=e,i=jd("where",t);return new Xd(i,r,n)}(e,n,r)))}catch(e){throw Ay(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,Yd(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=jd("orderBy",t);return new Jd(r,n)}(e,n)))}catch(e){throw Ay(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,Yd(this._delegate,function(t){return Gp("limit",t),new Zd("limit",t,"F")}(e)))}catch(e){throw Ay(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,Yd(this._delegate,function(t){return Gp("limitToLast",t),new Zd("limitToLast",t,"L")}(e)))}catch(e){throw Ay(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Yd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ty("startAt",t,!0)}.apply(void 0,e)))}catch(e){throw Ay(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Yd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ty("startAfter",t,!1)}.apply(void 0,e)))}catch(e){throw Ay(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Yd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ey("endBefore",t,!0)}.apply(void 0,e)))}catch(e){throw Ay(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Yd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ey("endAt",t,!1)}.apply(void 0,e)))}catch(e){throw Ay(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return ed(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=zp(t,Yp);var e=zp(t.firestore,id),n=od(e),r=new ly(e);return function(t,e){var n=this,r=new kc;return t.asyncQueue.enqueueAndForget((function(){return Nt(n,void 0,void 0,(function(){var n;return At(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Nt(this,void 0,void 0,(function(){var r,i,o,s,a;return At(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,rl(t,e,!0)];case 1:return a=u.sent(),r=new kf(e,a.Bn),i=r._o(a.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=u.sent(),a=gf(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}}))}))},[4,_p(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._query).then((function(n){return new zd(e,r,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=zp(t,Yp);var e=zp(t.firestore,id),n=od(e),r=new ly(e);return Cp(n,t._query,{source:"server"}).then((function(n){return new zd(e,r,t,n)}))}(this._delegate):function(t){t=zp(t,Yp);var e=zp(t.firestore,id),n=od(e),r=new ly(e);return Qd(t._query),Cp(n,t._query).then((function(n){return new zd(e,r,t,n)}))}(this._delegate)).then((function(t){return new Ly(e.firestore,new zd(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Dy(e),i=Cy(e,(function(e){return new Ly(t.firestore,new zd(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return py(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Sy.nu(this.firestore,e)):this._delegate.withConverter(null))},t}(),Oy=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new xy(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),Ly=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new Ry(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new xy(t._firestore,e)}))},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new Oy(e._firestore,t)}))},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new xy(n._firestore,r))}))},t.prototype.isEqual=function(t){return Hd(this._delegate,t._delegate)},t}(),Py=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return _t(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new Ny(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Ny(this.firestore,void 0===t?Zp(this._delegate):Zp(this._delegate,t))}catch(t){throw Ay(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=zp(t.firestore,id),r=Zp(t),i=ay(t.converter,e);return dy(n,[wd(bd(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,qa.exists(!1))]).then((function(){return r}))}(this._delegate,t).then((function(t){return new Ny(e.firestore,t)}))},e.prototype.isEqual=function(t){return td(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(Sy.nu(this.firestore,t)):this._delegate.withConverter(null))},e}(Ry);function Fy(t){return zp(t,Wp)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var My,Vy=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(cd.bind.apply(cd,kt([void 0],t)))}return t.documentId=function(){return new t(cs.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=Gt(t))instanceof cd&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),Uy=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new Td("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new Ed("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new _d("arrayUnion",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Sd("arrayRemove",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new Nd("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),qy={Firestore:Ey,GeoPoint:fd,Timestamp:es,Blob:by,Transaction:Ty,WriteBatch:_y,DocumentReference:Ny,DocumentSnapshot:ky,Query:Ry,QueryDocumentSnapshot:xy,QuerySnapshot:Ly,CollectionReference:Py,FieldPath:Vy,FieldValue:Uy,setLogLevel:function(t){var e;e=t,jo.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new Ht("firestore",(function(t){return function(t,e){return new Ey(t,new id(t,e),new wy)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},qy)))})(My=Ee),My.registerVersion("@firebase/firestore","2.4.0");Ee.initializeApp({projectId:"sample-project-294713"});const jy=function(){const t=window.location.search;let e;if(t)e=t.substring(1);else{const t=It();window.location.hash=t,window.history.replaceState("","","?"+t),e=t}return e}(),By=Ee.firestore().collection("rooms").doc(jy),$y=function(){const{subscribe:t,set:e}=dt([]);return{subscribe:t,set:e,append:(t,e)=>{By.get().then((n=>{let r=[],i={closed:!0};if(n&&n.exists){const e=n.data();r=[...e.estimates.filter((e=>e.name!==t))],i=e.tableState}r.push({name:t,point:e,appendedAt:Ee.firestore.Timestamp.now()}),By.set({estimates:r,tableState:i})}))},remove:(t,e=null)=>{By.get().then((n=>{if(n&&n.exists){const r=n.data();r.estimates=r.estimates.filter((e=>e.name!==t)),By.set(r).then(e)}else e()}))},clear:()=>{By.delete()}}}(),Ky=function(){const{subscribe:t,set:e}=dt({closed:!0});return{subscribe:t,set:e,open:()=>{By.get().then((t=>{if(t&&t.exists){const e=t.data();e.tableState={closed:!1},By.set(e)}}))},close:()=>{By.delete()}}}(),zy=new Promise((t=>{By.onSnapshot((t=>{if(t&&t.exists){const e=t.data(),n=(t,e)=>t.appendedAt.seconds-e.appendedAt.seconds;$y.set(e.estimates.sort(n)),Ky.set(e.tableState)}else $y.set([]),Ky.set({closed:!0})})),t()}));function Gy(t){const e=t-1;return e*e*e+1}function Hy(t,{delay:e=0,duration:n=400,easing:r=Gy,x:i=0,y:o=0,opacity:s=0}={}){const a=getComputedStyle(t),u=+a.opacity,c="none"===a.transform?"":a.transform,h=u*(1-s);return{delay:e,duration:n,easing:r,css:(t,e)=>`\n\t\t\ttransform: ${c} translate(${(1-t)*i}px, ${(1-t)*o}px);\n\t\t\topacity: ${u-h*e}`}}function Qy(e){let n,r,i,s,a,c=(e[3]?"":e[0])+"";return{c(){n=b("div"),r=w(c),S(n,"class",i=u("card "+e[4])+" svelte-1lt9def"),C(n,"selectable",e[1]),C(n,"closed",e[3]),C(n,"selected",e[2])},m(t,i){v(t,n,i),d(n,r),s||(a=T(n,"click",(function(){o(e[1]?e[5]:void 0)&&(e[1]?e[5]:void 0).apply(this,arguments)})),s=!0)},p(t,[o]){e=t,9&o&&c!==(c=(e[3]?"":e[0])+"")&&N(r,c),16&o&&i!==(i=u("card "+e[4])+" svelte-1lt9def")&&S(n,"class",i),18&o&&C(n,"selectable",e[1]),24&o&&C(n,"closed",e[3]),20&o&&C(n,"selected",e[2])},i:t,o:t,d(t){t&&m(n),s=!1,a()}}}function Wy(t,e,n){let{point:r}=e,{selectable:i=!1}=e,{selected:o=!1}=e,{closed:s=!1}=e,{size:a="medium"}=e;const u=function(){const t=M();return(e,n)=>{const r=t.$$.callbacks[e];if(r){const i=k(e,n);r.slice().forEach((e=>{e.call(t,i)}))}}}();return t.$$set=t=>{"point"in t&&n(0,r=t.point),"selectable"in t&&n(1,i=t.selectable),"selected"in t&&n(2,o=t.selected),"closed"in t&&n(3,s=t.closed),"size"in t&&n(4,a=t.size)},[r,i,o,s,a,function(){u("selectCard",{point:r})}]}class Yy extends ft{constructor(t){super(),lt(this,t,Wy,Qy,s,{point:0,selectable:1,selected:2,closed:3,size:4})}}function Xy(e){let n,r,i,o,s=e[0]?"OPEN":"RETURN";return{c(){n=b("button"),r=w(s),S(n,"class",u("open-button")+" svelte-1i6cetj")},m(t,s){v(t,n,s),d(n,r),i||(o=T(n,"click",e[1]),i=!0)},p(t,[e]){1&e&&s!==(s=t[0]?"OPEN":"RETURN")&&N(r,s)},i:t,o:t,d(t){t&&m(n),i=!1,o()}}}function Jy(t,e,n){let{isClosed:r=!0}=e;return t.$$set=t=>{"isClosed"in t&&n(0,r=t.isClosed)},[r,function(e){V.call(this,t,e)}]}class Zy extends ft{constructor(t){super(),lt(this,t,Jy,Xy,s,{isClosed:0})}}function tg(e){let n,r,i,o,s,a,c=e[0]?"COPIED":"COPY";return{c(){n=b("button"),r=w(c),S(n,"class",i=u(["copy-button",e[0]?"copied":""].join(" "))+" svelte-96r1p3"),n.disabled=o=!!e[0]},m(t,i){v(t,n,i),d(n,r),s||(a=T(n,"click",e[1]),s=!0)},p(t,[e]){1&e&&c!==(c=t[0]?"COPIED":"COPY")&&N(r,c),1&e&&i!==(i=u(["copy-button",t[0]?"copied":""].join(" "))+" svelte-96r1p3")&&S(n,"class",i),1&e&&o!==(o=!!t[0])&&(n.disabled=o)},i:t,o:t,d(t){t&&m(n),s=!1,a()}}}function eg(t,e,n){let{isCopied:r=!1}=e;return t.$$set=t=>{"isCopied"in t&&n(0,r=t.isCopied)},[r,function(e){V.call(this,t,e)}]}class ng extends ft{constructor(t){super(),lt(this,t,eg,tg,s,{isCopied:0})}}function rg(t,e,n){const r=t.slice();return r[6]=e[n],r}function ig(t,e){let n,r,i,o,s,a,u,c,h=e[6].name+"";return r=new Yy({props:{point:e[6].point,size:"large",selectable:!1,closed:e[1]}}),{key:t,first:null,c(){n=b("div"),at(r.$$.fragment),i=E(),o=b("div"),s=w(h),a=E(),S(o,"class","name svelte-9nb4u2"),S(n,"class","estimate svelte-9nb4u2"),this.first=n},m(t,e){v(t,n,e),ut(r,n,null),d(n,i),d(n,o),d(o,s),d(n,a),c=!0},p(t,n){e=t;const i={};1&n&&(i.point=e[6].point),2&n&&(i.closed=e[1]),r.$set(i),(!c||1&n)&&h!==(h=e[6].name+"")&&N(s,h)},i(t){c||(nt(r.$$.fragment,t),z((()=>{u||(u=ot(n,Hy,{y:100},!0)),u.run(1)})),c=!0)},o(t){rt(r.$$.fragment,t),u||(u=ot(n,Hy,{y:100},!1)),u.run(0),c=!1},d(t){t&&m(n),ct(r),t&&u&&u.end()}}}function og(t){let e,n,r;return n=new Zy({props:{isClosed:t[1]}}),n.$on("click",(function(){o(t[2])&&t[2].apply(this,arguments)})),{c(){e=b("div"),at(n.$$.fragment),S(e,"class","open-button-area svelte-9nb4u2")},m(t,i){v(t,e,i),ut(n,e,null),r=!0},p(e,r){t=e;const i={};2&r&&(i.isClosed=t[1]),n.$set(i)},i(t){r||(nt(n.$$.fragment,t),r=!0)},o(t){rt(n.$$.fragment,t),r=!1},d(t){t&&m(e),ct(n)}}}function sg(t){let e,n;return e=new ng({props:{isCopied:t[3]}}),e.$on("click",t[4]),{c(){at(e.$$.fragment)},m(t,r){ut(e,t,r),n=!0},p(t,n){const r={};8&n&&(r.isCopied=t[3]),e.$set(r)},i(t){n||(nt(e.$$.fragment,t),n=!0)},o(t){rt(e.$$.fragment,t),n=!1},d(t){ct(e,t)}}}function ag(t){let e,n,r,i,o,s=[],a=new Map,u=t[0];const c=t=>t[6].name;for(let e=0;e<u.length;e+=1){let n=rg(t,u,e),r=c(n);a.set(r,s[e]=ig(r,n))}let h=(t[0].length>0||!t[1])&&og(t),l=!t[1]&&sg(t);return{c(){e=b("div"),n=b("div");for(let t=0;t<s.length;t+=1)s[t].c();r=E(),h&&h.c(),i=E(),l&&l.c(),S(n,"class","estimates svelte-9nb4u2"),S(e,"class","table svelte-9nb4u2")},m(t,a){v(t,e,a),d(e,n);for(let t=0;t<s.length;t+=1)s[t].m(n,null);d(e,r),h&&h.m(e,null),d(e,i),l&&l.m(e,null),o=!0},p(t,[r]){3&r&&(u=t[0],tt(),s=function(t,e,n,r,i,o,s,a,u,c,h,l){let f=t.length,p=o.length,d=f;const y={};for(;d--;)y[t[d].key]=d;const g=[],v=new Map,m=new Map;for(d=p;d--;){const t=l(i,o,d),a=n(t);let u=s.get(a);u?r&&u.p(t,e):(u=c(a,t),u.c()),v.set(a,g[d]=u),a in y&&m.set(a,Math.abs(d-y[a]))}const b=new Set,w=new Set;function E(t){nt(t,1),t.m(a,h),s.set(t.key,t),h=t.first,p--}for(;f&&p;){const e=g[p-1],n=t[f-1],r=e.key,i=n.key;e===n?(h=e.first,f--,p--):v.has(i)?!s.has(r)||b.has(r)?E(e):w.has(i)?f--:m.get(r)>m.get(i)?(w.add(r),E(e)):(b.add(i),f--):(u(n,s),f--)}for(;f--;){const e=t[f];v.has(e.key)||u(e,s)}for(;p;)E(g[p-1]);return g}(s,r,c,1,t,u,a,n,st,ig,null,rg),et()),t[0].length>0||!t[1]?h?(h.p(t,r),3&r&&nt(h,1)):(h=og(t),h.c(),nt(h,1),h.m(e,i)):h&&(tt(),rt(h,1,1,(()=>{h=null})),et()),t[1]?l&&(tt(),rt(l,1,1,(()=>{l=null})),et()):l?(l.p(t,r),2&r&&nt(l,1)):(l=sg(t),l.c(),nt(l,1),l.m(e,null))},i(t){if(!o){for(let t=0;t<u.length;t+=1)nt(s[t]);nt(h),nt(l),o=!0}},o(t){for(let t=0;t<s.length;t+=1)rt(s[t]);rt(h),rt(l),o=!1},d(t){t&&m(e);for(let t=0;t<s.length;t+=1)s[t].d();h&&h.d(),l&&l.d()}}}function ug(t,e,n){let{estimates:r=[]}=e,{isClosed:i=!0}=e,{handleOpenButtonClick:o=(()=>{})}=e;r=r||[];let s=!1;return t.$$set=t=>{"estimates"in t&&n(0,r=t.estimates),"isClosed"in t&&n(1,i=t.isClosed),"handleOpenButtonClick"in t&&n(2,o=t.handleOpenButtonClick)},[r,i,o,s,function(){const t=function(){if(0===r.length)return"empty.";const t=new Date;return"["+t.toLocaleDateString()+" "+t.toLocaleTimeString()+"] "+r.sort(((t,e)=>t.name>e.name?1:-1)).reduce(((t,e)=>(t?t+" ":"")+`${e.name}(${e.point})`),null)}();navigator.clipboard.writeText(t),n(3,s=!0),setTimeout((()=>{n(3,s=!1)}),1e3)}]}class cg extends ft{constructor(t){super(),lt(this,t,ug,ag,s,{estimates:0,isClosed:1,handleOpenButtonClick:2})}}function hg(e){let n,r,i;return{c(){n=b("button"),n.textContent="OK",S(n,"class",u("ok-button")+" svelte-rmf0e0")},m(t,o){v(t,n,o),r||(i=T(n,"click",function(t){return function(e){return e.stopPropagation(),t.call(this,e)}}(_(e[0]))),r=!0)},p:t,i:t,o:t,d(t){t&&m(n),r=!1,i()}}}function lg(t){return[function(e){V.call(this,t,e)}]}class fg extends ft{constructor(t){super(),lt(this,t,lg,hg,s,{})}}function pg(t,e,n){const r=t.slice();return r[10]=e[n],r}function dg(t){let e,n,r,o,s,a,u,c=t[0]&&gg(t);return{c(){e=b("div"),n=b("form"),r=b("input"),o=E(),c&&c.c(),S(r,"placeholder","your name"),r.autofocus=!0,S(r,"class","svelte-y3ory"),S(e,"class","user-name svelte-y3ory")},m(i,h){v(i,e,h),d(e,n),d(n,r),A(r,t[0]),d(n,o),c&&c.m(n,null),s=!0,r.focus(),a||(u=[T(r,"input",t[7]),T(n,"submit",_(t[9]))],a=!0)},p(t,e){1&e&&r.value!==t[0]&&A(r,t[0]),t[0]?c?(c.p(t,e),1&e&&nt(c,1)):(c=gg(t),c.c(),nt(c,1),c.m(n,null)):c&&(tt(),rt(c,1,1,(()=>{c=null})),et())},i(t){s||(nt(c),s=!0)},o(t){rt(c),s=!1},d(t){t&&m(e),c&&c.d(),a=!1,i(u)}}}function yg(t){let e,n,r,i,o,s=t[5],a=[];for(let e=0;e<s.length;e+=1)a[e]=vg(pg(t,s,e));const u=t=>rt(a[t],1,1,(()=>{a[t]=null}));return{c(){e=b("div"),n=w(t[0]),r=E();for(let t=0;t<a.length;t+=1)a[t].c();i=I(),S(e,"class","user-name svelte-y3ory")},m(t,s){v(t,e,s),d(e,n),v(t,r,s);for(let e=0;e<a.length;e+=1)a[e].m(t,s);v(t,i,s),o=!0},p(t,e){if((!o||1&e)&&N(n,t[0]),52&e){let n;for(s=t[5],n=0;n<s.length;n+=1){const r=pg(t,s,n);a[n]?(a[n].p(r,e),nt(a[n],1)):(a[n]=vg(r),a[n].c(),nt(a[n],1),a[n].m(i.parentNode,i))}for(tt(),n=s.length;n<a.length;n+=1)u(n);et()}},i(t){if(!o){for(let t=0;t<s.length;t+=1)nt(a[t]);o=!0}},o(t){a=a.filter(Boolean);for(let t=0;t<a.length;t+=1)rt(a[t]);o=!1},d(t){t&&m(e),t&&m(r),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(a,t),t&&m(i)}}}function gg(e){let n,r;return n=new fg({}),n.$on("click",e[8]),{c(){at(n.$$.fragment)},m(t,e){ut(n,t,e),r=!0},p:t,i(t){r||(nt(n.$$.fragment,t),r=!0)},o(t){rt(n.$$.fragment,t),r=!1},d(t){ct(n,t)}}}function vg(t){let e,n;return e=new Yy({props:{point:t[10],selectable:!0,size:"medium",selected:t[4]===t[10]}}),e.$on("selectCard",(function(){o(t[2])&&t[2].apply(this,arguments)})),{c(){at(e.$$.fragment)},m(t,r){ut(e,t,r),n=!0},p(n,r){t=n;const i={};16&r&&(i.selected=t[4]===t[10]),e.$set(i)},i(t){n||(nt(e.$$.fragment,t),n=!0)},o(t){rt(e.$$.fragment,t),n=!1},d(t){ct(e,t)}}}function mg(t){let e,n,r,i;const o=[yg,dg],s=[];function a(t,e){return t[0]&&t[1]?0:1}return n=a(t),r=s[n]=o[n](t),{c(){e=b("div"),r.c(),S(e,"class",u("user-selection")+" svelte-y3ory")},m(t,r){v(t,e,r),s[n].m(e,null),i=!0},p(t,[i]){let u=n;n=a(t),n===u?s[n].p(t,i):(tt(),rt(s[u],1,1,(()=>{s[u]=null})),et(),r=s[n],r?r.p(t,i):(r=s[n]=o[n](t),r.c()),nt(r,1),r.m(e,null))},i(t){i||(nt(r),i=!0)},o(t){rt(r),i=!1},d(t){t&&m(e),s[n].d()}}}function bg(t,e,n){let r,{userName:i=""}=e,{isFixedUserName:o=!1}=e,{estimates:s=[]}=e,{handleSelectCard:a}=e,{handleFixName:u}=e;s=s||[];return t.$$set=t=>{"userName"in t&&n(0,i=t.userName),"isFixedUserName"in t&&n(1,o=t.isFixedUserName),"estimates"in t&&n(6,s=t.estimates),"handleSelectCard"in t&&n(2,a=t.handleSelectCard),"handleFixName"in t&&n(3,u=t.handleFixName)},t.$$.update=()=>{65&t.$$.dirty&&n(4,r=s.filter((t=>t.name===i)).map((t=>t.point)).pop())},[i,o,a,u,r,["0","1","2","3","5","8","13","21","34","55","?","∞"],s,function(){i=this.value,n(0,i)},()=>u(i),()=>u(i)]}class wg extends ft{constructor(t){super(),lt(this,t,bg,mg,s,{userName:0,isFixedUserName:1,estimates:6,handleSelectCard:2,handleFixName:3})}}function Eg(e){let n;return{c(){n=b("div"),n.innerHTML='<a href="https://unsplash.com" target="_blank" rel="noopener noreferrer" title="Photo by Unsplash"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="_1Jlgk" version="1.1" viewBox="0 0 32 32" aria-labelledby="unsplash-home" aria-hidden="false"><path d="M10 9V0h12v9H10zm12 5h10v18H0V14h10v9h12v-9z"></path></svg></a>',S(n,"class","unsplash-credit svelte-1vmngv8")},m(t,e){v(t,n,e)},p:t,i:t,o:t,d(t){t&&m(n)}}}class Ig extends ft{constructor(t){super(),lt(this,t,null,Eg,s,{})}}function Tg(t){let e,n,r,o,s,a,u,c,h,l,f,p,y,g,I,_,A;return c=new cg({props:{isClosed:t[2],estimates:t[0],handleOpenButtonClick:t[5]}}),l=new wg({props:{userName:t[3],isFixedUserName:t[4],estimates:t[0],handleFixName:t[6],handleSelectCard:t[7]}}),g=new Ig({}),{c(){e=b("div"),n=b("main"),r=b("h1"),o=w(t[1]),s=E(),a=b("p"),a.textContent="share the URL of this page with your team members.",u=E(),at(c.$$.fragment),h=E(),at(l.$$.fragment),f=E(),p=b("div"),p.innerHTML='development: <a href="https://github.com/redfe/planning-poker-svelte" target="_blank" rel="noopener noreferrer" class="svelte-1qmg1fv">Source code</a>,<a href="./storybook-static/" target="_blank" rel="noopener noreferrer" class="svelte-1qmg1fv">Storybook</a>.',y=E(),at(g.$$.fragment),S(r,"class","svelte-1qmg1fv"),S(a,"class","svelte-1qmg1fv"),S(p,"class","devinfo svelte-1qmg1fv"),S(n,"class","svelte-1qmg1fv"),S(e,"class","container svelte-1qmg1fv"),D(e,"height",t[8])},m(i,m){v(i,e,m),d(e,n),d(n,r),d(r,o),d(n,s),d(n,a),d(n,u),ut(c,n,null),d(n,h),ut(l,n,null),d(n,f),d(n,p),d(e,y),ut(g,e,null),I=!0,_||(A=[T(window,"resize",t[9]),T(window,"load",t[9])],_=!0)},p(t,[n]){(!I||2&n)&&N(o,t[1]);const r={};4&n&&(r.isClosed=t[2]),1&n&&(r.estimates=t[0]),32&n&&(r.handleOpenButtonClick=t[5]),c.$set(r);const i={};8&n&&(i.userName=t[3]),16&n&&(i.isFixedUserName=t[4]),1&n&&(i.estimates=t[0]),64&n&&(i.handleFixName=t[6]),128&n&&(i.handleSelectCard=t[7]),l.$set(i),(!I||256&n)&&D(e,"height",t[8])},i(t){I||(nt(c.$$.fragment,t),nt(l.$$.fragment,t),nt(g.$$.fragment,t),I=!0)},o(t){rt(c.$$.fragment,t),rt(l.$$.fragment,t),rt(g.$$.fragment,t),I=!1},d(t){t&&m(e),ct(c),ct(l),ct(g),_=!1,i(A)}}}function _g(t,e,n){let{name:r}=e,{isTableClosed:i=!0}=e,{estimates:o=[]}=e,{userName:s=""}=e,{isFixedUserName:a=!1}=e,{handleOpenButtonClick:u}=e,{handleFixName:c}=e,{handleSelectCard:h}=e;o=o||[];const l=()=>document.documentElement.offsetHeight<document.documentElement.scrollHeight?"auto":"100%";let f=l();console.log("height:",f);return t.$$set=t=>{"name"in t&&n(1,r=t.name),"isTableClosed"in t&&n(2,i=t.isTableClosed),"estimates"in t&&n(0,o=t.estimates),"userName"in t&&n(3,s=t.userName),"isFixedUserName"in t&&n(4,a=t.isFixedUserName),"handleOpenButtonClick"in t&&n(5,u=t.handleOpenButtonClick),"handleFixName"in t&&n(6,c=t.handleFixName),"handleSelectCard"in t&&n(7,h=t.handleSelectCard)},[o,r,i,s,a,u,c,h,f,()=>{n(8,f=l())}]}class Sg extends ft{constructor(t){super(),lt(this,t,_g,Tg,s,{name:1,isTableClosed:2,estimates:0,userName:3,isFixedUserName:4,handleOpenButtonClick:5,handleFixName:6,handleSelectCard:7})}}function Ng(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function Ag(t){let e,n;return e=new Sg({props:{name:t[0],isTableClosed:t[4].closed,estimates:t[2],userName:t[1],isFixedUserName:t[3],handleOpenButtonClick:t[5],handleFixName:t[6],handleSelectCard:t[7]}}),{c(){at(e.$$.fragment)},m(t,r){ut(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.name=t[0]),16&n&&(r.isTableClosed=t[4].closed),4&n&&(r.estimates=t[2]),2&n&&(r.userName=t[1]),8&n&&(r.isFixedUserName=t[3]),e.$set(r)},i(t){n||(nt(e.$$.fragment,t),n=!0)},o(t){rt(e.$$.fragment,t),n=!1},d(t){ct(e,t)}}}function Dg(e){let n;return{c(){n=b("p"),n.textContent="...waiting"},m(t,e){v(t,n,e)},p:t,i:t,o:t,d(t){t&&m(n)}}}function Cg(t){let e,n,r,i,o;document.title=e=t[0];let s={ctx:t,current:null,token:null,hasCatch:!1,pending:Dg,then:Ag,catch:Ng,blocks:[,,,]};return function(t,e){const n=e.token={};function r(t,r,i,o){if(e.token!==n)return;e.resolved=o;let s=e.ctx;void 0!==i&&(s=s.slice(),s[i]=o);const a=t&&(e.current=t)(s);let u=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==r&&t&&(tt(),rt(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),et())})):e.block.d(1),a.c(),nt(a,1),a.m(e.mount(),e.anchor),u=!0),e.block=a,e.blocks&&(e.blocks[r]=a),u&&Q()}if((i=t)&&"object"==typeof i&&"function"==typeof i.then){const n=M();if(t.then((t=>{F(n),r(e.then,1,e.value,t),F(null)}),(t=>{if(F(n),r(e.catch,2,e.error,t),F(null),!e.hasCatch)throw t})),e.current!==e.pending)return r(e.pending,0),!0}else{if(e.current!==e.then)return r(e.then,1,e.value,t),!0;e.resolved=t}var i}(zy,s),{c(){n=b("link"),r=E(),i=I(),s.block.c(),S(n,"href","https://fonts.googleapis.com/css?family=M+PLUS+1p"),S(n,"rel","stylesheet")},m(t,e){d(document.head,n),v(t,r,e),v(t,i,e),s.block.m(t,s.anchor=e),s.mount=()=>i.parentNode,s.anchor=i,o=!0},p(n,[r]){t=n,(!o||1&r)&&e!==(e=t[0])&&(document.title=e),function(t,e,n){const r=e.slice(),{resolved:i}=t;t.current===t.then&&(r[t.value]=i),t.current===t.catch&&(r[t.error]=i),t.block.p(r,n)}(s,t,r)},i(t){o||(nt(s.block),o=!0)},o(t){for(let t=0;t<3;t+=1){rt(s.blocks[t])}o=!1},d(t){m(n),t&&m(r),t&&m(i),s.block.d(t),s.token=null,s=null}}}function kg(t,e,n){let r,i,o;a(t,$y,(t=>n(2,i=t))),a(t,Ky,(t=>n(4,o=t)));let{name:s}=e,u=window.localStorage.name||"",c=!1;return t.$$set=t=>{"name"in t&&n(0,s=t.name)},t.$$.update=()=>{6&t.$$.dirty&&(r=i.filter((t=>t.name===u)).map((t=>t.point)).pop())},[s,u,i,c,o,function(){o.closed?i.length>0&&Ky.open():($y.clear(),Ky.close())},function(t){t&&(n(1,u=t),window.localStorage.setItem("name",u),n(3,c=!0))},function(t){const e=()=>$y.append(u,t.detail.point);r?$y.remove(u,r===t.detail.point?null:()=>setTimeout(e,300)):e()}]}return new class extends ft{constructor(t){super(),lt(this,t,kg,Cg,s,{name:0})}}({target:document.body,props:{name:"Planning Poker"}})}();
//# sourceMappingURL=bundle.js.map
