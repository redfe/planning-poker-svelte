var app=function(){"use strict";function t(){}const e=t=>t;function n(t,e){for(const n in e)t[n]=e[n];return t}function r(t){return t()}function i(){return Object.create(null)}function o(t){t.forEach(r)}function s(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function u(e,n,r){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function c(t,e,r,i){return t[1]&&i?n(r.ctx.slice(),t[1](i(e))):r.ctx}function h(t,e,n,r,i,o,s){const a=function(t,e,n,r){if(t[2]&&r){const i=t[2](r(n));if(void 0===e.dirty)return i;if("object"==typeof i){const t=[],n=Math.max(e.dirty.length,i.length);for(let r=0;r<n;r+=1)t[r]=e.dirty[r]|i[r];return t}return e.dirty|i}return e.dirty}(e,r,i,o);if(a){const i=c(e,n,r,s);t.p(i,a)}}function l(t){const e={};for(const n in t)"$"!==n[0]&&(e[n]=t[n]);return e}function f(t){return null==t?"":t}const p="undefined"!=typeof window;let d=p?()=>window.performance.now():()=>Date.now(),y=p?t=>requestAnimationFrame(t):t;const g=new Set;function v(t){g.forEach((e=>{e.c(t)||(g.delete(e),e.f())})),0!==g.size&&y(v)}let m=!1;function b(t,e,n,r){for(;t<e;){const i=t+(e-t>>1);n(i)<=r?t=i+1:e=i}return t}function w(t,e){m?(!function(t){if(t.hydrate_init)return;t.hydrate_init=!0;const e=t.childNodes,n=new Int32Array(e.length+1),r=new Int32Array(e.length);n[0]=-1;let i=0;for(let t=0;t<e.length;t++){const o=b(1,i+1,(t=>e[n[t]].claim_order),e[t].claim_order)-1;r[t]=n[o]+1;const s=o+1;n[s]=t,i=Math.max(s,i)}const o=[],s=[];let a=e.length-1;for(let t=n[i]+1;0!=t;t=r[t-1]){for(o.push(e[t-1]);a>=t;a--)s.push(e[a]);a--}for(;a>=0;a--)s.push(e[a]);o.reverse(),s.sort(((t,e)=>t.claim_order-e.claim_order));for(let e=0,n=0;e<s.length;e++){for(;n<o.length&&s[e].claim_order>=o[n].claim_order;)n++;const r=n<o.length?o[n]:null;t.insertBefore(s[e],r)}}(t),(void 0===t.actual_end_child||null!==t.actual_end_child&&t.actual_end_child.parentElement!==t)&&(t.actual_end_child=t.firstChild),e!==t.actual_end_child?t.insertBefore(e,t.actual_end_child):t.actual_end_child=e.nextSibling):e.parentNode!==t&&t.appendChild(e)}function E(t,e,n){m&&!n?w(t,e):(e.parentNode!==t||n&&e.nextSibling!==n)&&t.insertBefore(e,n||null)}function I(t){t.parentNode.removeChild(t)}function _(t){return document.createElement(t)}function T(t){return document.createTextNode(t)}function S(){return T(" ")}function A(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function D(t){return function(e){return e.preventDefault(),t.call(this,e)}}function N(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function C(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function k(t,e){t.value=null==e?"":e}function x(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}function R(t,e,n){t.classList[n?"add":"remove"](e)}function O(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}const L=new Set;let P,M=0;function F(t,e,n,r,i,o,s,a=0){const u=16.666/r;let c="{\n";for(let t=0;t<=1;t+=u){const r=e+(n-e)*o(t);c+=100*t+`%{${s(r,1-r)}}\n`}const h=c+`100% {${s(n,1-n)}}\n}`,l=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(h)}_${a}`,f=t.ownerDocument;L.add(f);const p=f.__svelte_stylesheet||(f.__svelte_stylesheet=f.head.appendChild(_("style")).sheet),d=f.__svelte_rules||(f.__svelte_rules={});d[l]||(d[l]=!0,p.insertRule(`@keyframes ${l} ${h}`,p.cssRules.length));const y=t.style.animation||"";return t.style.animation=`${y?`${y}, `:""}${l} ${r}ms linear ${i}ms 1 both`,M+=1,l}function V(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),i=n.length-r.length;i&&(t.style.animation=r.join(", "),M-=i,M||y((()=>{M||(L.forEach((t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}})),L.clear())})))}function U(t){P=t}function q(){if(!P)throw new Error("Function called outside component initialization");return P}function j(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const B=[],$=[],K=[],z=[],G=Promise.resolve();let H=!1;function Q(t){K.push(t)}let W=!1;const Y=new Set;function X(){if(!W){W=!0;do{for(let t=0;t<B.length;t+=1){const e=B[t];U(e),J(e.$$)}for(U(null),B.length=0;$.length;)$.pop()();for(let t=0;t<K.length;t+=1){const e=K[t];Y.has(e)||(Y.add(e),e())}K.length=0}while(B.length);for(;z.length;)z.pop()();H=!1,W=!1,Y.clear()}}function J(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Q)}}let Z;function tt(t,e,n){t.dispatchEvent(O(`${e?"intro":"outro"}${n}`))}const et=new Set;let nt;function rt(){nt={r:0,c:[],p:nt}}function it(){nt.r||o(nt.c),nt=nt.p}function ot(t,e){t&&t.i&&(et.delete(t),t.i(e))}function st(t,e,n,r){if(t&&t.o){if(et.has(t))return;et.add(t),nt.c.push((()=>{et.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}const at={duration:0};function ut(n,r,i,a){let u=r(n,i),c=a?0:1,h=null,l=null,f=null;function p(){f&&V(n,f)}function m(t,e){const n=t.b-c;return e*=Math.abs(n),{a:c,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function b(r){const{delay:i=0,duration:s=300,easing:a=e,tick:b=t,css:w}=u||at,E={start:d()+i,b:r};r||(E.group=nt,nt.r+=1),h||l?l=E:(w&&(p(),f=F(n,c,r,s,i,a,w)),r&&b(0,1),h=m(E,s),Q((()=>tt(n,r,"start"))),function(t){let e;0===g.size&&y(v),new Promise((n=>{g.add(e={c:t,f:n})}))}((t=>{if(l&&t>l.start&&(h=m(l,s),l=null,tt(n,h.b,"start"),w&&(p(),f=F(n,c,h.b,h.duration,0,a,u.css))),h)if(t>=h.end)b(c=h.b,1-c),tt(n,h.b,"end"),l||(h.b?p():--h.group.r||o(h.group.c)),h=null;else if(t>=h.start){const e=t-h.start;c=h.a+h.d*a(e/h.duration),b(c,1-c)}return!(!h&&!l)})))}return{run(t){s(u)?(Z||(Z=Promise.resolve(),Z.then((()=>{Z=null}))),Z).then((()=>{u=u(),b(t)})):b(t)},end(){p(),h=l=null}}}const ct="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function ht(t,e){st(t,1,1,(()=>{e.delete(t.key)}))}function lt(t){t&&t.c()}function ft(t,e,n,i){const{fragment:a,on_mount:u,on_destroy:c,after_update:h}=t.$$;a&&a.m(e,n),i||Q((()=>{const e=u.map(r).filter(s);c?c.push(...e):o(e),t.$$.on_mount=[]})),h.forEach(Q)}function pt(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function dt(t,e){-1===t.$$.dirty[0]&&(B.push(t),H||(H=!0,G.then(X)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function yt(e,n,r,s,a,u,c=[-1]){const h=P;U(e);const l=e.$$={fragment:null,ctx:null,props:u,update:t,not_equal:a,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(h?h.$$.context:n.context||[]),callbacks:i(),dirty:c,skip_bound:!1};let f=!1;if(l.ctx=r?r(e,n.props||{},((t,n,...r)=>{const i=r.length?r[0]:n;return l.ctx&&a(l.ctx[t],l.ctx[t]=i)&&(!l.skip_bound&&l.bound[t]&&l.bound[t](i),f&&dt(e,t)),n})):[],l.update(),f=!0,o(l.before_update),l.fragment=!!s&&s(l.ctx),n.target){if(n.hydrate){m=!0;const t=function(t){return Array.from(t.childNodes)}(n.target);l.fragment&&l.fragment.l(t),t.forEach(I)}else l.fragment&&l.fragment.c();n.intro&&ot(e.$$.fragment),ft(e,n.target,n.anchor,n.customElement),m=!1,X()}U(h)}class gt{$destroy(){pt(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function vt(t){const e=t-1;return e*e*e+1}function mt(t,{delay:e=0,duration:n=400,easing:r=vt,x:i=0,y:o=0,opacity:s=0}={}){const a=getComputedStyle(t),u=+a.opacity,c="none"===a.transform?"":a.transform,h=u*(1-s);return{delay:e,duration:n,easing:r,css:(t,e)=>`\n\t\t\ttransform: ${c} translate(${(1-t)*i}px, ${(1-t)*o}px);\n\t\t\topacity: ${u-h*e}`}}const bt=[];function wt(e,n=t){let r;const i=[];function o(t){if(a(e,t)&&(e=t,r)){const t=!bt.length;for(let t=0;t<i.length;t+=1){const n=i[t];n[1](),bt.push(n,e)}if(t){for(let t=0;t<bt.length;t+=2)bt[t][0](bt[t+1]);bt.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(s,a=t){const u=[s,a];return i.push(u),1===i.length&&(r=n(o)||t),s(e),()=>{const t=i.indexOf(u);-1!==t&&i.splice(t,1),0===i.length&&(r(),r=null)}}}}var Et,It=new Uint8Array(16);function _t(){if(!Et&&!(Et="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Et(It)}var Tt=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function St(t){return"string"==typeof t&&Tt.test(t)}for(var At=[],Dt=0;Dt<256;++Dt)At.push((Dt+256).toString(16).substr(1));function Nt(t,e,n){var r=(t=t||{}).random||(t.rng||_t)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(At[t[e+0]]+At[t[e+1]]+At[t[e+2]]+At[t[e+3]]+"-"+At[t[e+4]]+At[t[e+5]]+"-"+At[t[e+6]]+At[t[e+7]]+"-"+At[t[e+8]]+At[t[e+9]]+"-"+At[t[e+10]]+At[t[e+11]]+At[t[e+12]]+At[t[e+13]]+At[t[e+14]]+At[t[e+15]]).toLowerCase();if(!St(n))throw TypeError("Stringified UUID is invalid");return n}(r)}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var Ct=function(t,e){return(Ct=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function kt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Ct(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var xt=function(){return(xt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Rt(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function Ot(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function Lt(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pt(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function Mt(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ft={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|a>>4,f=(15&a)<<2|c>>6,p=63&c;u||(p=64,s||(f=64)),r.push(n[h],n[l],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e}(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();var c=o<<2|s>>4;if(r.push(c),64!==a){var h=s<<4&240|a>>2;if(r.push(h),64!==u){var l=a<<6&192|u;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};function Vt(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=Vt(t[n],e[n]));return t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Ut=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function qt(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function jt(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Bt=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,$t.prototype.create),o}return kt(e,t),e}(Error),$t=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?Kt(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new Bt(i,a,r);return u},t}();function Kt(t,e){return t.replace(zt,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var zt=/\{\$([^}]+)}/g;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Gt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ht(t,e){var n=new Qt(t,e);return n.subscribe.bind(n)}var Qt=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=Wt),void 0===r.error&&(r.error=Wt),void 0===r.complete&&(r.complete=Wt);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function Wt(){}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Yt(t){return t&&t._delegate?t._delegate:t}var Xt=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),Jt="[DEFAULT]",Zt=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new Ut;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(r)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t))try{this.getOrInitializeService({instanceIdentifier:Jt})}catch(t){}try{for(var r=Lt(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=Pt(i.value,2),s=o[0],a=o[1],u=this.normalizeInstanceIdentifier(s);try{var c=this.getOrInitializeService({instanceIdentifier:u});a.resolve(c)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=Jt),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return Rt(this,void 0,void 0,(function(){var t;return Ot(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(Mt(Mt([],Pt(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),Pt(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=Jt),this.instances.has(t)},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var r=t.options,i=void 0===r?{}:r,o=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(o))throw Error(this.name+"("+o+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var s=this.getOrInitializeService({instanceIdentifier:o,options:i});try{for(var a=Lt(this.instancesDeferred.entries()),u=a.next();!u.done;u=a.next()){var c=Pt(u.value,2),h=c[0],l=c[1];o===this.normalizeInstanceIdentifier(h)&&l.resolve(s)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return s},t.prototype.onInit=function(t,e){var n,r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&t(o,r),function(){i.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,r,i=this.onInitCallbacks.get(e);if(i)try{for(var o=Lt(i),s=o.next();!s.done;s=o.next()){var a=s.value;try{a(t,e)}catch(t){}}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===Jt?void 0:e),options:i}),this.instances.set(n,o),this.invokeOnInitCallbacks(o,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(t){}return o||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=Jt),this.component?this.component.multipleInstances?t:Jt:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var te,ee=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new Zt(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function ne(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var re,ie=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(re||(re={}));var oe,se={debug:re.DEBUG,verbose:re.VERBOSE,info:re.INFO,warn:re.WARN,error:re.ERROR,silent:re.SILENT},ae=re.INFO,ue=((te={})[re.DEBUG]="log",te[re.VERBOSE]="log",te[re.INFO]="info",te[re.WARN]="warn",te[re.ERROR]="error",te),ce=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=ue[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,ne(["["+i+"]  "+t.name+":"],n))}},he=function(){function t(t){this.name=t,this._logLevel=ae,this._logHandler=ce,this._userLogHandler=null,ie.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in re))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?se[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,ne([this,re.DEBUG],t)),this._logHandler.apply(this,ne([this,re.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,ne([this,re.VERBOSE],t)),this._logHandler.apply(this,ne([this,re.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,ne([this,re.INFO],t)),this._logHandler.apply(this,ne([this,re.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,ne([this,re.WARN],t)),this._logHandler.apply(this,ne([this,re.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,ne([this,re.ERROR],t)),this._logHandler.apply(this,ne([this,re.ERROR],t))},t}();function le(t){ie.forEach((function(e){e.setLogLevel(t)}))}var fe,pe=((oe={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",oe["bad-app-name"]="Illegal App name: '{$appName}",oe["duplicate-app"]="Firebase App named '{$appName}' already exists",oe["app-deleted"]="Firebase App named '{$appName}' already deleted",oe["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",oe["invalid-log-argument"]="First argument to `onLog` must be null or a function.",oe),de=new $t("app","Firebase",pe),ye="@firebase/app",ge="[DEFAULT]",ve=((fe={})[ye]="fire-core",fe["@firebase/analytics"]="fire-analytics",fe["@firebase/app-check"]="fire-app-check",fe["@firebase/auth"]="fire-auth",fe["@firebase/database"]="fire-rtdb",fe["@firebase/functions"]="fire-fn",fe["@firebase/installations"]="fire-iid",fe["@firebase/messaging"]="fire-fcm",fe["@firebase/performance"]="fire-perf",fe["@firebase/remote-config"]="fire-rc",fe["@firebase/storage"]="fire-gcs",fe["@firebase/firestore"]="fire-fst",fe["fire-js"]="fire-js",fe["firebase-wrapper"]="fire-js-all",fe),me=new he("@firebase/app"),be=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=Vt(void 0,t),this.container=new ee(e.name),this._addComponent(new Xt("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){var n;void 0===e&&(e=ge),this.checkDestroyed_();var r=this.container.getProvider(t);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=ge),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){me.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw de.create("app-deleted",{appName:this.name_})},t}();be.prototype.name&&be.prototype.options||be.prototype.delete||console.log("dc");
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function we(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var o=i;void 0===o.name&&(o.name=ge);var s=o.name;if("string"!=typeof s||!s)throw de.create("bad-app-name",{appName:String(s)});if(Gt(e,s))throw de.create("duplicate-app",{appName:s});var a=new t(n,o,r);return e[s]=a,a},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=ve[t])&&void 0!==r?r:t;n&&(i+="-"+n);var s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return s&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),s&&a&&u.push("and"),a&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void me.warn(u.join(" "))}o(new Xt(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:le,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw de.create("invalid-log-argument");!function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=se[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:re[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=ie;r<i.length;r++)n(i[r])}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t,e)},apps:null,SDK_VERSION:"8.7.0",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){if("serverAuth"===e)return null;return e}}};function i(t){if(!Gt(e,t=t||ge))throw de.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return me.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var a=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[s])throw de.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&Vt(a,o.serviceProps),r[s]=a,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,s);return n.apply(this,o.multipleInstances?t:[])}}for(var u=0,c=Object.keys(e);u<c.length;u++){var h=c[u];e[h]._addComponent(o)}return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ee=function t(){var e=we(be);return e.INTERNAL=xt(xt({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){Vt(e,t)},createSubscribe:Ht,ErrorFactory:$t,deepExtend:Vt}),e}(),Ie=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){me.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var _e=self.firebase.SDK_VERSION;_e&&_e.indexOf("LITE")>=0&&me.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Te=Ee.initializeApp;Ee.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return jt()&&me.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),Te.apply(void 0,t)};var Se=Ee;!function(t,e){t.INTERNAL.registerComponent(new Xt("platform-logger",(function(t){return new Ie(t)}),"PRIVATE")),t.registerVersion(ye,"0.6.28",e),t.registerVersion("fire-js","")}(Se);var Ae="8.7.1";
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
Se.registerVersion("firebase",Ae,"app"),Se.SDK_VERSION=Ae;
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var De=function(t,e){return(De=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function Ne(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var Ce,ke="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},xe=xe||{},Re=ke||self;function Oe(){}function Le(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Pe(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Me="closure_uid_"+(1e9*Math.random()>>>0),Fe=0;function Ve(t,e,n){return t.call.apply(t.bind,arguments)}function Ue(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function qe(t,e,n){return(qe=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Ve:Ue).apply(null,arguments)}function je(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Be(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function $e(){this.s=this.s,this.o=this.o}var Ke={};$e.prototype.s=!1,$e.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,Me)&&t[Me]||(t[Me]=++Fe)}(this);delete Ke[t]}},$e.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var ze=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Ge=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function He(t){return Array.prototype.concat.apply([],arguments)}function Qe(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function We(t){return/^[\s\xa0]*$/.test(t)}var Ye,Xe=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Je(t,e){return-1!=t.indexOf(e)}function Ze(t,e){return t<e?-1:t>e?1:0}t:{var tn=Re.navigator;if(tn){var en=tn.userAgent;if(en){Ye=en;break t}}Ye=""}function nn(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function rn(t){var e={};for(var n in t)e[n]=t[n];return e}var on="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function sn(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<on.length;o++)n=on[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function an(t){return an[" "](t),t}an[" "]=Oe;var un,cn,hn=Je(Ye,"Opera"),ln=Je(Ye,"Trident")||Je(Ye,"MSIE"),fn=Je(Ye,"Edge"),pn=fn||ln,dn=Je(Ye,"Gecko")&&!(Je(Ye.toLowerCase(),"webkit")&&!Je(Ye,"Edge"))&&!(Je(Ye,"Trident")||Je(Ye,"MSIE"))&&!Je(Ye,"Edge"),yn=Je(Ye.toLowerCase(),"webkit")&&!Je(Ye,"Edge");function gn(){var t=Re.document;return t?t.documentMode:void 0}t:{var vn="",mn=(cn=Ye,dn?/rv:([^\);]+)(\)|;)/.exec(cn):fn?/Edge\/([\d\.]+)/.exec(cn):ln?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(cn):yn?/WebKit\/(\S+)/.exec(cn):hn?/(?:Version)[ \/]?(\S+)/.exec(cn):void 0);if(mn&&(vn=mn?mn[1]:""),ln){var bn=gn();if(null!=bn&&bn>parseFloat(vn)){un=String(bn);break t}}un=vn}var wn,En={};function In(){return function(t){var e=En;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}((function(){for(var t=0,e=Xe(String(un)).split("."),n=Xe("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Ze(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Ze(0==o[2].length,0==s[2].length)||Ze(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t}))}if(Re.document&&ln){var _n=gn();wn=_n||(parseInt(un,10)||void 0)}else wn=void 0;var Tn=wn,Sn=function(){if(!Re.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Re.addEventListener("test",Oe,e),Re.removeEventListener("test",Oe,e)}catch(t){}return t}();function An(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function Dn(t,e){if(An.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(dn){t:{try{an(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Nn[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Dn.Z.h.call(this)}}An.prototype.h=function(){this.defaultPrevented=!0},Be(Dn,An);var Nn={2:"touch",3:"pen",4:"mouse"};Dn.prototype.h=function(){Dn.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Cn="closure_listenable_"+(1e6*Math.random()|0),kn=0;function xn(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++kn,this.ca=this.fa=!1}function Rn(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function On(t){this.src=t,this.g={},this.h=0}function Ln(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],o=ze(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Rn(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Pn(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ca&&o.listener==e&&o.capture==!!n&&o.ia==r)return i}return-1}On.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var s=Pn(t,e,r,i);return-1<s?(e=t[s],n||(e.fa=!1)):((e=new xn(e,this.src,o,!!r,i)).fa=n,t.push(e)),e};var Mn="closure_lm_"+(1e6*Math.random()|0),Fn={};function Vn(t,e,n,r,i){if(r&&r.once)return qn(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Vn(t,e[o],n,r,i);return null}return n=Hn(n),t&&t[Cn]?t.N(e,n,Pe(r)?!!r.capture:!!r,i):Un(t,e,n,!1,r,i)}function Un(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=Pe(i)?!!i.capture:!!i,a=zn(t);if(a||(t[Mn]=a=new On(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){function t(n){return e.call(t.src,t.listener,n)}var e=Kn;return t}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Sn||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent($n(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function qn(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)qn(t,e[o],n,r,i);return null}return n=Hn(n),t&&t[Cn]?t.O(e,n,Pe(r)?!!r.capture:!!r,i):Un(t,e,n,!0,r,i)}function jn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)jn(t,e[o],n,r,i);else r=Pe(r)?!!r.capture:!!r,n=Hn(n),t&&t[Cn]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=Pn(o=t.g[e],n,r,i))&&(Rn(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.g[e],t.h--)))):t&&(t=zn(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Pn(e,n,r,i)),(n=-1<t?e[t]:null)&&Bn(n))}function Bn(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[Cn])Ln(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent($n(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=zn(e))?(Ln(n,t),0==n.h&&(n.src=null,e[Mn]=null)):Rn(t)}}}function $n(t){return t in Fn?Fn[t]:Fn[t]="on"+t}function Kn(t,e){if(t.ca)t=!0;else{e=new Dn(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&Bn(t),t=n.call(r,e)}return t}function zn(t){return(t=t[Mn])instanceof On?t:null}var Gn="__closure_events_fn_"+(1e9*Math.random()>>>0);function Hn(t){return"function"==typeof t?t:(t[Gn]||(t[Gn]=function(e){return t.handleEvent(e)}),t[Gn])}function Qn(){$e.call(this),this.i=new On(this),this.P=this,this.I=null}function Wn(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"==typeof e)e=new An(e,t);else if(e instanceof An)e.target=e.target||t;else{var i=e;sn(e=new An(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.g=n[o];i=Yn(s,r,!0,e)&&i}if(i=Yn(s=e.g=t,r,!0,e)&&i,i=Yn(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Yn(s=e.g=n[o],r,!1,e)&&i}function Yn(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.ca&&s.capture==n){var a=s.listener,u=s.ia||s.src;s.fa&&Ln(t.i,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}Be(Qn,$e),Qn.prototype[Cn]=!0,Qn.prototype.removeEventListener=function(t,e,n,r){jn(this,t,e,n,r)},Qn.prototype.M=function(){if(Qn.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)Rn(n[r]);delete e.g[t],e.h--}}this.I=null},Qn.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},Qn.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var Xn=Re.JSON.stringify;function Jn(){var t=sr,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Zn,tr=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=er.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),er=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t},t}())((function(){return new nr}),(function(t){return t.reset()})),nr=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function rr(t){Re.setTimeout((function(){throw t}),0)}function ir(t,e){Zn||function(){var t=Re.Promise.resolve(void 0);Zn=function(){t.then(ar)}}(),or||(Zn(),or=!0),sr.add(t,e)}var or=!1,sr=new tr;function ar(){for(var t;t=Jn();){try{t.h.call(t.g)}catch(t){rr(t)}var e=er;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}or=!1}function ur(t,e){Qn.call(this),this.h=t||1,this.g=e||Re,this.j=qe(this.kb,this),this.l=Date.now()}function cr(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function hr(t,e,n){if("function"==typeof t)n&&(t=qe(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=qe(t.handleEvent,t)}return 2147483647<Number(e)?-1:Re.setTimeout(t,e||0)}function lr(t){t.g=hr((function(){t.g=null,t.i&&(t.i=!1,lr(t))}),t.j);var e=t.h;t.h=null,t.m.apply(null,e)}Be(ur,Qn),(Ce=ur.prototype).da=!1,Ce.S=null,Ce.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Wn(this,"tick"),this.da&&(cr(this),this.start()))}},Ce.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Ce.M=function(){ur.Z.M.call(this),cr(this),delete this.g};var fr=function(t){function e(e,n){var r=t.call(this)||this;return r.m=e,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}De(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:lr(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(Re.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}($e);function pr(t){$e.call(this),this.h=t,this.g={}}Be(pr,$e);var dr=[];function yr(t,e,n,r){Array.isArray(n)||(n&&(dr[0]=n.toString()),n=dr);for(var i=0;i<n.length;i++){var o=Vn(e,n[i],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function gr(t){nn(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Bn(t)}),t),t.g={}}function vr(){this.g=!0}function mr(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Xn(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}pr.prototype.M=function(){pr.Z.M.call(this),gr(this)},pr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},vr.prototype.Aa=function(){this.g=!1},vr.prototype.info=function(){};var br={},wr=null;function Er(){return wr=wr||new Qn}function Ir(t){An.call(this,br.Ma,t)}function _r(t){var e=Er();Wn(e,new Ir(e,t))}function Tr(t,e){An.call(this,br.STAT_EVENT,t),this.stat=e}function Sr(t){var e=Er();Wn(e,new Tr(e,t))}function Ar(t,e){An.call(this,br.Na,t),this.size=e}function Dr(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Re.setTimeout((function(){t()}),e)}br.Ma="serverreachability",Be(Ir,An),br.STAT_EVENT="statevent",Be(Tr,An),br.Na="timingevent",Be(Ar,An);var Nr={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Cr={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function kr(){}function xr(t){return t.h||(t.h=t.i())}function Rr(){}kr.prototype.h=null;var Or,Lr={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Pr(){An.call(this,"d")}function Mr(){An.call(this,"c")}function Fr(){}function Vr(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new pr(this),this.P=qr,t=pn?125:void 0,this.W=new ur(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Ur}function Ur(){this.i=null,this.g="",this.h=!1}Be(Pr,An),Be(Mr,An),Be(Fr,kr),Fr.prototype.g=function(){return new XMLHttpRequest},Fr.prototype.i=function(){return{}},Or=new Fr;var qr=45e3,jr={},Br={};function $r(t,e,n){t.K=1,t.v=fi(si(e)),t.s=n,t.U=!0,Kr(t,null)}function Kr(t,e){t.F=Date.now(),Qr(t),t.A=si(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),Si(n.h,"t",r),t.C=0,n=t.l.H,t.h=new Ur,t.g=Do(t.l,n?e:null,!t.s),0<t.O&&(t.L=new fr(qe(t.Ia,t,t.g),t.O)),yr(t.V,t.g,"readystatechange",t.gb),e=t.H?rn(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),_r(1),function(t,e,n,r,i,o){t.info((function(){if(t.g)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&"type"==l[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function zr(t){return!!t.g&&("GET"==t.u&&2!=t.K&&t.l.Ba)}function Gr(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;){if((r=Hr(t,n))==Br){4==e&&(t.o=4,Sr(14),i=!1),mr(t.j,t.m,null,"[Incomplete Response]");break}if(r==jr){t.o=4,Sr(15),mr(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}mr(t.j,t.m,r,null),Zr(t,r)}zr(t)&&r!=Br&&r!=jr&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,Sr(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),bo(e),e.L=!0,Sr(11))):(mr(t.j,t.m,n,"[Invalid Chunked Response]"),Jr(t),Xr(t))}function Hr(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?Br:(n=Number(e.substring(n,r)),isNaN(n)?jr:(r+=1)+n>e.length?Br:(e=e.substr(r,n),t.C=r+n,e))}function Qr(t){t.Y=Date.now()+t.P,Wr(t,t.P)}function Wr(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Dr(qe(t.eb,t),e)}function Yr(t){t.B&&(Re.clearTimeout(t.B),t.B=null)}function Xr(t){0==t.l.G||t.I||Io(t.l,t)}function Jr(t){Yr(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,cr(t.W),gr(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Zr(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||Ri(n.i,t)))if(n.I=t.N,!t.J&&Ri(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(o){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;Eo(n),co(n)}mo(n),Sr(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=Dr(qe(n.ab,n),6e3));if(1>=xi(n.i)&&n.ka){try{n.ka()}catch(o){}n.ka=void 0}}else To(n,11)}else if((t.J||n.g==t)&&Eo(n),!We(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var o=i[e];if(n.U=o[0],o=o[1],2==n.G)if("c"==o[0]){n.J=o[1],n.la=o[2];var s=o[3];null!=s&&(n.ma=s,n.h.info("VER="+n.ma));var a=o[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var u=o[5];null!=u&&"number"==typeof u&&0<u&&(r=1.5*u,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=t.g;if(c){var h=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=r.i;!l.g&&(Je(h,"spdy")||Je(h,"quic")||Je(h,"h2"))&&(l.j=l.l,l.g=new Set,l.h&&(Oi(l,l.h),l.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,li(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var p=t;if((r=n).oa=Ao(r,r.H?r.la:null,r.W),p.J){Li(r.i,p);var d=p,y=r.K;y&&d.setTimeout(y),d.B&&(Yr(d),Qr(d)),r.g=p}else vo(r);0<n.l.length&&fo(n)}else"stop"!=o[0]&&"close"!=o[0]||To(n,7);else 3==n.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?To(n,7):uo(n):"noop"!=o[0]&&n.j&&n.j.wa(o),n.A=0)}_r(4)}catch(o){}}function ti(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Le(t)||"string"==typeof t)Ge(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(Le(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(Le(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ei(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ei)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ni(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];ri(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)ri(i,r=t.g[e])||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}function ri(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(Ce=Vr.prototype).setTimeout=function(t){this.P=t},Ce.gb=function(t){t=t.target;var e=this.L;e&&3==ro(t)?e.l():this.Ia(t)},Ce.Ia=function(t){try{if(t==this.g)t:{var e=ro(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||pn||this.g&&(this.h.h||this.g.ga()||io(this.g)))){this.I||4!=e||7==n||_r(8==n||0>=r?3:2),Yr(this);var i=this.g.ba();this.N=i;e:if(zr(this)){var o=io(this.g);t="";var s=o.length,a=4==ro(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Jr(this),Xr(this);var u="";break e}this.h.i=new Re.TextDecoder}for(n=0;n<s;n++)this.h.h=!0,t+=this.h.i.decode(o[n],{stream:a&&n==s-1});o.splice(0,s),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,h=this.g;if((c=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!We(c)){var l=c;break e}}l=null}if(!(i=l)){this.i=!1,this.o=3,Sr(12),Jr(this),Xr(this);break t}mr(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Zr(this,i)}this.U?(Gr(this,e,u),pn&&this.i&&3==e&&(yr(this.V,this.W,"tick",this.fb),this.W.start())):(mr(this.j,this.m,u,null),Zr(this,u)),4==e&&Jr(this),this.i&&!this.I&&(4==e?Io(this.l,this):(this.i=!1,Qr(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,Sr(12)):(this.o=0,Sr(13)),Jr(this),Xr(this)}}}catch(e){}},Ce.fb=function(){if(this.g){var t=ro(this.g),e=this.g.ga();this.C<e.length&&(Yr(this),Gr(this,t,e),this.i&&4!=t&&Qr(this))}},Ce.cancel=function(){this.I=!0,Jr(this)},Ce.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(_r(3),Sr(17)),Jr(this),this.o=2,Xr(this)):Wr(this,this.Y-t)},(Ce=ei.prototype).R=function(){ni(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},Ce.T=function(){return ni(this),this.g.concat()},Ce.get=function(t,e){return ri(this.h,t)?this.h[t]:e},Ce.set=function(t,e){ri(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},Ce.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var ii=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function oi(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof oi){this.g=void 0!==e?e:t.g,ai(this,t.j),this.s=t.s,ui(this,t.i),ci(this,t.m),this.l=t.l,e=t.h;var n=new Ei;n.i=e.i,e.g&&(n.g=new ei(e.g),n.h=e.h),hi(this,n),this.o=t.o}else t&&(n=String(t).match(ii))?(this.g=!!e,ai(this,n[1]||"",!0),this.s=pi(n[2]||""),ui(this,n[3]||"",!0),ci(this,n[4]),this.l=pi(n[5]||"",!0),hi(this,n[6]||"",!0),this.o=pi(n[7]||"")):(this.g=!!e,this.h=new Ei(null,this.g))}function si(t){return new oi(t)}function ai(t,e,n){t.j=n?pi(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function ui(t,e,n){t.i=n?pi(e,!0):e}function ci(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function hi(t,e,n){e instanceof Ei?(t.h=e,function(t,e){e&&!t.j&&(Ii(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(_i(this,e),Si(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=di(e,bi)),t.h=new Ei(e,t.g))}function li(t,e,n){t.h.set(e,n)}function fi(t){return li(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function pi(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function di(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,yi),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function yi(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}oi.prototype.toString=function(){var t=[],e=this.j;e&&t.push(di(e,gi,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(di(e,gi,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(di(n,"/"==n.charAt(0)?mi:vi,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",di(n,wi)),t.join("")};var gi=/[#\/\?@]/g,vi=/[#\?:]/g,mi=/[#\?]/g,bi=/[#\?@]/g,wi=/#/g;function Ei(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ii(t){t.g||(t.g=new ei,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function _i(t,e){Ii(t),e=Ai(t,e),ri(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,ri((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&ni(t)))}function Ti(t,e){return Ii(t),e=Ai(t,e),ri(t.g.h,e)}function Si(t,e,n){_i(t,e),0<n.length&&(t.i=null,t.g.set(Ai(t,e),Qe(n)),t.h+=n.length)}function Ai(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(Ce=Ei.prototype).add=function(t,e){Ii(this),this.i=null,t=Ai(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},Ce.forEach=function(t,e){Ii(this),this.g.forEach((function(n,r){Ge(n,(function(n){t.call(e,n,r,this)}),this)}),this)},Ce.T=function(){Ii(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},Ce.R=function(t){Ii(this);var e=[];if("string"==typeof t)Ti(this,t)&&(e=He(e,this.g.get(Ai(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=He(e,t[n])}return e},Ce.set=function(t,e){return Ii(this),this.i=null,Ti(this,t=Ai(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},Ce.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},Ce.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.i=t.join("&")};var Di=function(t,e){this.h=t,this.g=e};function Ni(t){this.l=t||Ci,Re.PerformanceNavigationTiming?t=0<(t=Re.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(Re.g&&Re.g.Ea&&Re.g.Ea()&&Re.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Ci=10;function ki(t){return!!t.h||!!t.g&&t.g.size>=t.j}function xi(t){return t.h?1:t.g?t.g.size:0}function Ri(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Oi(t,e){t.g?t.g.add(e):t.h=e}function Li(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Pi(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var r=t.i;try{for(var i=Ne(t.g.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.D)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return Qe(t.i)}function Mi(){}function Fi(){this.g=new Mi}function Vi(t,e,n){var r=n||"";try{ti(t,(function(t,n){var i=t;Pe(t)&&(i=Xn(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function Ui(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function qi(t){this.l=t.$b||null,this.j=t.ib||!1}function ji(t,e){Qn.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Bi,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ni.prototype.cancel=function(){var t,e;if(this.i=Pi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=Ne(this.g.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},Mi.prototype.stringify=function(t){return Re.JSON.stringify(t,void 0)},Mi.prototype.parse=function(t){return Re.JSON.parse(t,void 0)},Be(qi,kr),qi.prototype.g=function(){return new ji(this.l,this.j)},qi.prototype.i=function(t){return function(){return t}}({}),Be(ji,Qn);var Bi=0;function $i(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function Ki(t){t.readyState=4,t.l=null,t.j=null,t.A=null,zi(t)}function zi(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(Ce=ji.prototype).open=function(t,e){if(this.readyState!=Bi)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,zi(this)},Ce.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||Re).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},Ce.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Ki(this)),this.readyState=Bi},Ce.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,zi(this)),this.g&&(this.readyState=3,zi(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==Re.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;$i(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},Ce.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Ki(this):zi(this),3==this.readyState&&$i(this)}},Ce.Ua=function(t){this.g&&(this.response=this.responseText=t,Ki(this))},Ce.Ta=function(t){this.g&&(this.response=t,Ki(this))},Ce.ha=function(){this.g&&Ki(this)},Ce.setRequestHeader=function(t,e){this.v.append(t,e)},Ce.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},Ce.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(ji.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Gi=Re.JSON.parse;function Hi(t){Qn.call(this),this.headers=new ei,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Qi,this.K=this.L=!1}Be(Hi,Qn);var Qi="",Wi=/^https?$/i,Yi=["POST","PUT"];function Xi(t){return"content-type"==t.toLowerCase()}function Ji(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Zi(t),eo(t)}function Zi(t){t.D||(t.D=!0,Wn(t,"complete"),Wn(t,"error"))}function to(t){if(t.h&&void 0!==xe&&(!t.C[1]||4!=ro(t)||2!=t.ba()))if(t.v&&4==ro(t))hr(t.Fa,0,t);else if(Wn(t,"readystatechange"),4==ro(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.H).match(ii)[1]||null;if(!o&&Re.self&&Re.self.location){var s=Re.self.location.protocol;o=s.substr(0,s.length-1)}i=!Wi.test(o?o.toLowerCase():"")}e=i}if(e)Wn(t,"complete"),Wn(t,"success");else{t.m=6;try{var a=2<ro(t)?t.g.statusText:""}catch(t){a=""}t.j=a+" ["+t.ba()+"]",Zi(t)}}finally{eo(t)}}}function eo(t,e){if(t.g){no(t);var n=t.g,r=t.C[0]?Oe:null;t.g=null,t.C=null,e||Wn(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function no(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(Re.clearTimeout(t.A),t.A=null)}function ro(t){return t.g?t.g.readyState:0}function io(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Qi:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function oo(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return nn(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):li(t,e,n))}function so(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function ao(t){this.za=0,this.l=[],this.h=new vr,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=so("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=so("baseRetryDelayMs",5e3,t),this.$a=so("retryDelaySeedMs",1e4,t),this.Ya=so("forwardChannelMaxRetries",2,t),this.ra=so("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new Ni(t&&t.concurrentRequestLimit),this.Ca=new Fi,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function uo(t){if(ho(t),3==t.G){var e=t.V++,n=si(t.F);li(n,"SID",t.J),li(n,"RID",e),li(n,"TYPE","terminate"),yo(t,n),(e=new Vr(t,t.h,e,void 0)).K=2,e.v=fi(si(n)),n=!1,Re.navigator&&Re.navigator.sendBeacon&&(n=Re.navigator.sendBeacon(e.v.toString(),"")),!n&&Re.Image&&((new Image).src=e.v,n=!0),n||(e.g=Do(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Qr(e)}So(t)}function co(t){t.g&&(bo(t),t.g.cancel(),t.g=null)}function ho(t){co(t),t.u&&(Re.clearTimeout(t.u),t.u=null),Eo(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Re.clearTimeout(t.m),t.m=null)}function lo(t,e){t.l.push(new Di(t.Za++,e)),3==t.G&&fo(t)}function fo(t){ki(t.i)||t.m||(t.m=!0,ir(t.Ha,t),t.C=0)}function po(t,e){var n;n=e?e.m:t.V++;var r=si(t.F);li(r,"SID",t.J),li(r,"RID",n),li(r,"AID",t.U),yo(t,r),t.o&&t.s&&oo(r,t.o,t.s),n=new Vr(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=go(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),Oi(t.i,n),$r(n,r,e)}function yo(t,e){t.j&&ti({},(function(t,n){li(e,n,t)}))}function go(t,e,n){n=Math.min(t.l.length,n);var r=t.j?qe(t.j.Oa,t.j,t):null;t:for(var i=t.l,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].h,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].h,h=i[u].g;if(0>(c-=o))o=Math.max(0,i[u].h-100),a=!1;else try{Vi(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function vo(t){t.g||t.u||(t.Y=1,ir(t.Ga,t),t.A=0)}function mo(t){return!(t.g||t.u||3<=t.A)&&(t.Y++,t.u=Dr(qe(t.Ga,t),_o(t,t.A)),t.A++,!0)}function bo(t){null!=t.B&&(Re.clearTimeout(t.B),t.B=null)}function wo(t){t.g=new Vr(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=si(t.oa);li(e,"RID","rpc"),li(e,"SID",t.J),li(e,"CI",t.N?"0":"1"),li(e,"AID",t.U),yo(t,e),li(e,"TYPE","xmlhttp"),t.o&&t.s&&oo(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=fi(si(e)),n.s=null,n.U=!0,Kr(n,t)}function Eo(t){null!=t.v&&(Re.clearTimeout(t.v),t.v=null)}function Io(t,e){var n=null;if(t.g==e){Eo(t),bo(t),t.g=null;var r=2}else{if(!Ri(t.i,e))return;n=e.D,Li(t.i,e),r=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;Wn(r=Er(),new Ar(r,n,e,i)),fo(t)}else vo(t);else if(3==(i=e.o)||0==i&&0<t.I||!(1==r&&function(t,e){return!(xi(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=Dr(qe(t.Ha,t,e),_o(t,t.C)),t.C++,0)))}(t,e)||2==r&&mo(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:To(t,5);break;case 4:To(t,10);break;case 3:To(t,6);break;default:To(t,2)}}function _o(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function To(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var r=qe(t.jb,t);n||(n=new oi("//www.google.com/images/cleardot.gif"),Re.location&&"http"==Re.location.protocol||ai(n,"https"),fi(n)),function(t,e){var n=new vr;if(Re.Image){var r=new Image;r.onload=je(Ui,n,r,"TestLoadImage: loaded",!0,e),r.onerror=je(Ui,n,r,"TestLoadImage: error",!1,e),r.onabort=je(Ui,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=je(Ui,n,r,"TestLoadImage: timeout",!1,e),Re.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Sr(2);t.G=0,t.j&&t.j.va(e),So(t),ho(t)}function So(t){t.G=0,t.I=-1,t.j&&(0==Pi(t.i).length&&0==t.l.length||(t.i.i.length=0,Qe(t.l),t.l.length=0),t.j.ua())}function Ao(t,e,n){var r=function(t){return t instanceof oi?si(t):new oi(t,void 0)}(n);if(""!=r.i)e&&ui(r,e+"."+r.i),ci(r,r.m);else{var i=Re.location;r=function(t,e,n,r){var i=new oi(null,void 0);return t&&ai(i,t),e&&ui(i,e),n&&ci(i,n),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&nn(t.aa,(function(t,e){li(r,e,t)})),e=t.D,n=t.sa,e&&n&&li(r,e,n),li(r,"VER",t.ma),yo(t,r),r}function Do(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new Hi(new qi({ib:!0})):new Hi(t.qa)).L=t.H,e}function No(){}function Co(){if(ln&&!(10<=Number(Tn)))throw Error("Environmental error: no available transport.")}function ko(t,e){Qn.call(this),this.g=new ao(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!We(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!We(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new Oo(this)}function xo(t){Pr.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Ro(){Mr.call(this),this.status=1}function Oo(t){this.g=t}(Ce=Hi.prototype).ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Or.g(),this.C=this.u?xr(this.u):xr(Or),this.g.onreadystatechange=qe(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void Ji(this,t)}t=n||"";var i=new ei(this.headers);r&&ti(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=Xi,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.T()),n=Re.FormData&&t instanceof Re.FormData,!(0<=ze(Yi,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{no(this),0<this.B&&((this.K=function(t){return ln&&In()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=qe(this.pa,this)):this.A=hr(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Ji(this,t)}},Ce.pa=function(){void 0!==xe&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Wn(this,"timeout"),this.abort(8))},Ce.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Wn(this,"complete"),Wn(this,"abort"),eo(this))},Ce.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),eo(this,!0)),Hi.Z.M.call(this)},Ce.Fa=function(){this.s||(this.F||this.v||this.l?to(this):this.cb())},Ce.cb=function(){to(this)},Ce.ba=function(){try{return 2<ro(this)?this.g.status:-1}catch(t){return-1}},Ce.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},Ce.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Gi(e)}},Ce.Da=function(){return this.m},Ce.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(Ce=ao.prototype).ma=8,Ce.G=1,Ce.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(t){}},Ce.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new Vr(this,this.h,t,void 0),n=this.s;if(this.P&&(n?sn(n=rn(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var o=this.l[i];if(void 0===(o="__data__"in o.g&&"string"==typeof(o=o.g.__data__)?o.length:void 0))break;if(4096<(r+=o)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=go(this,e,r),li(i=si(this.F),"RID",t),li(i,"CVER",22),this.D&&li(i,"X-HTTP-Session-Id",this.D),yo(this,i),this.o&&n&&oo(i,this.o,n),Oi(this.i,e),this.Ra&&li(i,"TYPE","init"),this.ja?(li(i,"$req",r),li(i,"SID","null"),e.$=!0,$r(e,i,null)):$r(e,i,r),this.G=2}}else 3==this.G&&(t?po(this,t):0==this.l.length||ki(this.i)||po(this))},Ce.Ga=function(){if(this.u=null,wo(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Dr(qe(this.bb,this),t)}},Ce.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Sr(10),co(this),wo(this))},Ce.ab=function(){null!=this.v&&(this.v=null,co(this),mo(this),Sr(19))},Ce.jb=function(t){t?(this.h.info("Successfully pinged google.com"),Sr(2)):(this.h.info("Failed to ping google.com"),Sr(1))},(Ce=No.prototype).xa=function(){},Ce.wa=function(){},Ce.va=function(){},Ce.ua=function(){},Ce.Oa=function(){},Co.prototype.g=function(t,e){return new ko(t,e)},Be(ko,Qn),ko.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),ir(qe(t.hb,t,e))),Sr(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=Ao(t,null,t.W),fo(t)},ko.prototype.close=function(){uo(this.g)},ko.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,lo(this.g,e)}else this.v?((e={}).__data__=Xn(t),lo(this.g,e)):lo(this.g,t)},ko.prototype.M=function(){this.g.j=null,delete this.j,uo(this.g),delete this.g,ko.Z.M.call(this)},Be(xo,Pr),Be(Ro,Mr),Be(Oo,No),Oo.prototype.xa=function(){Wn(this.g,"a")},Oo.prototype.wa=function(t){Wn(this.g,new xo(t))},Oo.prototype.va=function(t){Wn(this.g,new Ro(t))},Oo.prototype.ua=function(){Wn(this.g,"b")},Co.prototype.createWebChannel=Co.prototype.g,ko.prototype.send=ko.prototype.u,ko.prototype.open=ko.prototype.m,ko.prototype.close=ko.prototype.close,Nr.NO_ERROR=0,Nr.TIMEOUT=8,Nr.HTTP_ERROR=6,Cr.COMPLETE="complete",Rr.EventType=Lr,Lr.OPEN="a",Lr.CLOSE="b",Lr.ERROR="c",Lr.MESSAGE="d",Qn.prototype.listen=Qn.prototype.N,Hi.prototype.listenOnce=Hi.prototype.O,Hi.prototype.getLastError=Hi.prototype.La,Hi.prototype.getLastErrorCode=Hi.prototype.Da,Hi.prototype.getStatus=Hi.prototype.ba,Hi.prototype.getResponseJson=Hi.prototype.Qa,Hi.prototype.getResponseText=Hi.prototype.ga,Hi.prototype.send=Hi.prototype.ea;var Lo=Nr,Po=Cr,Mo=br,Fo=10,Vo=11,Uo=qi,qo=Rr,jo=Hi,Bo=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();Bo.o=-1;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var $o={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ko=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return kt(e,t),e}(Error),zo=new he("@firebase/firestore");function Go(){return zo.logLevel}function Ho(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(zo.logLevel<=re.DEBUG){var r=e.map(Yo);zo.debug.apply(zo,Mt(["Firestore (8.7.0): "+t],r))}}function Qo(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(zo.logLevel<=re.ERROR){var r=e.map(Yo);zo.error.apply(zo,Mt(["Firestore (8.7.0): "+t],r))}}function Wo(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(zo.logLevel<=re.WARN){var r=e.map(Yo);zo.warn.apply(zo,Mt(["Firestore (8.7.0): "+t],r))}}function Yo(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Xo(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.7.0) INTERNAL ASSERTION FAILED: "+t;throw Qo(e),new Error(e)}function Jo(t,e){t||Xo()}function Zo(t,e){return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ts(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var es=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=ts(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function ns(t,e){return t<e?-1:t>e?1:0}function rs(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function is(t){return t+"\0"}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var os=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Ko($o.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Ko($o.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ko($o.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ko($o.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?ns(this.nanoseconds,t.nanoseconds):ns(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),ss=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new os(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function as(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function us(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function cs(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var hs=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Xo(),void 0===n?n=t.length-e:n>t.length-e&&Xo(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),ls=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return kt(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Ko($o.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.emptyPath=function(){return new e([])},e}(hs),fs=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ps=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return kt(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return fs.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Ko($o.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new Ko($o.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ko($o.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new Ko($o.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(hs),ds=function(){function t(t){this.fields=t,t.sort(ps.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return rs(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),ys=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return ns(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();ys.EMPTY_BYTE_STRING=new ys("");var gs=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vs(t){if(Jo(!!t),"string"==typeof t){var e=0,n=gs.exec(t);if(Jo(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ms(t.seconds),nanos:ms(t.nanos)}}function ms(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function bs(t){return"string"==typeof t?ys.fromBase64String(t):ys.fromUint8Array(t)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ws(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Es(t){var e=t.mapValue.fields.__previous_value__;return ws(e)?Es(e):e}function Is(t){var e=vs(t.mapValue.fields.__local_write_time__.timestampValue);return new os(e.seconds,e.nanos)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function _s(t){return null==t}function Ts(t){return 0===t&&1/t==-1/0}function Ss(t){return"number"==typeof t&&Number.isInteger(t)&&!Ts(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var As=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(ls.fromString(e))},t.fromName=function(e){return new t(ls.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===ls.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return ls.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new ls(e.slice()))},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ds(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ws(t)?4:10:Xo()}function Ns(t,e){var n=Ds(t);if(n!==Ds(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Is(t).isEqual(Is(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=vs(t.timestampValue),r=vs(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return bs(t.bytesValue).isEqual(bs(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return ms(t.geoPointValue.latitude)===ms(e.geoPointValue.latitude)&&ms(t.geoPointValue.longitude)===ms(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return ms(t.integerValue)===ms(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=ms(t.doubleValue),r=ms(e.doubleValue);return n===r?Ts(n)===Ts(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return rs(t.arrayValue.values||[],e.arrayValue.values||[],Ns);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(as(n)!==as(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Ns(n[i],r[i])))return!1;return!0}(t,e);default:return Xo()}}function Cs(t,e){return void 0!==(t.values||[]).find((function(t){return Ns(t,e)}))}function ks(t,e){var n=Ds(t),r=Ds(e);if(n!==r)return ns(n,r);switch(n){case 0:return 0;case 1:return ns(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=ms(t.integerValue||t.doubleValue),r=ms(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return xs(t.timestampValue,e.timestampValue);case 4:return xs(Is(t),Is(e));case 5:return ns(t.stringValue,e.stringValue);case 6:return function(t,e){var n=bs(t),r=bs(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=ns(n[i],r[i]);if(0!==o)return o}return ns(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=ns(ms(t.latitude),ms(e.latitude));return 0!==n?n:ns(ms(t.longitude),ms(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=ks(n[i],r[i]);if(o)return o}return ns(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=ns(r[s],o[s]);if(0!==a)return a;var u=ks(n[r[s]],i[o[s]]);if(0!==u)return u}return ns(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Xo()}}function xs(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ns(t,e);var n=vs(t),r=vs(e),i=ns(n.seconds,r.seconds);return 0!==i?i:ns(n.nanos,r.nanos)}function Rs(t){return Os(t)}function Os(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=vs(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?bs(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,As.fromName(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Os(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Os(t.fields[o])}return e+"}"}(t.mapValue):Xo();var e,n}function Ls(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function Ps(t){return!!t&&"integerValue"in t}function Ms(t){return!!t&&"arrayValue"in t}function Fs(t){return!!t&&"nullValue"in t}function Vs(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Us(t){return!!t&&"mapValue"in t}function qs(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue)return{timestampValue:Object.assign({},vs(t.timestampValue))};if(t.mapValue){var e={mapValue:{fields:{}}};return us(t.mapValue.fields,(function(t,n){return e.mapValue.fields[t]=qs(n)})),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=qs(t.arrayValue.values[r]);return n}return Object.assign({},t)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var js=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!Us(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=qs(e)},t.prototype.setAll=function(t){var e=this,n=ps.emptyPath(),r={},i=[];t.forEach((function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=qs(t):i.push(o.lastSegment())}));var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());Us(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return Ns(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];Us(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){us(e,(function(e,n){return t[e]=n}));for(var r=0,i=n;r<i.length;r++){var o=i[r];delete t[o]}},t.prototype.clone=function(){return new t(qs(this.value))},t}();function Bs(t){var e=[];return us(t.fields,(function(t,n){var r=new ps([t]);if(Us(n)){var i=Bs(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var a=s[o];e.push(r.child(a))}}else e.push(r)})),new ds(e)
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var $s=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,ss.min(),js.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,js.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,js.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=js.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=js.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),Ks=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function zs(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Ks(t,e,n,r,i,o,s)}function Gs(t){var e=Zo(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+Rs(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),_s(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=oa(e.startAt)),e.endAt&&(n+="|ub:",n+=oa(e.endAt)),e.h=n}return e.h}function Hs(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!aa(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!Ns(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ca(t.startAt,e.startAt)&&ca(t.endAt,e.endAt)}function Qs(t){return As.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ws=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return kt(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new Ys(t,n,r):"array-contains"===n?new ta(t,r):"in"===n?new ea(t,r):"not-in"===n?new na(t,r):"array-contains-any"===n?new ra(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new Xs(t,n):new Js(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(ks(e,this.value)):null!==e&&Ds(this.value)===Ds(e)&&this.m(ks(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Xo()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),Ys=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=As.fromName(r.referenceValue),i}return kt(e,t),e.prototype.matches=function(t){var e=As.comparator(t.key,this.key);return this.m(e)},e}(Ws),Xs=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Zs("in",n),r}return kt(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Ws),Js=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Zs("not-in",n),r}return kt(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Ws);function Zs(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return As.fromName(t.referenceValue)}))}var ta=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return kt(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return Ms(e)&&Cs(e.arrayValue,this.value)},e}(Ws),ea=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return kt(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&Cs(this.value.arrayValue,e)},e}(Ws),na=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return kt(e,t),e.prototype.matches=function(t){if(Cs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!Cs(this.value.arrayValue,e)},e}(Ws),ra=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return kt(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!Ms(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return Cs(e.value.arrayValue,t)}))},e}(Ws),ia=function(t,e){this.position=t,this.before=e};function oa(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return Rs(t)})).join(",")}var sa=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function aa(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function ua(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?As.comparator(As.fromName(s.referenceValue),n.key):ks(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ca(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Ns(t.position[n],e.position[n]))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ha=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt};function la(t,e,n,r,i,o,s,a){return new ha(t,e,n,r,i,o,s,a)}function fa(t){return new ha(t)}function pa(t){return!_s(t.limit)&&"F"===t.limitType}function da(t){return!_s(t.limit)&&"L"===t.limitType}function ya(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function ga(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function va(t){return null!==t.collectionGroup}function ma(t){var e=Zo(t);if(null===e.p){e.p=[];var n=ga(e),r=ya(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new sa(n)),e.p.push(new sa(ps.keyField(),"asc"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var a=s[o];e.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new sa(ps.keyField(),u))}}}return e.p}function ba(t){var e=Zo(t);if(!e.T)if("F"===e.limitType)e.T=zs(e.path,e.collectionGroup,ma(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=ma(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new sa(o.field,s))}var a=e.endAt?new ia(e.endAt.position,!e.endAt.before):null,u=e.startAt?new ia(e.startAt.position,!e.startAt.before):null;e.T=zs(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.T}function wa(t,e,n){return new ha(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ea(t,e){return Hs(ba(t),ba(e))&&t.limitType===e.limitType}function Ia(t){return Gs(ba(t))+"|lt:"+t.limitType}function _a(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+Rs(e.value);var e})).join(", ")+"]"),_s(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+oa(t.startAt)),t.endAt&&(e+=", endAt: "+oa(t.endAt)),"Target("+e+")"}(ba(t))+"; limitType="+t.limitType+")"}function Ta(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):As.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!ua(t.startAt,ma(t),e)||t.endAt&&ua(t.endAt,ma(t),e))}(t,e)}function Sa(t){return function(e,n){for(var r=!1,i=0,o=ma(t);i<o.length;i++){var s=o[i],a=Aa(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function Aa(t,e,n){var r=t.field.isKeyField()?As.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?ks(r,i):Xo()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Xo()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Da(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ts(e)?"-0":e}}function Na(t){return{integerValue:""+t}}function Ca(t,e){return Ss(e)?Na(e):Da(t,e)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ka=function(){this._=void 0};function xa(t,e,n){return t instanceof La?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Pa?Ma(t,e):t instanceof Fa?Va(t,e):function(t,e){var n=Oa(t,e),r=qa(n)+qa(t.A);return Ps(n)&&Ps(t.A)?Na(r):Da(t.R,r)}(t,e)}function Ra(t,e,n){return t instanceof Pa?Ma(t,e):t instanceof Fa?Va(t,e):n}function Oa(t,e){return t instanceof Ua?Ps(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var La=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return kt(e,t),e}(ka),Pa=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return kt(e,t),e}(ka);function Ma(t,e){for(var n=ja(e),r=function(t){n.some((function(e){return Ns(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Fa=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return kt(e,t),e}(ka);function Va(t,e){for(var n=ja(e),r=function(t){n=n.filter((function(e){return!Ns(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Ua=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return kt(e,t),e}(ka);function qa(t){return ms(t.integerValue||t.doubleValue)}function ja(t){return Ms(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ba=function(t,e){this.field=t,this.transform=e},$a=function(t,e){this.version=t,this.transformResults=e},Ka=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function za(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var Ga=function(){};function Ha(t,e,n){t instanceof Ja?function(t,e,n){var r=t.value.clone(),i=eu(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof Za?function(t,e,n){if(za(t.precondition,e)){var r=eu(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(tu(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Qa(t,e,n){t instanceof Ja?function(t,e,n){if(za(t.precondition,e)){var r=t.value.clone(),i=nu(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(Xa(e),r).setHasLocalMutations()}}(t,e,n):t instanceof Za?function(t,e,n){if(za(t.precondition,e)){var r=nu(t.fieldTransforms,n,e),i=e.data;i.setAll(tu(t)),i.setAll(r),e.convertToFoundDocument(Xa(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){za(t.precondition,e)&&e.convertToNoDocument(ss.min())}(t,e)}function Wa(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=Oa(o.transform,s||null);null!=a&&(null==n&&(n=js.empty()),n.set(o.field,a))}return n||null}function Ya(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&rs(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Pa&&e instanceof Pa||t instanceof Fa&&e instanceof Fa?rs(t.elements,e.elements,Ns):t instanceof Ua&&e instanceof Ua?Ns(t.A,e.A):t instanceof La&&e instanceof La}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Xa(t){return t.isFoundDocument()?t.version:ss.min()}var Ja=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return kt(e,t),e}(Ga),Za=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return kt(e,t),e}(Ga);function tu(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function eu(t,e,n){var r=new Map;Jo(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,Ra(s,a,n[i]))}return r}function nu(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=n.data.field(s.field);r.set(s.field,xa(a,u,e))}return r}var ru,iu,ou=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return kt(e,t),e}(Ga),su=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return kt(e,t),e}(Ga),au=function(t){this.count=t};function uu(t){switch(t){case $o.OK:return Xo();case $o.CANCELLED:case $o.UNKNOWN:case $o.DEADLINE_EXCEEDED:case $o.RESOURCE_EXHAUSTED:case $o.INTERNAL:case $o.UNAVAILABLE:case $o.UNAUTHENTICATED:return!1;case $o.INVALID_ARGUMENT:case $o.NOT_FOUND:case $o.ALREADY_EXISTS:case $o.PERMISSION_DENIED:case $o.FAILED_PRECONDITION:case $o.ABORTED:case $o.OUT_OF_RANGE:case $o.UNIMPLEMENTED:case $o.DATA_LOSS:return!0;default:return Xo()}}function cu(t){if(void 0===t)return Qo("GRPC error has no .code"),$o.UNKNOWN;switch(t){case ru.OK:return $o.OK;case ru.CANCELLED:return $o.CANCELLED;case ru.UNKNOWN:return $o.UNKNOWN;case ru.DEADLINE_EXCEEDED:return $o.DEADLINE_EXCEEDED;case ru.RESOURCE_EXHAUSTED:return $o.RESOURCE_EXHAUSTED;case ru.INTERNAL:return $o.INTERNAL;case ru.UNAVAILABLE:return $o.UNAVAILABLE;case ru.UNAUTHENTICATED:return $o.UNAUTHENTICATED;case ru.INVALID_ARGUMENT:return $o.INVALID_ARGUMENT;case ru.NOT_FOUND:return $o.NOT_FOUND;case ru.ALREADY_EXISTS:return $o.ALREADY_EXISTS;case ru.PERMISSION_DENIED:return $o.PERMISSION_DENIED;case ru.FAILED_PRECONDITION:return $o.FAILED_PRECONDITION;case ru.ABORTED:return $o.ABORTED;case ru.OUT_OF_RANGE:return $o.OUT_OF_RANGE;case ru.UNIMPLEMENTED:return $o.UNIMPLEMENTED;case ru.DATA_LOSS:return $o.DATA_LOSS;default:return Xo()}}(iu=ru||(ru={}))[iu.OK=0]="OK",iu[iu.CANCELLED=1]="CANCELLED",iu[iu.UNKNOWN=2]="UNKNOWN",iu[iu.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",iu[iu.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",iu[iu.NOT_FOUND=5]="NOT_FOUND",iu[iu.ALREADY_EXISTS=6]="ALREADY_EXISTS",iu[iu.PERMISSION_DENIED=7]="PERMISSION_DENIED",iu[iu.UNAUTHENTICATED=16]="UNAUTHENTICATED",iu[iu.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",iu[iu.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",iu[iu.ABORTED=10]="ABORTED",iu[iu.OUT_OF_RANGE=11]="OUT_OF_RANGE",iu[iu.UNIMPLEMENTED=12]="UNIMPLEMENTED",iu[iu.INTERNAL=13]="INTERNAL",iu[iu.UNAVAILABLE=14]="UNAVAILABLE",iu[iu.DATA_LOSS=15]="DATA_LOSS";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var hu=function(){function t(t,e){this.comparator=t,this.root=e||fu.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,fu.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,fu.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new lu(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new lu(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new lu(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new lu(this.root,t,this.comparator,!0)},t}(),lu=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),fu=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Xo();if(this.right.isRed())throw Xo();var t=this.left.check();if(t!==this.right.check())throw Xo();return t+(this.isRed()?0:1)},t}();fu.EMPTY=null,fu.RED=!0,fu.BLACK=!1,fu.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Xo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Xo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Xo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Xo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Xo()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new fu(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var pu=function(){function t(t){this.comparator=t,this.data=new hu(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new du(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new du(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),du=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),yu=new hu(As.comparator);function gu(){return yu}var vu=new hu(As.comparator);function mu(){return vu}var bu=new hu(As.comparator);var wu=new pu(As.comparator);function Eu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=wu,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Iu=new pu(ns);function _u(){return Iu}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Tu=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,Su.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(ss.min(),r,_u(),gu(),Eu())},t}(),Su=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(ys.EMPTY_BYTE_STRING,n,Eu(),Eu(),Eu())},t}(),Au=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},Du=function(t,e){this.targetId=t,this.V=e},Nu=function(t,e,n,r){void 0===n&&(n=ys.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Cu=function(){function t(){this.S=0,this.D=Ru(),this.C=ys.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=Eu(),e=Eu(),n=Eu();return this.D.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Xo()}})),new Su(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=Ru()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),ku=function(){function t(t){this.W=t,this.G=new Map,this.H=gu(),this.J=xu(),this.Y=new pu(ns)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:Xo()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach((function(t,r){n.st(r)&&e(r)}))},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(Qs(i))if(0===n){var o=new As(i.path);this.tt(e,o,$s.newNoDocument(o,ss.min()))}else Jo(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach((function(r,i){var o=e.ot(i);if(o){if(r.current&&Qs(o.target)){var s=new As(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,$s.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}}));var r=Eu();this.J.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Tu(t,n,this.Y,this.H,r);return this.H=gu(),this.J=xu(),this.Y=new pu(ns),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new Cu,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new pu(ns),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||Ho("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new Cu),this.W.getRemoteKeysForTarget(t).forEach((function(n){e.tt(t,n,null)}))},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function xu(){return new hu(As.comparator)}function Ru(){return new hu(As.comparator)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ou={asc:"ASCENDING",desc:"DESCENDING"},Lu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Pu=function(t,e){this.databaseId=t,this.I=e};function Mu(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Fu(t,e){return t.I?e.toBase64():e.toUint8Array()}function Vu(t,e){return Mu(t,e.toTimestamp())}function Uu(t){return Jo(!!t),ss.fromTimestamp(function(t){var e=vs(t);return new os(e.seconds,e.nanos)}(t))}function qu(t,e){return function(t){return new ls(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function ju(t){var e=ls.fromString(t);return Jo(hc(e)),e}function Bu(t,e){return qu(t.databaseId,e.path)}function $u(t,e){var n=ju(e);if(n.get(1)!==t.databaseId.projectId)throw new Ko($o.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Ko($o.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new As(Hu(n))}function Ku(t,e){return qu(t.databaseId,e)}function zu(t){var e=ju(t);return 4===e.length?ls.emptyPath():Hu(e)}function Gu(t){return new ls(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Hu(t){return Jo(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Qu(t,e,n){return{name:Bu(t,e),fields:n.value.mapValue.fields}}function Wu(t,e){var n;if(e instanceof Ja)n={update:Qu(t,e.key,e.value)};else if(e instanceof ou)n={delete:Bu(t,e.key)};else if(e instanceof Za)n={update:Qu(t,e.key,e.data),updateMask:cc(e.fieldMask)};else{if(!(e instanceof su))return Xo();n={verify:Bu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof La)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Pa)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Fa)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Ua)return{fieldPath:e.field.canonicalString(),increment:n.A};throw Xo()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Vu(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Xo()}(t,e.precondition)),n}function Yu(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Ka.updateTime(Uu(t.updateTime)):void 0!==t.exists?Ka.exists(t.exists):Ka.none()}(e.currentDocument):Ka.none(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)Jo("REQUEST_TIME"===e.setToServerValue),n=new La;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new Pa(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new Fa(i)}else"increment"in e?n=new Ua(t,e.increment):Xo();var o=ps.fromServerFormat(e.fieldPath);return new Ba(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=$u(t,e.update.name),o=new js({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){var e=t.fieldPaths||[];return new ds(e.map((function(t){return ps.fromServerFormat(t)})))}(e.updateMask);return new Za(i,o,s,n,r)}return new Ja(i,o,n,r)}if(e.delete){var a=$u(t,e.delete);return new ou(a,n)}if(e.verify){var u=$u(t,e.verify);return new su(u,n)}return Xo()}function Xu(t,e){return{documents:[Ku(t,e.path)]}}function Ju(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Ku(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ku(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(Vs(t.value))return{unaryFilter:{field:oc(t.field),op:"IS_NAN"}};if(Fs(t.value))return{unaryFilter:{field:oc(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Vs(t.value))return{unaryFilter:{field:oc(t.field),op:"IS_NOT_NAN"}};if(Fs(t.value))return{unaryFilter:{field:oc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:oc(t.field),op:ic(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:oc(t.field),direction:rc(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.I||_s(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=ec(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ec(e.endAt)),n}function Zu(t){var e=zu(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Jo(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=tc(n.where));var a=[];n.orderBy&&(a=n.orderBy.map((function(t){return function(t){return new sa(sc(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return _s(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=nc(n.startAt));var h=null;return n.endAt&&(h=nc(n.endAt)),la(e,i,a,s,u,"F",c,h)}function tc(t){return t?void 0!==t.unaryFilter?[uc(t)]:void 0!==t.fieldFilter?[ac(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return tc(t)})).reduce((function(t,e){return t.concat(e)})):Xo():[]}function ec(t){return{before:t.before,values:t.position}}function nc(t){var e=!!t.before,n=t.values||[];return new ia(n,e)}function rc(t){return Ou[t]}function ic(t){return Lu[t]}function oc(t){return{fieldPath:t.canonicalString()}}function sc(t){return ps.fromServerFormat(t.fieldPath)}function ac(t){return Ws.create(sc(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Xo()}}(t.fieldFilter.op),t.fieldFilter.value)}function uc(t){switch(t.unaryFilter.op){case"IS_NAN":var e=sc(t.unaryFilter.field);return Ws.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=sc(t.unaryFilter.field);return Ws.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=sc(t.unaryFilter.field);return Ws.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=sc(t.unaryFilter.field);return Ws.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Xo()}}function cc(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function hc(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function lc(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=pc(e)),e=fc(t.get(n),e);return pc(e)}function fc(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function pc(t){return t+""}function dc(t){var e=t.length;if(Jo(e>=2),2===e)return Jo(""===t.charAt(0)&&""===t.charAt(1)),ls.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&Xo(),t.charAt(s+1)){case"":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Xo()}o=s+2}return new ls(r)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var yc=function(t,e){this.seconds=t,this.nanoseconds=e},gc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};gc.store="owner",gc.key="owner";var vc=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};vc.store="mutationQueues",vc.keyPath="userId";var mc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};mc.store="mutations",mc.keyPath="batchId",mc.userMutationsIndex="userMutationsIndex",mc.userMutationsKeyPath=["userId","batchId"];var bc=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,lc(e)]},t.key=function(t,e,n){return[t,lc(e),n]},t}();bc.store="documentMutations",bc.PLACEHOLDER=new bc;var wc=function(t,e){this.path=t,this.readTime=e},Ec=function(t,e){this.path=t,this.version=e},Ic=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Ic.store="remoteDocuments",Ic.readTimeIndex="readTimeIndex",Ic.readTimeIndexPath="readTime",Ic.collectionReadTimeIndex="collectionReadTimeIndex",Ic.collectionReadTimeIndexPath=["parentPath","readTime"];var _c=function(t){this.byteSize=t};_c.store="remoteDocumentGlobal",_c.key="remoteDocumentGlobalKey";var Tc=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Tc.store="targets",Tc.keyPath="targetId",Tc.queryTargetsIndexName="queryTargetsIndex",Tc.queryTargetsKeyPath=["canonicalId","targetId"];var Sc=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Sc.store="targetDocuments",Sc.keyPath=["targetId","path"],Sc.documentTargetsIndex="documentTargetsIndex",Sc.documentTargetsKeyPath=["path","targetId"];var Ac=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Ac.key="targetGlobalKey",Ac.store="targetGlobal";var Dc=function(t,e){this.collectionId=t,this.parent=e};Dc.store="collectionParents",Dc.keyPath=["collectionId","parent"];var Nc=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Nc.store="clientMetadata",Nc.keyPath="clientId";var Cc=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Cc.store="bundles",Cc.keyPath="bundleId";var kc=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};kc.store="namedQueries",kc.keyPath="name";var xc=Mt(Mt([],Mt(Mt([],Mt(Mt([],Mt(Mt([],[vc.store,mc.store,bc.store,Ic.store,Tc.store,gc.store,Ac.store,Sc.store]),[Nc.store])),[_c.store])),[Dc.store])),[Cc.store,kc.store]),Rc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Oc=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),Lc=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},Pc=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&Xo(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),Mc=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new Lc,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new Uc(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=Kc(e.target.error);n.ft.reject(new Uc(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Uc(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(Ho("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new jc(e)},t}(),Fc=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(qt())&&Qo("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Ho("SimpleDb","Removing database:",t),Bc(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=qt(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return Rt(this,void 0,void 0,(function(){var e,n=this;return Ot(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(Ho("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new Uc(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new Ko($o.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new Uc(t,n))},i.onupgradeneeded=function(t){Ho("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.wt.Rt(e,i.transaction,t.oldVersion,n.version).next((function(){Ho("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}}))}))},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Rt(this,void 0,void 0,(function(){var i,o,s,a,u;return Ot(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,h;return Ot(this,(function(l){switch(l.label){case 0:++o,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,a.At(t)];case 2:return a.db=l.sent(),e=Mc.open(a.db,t,i?"readonly":"readwrite",n),s=r(e).catch((function(t){return e.abort(t),Pc.reject(t)})).toPromise(),u={},s.catch((function(){})),[4,e.dt];case 3:return[2,(u.value=(l.sent(),s),u)];case 4:return c=l.sent(),h="FirebaseError"!==c.name&&o<3,Ho("SimpleDb","Transaction failed with error:",c.message,"Retrying:",h),a.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Vc=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return Bc(this.Pt.delete())},t}(),Uc=function(t){function e(e,n){var r=this;return(r=t.call(this,$o.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return kt(e,t),e}(Ko);function qc(t){return"IndexedDbTransactionError"===t.name}var jc=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Ho("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Ho("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Bc(n)},t.prototype.add=function(t){return Ho("SimpleDb","ADD",this.store.name,t,t),Bc(this.store.add(t))},t.prototype.get=function(t){var e=this;return Bc(this.store.get(t)).next((function(n){return void 0===n&&(n=null),Ho("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return Ho("SimpleDb","DELETE",this.store.name,t),Bc(this.store.delete(t))},t.prototype.count=function(){return Ho("SimpleDb","COUNT",this.store.name),Bc(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.Ft=function(t,e){Ho("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,(function(t,e,n){return n.delete()}))},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new Pc((function(n,r){e.onerror=function(t){var e=Kc(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.xt=function(t,e){var n=[];return new Pc((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Vc(i),s=e(i.primaryKey,i.value,o);if(s instanceof Pc){var a=s.catch((function(t){return o.done(),Pc.reject(t)}));n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return Pc.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Bc(t){return new Pc((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=Kc(t.target.error);n(e)}}))}var $c=!1;function Kc(t){var e=Fc._t(qt());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Ko("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return $c||($c=!0,setTimeout((function(){throw r}),0)),r}}return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var zc=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return kt(e,t),e}(Oc);function Gc(t,e){var n=Zo(t);return Fc.It(n.Mt,e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Hc=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&Ha(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&Qa(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&Qa(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(ss.min())}))},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Eu())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&rs(this.mutations,t.mutations,(function(t,e){return Ya(t,e)}))&&rs(this.baseMutations,t.baseMutations,(function(t,e){return Ya(t,e)}))},t}(),Qc=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){Jo(e.mutations.length===r.length);for(var i=bu,o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Wc=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=ss.min()),void 0===o&&(o=ss.min()),void 0===s&&(s=ys.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),Yc=function(t){this.Lt=t};function Xc(t,e){if(e.document)return function(t,e,n){var r=$u(t,e.name),i=Uu(e.updateTime),o=new js({mapValue:{fields:e.fields}}),s=$s.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=As.fromSegments(e.noDocument.path),r=nh(e.noDocument.readTime),i=$s.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=As.fromSegments(e.unknownDocument.path);return r=nh(e.unknownDocument.version),$s.newUnknownDocument(o,r)}return Xo()}function Jc(t,e,n){var r=Zc(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:Bu(t,e.key),fields:e.data.value.mapValue.fields,updateTime:Mu(t,e.version.toTimestamp())}}(t.Lt,e),s=e.hasCommittedMutations;return new Ic(null,null,o,s,r,i)}if(e.isNoDocument()){var a=e.key.path.toArray(),u=eh(e.version);return s=e.hasCommittedMutations,new Ic(null,new wc(a,u),null,s,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),h=eh(e.version);return new Ic(new Ec(c,h),null,null,!0,r,i)}return Xo()}function Zc(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function th(t){var e=new os(t[0],t[1]);return ss.fromTimestamp(e)}function eh(t){var e=t.toTimestamp();return new yc(e.seconds,e.nanoseconds)}function nh(t){var e=new os(t.seconds,t.nanoseconds);return ss.fromTimestamp(e)}function rh(t,e){for(var n=(e.baseMutations||[]).map((function(e){return Yu(t.Lt,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var s=e.mutations.map((function(e){return Yu(t.Lt,e)})),a=os.fromMillis(e.localWriteTimeMs);return new Hc(e.batchId,a,n,s)}function ih(t){var e,n,r=nh(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?nh(t.lastLimboFreeSnapshotVersion):ss.min();return void 0!==t.query.documents?(Jo(1===(n=t.query).documents.length),e=ba(fa(zu(n.documents[0])))):e=function(t){return ba(Zu(t))}(t.query),new Wc(e,t.targetId,0,t.lastListenSequenceNumber,r,i,ys.fromBase64String(t.resumeToken))}function oh(t,e){var n,r=eh(e.snapshotVersion),i=eh(e.lastLimboFreeSnapshotVersion);n=Qs(e.target)?Xu(t.Lt,e.target):Ju(t.Lt,e.target);var o=e.resumeToken.toBase64();return new Tc(e.targetId,Gs(e.target),r,o,e.sequenceNumber,i,n)}function sh(t){var e=Zu({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?wa(e,e.limit,"L"):e}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ah=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return uh(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:nh(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return uh(t).put({bundleId:(n=e).id,createTime:eh(Uu(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return ch(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:sh(e.bundledQuery),readTime:nh(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return ch(t).put(function(t){return{name:t.name,readTime:eh(Uu(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function uh(t){return Gc(t,Cc.store)}function ch(t){return Gc(t,kc.store)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var hh=function(){function t(){this.Bt=new lh}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),Pc.resolve()},t.prototype.getCollectionParents=function(t,e){return Pc.resolve(this.Bt.getEntries(e))},t}(),lh=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new pu(ls.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new pu(ls.comparator)).toArray()},t}(),fh=function(){function t(){this.qt=new lh}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.qt.add(e)}));var o={collectionId:r,parent:lc(i)};return ph(t).put(o)}return Pc.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[is(e),""],!1,!0);return ph(t).Nt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(dc(o.parent))}return n}))},t}();function ph(t){return Gc(t,Dc.store)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var dh={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},yh=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function gh(t,e,n){var r=t.store(mc.store),i=t.store(bc.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},(function(t,e,n){return a++,n.delete()}));o.push(u.next((function(){Jo(1===a)})));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],p=bc.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return Pc.waitFor(o).next((function(){return c}))}function vh(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Xo();e=t.noDocument}return JSON.stringify(e).length}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */yh.DEFAULT_COLLECTION_PERCENTILE=10,yh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,yh.DEFAULT=new yh(41943040,yh.DEFAULT_COLLECTION_PERCENTILE,yh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),yh.DISABLED=new yh(-1,0,0);var mh=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Kt={}}return t.Qt=function(e,n,r,i){return Jo(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return wh(t).$t({index:mc.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=Eh(t),s=wh(t);return s.add({}).next((function(a){Jo("number"==typeof a);for(var u=new Hc(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return Wu(t.Lt,e)})),i=n.mutations.map((function(e){return Wu(t.Lt,e)}));return new mc(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),h=[],l=new pu((function(t,e){return ns(t.canonicalString(),e.canonicalString())})),f=0,p=r;f<p.length;f++){var d=p[f],y=bc.key(i.userId,d.key.path,a);l=l.add(d.key.path.popLast()),h.push(s.put(c)),h.push(o.put(y,bc.PLACEHOLDER))}return l.forEach((function(e){h.push(i.Ut.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.Kt[a]=u.keys()})),Pc.waitFor(h).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return wh(t).get(e).next((function(t){return t?(Jo(t.userId===n.userId),rh(n.R,t)):null}))},t.prototype.jt=function(t,e){var n=this;return this.Kt[e]?Pc.resolve(this.Kt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.Kt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return wh(t).$t({index:mc.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(Jo(e.batchId>=r),o=rh(n.R,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return wh(t).$t({index:mc.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return wh(t).Nt(mc.userMutationsIndex,n).next((function(t){return t.map((function(t){return rh(e.R,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=bc.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Eh(t).$t({range:i},(function(r,i,s){var a=r[0],u=r[1],c=r[2],h=dc(u);if(a===n.userId&&e.path.isEqual(h))return wh(t).get(c).next((function(t){if(!t)throw Xo();Jo(t.userId===n.userId),o.push(rh(n.R,t))}));s.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new pu(ns),i=[];return e.forEach((function(e){var o=bc.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=Eh(t).$t({range:s},(function(t,i,o){var s=t[0],a=t[1],u=t[2],c=dc(a);s===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(a)})),Pc.waitFor(i).next((function(){return n.Wt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=bc.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new pu(ns);return Eh(t).$t({range:s},(function(t,e,o){var s=t[0],u=t[1],c=t[2],h=dc(u);s===n.userId&&r.isPrefixOf(h)?h.length===i&&(a=a.add(c)):o.done()})).next((function(){return n.Wt(t,a)}))},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(wh(t).get(e).next((function(t){if(null===t)throw Xo();Jo(t.userId===n.userId),r.push(rh(n.R,t))})))})),Pc.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return gh(t.Mt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Gt(e.batchId)})),Pc.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Gt=function(t){delete this.Kt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return Pc.resolve();var r=IDBKeyRange.lowerBound(bc.prefixForUser(e.userId)),i=[];return Eh(t).$t({range:r},(function(t,n,r){if(t[0]===e.userId){var o=dc(t[1]);i.push(o)}else r.done()})).next((function(){Jo(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return bh(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return Ih(t).get(this.userId).next((function(t){return t||new vc(e.userId,-1,"")}))},t}();function bh(t,e,n){var r=bc.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Eh(t).$t({range:o,kt:!0},(function(t,n,r){var o=t[0],a=t[1];t[2],o===e&&a===i&&(s=!0),r.done()})).next((function(){return s}))}function wh(t){return Gc(t,mc.store)}function Eh(t){return Gc(t,bc.store)}function Ih(t){return Gc(t,vc.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var _h=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),Th=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next((function(n){var r=new _h(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next((function(t){return ss.fromTimestamp(new os(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next((function(){return n.Xt(t).next((function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return Sh(t).delete(e.targetId)})).next((function(){return n.Xt(t)})).next((function(e){return Jo(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Sh(t).$t((function(s,a){var u=ih(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return Pc.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return Sh(t).$t((function(t,n){var r=ih(n);e(r)}))},t.prototype.Xt=function(t){return Ah(t).get(Ac.key).next((function(t){return Jo(null!==t),t}))},t.prototype.Zt=function(t,e){return Ah(t).put(Ac.key,e)},t.prototype.te=function(t,e){return Sh(t).put(oh(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=Gs(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Sh(t).$t({range:r,index:Tc.queryTargetsIndexName},(function(t,n,r){var o=ih(n);Hs(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Dh(t);return e.forEach((function(e){var s=lc(e.path);i.push(o.put(new Sc(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))})),Pc.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Dh(t);return Pc.forEach(e,(function(e){var o=lc(e.path);return Pc.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Dh(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Dh(t),i=Eu();return r.$t({range:n,kt:!0},(function(t,e,n){var r=dc(t[1]),o=new As(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=lc(e.path),r=IDBKeyRange.bound([n],[is(n)],!1,!0),i=0;return Dh(t).$t({index:Sc.documentTargetsIndex,kt:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.lt=function(t,e){return Sh(t).get(e).next((function(t){return t?ih(t):null}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Sh(t){return Gc(t,Tc.store)}function Ah(t){return Gc(t,Ac.store)}function Dh(t){return Gc(t,Sc.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Nh(t){return Rt(this,void 0,void 0,(function(){return Ot(this,(function(e){if(t.code!==$o.FAILED_PRECONDITION||t.message!==Rc)throw t;return Ho("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ch(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=ns(n,i);return 0===s?ns(r,o):s}var kh=function(){function t(t){this.ne=t,this.buffer=new pu(Ch),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Ch(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),xh=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;Ho("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return Rt(e,void 0,void 0,(function(){var e;return Ot(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return qc(e=n.sent())?(Ho("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Nh(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),Rh=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return Pc.resolve(Bo.o);var r=new kh(e);return this.ae.forEachTarget(t,(function(t){return r.re(t.sequenceNumber)})).next((function(){return n.ae.le(t,(function(t){return r.re(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Ho("LruGarbageCollector","Garbage collection skipped; disabled"),Pc.resolve(dh)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(Ho("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),dh):n.fe(t,e)}))},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,a,u,c=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>c.params.maximumSequenceNumbersToCollect?(Ho("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)})).next((function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)})).next((function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)})).next((function(t){return u=Date.now(),Go()<=re.DEBUG&&Ho("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-h)+"ms"),Pc.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),Oh=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new Rh(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.de=function(t){var e=0;return this.le(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return Lh(t,n)},t.prototype.removeReference=function(t,e,n){return Lh(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return Lh(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return Ih(t).Ot((function(r){return bh(t,r,e).next((function(t){return t&&(n=!0),Pc.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,(function(s,a){if(a<=e){var u=n._e(t,s).next((function(e){if(!e)return o++,r.getEntry(t,s).next((function(){return r.removeEntry(s),Dh(t).delete([0,lc(s.path)])}))}));i.push(u)}})).next((function(){return Pc.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Lh(t,e)},t.prototype.we=function(t,e){var n,r=Dh(t),i=Bo.o;return r.$t({index:Sc.documentTargetsIndex},(function(t,r){var o=t[0];t[1];var s=r.path,a=r.sequenceNumber;0===o?(i!==Bo.o&&e(new As(dc(n)),i),i=a,n=s):i=Bo.o})).next((function(){i!==Bo.o&&e(new As(dc(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function Lh(t,e){return Dh(t).put(function(t,e){return new Sc(0,lc(t.path),e)}(e,t.currentSequenceNumber))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ph=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.equalsFn(s,t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){us(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];t(s,a)}}))},t.prototype.isEmpty=function(){return cs(this.inner)},t}(),Mh=function(){function t(){this.changes=new Ph((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:ss.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:$s.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?Pc.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),Fh=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return qh(t).put(jh(e),n)},t.prototype.removeEntry=function(t,e){var n=qh(t),r=jh(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.me(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return qh(t).get(jh(e)).next((function(t){return n.ye(e,t)}))},t.prototype.ge=function(t,e){var n=this;return qh(t).get(jh(e)).next((function(t){return{document:n.ye(e,t),size:vh(t)}}))},t.prototype.getEntries=function(t,e){var n=this,r=gu();return this.pe(t,e,(function(t,e){var i=n.ye(t,e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.Ee=function(t,e){var n=this,r=gu(),i=new hu(As.comparator);return this.pe(t,e,(function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,vh(e))})).next((function(){return{documents:r,Te:i}}))},t.prototype.pe=function(t,e,n){if(e.isEmpty())return Pc.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return qh(t).$t({range:r},(function(t,e,r){for(var s=As.fromSegments(t);o&&As.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=gu(),o=e.path.length+1,s={};if(n.isEqual(ss.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=Zc(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=Ic.collectionReadTimeIndex}return qh(t).$t(s,(function(t,n,s){if(t.length===o){var a=Xc(r.R,n);e.path.isPrefixOf(a.key.path)?Ta(e,a)&&(i=i.insert(a.key,a)):s.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new Vh(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return Uh(t).get(_c.key).next((function(t){return Jo(!!t),t}))},t.prototype.me=function(t,e){return Uh(t).put(_c.key,e)},t.prototype.ye=function(t,e){if(e){var n=Xc(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(ss.min()))return n}return $s.newInvalidDocument(t)},t}(),Vh=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new Ph((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return kt(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new pu((function(t,e){return ns(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=Jc(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=vh(u);r+=c-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var h=Jc(e.Ie.R,$s.newNoDocument(o,ss.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,h))}else n.push(e.Ie.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))})),n.push(this.Ie.updateMetadata(t,r)),Pc.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next((function(t){return n.Ae.set(e,t.size),t.document}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next((function(t){var e=t.documents;return t.Te.forEach((function(t,e){n.Ae.set(t,e)})),e}))},e}(Mh);
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Uh(t){return Gc(t,_c.store)}function qh(t){return Gc(t,Ic.store)}function jh(t){return t.path.toArray()}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Bh=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;Jo(n<r&&n>=0&&r<=11);var o=new Mc("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(gc.store)}(t),function(t){t.createObjectStore(vc.store,{keyPath:vc.keyPath}),t.createObjectStore(mc.store,{keyPath:mc.keyPath,autoIncrement:!0}).createIndex(mc.userMutationsIndex,mc.userMutationsKeyPath,{unique:!0}),t.createObjectStore(bc.store)}(t),$h(t),function(t){t.createObjectStore(Ic.store)}(t));var s=Pc.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Sc.store),t.deleteObjectStore(Tc.store),t.deleteObjectStore(Ac.store)}(t),$h(t)),s=s.next((function(){return function(t){var e=t.store(Ac.store),n=new Ac(0,0,ss.min().toTimestamp(),0);return e.put(Ac.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(mc.store).Nt().next((function(n){t.deleteObjectStore(mc.store),t.createObjectStore(mc.store,{keyPath:mc.keyPath,autoIncrement:!0}).createIndex(mc.userMutationsIndex,mc.userMutationsKeyPath,{unique:!0});var r=e.store(mc.store),i=n.map((function(t){return r.put(t)}));return Pc.waitFor(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Nc.store,{keyPath:Nc.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.Re(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(_c.store)}(t),i.be(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ve(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.Pe(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Ic.store);e.createIndex(Ic.readTimeIndex,Ic.readTimeIndexPath,{unique:!1}),e.createIndex(Ic.collectionReadTimeIndex,Ic.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(Cc.store,{keyPath:Cc.keyPath})}(t),function(t){t.createObjectStore(kc.store,{keyPath:kc.keyPath})}(t)}))),s},t.prototype.be=function(t){var e=0;return t.store(Ic.store).$t((function(t,n){e+=vh(n)})).next((function(){var n=new _c(e);return t.store(_c.store).put(_c.key,n)}))},t.prototype.Re=function(t){var e=this,n=t.store(vc.store),r=t.store(mc.store);return n.Nt().next((function(n){return Pc.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(mc.userMutationsIndex,i).next((function(r){return Pc.forEach(r,(function(r){Jo(r.userId===n.userId);var i=rh(e.R,r);return gh(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ve=function(t){var e=t.store(Sc.store),n=t.store(Ic.store);return t.store(Ac.store).get(Ac.key).next((function(t){var r=[];return n.$t((function(n,i){var o=new ls(n),s=function(t){return[0,lc(t)]}(o);r.push(e.get(s).next((function(n){return n?Pc.resolve():function(n){return e.put(new Sc(0,lc(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return Pc.waitFor(r)}))}))},t.prototype.Pe=function(t,e){t.createObjectStore(Dc.store,{keyPath:Dc.keyPath});var n=e.store(Dc.store),r=new lh,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:lc(i)})}};return e.store(Ic.store).$t({kt:!0},(function(t,e){var n=new ls(t);return i(n.popLast())})).next((function(){return e.store(bc.store).$t({kt:!0},(function(t,e){t[0];var n=t[1];t[2];var r=dc(n);return i(r.popLast())}))}))},t.prototype.Ve=function(t){var e=this,n=t.store(Tc.store);return n.$t((function(t,r){var i=ih(r),o=oh(e.R,i);return n.put(o)}))},t}();function $h(t){t.createObjectStore(Sc.store,{keyPath:Sc.keyPath}).createIndex(Sc.documentTargetsIndex,Sc.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Tc.store,{keyPath:Tc.keyPath}).createIndex(Tc.queryTargetsIndexName,Tc.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Ac.store)}var Kh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",zh=function(){function t(e,n,r,i,o,s,a,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=c,this.Ce=h,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new Ko($o.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Oh(this,i),this.Le=n+"main",this.R=new Yc(u),this.Be=new Fc(this.Le,11,new Bh(this.R)),this.qe=new Th(this.referenceDelegate,this.R),this.Ut=new fh,this.Ue=function(t,e){return new Fh(t,e)}(this.R,this.Ut),this.Ke=new ah,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===h&&Qo("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Ko($o.FAILED_PRECONDITION,Kh);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.qe.getHighestSequenceNumber(e)}))})).then((function(e){t.Ne=new Bo(e,t.De)})).then((function(){t.xe=!0})).catch((function(e){return t.Be&&t.Be.close(),Promise.reject(e)}))},t.prototype.He=function(t){var e=this;return this.Me=function(n){return Rt(e,void 0,void 0,(function(){return Ot(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt((function(n){return Rt(e,void 0,void 0,(function(){return Ot(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget((function(){return Rt(e,void 0,void 0,(function(){return Ot(this,(function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return Hh(e).put(new Nc(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Je(e).next((function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable((function(){return t.Me(!1)})))}))})).next((function(){return t.Ye(e)})).next((function(n){return t.isPrimary&&!n?t.Xe(e).next((function(){return!1})):!!n&&t.Ze(e).next((function(){return!0}))}))})).catch((function(e){if(qc(e))return Ho("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Ho("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Se.enqueueRetryable((function(){return t.Me(e)})),t.isPrimary=e}))},t.prototype.Je=function(t){var e=this;return Gh(t).get(gc.key).next((function(t){return Pc.resolve(e.tn(t))}))},t.prototype.en=function(t){return Hh(t).delete(this.clientId)},t.prototype.nn=function(){return Rt(this,void 0,void 0,(function(){var t,e,n,r,i=this;return Ot(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=Gc(t,Nc.store);return e.Nt().next((function(t){var n=i.rn(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return Pc.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Qe)for(e=0,n=t;e<n.length;e++)r=n[e],this.Qe.removeItem(this.on(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.je().then((function(){return t.nn()})).then((function(){return t.ze()}))}))},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?Pc.resolve(!0):Gh(t).get(gc.key).next((function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new Ko($o.FAILED_PRECONDITION,Kh);return!1}}return!(!e.networkEnabled||!e.inForeground)||Hh(t).Nt().next((function(t){return void 0===e.rn(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&Ho("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return Rt(this,void 0,void 0,(function(){var t=this;return Ot(this,(function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[gc.store,Nc.store],(function(e){var n=new zc(e,Bo.o);return t.Xe(n).next((function(){return t.en(n)}))}))];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}}))}))},t.prototype.rn=function(t,e){var n=this;return t.filter((function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)}))},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return Hh(e).Nt().next((function(e){return t.rn(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return mh.Qt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;Ho("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Be.runTransaction(t,o,xc,(function(o){return i=new zc(o,r.Ne?r.Ne.next():Bo.o),"readwrite-primary"===e?r.Je(i).next((function(t){return!!t||r.Ye(i)})).next((function(e){if(!e)throw Qo("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new Ko($o.FAILED_PRECONDITION,Rc);return n(i)})).next((function(t){return r.Ze(i).next((function(){return t}))})):r.dn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.dn=function(t){var e=this;return Gh(t).get(gc.key).next((function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Ko($o.FAILED_PRECONDITION,Kh)}))},t.prototype.Ze=function(t){var e=new gc(this.clientId,this.allowTabSynchronization,Date.now());return Gh(t).put(gc.key,e)},t.yt=function(){return Fc.yt()},t.prototype.Xe=function(t){var e=this,n=Gh(t);return n.get(gc.key).next((function(t){return e.tn(t)?(Ho("IndexedDbPersistence","Releasing primary lease."),n.delete(gc.key)):Pc.resolve()}))},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Qo("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.je()}))},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.un(),e.Se.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("pagehide",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Qe)||void 0===e?void 0:e.getItem(this.on(t)));return Ho("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Qo("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(t){Qo("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Gh(t){return Gc(t,gc.store)}function Hh(t){return Gc(t,Nc.store)}function Qh(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var Wh=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.yn(t,e,r)}))},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next((function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t}))},t.prototype.gn=function(t,e){t.forEach((function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)}))},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next((function(e){return n.En(t,e).next((function(){return e}))}))},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.gn(e,t)}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return As.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):va(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new As(e)).next((function(t){var e=mu();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=mu();return this.Ut.getCollectionParents(t,i).next((function(s){return Pc.forEach(s,(function(s){var a=function(t,e){return new ha(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.An(t,a,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.Rn(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,h=r.get(c);null==h&&(h=$s.newInvalidDocument(c),r=r.insert(c,h)),Qa(u,h,o.localWriteTime),h.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(t,n){Ta(e,n)||(r=r.remove(t))})),r}))},t.prototype.Rn=function(t,e,n){for(var r=Eu(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof Za&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))})),c}))},t}(),Yh=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=Eu(),i=Eu(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Xh=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(ss.min())?this.Dn(t,e):this.Sn.pn(t,r).next((function(o){var s=i.Cn(e,o);return(pa(e)||da(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(Go()<=re.DEBUG&&Ho("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),_a(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next((function(t){return s.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.Cn=function(t,e){var n=new pu(Sa(t));return e.forEach((function(e,r){Ta(t,r)&&(n=n.add(r))})),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return Go()<=re.DEBUG&&Ho("QueryEngine","Using full collection scan to execute query:",_a(e)),this.Sn.getDocumentsMatchingQuery(t,e,ss.min())},t}(),Jh=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new hu(ns),this.kn=new Ph((function(t){return Gs(t)}),Hs),this.$n=ss.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new Wh(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.Fn)}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Zh(t,e,n,r){return new Jh(t,e,n,r)}function tl(t,e){return Rt(this,void 0,void 0,(function(){var n,r,i,o;return Ot(this,(function(s){switch(s.label){case 0:return n=Zo(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n._n.getAllMutationBatches(t).next((function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new Wh(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],s=Eu(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];s=s.add(f.key)}}for(var p=0,d=e;p<d.length;p++){var y=d[p];r.push(y.batchId);for(var g=0,v=y.mutations;g<v.length;g++){var m=v[g];s=s.add(m.key)}}return i.pn(t,s).next((function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}}))}))}function el(t,e){var n=Zo(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=Pc.resolve();return o.forEach((function(t){s=s.next((function(){return r.getEntry(e,t)})).next((function(e){var o=n.docVersions.get(t);Jo(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))}))})),s.next((function(){return t._n.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}function nl(t){var e=Zo(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.qe.getLastRemoteSnapshotVersion(t)}))}function rl(t,e){var n=Zo(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.Fn;var s=[];e.targetChanges.forEach((function(e,o){var a=i.get(o);if(a){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)})));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=a.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return Jo(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,c,e)&&s.push(n.qe.updateTargetData(t,c))}}}));var a=gu();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),s.push(function(t,e,n,r,i){var o=Eu();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=gu();return n.forEach((function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(ss.min())?(e.removeEntry(n,u),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):Ho("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)})),o}))}(t,o,e.documentUpdates,r,void 0).next((function(t){a=t}))),!r.isEqual(ss.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next((function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)}));s.push(u)}return Pc.waitFor(s).next((function(){return o.apply(t)})).next((function(){return n.Mn.En(t,a)})).next((function(){return a}))})).then((function(t){return n.Fn=i,t}))}function il(t,e){var n=Zo(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)}))}function ol(t,e){var n=Zo(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.qe.getTargetData(t,e).next((function(i){return i?(r=i,Pc.resolve(r)):n.qe.allocateTargetId(t).next((function(i){return r=new Wc(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Fn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t}))}function sl(t,e,n){return Rt(this,void 0,void 0,(function(){var r,i,o,s;return Ot(this,(function(a){switch(a.label){case 0:r=Zo(t),i=r.Fn.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.referenceDelegate.removeTarget(t,i)}))];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!qc(s=a.sent()))throw s;return Ho("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}}))}))}function al(t,e,n){var r=Zo(t),i=ss.min(),o=Eu();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=Zo(t),i=r.kn.get(n);return void 0!==i?Pc.resolve(r.Fn.get(i)):r.qe.getTargetData(e,n)}(r,t,ba(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:ss.min(),n?o:Eu())})).next((function(t){return{documents:t,Bn:o}}))}))}function ul(t,e){var n=Zo(t),r=Zo(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.lt(t,e).next((function(t){return t?t.target:null}))}))}function cl(t){var e=Zo(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=Zo(t),i=gu(),o=Zc(n),s=qh(e),a=IDBKeyRange.lowerBound(o,!0);return s.$t({index:Ic.readTimeIndex,range:a},(function(t,e){var n=Xc(r.R,e);i=i.insert(n.key,n),o=e.readTime})).next((function(){return{wn:i,readTime:th(o)}}))}(e.On,t,e.$n)})).then((function(t){var n=t.wn,r=t.readTime;return e.$n=r,n}))}function hl(t){return Rt(this,void 0,void 0,(function(){var e;return Ot(this,(function(n){return[2,(e=Zo(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=qh(t),n=ss.min();return e.$t({index:Ic.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=th(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.$n=t}))]}))}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ll=function(){function t(t){this.R=t,this.Qn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return Pc.resolve(this.Qn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Qn.set(e.id,{id:(n=e).id,version:n.version,createTime:Uu(n.createTime)}),Pc.resolve()},t.prototype.getNamedQuery=function(t,e){return Pc.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:sh(t.bundledQuery),readTime:Uu(t.readTime)}}(e)),Pc.resolve()},t}(),fl=function(){function t(){this.Wn=new pu(pl.Gn),this.zn=new pu(pl.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new pl(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.Yn(new pl(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.Zn=function(t){var e=this,n=new As(new ls([])),r=new pl(n,t),i=new pl(n,t+1),o=[];return this.zn.forEachInRange([r,i],(function(t){e.Yn(t),o.push(t.key)})),o},t.prototype.ts=function(){var t=this;this.Wn.forEach((function(e){return t.Yn(e)}))},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new As(new ls([])),n=new pl(e,t),r=new pl(e,t+1),i=Eu();return this.zn.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new pl(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),pl=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return As.comparator(t.key,e.key)||ns(t.ns,e.ns)},t.Hn=function(t,e){return ns(t.ns,e.ns)||As.comparator(t.key,e.key)},t}(),dl=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new pu(pl.Gn)}return t.prototype.checkEmpty=function(t){return Pc.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new Hc(i,e,n,r);this._n.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.rs=this.rs.add(new pl(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return Pc.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return Pc.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.cs(n),i=r<0?0:r;return Pc.resolve(this._n.length>i?this._n[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return Pc.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return Pc.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new pl(e,0),i=new pl(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(t){var e=n.os(t.ns);o.push(e)})),Pc.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new pu(ns);return e.forEach((function(t){var e=new pl(t,0),i=new pl(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],(function(t){r=r.add(t.ns)}))})),Pc.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;As.isDocumentKey(i)||(i=i.child(""));var o=new pl(new As(i),0),s=new pu(ns);return this.rs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)}),o),Pc.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.os(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;Jo(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return Pc.forEach(e.mutations,(function(i){var o=new pl(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.rs=r}))},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new pl(e,0),r=this.rs.firstAfterOrEqual(n);return Pc.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return this._n.length,Pc.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),yl=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new hu(As.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Pc.resolve(n?n.document.clone():$s.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=gu();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():$s.newInvalidDocument(t))})),Pc.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=gu(),i=new As(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.key,u=s.value,c=u.document,h=u.readTime;if(!e.path.isPrefixOf(a.path))break;h.compareTo(n)<=0||Ta(e,c)&&(r=r.insert(c.key,c.clone()))}return Pc.resolve(r)},t.prototype.fs=function(t,e){return Pc.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new gl(this)},t.prototype.getSize=function(t){return Pc.resolve(this.size)},t}(),gl=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return kt(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)})),Pc.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(Mh),vl=function(){function t(t){this.persistence=t,this.ds=new Ph((function(t){return Gs(t)}),Hs),this.lastRemoteSnapshotVersion=ss.min(),this.highestTargetId=0,this.ws=0,this._s=new fl,this.targetCount=0,this.ys=_h.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach((function(t,n){return e(n)})),Pc.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return Pc.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return Pc.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),Pc.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),Pc.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new _h(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,Pc.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),Pc.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,Pc.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach((function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)})),Pc.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return Pc.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return Pc.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),Pc.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),Pc.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),Pc.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return Pc.resolve(n)},t.prototype.containsKey=function(t,e){return Pc.resolve(this._s.containsKey(e))},t}(),ml=function(){function t(t,e){var n=this;this.gs={},this.Ne=new Bo(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new vl(this),this.Ut=new hh,this.Ue=function(t,e){return new yl(t,(function(t){return n.referenceDelegate.ps(t)}))}(this.Ut),this.R=new Yc(e),this.Ke=new ll(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new dl(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;Ho("MemoryPersistence","Starting transaction:",t);var i=new bl(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(t){return r.referenceDelegate.Ts(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Is=function(t,e){return Pc.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),bl=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return kt(e,t),e}(Oc),wl=function(){function t(t){this.persistence=t,this.As=new fl,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw Xo()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),Pc.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),Pc.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),Pc.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach((function(t){return n.vs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.vs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Pc.forEach(this.vs,(function(r){var i=As.fromPath(r);return e.Ps(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Rs=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next((function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())}))},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return Pc.or([function(){return Pc.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),El=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Il(t,e){return"firestore_clients_"+t+"_"+e}function _l(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function Tl(t,e){return"firestore_targets_"+t+"_"+e}El.UNAUTHENTICATED=new El(null),El.GOOGLE_CREDENTIALS=new El("google-credentials-uid"),El.FIRST_PARTY=new El("first-party-uid");var Sl=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new Ko(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(Qo("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Al=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Ko(i.error.code,i.error.message)),o?new t(e,i.state,r):(Qo("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Dl=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=_u(),s=0;i&&s<r.activeTargetIds.length;++s)i=Ss(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(Qo("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Nl=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Qo("SharedClientState","Failed to parse online state: "+e),null)},t}(),Cl=function(){function t(){this.activeTargetIds=_u()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),kl=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new hu(ns),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=Il(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new Cl),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Ks=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Rt(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,a,u,c,h,l=this;return Ot(this,(function(f){switch(f.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(Il(this.persistenceKey,r)))&&(o=Dl.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Qs(),(s=this.storage.getItem(this.Us))&&(a=this.js(s))&&this.Ws(a),u=0,c=this.$s;u<c.length;u++)h=c[u],this.Fs(h);return this.$s=[],this.window.addEventListener("pagehide",(function(){return l.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(Tl(this.persistenceKey,t));if(n){var r=Al.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Qs(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(Tl(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.Hs(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Ho("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Ho("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Ho("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Ho("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void Qo("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return Rt(e,void 0,void 0,(function(){var t,e,r,i,o,s;return Ot(this,(function(a){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(s=function(t){var e=Bo.o;if(null!=t)try{var n=JSON.parse(t);Jo("number"==typeof n),e=n}catch(t){Qo("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Bo.o&&this.sequenceNumberHandler(s);else if(n.key===this.Ks)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new Sl(this.currentUser,t,e,n),i=_l(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=_l(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){var e={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(e))},t.prototype.Ys=function(t,e,n){var r=Tl(this.persistenceKey,t),i=new Al(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return Dl.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Sl.Vs(new El(i),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return Al.Vs(r,e)},t.prototype.js=function(t){return Nl.Vs(t)},t.prototype.ii=function(t){return Rt(this,void 0,void 0,(function(){return Ot(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(Ho("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),s=[],a=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||a.push(t)})),this.syncEngine.hi(s,a).then((function(){n.ks=r}))},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=_u();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),xl=function(){function t(){this.li=new Cl,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new Cl,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),Rl=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),Ol=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){Ho("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){Ho("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Ll={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Pl=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),Ml=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return kt(e,t),e.prototype.ki=function(t,e,n,r){return new Promise((function(i,o){var s=new jo;s.listenOnce(Po.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case Lo.NO_ERROR:var e=s.getResponseJson();Ho("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Lo.TIMEOUT:Ho("Connection",'RPC "'+t+'" timed out'),o(new Ko($o.DEADLINE_EXCEEDED,"Request time out"));break;case Lo.HTTP_ERROR:var n=s.getStatus();if(Ho("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values($o).indexOf(e)>=0?e:$o.UNKNOWN}(r.status);o(new Ko(a,r.message))}else o(new Ko($o.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Ko($o.UNAVAILABLE,"Connection failed."));break;default:Xo()}}finally{Ho("Connection",'RPC "'+t+'" completed.')}}));var a=JSON.stringify(r);s.send(e,"POST",a,n,15)}))},e.prototype.Oi=function(t,e){var n,r=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new Co,o=Er(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(s.xmlHttpFactory=new Uo({})),this.Fi(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(qt())||"object"==typeof navigator&&"ReactNative"===navigator.product||qt().indexOf("Electron/")>=0||function(){var t=qt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||qt().indexOf("MSAppHost/")>=0||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=r.join("");Ho("Connection","Creating WebChannel: "+a,s);var u=i.createWebChannel(a,s),c=!1,h=!1,l=new Pl({Ei:function(t){h?Ho("Connection","Not sending because WebChannel is closed:",t):(c||(Ho("Connection","Opening WebChannel transport."),u.open(),c=!0),Ho("Connection","WebChannel sending:",t),u.send(t))},Ti:function(){return u.close()}}),f=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(u,qo.EventType.OPEN,(function(){h||Ho("Connection","WebChannel transport opened.")})),f(u,qo.EventType.CLOSE,(function(){h||(h=!0,Ho("Connection","WebChannel transport closed"),l.Vi())})),f(u,qo.EventType.ERROR,(function(t){h||(h=!0,Wo("Connection","WebChannel transport errored:",t),l.Vi(new Ko($o.UNAVAILABLE,"The operation could not be completed")))})),f(u,qo.EventType.MESSAGE,(function(t){var e;if(!h){var n=t.data[0];Jo(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){Ho("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=ru[t];if(void 0!==e)return cu(e)}(o),a=i.message;void 0===s&&(s=$o.INTERNAL,a="Unknown error status: "+o+" with message "+i.message),h=!0,l.Vi(new Ko(s,a)),u.close()}else Ho("Connection","WebChannel received:",n),l.Si(n)}})),f(o,Mo.STAT_EVENT,(function(t){t.stat===Fo?Ho("Connection","Detected buffering proxy"):t.stat===Vo&&Ho("Connection","Detected no buffering proxy")})),setTimeout((function(){l.Pi()}),0),l},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);Ho("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then((function(t){return Ho("RestConnection","Received: ",t),t}),(function(e){throw Wo("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.7.0",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){var n=Ll[t];return this.Di+"/v1/"+e+":"+n},t}());
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Fl(){return"undefined"!=typeof window?window:null}function Vl(){return"undefined"!=typeof document?document:null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ul(t){return new Pu(t,!0)}var ql=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Qi=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Ki),i=Math.max(0,n-r);i>0&&Ho("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return e.Ki=Date.now(),t()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),jl=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new ql(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return Rt(this,void 0,void 0,(function(){return Ot(this,(function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return t.rr()})))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return Rt(this,void 0,void 0,(function(){return Ot(this,(function(t){return this.er()?[2,this.close(0)]:[2]}))}))},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return Rt(this,void 0,void 0,(function(){return Ot(this,(function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===$o.RESOURCE_EXHAUSTED?(Qo(e.toString()),Qo("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):e&&e.code===$o.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(e){t.Yi===n&&t.lr(e)}),(function(n){e((function(){var e=new Ko($o.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)}))}))},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii((function(){n((function(){return e.state=2,e.listener.Ii()}))})),this.stream.Ri((function(t){n((function(){return e.dr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji((function(){return Rt(t,void 0,void 0,(function(){return Ot(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.dr=function(t){return Ho("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget((function(){return e.Yi===t?n():(Ho("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Bl=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return kt(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Xo()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(Jo(void 0===e||"string"==typeof e),ys.fromBase64String(e||"")):(Jo(void 0===e||e instanceof Uint8Array),ys.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?$o.UNKNOWN:cu(t.code);return new Ko(e,t.message||"")}(a);n=new Nu(r,i,o,s||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=$u(t,r.document.name),o=Uu(r.document.updateTime);var a=new js({mapValue:{fields:r.document.fields}}),u=(s=$s.newFoundDocument(i,o,a),r.targetIds||[]),c=r.removedTargetIds||[];n=new Au(u,c,s.key,s)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=$u(t,r.document),o=r.readTime?Uu(r.readTime):ss.min(),a=$s.newNoDocument(i,o),s=r.removedTargetIds||[],n=new Au([],s,a.key,a);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=$u(t,r.document),o=r.removedTargetIds||[],n=new Au([],o,i,null);else{if(!("filter"in e))return Xo();e.filter;var h=e.filter;h.targetId,r=h.count||0,i=new au(r),o=h.targetId,n=new Du(o,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return ss.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?ss.min():e.readTime?Uu(e.readTime):ss.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=Gu(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=Qs(r)?{documents:Xu(t,r)}:{query:Ju(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Fu(t,e.resumeToken):e.snapshotVersion.compareTo(ss.min())>0&&(n.readTime=Mu(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Xo()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=Gu(this.R),e.removeTarget=t,this.cr(e)},e}(jl),$l=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return kt(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(Jo(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(Jo(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?Uu(t.updateTime):Uu(e);return n.isEqual(ss.min())&&(n=Uu(e)),new $a(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=Uu(t.commitTime);return this.listener.Tr(n,e)}return Jo(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=Gu(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Wu(e.R,t)}))};this.cr(n)},e}(jl),Kl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return kt(e,t),e.prototype.br=function(){if(this.Rr)throw new Ko($o.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===$o.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Ko($o.UNKNOWN,t.toString())}))},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.$i(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===$o.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Ko($o.UNKNOWN,t.toString())}))},e.prototype.terminate=function(){this.Rr=!0},e}((function(){})),zl=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()})))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(Qo(e),this.Vr=!1):Ho("OnlineStateTracker",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),Gl=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di((function(t){n.enqueueAndForget((function(){return Rt(o,void 0,void 0,(function(){return Ot(this,(function(t){switch(t.label){case 0:return ef(this)?(Ho("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Rt(this,void 0,void 0,(function(){var e;return Ot(this,(function(n){switch(n.label){case 0:return(e=Zo(t)).Or.add(4),[4,Ql(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,Hl(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Br=new zl(n,r)};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Hl(t){return Rt(this,void 0,void 0,(function(){var e,n;return Ot(this,(function(r){switch(r.label){case 0:if(!ef(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Ql(t){return Rt(this,void 0,void 0,(function(){var e,n;return Ot(this,(function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Wl(t,e){var n=Zo(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),tf(n)?Zl(n):vf(n).er()&&Xl(n,e))}function Yl(t,e){var n=Zo(t),r=vf(n);n.$r.delete(e),r.er()&&Jl(n,e),0===n.$r.size&&(r.er()?r.ir():ef(n)&&n.Br.set("Unknown"))}function Xl(t,e){t.qr.U(e.targetId),vf(t).mr(e)}function Jl(t,e){t.qr.U(e),vf(t).yr(e)}function Zl(t){t.qr=new ku({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),vf(t).start(),t.Br.Sr()}function tf(t){return ef(t)&&!vf(t).tr()&&t.$r.size>0}function ef(t){return 0===Zo(t).Or.size}function nf(t){t.qr=void 0}function rf(t){return Rt(this,void 0,void 0,(function(){return Ot(this,(function(e){return t.$r.forEach((function(e,n){Xl(t,e)})),[2]}))}))}function of(t,e){return Rt(this,void 0,void 0,(function(){return Ot(this,(function(n){return nf(t),tf(t)?(t.Br.Nr(e),Zl(t)):t.Br.set("Unknown"),[2]}))}))}function sf(t,e,n){return Rt(this,void 0,void 0,(function(){var r,i,o;return Ot(this,(function(s){switch(s.label){case 0:if(t.Br.set("Online"),!(e instanceof Nu&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Rt(this,void 0,void 0,(function(){var n,r,i,o;return Ot(this,(function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?(o=i[r],t.$r.has(o)?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]):[3,5];case 2:s.sent(),t.$r.delete(o),t.qr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),Ho("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,af(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Au?t.qr.X(e):e instanceof Du?t.qr.rt(e):t.qr.et(e),n.isEqual(ss.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,nl(t.localStore)];case 8:return i=s.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(ys.EMPTY_BYTE_STRING,n.snapshotVersion)),Jl(t,e);var r=new Wc(n.target,e,1,n.sequenceNumber);Xl(t,r)}})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return Ho("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,af(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}}))}))}function af(t,e,n){return Rt(this,void 0,void 0,(function(){var r=this;return Ot(this,(function(i){switch(i.label){case 0:if(!qc(e))throw e;return t.Or.add(1),[4,Ql(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return nl(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return Rt(r,void 0,void 0,(function(){return Ot(this,(function(e){switch(e.label){case 0:return Ho("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,Hl(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function uf(t,e){return e().catch((function(n){return af(t,n,e)}))}function cf(t){return Rt(this,void 0,void 0,(function(){var e,n,r,i,o;return Ot(this,(function(s){switch(s.label){case 0:e=Zo(t),n=mf(e),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return ef(t)&&t.kr.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,il(e.localStore,r)];case 3:return null===(i=s.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=mf(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,af(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return hf(e)&&lf(e),[2]}}))}))}function hf(t){return ef(t)&&!mf(t).tr()&&t.kr.length>0}function lf(t){mf(t).start()}function ff(t){return Rt(this,void 0,void 0,(function(){return Ot(this,(function(e){return mf(t).Ar(),[2]}))}))}function pf(t){return Rt(this,void 0,void 0,(function(){var e,n,r,i;return Ot(this,(function(o){for(e=mf(t),n=0,r=t.kr;n<r.length;n++)i=r[n],e.Er(i.mutations);return[2]}))}))}function df(t,e,n){return Rt(this,void 0,void 0,(function(){var r,i;return Ot(this,(function(o){switch(o.label){case 0:return r=t.kr.shift(),i=Qc.from(r,e,n),[4,uf(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,cf(t)];case 2:return o.sent(),[2]}}))}))}function yf(t,e){return Rt(this,void 0,void 0,(function(){return Ot(this,(function(n){switch(n.label){case 0:return e&&mf(t).pr?[4,function(t,e){return Rt(this,void 0,void 0,(function(){var n,r;return Ot(this,(function(i){switch(i.label){case 0:return uu(r=e.code)&&r!==$o.ABORTED?(n=t.kr.shift(),mf(t).sr(),[4,uf(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,cf(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return hf(t)&&lf(t),[2]}}))}))}function gf(t,e){return Rt(this,void 0,void 0,(function(){var n;return Ot(this,(function(r){switch(r.label){case 0:return n=Zo(t),e?(n.Or.delete(2),[4,Hl(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,Ql(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function vf(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=Zo(t);return r.br(),new Bl(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:rf.bind(null,t),Ri:of.bind(null,t),_r:sf.bind(null,t)}),t.Mr.push((function(n){return Rt(e,void 0,void 0,(function(){return Ot(this,(function(e){switch(e.label){case 0:return n?(t.Ur.sr(),tf(t)?Zl(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),nf(t),e.label=3;case 3:return[2]}}))}))}))),t.Ur}function mf(t){var e=this;return t.Kr||(t.Kr=function(t,e,n){var r=Zo(t);return r.br(),new $l(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:ff.bind(null,t),Ri:yf.bind(null,t),Ir:pf.bind(null,t),Tr:df.bind(null,t)}),t.Mr.push((function(n){return Rt(e,void 0,void 0,(function(){return Ot(this,(function(e){switch(e.label){case 0:return n?(t.Kr.sr(),[4,cf(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kr.stop()];case 3:e.sent(),t.kr.length>0&&(Ho("RemoteStore","Stopping write stream with "+t.kr.length+" pending writes"),t.kr=[]),e.label=4;case 4:return[2]}}))}))}))),t.Kr
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var bf=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Lc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ko($o.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function wf(t,e){if(Qo("AsyncQueue",e+": "+t),qc(t))return new Ko($o.UNAVAILABLE,e+": "+t);throw t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ef=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||As.comparator(e.key,n.key)}:function(t,e){return As.comparator(t.key,e.key)},this.keyedMap=mu(),this.sortedSet=new hu(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),If=function(){function t(){this.Qr=new hu(As.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Qr.get(e);n?0!==t.type&&3===n.type?this.Qr=this.Qr.insert(e,t):3===t.type&&1!==n.type?this.Qr=this.Qr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Qr=this.Qr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Qr=this.Qr.remove(e):1===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):Xo():this.Qr=this.Qr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Qr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),_f=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,Ef.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Ea(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Tf=function(){this.Wr=void 0,this.listeners=[]},Sf=function(){this.queries=new Ph((function(t){return Ia(t)}),Ea),this.onlineState="Unknown",this.Gr=new Set};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Af(t,e){return Rt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u;return Ot(this,(function(c){switch(c.label){case 0:if(n=Zo(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new Tf),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=c.sent(),[3,4];case 3:return a=c.sent(),u=wf(a,"Initialization of query '"+_a(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&kf(n),[2]}}))}))}function Df(t,e){return Rt(this,void 0,void 0,(function(){var n,r,i,o,s;return Ot(this,(function(a){return n=Zo(t),r=e.query,i=!1,(o=n.queries.get(r))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function Nf(t,e){for(var n=Zo(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,u=n.queries.get(a);if(u){for(var c=0,h=u.listeners;c<h.length;c++)h[c].Hr(s)&&(r=!0);u.Wr=s}}r&&kf(n)}function Cf(t,e,n){var r=Zo(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function kf(t){t.Gr.forEach((function(t){t.next()}))}var xf=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new _f(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.so&&n||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=_f.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),Rf=function(t){this.key=t},Of=function(t){this.key=t},Lf=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=Eu(),this.mutatedKeys=Eu(),this.lo=Sa(t),this.fo=new Ef(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new If,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=pa(this.query)&&i.size===this.query.limit?i.last():null,c=da(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var h=i.get(t),l=Ta(n.query,e)?e:null,f=!!h&&n.mutatedKeys.has(h.key),p=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),d=!1;h&&l?h.data.isEqual(l.data)?f!==p&&(r.track({type:3,doc:l}),d=!0):n.yo(h,l)||(r.track({type:2,doc:l}),d=!0,(u&&n.lo(l,u)>0||c&&n.lo(l,c)<0)&&(a=!0)):!h&&l?(r.track({type:0,doc:l}),d=!0):h&&!l&&(r.track({type:1,doc:h}),d=!0,(u||c)&&(a=!0)),d&&(l?(s=s.add(l),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),pa(this.query)||da(this.query))for(;s.size>this.query.limit;){var h=pa(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Xo()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)})),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new _f(this.query,t.fo,i,o,t.mutatedKeys,0===a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new If,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.uo=e.uo.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.uo=e.uo.delete(t)})),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=Eu(),this.fo.forEach((function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))}));var n=[];return e.forEach((function(e){t.ho.has(e)||n.push(new Of(e))})),this.ho.forEach((function(t){e.has(t)||n.push(new Rf(t))})),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=Eu();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return _f.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),Pf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Mf=function(t){this.key=t,this.bo=!1},Ff=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new Ph((function(t){return Ia(t)}),Ea),this.Vo=new Map,this.So=new Set,this.Do=new hu(As.comparator),this.Co=new Map,this.No=new fl,this.xo={},this.Fo=new Map,this.ko=_h.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Vf(t,e){return Rt(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Ot(this,(function(u){switch(u.label){case 0:return n=pp(t),(o=n.Po.get(e))?(r=o.targetId,n.sharedClientState.addLocalQueryTarget(r),i=o.view.Ro(),[3,4]):[3,1];case 1:return[4,ol(n.localStore,ba(e))];case 2:return s=u.sent(),a=n.sharedClientState.addLocalQueryTarget(s.targetId),r=s.targetId,[4,Uf(n,e,r,"current"===a)];case 3:i=u.sent(),n.isPrimaryClient&&Wl(n.remoteStore,s),u.label=4;case 4:return[2,i]}}))}))}function Uf(t,e,n,r){return Rt(this,void 0,void 0,(function(){var i,o,s,a,u,c;return Ot(this,(function(h){switch(h.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return Rt(this,void 0,void 0,(function(){var i,o,s;return Ot(this,(function(a){switch(a.label){case 0:return(i=e.view._o(n)).Nn?[4,al(t.localStore,e.query,!1).then((function(t){var n=t.documents;return e.view._o(n,i)}))]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(Jf(t,e.targetId,s.To),s.snapshot)]}}))}))}(t,e,n,r)},[4,al(t.localStore,e,!0)];case 1:return i=h.sent(),o=new Lf(e,i.Bn),s=o._o(i.documents),a=Su.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(s,t.isPrimaryClient,a),Jf(t,n,u.To),c=new Pf(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}}))}))}function qf(t,e){return Rt(this,void 0,void 0,(function(){var n,r,i;return Ot(this,(function(o){switch(o.label){case 0:return n=Zo(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter((function(t){return!Ea(t,e)}))),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,sl(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),Yl(n.remoteStore,r.targetId),Yf(n,r.targetId)})).catch(Nh)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Yf(n,r.targetId),[4,sl(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function jf(t,e,n){return Rt(this,void 0,void 0,(function(){var r,i,o,s;return Ot(this,(function(a){switch(a.label){case 0:r=dp(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=Zo(t),i=os.now(),o=e.reduce((function(t,e){return t.add(e.key)}),Eu());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Mn.pn(t,o).next((function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],h=Wa(c,n.get(c.key));null!=h&&s.push(new Za(c.key,h,Bs(h.value.mapValue),Ka.exists(!0)))}return r._n.addMutationBatch(t,i,s,e)}))})).then((function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}}))}(r.localStore,e)];case 2:return i=a.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new hu(ns)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,ep(r,i.changes)];case 3:return a.sent(),[4,cf(r.remoteStore)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=wf(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}}))}))}function Bf(t,e){return Rt(this,void 0,void 0,(function(){var n,r;return Ot(this,(function(i){switch(i.label){case 0:n=Zo(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,rl(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.Co.get(e);r&&(Jo(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?Jo(r.bo):t.removedDocuments.size>0&&(Jo(r.bo),r.bo=!1))})),[4,ep(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Nh(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function $f(t,e,n){var r=Zo(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=Zo(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)})),r&&kf(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Kf(t,e,n){return Rt(this,void 0,void 0,(function(){var r,i,o,s,a,u;return Ot(this,(function(c){switch(c.label){case 0:return(r=Zo(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(s=(s=new hu(As.comparator)).insert(o,$s.newNoDocument(o,ss.min())),a=Eu().add(o),u=new Tu(ss.min(),new Map,new pu(ns),s,a),[4,Bf(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),tp(r),[3,4];case 2:return[4,sl(r.localStore,e,!1).then((function(){return Yf(r,e,n)})).catch(Nh)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function zf(t,e){return Rt(this,void 0,void 0,(function(){var n,r,i;return Ot(this,(function(o){switch(o.label){case 0:n=Zo(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,el(n.localStore,e)];case 2:return i=o.sent(),Wf(n,r,null),Qf(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,ep(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Nh(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Gf(t,e,n){return Rt(this,void 0,void 0,(function(){var r,i;return Ot(this,(function(o){switch(o.label){case 0:r=Zo(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Zo(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n._n.lookupMutationBatch(t,e).next((function(e){return Jo(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}(r.localStore,e)];case 2:return i=o.sent(),Wf(r,e,n),Qf(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,ep(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Nh(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Hf(t,e){return Rt(this,void 0,void 0,(function(){var n,r,i,o,s;return Ot(this,(function(a){switch(a.label){case 0:ef((n=Zo(t)).remoteStore)||Ho("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=Zo(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e._n.getHighestUnacknowledgedBatchId(t)}))}(n.localStore)];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return o=a.sent(),s=wf(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}}))}))}function Qf(t,e){(t.Fo.get(e)||[]).forEach((function(t){t.resolve()})),t.Fo.delete(e)}function Wf(t,e,n){var r=Zo(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function Yf(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach((function(e){t.No.containsKey(e)||Xf(t,e)}))}function Xf(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(Yl(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),tp(t))}function Jf(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Rf?(t.No.addReference(o.key,e),Zf(t,o)):o instanceof Of?(Ho("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||Xf(t,o.key)):Xo()}}function Zf(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(Ho("SyncEngine","New document in limbo: "+n),t.So.add(r),tp(t))}function tp(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new As(ls.fromString(e)),r=t.ko.next();t.Co.set(r,new Mf(n)),t.Do=t.Do.insert(n,r),Wl(t.remoteStore,new Wc(ba(fa(n.path)),r,2,Bo.o))}}function ep(t,e,n){return Rt(this,void 0,void 0,(function(){var r,i,o,s;return Ot(this,(function(a){switch(a.label){case 0:return r=Zo(t),i=[],o=[],s=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach((function(t,a){s.push(r.Oo(a,e,n).then((function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Yh.Pn(a.targetId,t);o.push(e)}})))})),[4,Promise.all(s)]);case 1:return a.sent(),r.vo._r(i),[4,function(t,e){return Rt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,h;return Ot(this,(function(l){switch(l.label){case 0:n=Zo(t),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return Pc.forEach(e,(function(e){return Pc.forEach(e.bn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return Pc.forEach(e.vn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return l.sent(),[3,4];case 3:if(!qc(r=l.sent()))throw r;return Ho("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)s=o[i],a=s.targetId,s.fromCache||(u=n.Fn.get(a),c=u.snapshotVersion,h=u.withLastLimboFreeSnapshotVersion(c),n.Fn=n.Fn.insert(a,h));return[2]}}))}))}(r.localStore,o)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function np(t,e){return Rt(this,void 0,void 0,(function(){var n,r;return Ot(this,(function(i){switch(i.label){case 0:return(n=Zo(t)).currentUser.isEqual(e)?[3,3]:(Ho("SyncEngine","User change. New user:",e.toKey()),[4,tl(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fo.forEach((function(t){t.forEach((function(t){t.reject(new Ko($o.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Fo.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,ep(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function rp(t,e){var n=Zo(t),r=n.Co.get(e);if(r&&r.bo)return Eu().add(r.key);var i=Eu(),o=n.Vo.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=a[s],c=n.Po.get(u);i=i.unionWith(c.view.wo)}return i}function ip(t,e){return Rt(this,void 0,void 0,(function(){var n,r,i;return Ot(this,(function(o){switch(o.label){case 0:return[4,al((n=Zo(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&Jf(n,e.targetId,i.To),i)]}}))}))}function op(t){return Rt(this,void 0,void 0,(function(){var e;return Ot(this,(function(n){return[2,cl((e=Zo(t)).localStore).then((function(t){return ep(e,t)}))]}))}))}function sp(t,e,n,r){return Rt(this,void 0,void 0,(function(){var i,o;return Ot(this,(function(s){switch(s.label){case 0:return[4,function(t,e){var n=Zo(t),r=Zo(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.jt(t,e).next((function(e){return e?n.Mn.pn(t,e):Pc.resolve(null)}))}))}((i=Zo(t)).localStore,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,cf(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Wf(i,e,r||null),Qf(i,e),function(t,e){Zo(Zo(t)._n).Gt(e)}(i.localStore,e)):Xo(),s.label=4;case 4:return[4,ep(i,o)];case 5:return s.sent(),[3,7];case 6:Ho("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}}))}))}function ap(t,e){return Rt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c;return Ot(this,(function(h){switch(h.label){case 0:return pp(n=Zo(t)),dp(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,up(n,r.toArray())]);case 1:return i=h.sent(),n.$o=!0,[4,gf(n.remoteStore,!0)];case 2:for(h.sent(),o=0,s=i;o<s.length;o++)a=s[o],Wl(n.remoteStore,a);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(u=[],c=Promise.resolve(),n.Vo.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?u.push(e):c=c.then((function(){return Yf(n,e),sl(n.localStore,e,!0)})),Yl(n.remoteStore,e)})),[4,c]);case 4:return h.sent(),[4,up(n,u)];case 5:return h.sent(),function(t){var e=Zo(t);e.Co.forEach((function(t,n){Yl(e.remoteStore,n)})),e.No.ts(),e.Co=new Map,e.Do=new hu(As.comparator)}(n),n.$o=!1,[4,gf(n.remoteStore,!1)];case 6:h.sent(),h.label=7;case 7:return[2]}}))}))}function up(t,e,n){return Rt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,h,l,f,p,d,y;return Ot(this,(function(g){switch(g.label){case 0:n=Zo(t),r=[],i=[],o=0,s=e,g.label=1;case 1:return o<s.length?(a=s[o],u=void 0,(c=n.Vo.get(a))&&0!==c.length?[4,ol(n.localStore,ba(c[0]))]:[3,7]):[3,13];case 2:u=g.sent(),h=0,l=c,g.label=3;case 3:return h<l.length?(f=l[h],p=n.Po.get(f),[4,ip(n,p)]):[3,6];case 4:(d=g.sent()).snapshot&&i.push(d.snapshot),g.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,ul(n.localStore,a)];case 8:return y=g.sent(),[4,ol(n.localStore,y)];case 9:return u=g.sent(),[4,Uf(n,cp(y),a,!1)];case 10:g.sent(),g.label=11;case 11:r.push(u),g.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}}))}))}function cp(t){return la(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function hp(t){var e=Zo(t);return Zo(Zo(e.localStore).persistence).fn()}function lp(t,e,n,r){return Rt(this,void 0,void 0,(function(){var i,o,s;return Ot(this,(function(a){switch(a.label){case 0:return(i=Zo(t)).$o?(Ho("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,cl(i.localStore)];case 3:return o=a.sent(),s=Tu.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,ep(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,sl(i.localStore,e,!0)];case 6:return a.sent(),Yf(i,e,r),[3,8];case 7:Xo(),a.label=8;case 8:return[2]}}))}))}function fp(t,e,n){return Rt(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,h,l,f;return Ot(this,(function(p){switch(p.label){case 0:if(!(r=pp(t)).$o)return[3,10];i=0,o=e,p.label=1;case 1:return i<o.length?(s=o[i],r.Vo.has(s)?(Ho("SyncEngine","Adding an already active target "+s),[3,5]):[4,ul(r.localStore,s)]):[3,6];case 2:return a=p.sent(),[4,ol(r.localStore,a)];case 3:return u=p.sent(),[4,Uf(r,cp(a),u.targetId,!1)];case 4:p.sent(),Wl(r.remoteStore,u),p.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Ot(this,(function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,sl(r.localStore,t,!1).then((function(){Yl(r.remoteStore,t),Yf(r,t)})).catch(Nh)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},h=0,l=n,p.label=7;case 7:return h<l.length?(f=l[h],[5,c(f)]):[3,10];case 8:p.sent(),p.label=9;case 9:return h++,[3,7];case 10:return[2]}}))}))}function pp(t){var e=Zo(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Bf.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=rp.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Kf.bind(null,e),e.vo._r=Nf.bind(null,e.eventManager),e.vo.Mo=Cf.bind(null,e.eventManager),e}function dp(t){var e=Zo(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=zf.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Gf.bind(null,e),e}var yp=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Rt(this,void 0,void 0,(function(){return Ot(this,(function(e){switch(e.label){case 0:return this.R=Ul(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Ko(t),[2]}}))}))},t.prototype.Uo=function(t){return null},t.prototype.Ko=function(t){return Zh(this.persistence,new Xh,t.initialUser,this.R)},t.prototype.qo=function(t){return new ml(wl.bs,this.R)},t.prototype.Bo=function(t){return new xl},t.prototype.terminate=function(){return Rt(this,void 0,void 0,(function(){return Ot(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),gp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qo=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return kt(e,t),e.prototype.initialize=function(e){return Rt(this,void 0,void 0,(function(){return Ot(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,hl(this.localStore)];case 2:return n.sent(),[4,this.Qo.initialize(this,e)];case 3:return n.sent(),[4,dp(this.Qo.syncEngine)];case 4:return n.sent(),[4,cf(this.Qo.remoteStore)];case 5:return n.sent(),[2]}}))}))},e.prototype.Ko=function(t){return Zh(this.persistence,new Xh,t.initialUser,this.R)},e.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new xh(e,t.asyncQueue)},e.prototype.qo=function(t){var e=Qh(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?yh.withCacheSize(this.cacheSizeBytes):yh.DEFAULT;return new zh(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,Fl(),Vl(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new xl},e}(yp),vp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Qo=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return kt(e,t),e.prototype.initialize=function(e){return Rt(this,void 0,void 0,(function(){var n,r=this;return Ot(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Qo.syncEngine,this.sharedClientState instanceof kl?(this.sharedClientState.syncEngine={ui:sp.bind(null,n),ai:lp.bind(null,n),hi:fp.bind(null,n),fn:hp.bind(null,n),ci:op.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He((function(t){return Rt(r,void 0,void 0,(function(){return Ot(this,(function(e){switch(e.label){case 0:return[4,ap(this.Qo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Bo=function(t){var e=Fl();if(!kl.yt(e))throw new Ko($o.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Qh(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new kl(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(gp),mp=function(){function t(){}return t.prototype.initialize=function(t,e){return Rt(this,void 0,void 0,(function(){var n=this;return Ot(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return $f(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=np.bind(null,this.syncEngine),[4,gf(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new Sf},t.prototype.createDatastore=function(t){var e,n=Ul(t.databaseInfo.databaseId),r=(e=t.databaseInfo,new Ml(e));return function(t,e,n){return new Kl(t,e,n)}(t.credentials,r,n)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return $f(s.syncEngine,t,0)},o=Ol.yt()?new Ol:new Rl,new Gl(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){var a=new Ff(t,e,n,r,i,o);return s&&(a.$o=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return Rt(this,void 0,void 0,(function(){var e;return Ot(this,(function(n){switch(n.label){case 0:return e=Zo(t),Ho("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,Ql(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}(),bp=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),wp=function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return Rt(this,void 0,void 0,(function(){var e,n=this;return Ot(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Ko($o.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Rt(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Ot(this,(function(u){switch(u.label){case 0:return n=Zo(t),r=Gu(n.R)+"/documents",i={documents:e.map((function(t){return Bu(n.R,t)}))},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){Jo(!!e.found),e.found.name,e.found.updateTime;var n=$u(t,e.found.name),r=Uu(e.found.updateTime),i=new js({mapValue:{fields:e.found.fields}});return $s.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){Jo(!!e.missing),Jo(!!e.readTime);var n=$u(t,e.missing),r=Uu(e.readTime);return $s.newNoDocument(n,r)}(t,e):Xo()}(n.R,t);s.set(e.key.toString(),e)})),a=[],[2,(e.forEach((function(t){var e=s.get(t.toString());Jo(!!e),a.push(e)})),a)]}}))}))}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach((function(t){return n.recordVersion(t)})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new ou(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return Rt(this,void 0,void 0,(function(){var t,e=this;return Ot(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=As.fromPath(n);e.mutations.push(new su(r,e.precondition(r)))})),[4,function(t,e){return Rt(this,void 0,void 0,(function(){var n,r,i;return Ot(this,(function(o){switch(o.label){case 0:return n=Zo(t),r=Gu(n.R)+"/documents",i={writes:e.map((function(t){return Wu(n.R,t)}))},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw Xo();e=ss.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Ko($o.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?Ka.updateTime(e):Ka.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(ss.min()))throw new Ko($o.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ka.updateTime(e)}return Ka.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}(),Ep=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new ql(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.ec-=1,this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji((function(){return Rt(t,void 0,void 0,(function(){var t,e,n=this;return Ot(this,(function(r){return t=new wp(this.datastore),(e=this.sc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.ic(t)}))}))})).catch((function(t){n.ic(t)})),[2]}))}))}))},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!_s(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return e.nc(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!uu(e)}return!1},t}(),Ip=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=El.UNAUTHENTICATED,this.clientId=es.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,(function(t){return Rt(r,void 0,void 0,(function(){return Ot(this,(function(e){switch(e.label){case 0:return Ho("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}}))}))}))}return t.prototype.getConfiguration=function(){return Rt(this,void 0,void 0,(function(){return Ot(this,(function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}))}))},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Ko($o.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new Lc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return Rt(t,void 0,void 0,(function(){var t,n;return Ot(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=wf(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function _p(t,e){return Rt(this,void 0,void 0,(function(){var n,r,i=this;return Ot(this,(function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),Ho("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener((function(t){return Rt(i,void 0,void 0,(function(){return Ot(this,(function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,tl(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}}))}))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function Tp(t,e){return Rt(this,void 0,void 0,(function(){var n,r;return Ot(this,(function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,Sp(t)];case 1:return n=i.sent(),Ho("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener((function(t){return function(t,e){return Rt(this,void 0,void 0,(function(){var n,r;return Ot(this,(function(i){switch(i.label){case 0:return(n=Zo(t)).asyncQueue.verifyOperationInProgress(),Ho("RemoteStore","RemoteStore received new credentials"),r=ef(n),n.Or.add(3),[4,Ql(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,Hl(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,t)})),t.onlineComponents=e,[2]}}))}))}function Sp(t){return Rt(this,void 0,void 0,(function(){return Ot(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(Ho("FirestoreClient","Using default OfflineComponentProvider"),[4,_p(t,new yp)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function Ap(t){return Rt(this,void 0,void 0,(function(){return Ot(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(Ho("FirestoreClient","Using default OnlineComponentProvider"),[4,Tp(t,new mp)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function Dp(t){return Sp(t).then((function(t){return t.persistence}))}function Np(t){return Sp(t).then((function(t){return t.localStore}))}function Cp(t){return Ap(t).then((function(t){return t.remoteStore}))}function kp(t){return Ap(t).then((function(t){return t.syncEngine}))}function xp(t){return Rt(this,void 0,void 0,(function(){var e,n;return Ot(this,(function(r){switch(r.label){case 0:return[4,Ap(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=Vf.bind(null,e.syncEngine),n.onUnlisten=qf.bind(null,e.syncEngine),n)]}}))}))}function Rp(t,e,n){var r=this;void 0===n&&(n={});var i=new Lc;return t.asyncQueue.enqueueAndForget((function(){return Rt(r,void 0,void 0,(function(){var r;return Ot(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new bp({next:function(o){e.enqueueAndForget((function(){return Df(t,s)}));var a=o.docs.has(n);!a&&o.fromCache?i.reject(new Ko($o.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new Ko($o.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new xf(fa(n.path),o,{includeMetadataChanges:!0,so:!0});return Af(t,s)},[4,xp(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}function Op(t,e,n){var r=this;void 0===n&&(n={});var i=new Lc;return t.asyncQueue.enqueueAndForget((function(){return Rt(r,void 0,void 0,(function(){var r;return Ot(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new bp({next:function(n){e.enqueueAndForget((function(){return Df(t,s)})),n.fromCache&&"server"===r.source?i.reject(new Ko($o.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new xf(n,o,{includeMetadataChanges:!0,so:!0});return Af(t,s)},[4,xp(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}var Lp=function(t,e,n,r,i,o,s,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},Pp=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Mp=new Map,Fp=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},Vp=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable((function(){return e(El.UNAUTHENTICATED)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Up=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),qp=function(){function t(t){var e=this;this.currentUser=El.UNAUTHENTICATED,this.oc=new Lc,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)}))};var n=function(t){Ho("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit((function(t){return n(t)})),setTimeout((function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(Ho("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}}),0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.cc!==e?(Ho("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Jo("string"==typeof n.accessToken),new Fp(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable((function(){return Rt(n,void 0,void 0,(function(){return Ot(this,(function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}}))}))}))},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return Jo(null===t||"string"==typeof t),new El(t)},t}(),jp=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=El.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),Bp=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new jp(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable((function(){return e(El.FIRST_PARTY)}))},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function $p(t,e,n){if(!n)throw new Ko($o.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Kp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Ko($o.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function zp(t,e,n,r){if(!0===e&&!0===r)throw new Ko($o.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Gp(t){if(!As.isDocumentKey(t))throw new Ko($o.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Hp(t){if(As.isDocumentKey(t))throw new Ko($o.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Qp(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Xo()}function Wp(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ko($o.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Qp(t);throw new Ko($o.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Yp(t,e){if(e<=0)throw new Ko($o.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Xp=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Ko($o.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Ko($o.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,zp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),Jp=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Xp({}),this._settingsFrozen=!1,t instanceof Pp?(this._databaseId=t,this._credentials=new Vp):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Ko($o.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Pp(t.options.projectId)}(t),this._credentials=new qp(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new Ko($o.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new Ko($o.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Xp(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new Vp;switch(t.type){case"gapi":var e=t.client;return Jo(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Bp(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Ko($o.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return this,(t=Mp.get(this))&&(Ho("ComponentProvider","Removing Datastore"),Mp.delete(this),t.terminate()),Promise.resolve();var t},t}(),Zp=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new ed(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),td=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),ed=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,fa(r))||this)._path=r,i.type="collection",i}return kt(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new Zp(this.firestore,null,new As(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(td);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function nd(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Yt(t),$p("collection","path",e),t instanceof Jp)return Hp(n=ls.fromString.apply(ls,Mt([e],r))),new ed(t,null,n);if(!(t instanceof Zp||t instanceof ed))throw new Ko($o.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Hp(n=ls.fromString.apply(ls,Mt([t.path],r)).child(ls.fromString(e))),new ed(t.firestore,null,n)}function rd(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Yt(t),1===arguments.length&&(e=es.u()),$p("doc","path",e),t instanceof Jp)return Gp(n=ls.fromString.apply(ls,Mt([e],r))),new Zp(t,null,new As(n));if(!(t instanceof Zp||t instanceof ed))throw new Ko($o.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Gp(n=t._path.child(ls.fromString.apply(ls,Mt([e],r)))),new Zp(t.firestore,t instanceof ed?t.converter:null,new As(n))}function id(t,e){return t=Yt(t),e=Yt(e),(t instanceof Zp||t instanceof ed)&&(e instanceof Zp||e instanceof ed)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function od(t,e){return t=Yt(t),e=Yt(e),t instanceof td&&e instanceof td&&t.firestore===e.firestore&&Ea(t._query,e._query)&&t.converter===e.converter
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var sd=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=[],this.Zi=new ql(this,"async_queue_retry"),this.Tc=function(){var e=Vl();e&&Ho("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=Vl();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Tc)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ic(),this.Ac(t)},t.prototype.enterRestrictedMode=function(){if(!this._c){this._c=!0;var t=Vl();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Tc)}},t.prototype.enqueue=function(t){return this.Ic(),this._c?new Promise((function(t){})):this.Ac(t)},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.wc.push(t),e.Rc()}))},t.prototype.Rc=function(){return Rt(this,void 0,void 0,(function(){var t,e=this;return Ot(this,(function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!qc(t=n.sent()))throw t;return Ho("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji((function(){return e.Rc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Ac=function(t){var e=this,n=this.dc.then((function(){return e.gc=!0,t().catch((function(t){throw e.yc=t,e.gc=!1,Qo("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.gc=!1,t}))}));return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ic(),this.Ec.indexOf(t)>-1&&(e=0);var i=bf.createAndSchedule(this,t,e,n,(function(t){return r.bc(t)}));return this.mc.push(i),i},t.prototype.Ic=function(){this.yc&&Xo()},t.prototype.verifyOperationInProgress=function(){},t.prototype.vc=function(){return Rt(this,void 0,void 0,(function(){var t;return Ot(this,(function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Pc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Vc=function(t){var e=this;return this.vc().then((function(){e.mc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.vc()}))},t.prototype.Sc=function(t){this.Ec.push(t)},t.prototype.bc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function ad(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var ud=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new sd,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return kt(e,t),e.prototype._terminate=function(){return this._firestoreClient||hd(this),this._firestoreClient.terminate()},e}(Jp);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function cd(t){return t._firestoreClient||hd(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function hd(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new Lp(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Ip(t._credentials,t._queue,r)}function ld(t,e,n){var r=this,i=new Lc;return t.asyncQueue.enqueue((function(){return Rt(r,void 0,void 0,(function(){var r;return Ot(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,_p(t,n)];case 1:return o.sent(),[4,Tp(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===$o.FAILED_PRECONDITION||t.code===$o.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function fd(t){if(t._initialized||t._terminated)throw new Ko($o.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var pd=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Ko($o.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ps(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),dd=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(ys.fromBase64String(e))}catch(e){throw new Ko($o.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(ys.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),yd=function(t){this._methodName=t},gd=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Ko($o.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Ko($o.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return ns(this._lat,t._lat)||ns(this._long,t._long)},t}(),vd=/^__.*__$/,md=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new Za(t,this.data,this.fieldMask,e,this.fieldTransforms):new Ja(t,this.data,e,this.fieldTransforms)},t}(),bd=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new Za(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function wd(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Xo()}}var Ed=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Dc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Cc",{get:function(){return this.settings.Cc},enumerable:!1,configurable:!0}),t.prototype.Nc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.xc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.kc(t),r},t.prototype.$c=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Nc({path:n,Fc:!1});return r.Dc(),r},t.prototype.Oc=function(t){return this.Nc({path:void 0,Fc:!0})},t.prototype.Mc=function(t){return jd(t,this.settings.methodName,this.settings.Lc||!1,this.path,this.settings.Bc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.Dc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.kc(this.path.get(t))},t.prototype.kc=function(t){if(0===t.length)throw this.Mc("Document fields must not be empty");if(wd(this.Cc)&&vd.test(t))throw this.Mc('Document fields cannot begin and end with "__"')},t}(),Id=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||Ul(t)}return t.prototype.qc=function(t,e,n,r){return void 0===r&&(r=!1),new Ed({Cc:t,methodName:e,Bc:n,path:ps.emptyPath(),Fc:!1,Lc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function _d(t){var e=t._freezeSettings(),n=Ul(t._databaseId);return new Id(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Td(t,e,n,r,i,o){void 0===o&&(o={});var s=t.qc(o.merge||o.mergeFields?2:0,e,n,i);Fd("Data must be an object, but it was:",s,r);var a,u,c=Pd(r,s);if(o.merge)a=new ds(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var p=Vd(e,f[l],n);if(!s.contains(p))throw new Ko($o.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Bd(h,p)||h.push(p)}a=new ds(h),u=s.fieldTransforms.filter((function(t){return a.covers(t.field)}))}else a=null,u=s.fieldTransforms;return new md(new js(c),a,u)}var Sd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return kt(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Cc)throw 1===t.Cc?t.Mc(this._methodName+"() can only appear at the top level of your update data"):t.Mc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(yd);function Ad(t,e,n){return new Ed({Cc:3,Bc:e.settings.Bc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var Dd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return kt(e,t),e.prototype._toFieldTransform=function(t){return new Ba(t.path,new La)},e.prototype.isEqual=function(t){return t instanceof e},e}(yd),Nd=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return kt(e,t),e.prototype._toFieldTransform=function(t){var e=Ad(this,t,!0),n=this.Uc.map((function(t){return Ld(t,e)})),r=new Pa(n);return new Ba(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(yd),Cd=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return kt(e,t),e.prototype._toFieldTransform=function(t){var e=Ad(this,t,!0),n=this.Uc.map((function(t){return Ld(t,e)})),r=new Fa(n);return new Ba(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(yd),kd=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return kt(e,t),e.prototype._toFieldTransform=function(t){var e=new Ua(t.R,Ca(t.R,this.Kc));return new Ba(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(yd);function xd(t,e,n,r){var i=t.qc(1,e,n);Fd("Data must be an object, but it was:",i,r);var o=[],s=js.empty();us(r,(function(t,r){var a=qd(e,t,n);r=Yt(r);var u=i.$c(a);if(r instanceof Sd)o.push(a);else{var c=Ld(r,u);null!=c&&(o.push(a),s.set(a,c))}}));var a=new ds(o);return new bd(s,a,i.fieldTransforms)}function Rd(t,e,n,r,i,o){var s=t.qc(1,e,n),a=[Vd(e,r,n)],u=[i];if(o.length%2!=0)throw new Ko($o.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(Vd(e,o[c])),u.push(o[c+1]);for(var h=[],l=js.empty(),f=a.length-1;f>=0;--f)if(!Bd(h,a[f])){var p=a[f],d=u[f];d=Yt(d);var y=s.$c(p);if(d instanceof Sd)h.push(p);else{var g=Ld(d,y);null!=g&&(h.push(p),l.set(p,g))}}var v=new ds(h);return new bd(l,v,s.fieldTransforms)}function Od(t,e,n,r){return void 0===r&&(r=!1),Ld(n,t.qc(r?4:3,e))}function Ld(t,e){if(Md(t=Yt(t)))return Fd("Unsupported field value:",e,t),Pd(t,e);if(t instanceof yd)return function(t,e){if(!wd(e.Cc))throw e.Mc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Mc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&4!==e.Cc)throw e.Mc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Ld(o[i],e.Oc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=Yt(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Ca(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=os.fromDate(t);return{timestampValue:Mu(e.R,n)}}if(t instanceof os)return n=new os(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Mu(e.R,n)};if(t instanceof gd)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof dd)return{bytesValue:Fu(e.R,t._byteString)};if(t instanceof Zp){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Mc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:qu(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Mc("Unsupported field value: "+Qp(t))}(t,e)}function Pd(t,e){var n={};return cs(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):us(t,(function(t,r){var i=Ld(r,e.xc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Md(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof os||t instanceof gd||t instanceof dd||t instanceof Zp||t instanceof yd)}function Fd(t,e,n){if(!Md(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Qp(n);throw"an object"===r?e.Mc(t+" a custom object"):e.Mc(t+" "+r)}}function Vd(t,e,n){if((e=Yt(e))instanceof pd)return e._internalPath;if("string"==typeof e)return qd(t,e);throw jd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Ud=new RegExp("[~\\*/\\[\\]]");function qd(t,e,n){if(e.search(Ud)>=0)throw jd("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(pd.bind.apply(pd,Mt([void 0],e.split(".")))))._internalPath}catch(r){throw jd("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function jd(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new Ko($o.INVALID_ARGUMENT,(a+=". ")+t+u)}function Bd(t,e){return t.some((function(t){return t.isEqual(e)}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var $d=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Zp(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new Kd(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(zd("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),Kd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return kt(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}($d);function zd(t,e){return"string"==typeof e?qd(t,e):e instanceof pd?e._internalPath:e._delegate._internalPath}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Gd=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Hd=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return kt(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new Qd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(zd("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}($d),Qd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return kt(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Hd),Wd=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new Gd(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new Qd(n._firestore,n._userDataWriter,r.key,r,new Gd(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Ko($o.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){return{type:"added",doc:new Qd(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Gd(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new Qd(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Gd(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Yd(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function Yd(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Xo()}}function Xd(t,e){return t instanceof Hd&&e instanceof Hd?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Wd&&e instanceof Wd&&t._firestore===e._firestore&&od(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Jd(t){if(da(t)&&0===t.explicitOrderBy.length)throw new Ko($o.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Zd=function(){};function ty(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var ey=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qc=e,i.jc=n,i.Wc=r,i.type="where",i}return kt(e,t),e.prototype._apply=function(t){var e=_d(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new Ko($o.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){uy(s,o);for(var u=[],c=0,h=s;c<h.length;c++){var l=h[c];u.push(ay(r,t,l))}a={arrayValue:{values:u}}}else a=ay(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||uy(s,o),a=Od(n,"where",s,"in"===o||"not-in"===o);var f=Ws.create(i,o,a);return function(t,e){if(e.g()){var n=ga(t);if(null!==n&&!n.isEqual(e.field))throw new Ko($o.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=ya(t);null!==r&&cy(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new Ko($o.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Ko($o.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t._query,0,e,t.firestore._databaseId,this.Qc,this.jc,this.Wc);return new td(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new ha(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(Zd),ny=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Qc=e,r.Gc=n,r.type="orderBy",r}return kt(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Ko($o.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Ko($o.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new sa(e,n);return function(t,e){if(null===ya(t)){var n=ga(t);null!==n&&cy(t,n,e.field)}}(t,r),r}(t._query,this.Qc,this.Gc);return new td(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new ha(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(Zd),ry=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.zc=n,i.Hc=r,i}return kt(e,t),e.prototype._apply=function(t){return new td(t.firestore,t.converter,wa(t._query,this.zc,this.Hc))},e}(Zd),iy=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return kt(e,t),e.prototype._apply=function(t){var e=sy(t,this.type,this.Jc,this.Yc);return new td(t.firestore,t.converter,function(t,e){return new ha(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(Zd),oy=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return kt(e,t),e.prototype._apply=function(t){var e=sy(t,this.type,this.Jc,this.Yc);return new td(t.firestore,t.converter,function(t,e){return new ha(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(Zd);function sy(t,e,n,r){if(n[0]=Yt(n[0]),n[0]instanceof $d)return function(t,e,n,r,i){if(!r)throw new Ko($o.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=ma(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(Ls(e,r.key));else{var c=r.data.field(u.field);if(ws(c))throw new Ko($o.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.canonicalString();throw new Ko($o.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new ia(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=_d(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new Ko($o.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new Ko($o.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!va(t)&&-1!==c.indexOf("/"))throw new Ko($o.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ls.fromString(c));if(!As.isDocumentKey(h))throw new Ko($o.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new As(h);a.push(Ls(e,l))}else{var f=Od(n,r,c);a.push(f)}}return new ia(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function ay(t,e,n){if("string"==typeof(n=Yt(n))){if(""===n)throw new Ko($o.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!va(e)&&-1!==n.indexOf("/"))throw new Ko($o.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ls.fromString(n));if(!As.isDocumentKey(r))throw new Ko($o.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Ls(t,new As(r))}if(n instanceof Zp)return Ls(t,n._key);throw new Ko($o.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Qp(n)+".")}function uy(t,e){if(!Array.isArray(t)||0===t.length)throw new Ko($o.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Ko($o.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function cy(t,e,n){if(!n.isEqual(e))throw new Ko($o.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var hy=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),Ds(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ms(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(bs(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Xo()}},t.prototype.convertObject=function(t,e){var n=this,r={};return us(t.fields,(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new gd(ms(t.latitude),ms(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=Es(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Is(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=vs(t);return new os(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=ls.fromString(t);Jo(hc(n));var r=new Pp(n.get(1),n.get(3)),i=new As(n.popFirst(5));return r.isEqual(e)||Qo("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ly(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var fy=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return kt(e,t),e.prototype.convertBytes=function(t){return new dd(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Zp(this.firestore,null,e)},e}(hy),py=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=_d(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=dy(t,this._firestore),i=ly(r.converter,e,n),o=Td(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,Ka.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=dy(t,this._firestore);return o="string"==typeof(e=Yt(e))||e instanceof pd?Rd(this._dataReader,"WriteBatch.update",s._key,e,n,r):xd(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,Ka.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=dy(t,this._firestore);return this._mutations=this._mutations.concat(new ou(e._key,Ka.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new Ko($o.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function dy(t,e){if((t=Yt(t)).firestore!==e)throw new Ko($o.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var yy=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return kt(e,t),e.prototype.convertBytes=function(t){return new dd(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Zp(this.firestore,null,e)},e}(hy);function gy(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Wp(t,Zp);var o=Wp(t.firestore,ud),s=_d(o);return my(o,[("string"==typeof(e=Yt(e))||e instanceof pd?Rd(s,"updateDoc",t._key,e,n,r):xd(s,"updateDoc",t._key,e)).toMutation(t._key,Ka.exists(!0))])}function vy(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=Yt(t);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||ad(i[a])||(s=i[a],a++);var u,c,h,l={includeMetadataChanges:s.includeMetadataChanges};if(ad(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof Zp)c=Wp(t.firestore,ud),h=fa(t._key.path),u={next:function(e){i[a]&&i[a](by(c,t,e))},error:i[a+1],complete:i[a+2]};else{var p=Wp(t,td);c=Wp(p.firestore,ud),h=p._query;var d=new yy(c);u={next:function(t){i[a]&&i[a](new Wd(c,d,p,t))},error:i[a+1],complete:i[a+2]},Jd(t._query)}return function(t,e,n,r){var i=this,o=new bp(r),s=new xf(e,o,n);return t.asyncQueue.enqueueAndForget((function(){return Rt(i,void 0,void 0,(function(){var e;return Ot(this,(function(n){switch(n.label){case 0:return e=Af,[4,xp(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))})),function(){o.Wo(),t.asyncQueue.enqueueAndForget((function(){return Rt(i,void 0,void 0,(function(){var e;return Ot(this,(function(n){switch(n.label){case 0:return e=Df,[4,xp(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))}))}}(cd(c),h,l,u)}function my(t,e){return function(t,e){var n=this,r=new Lc;return t.asyncQueue.enqueueAndForget((function(){return Rt(n,void 0,void 0,(function(){var n;return Ot(this,(function(i){switch(i.label){case 0:return n=jf,[4,kp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(cd(t),e)}function by(t,e,n){var r=n.docs.get(e._key),i=new yy(t);return new Hd(t,i,e._key,r,new Gd(n.hasPendingWrites,n.fromCache),e.converter)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var wy=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return kt(e,t),e.prototype.get=function(e){var n=this,r=dy(e,this._firestore),i=new yy(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new Hd(n._firestore,i,r._key,t._document,new Gd(!1,!1),r.converter)}))},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=_d(t)}return t.prototype.get=function(t){var e=this,n=dy(t,this._firestore),r=new fy(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return Xo();var i=t[0];if(i.isFoundDocument())return new $d(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new $d(e._firestore,r,n._key,null,n.converter);throw Xo()}))},t.prototype.set=function(t,e,n){var r=dy(t,this._firestore),i=ly(r.converter,e,n),o=Td(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=dy(t,this._firestore);return o="string"==typeof(e=Yt(e))||e instanceof pd?Rd(this._dataReader,"Transaction.update",s._key,e,n,r):xd(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=dy(t,this._firestore);return this._transaction.delete(e._key),this},t}());
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ey(){if("undefined"==typeof Uint8Array)throw new Ko($o.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Iy(){if("undefined"==typeof atob)throw new Ko($o.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var _y=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return Iy(),new t(dd.fromBase64String(e))},t.fromUint8Array=function(e){return Ey(),new t(dd.fromUint8Array(e))},t.prototype.toBase64=function(){return Iy(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return Ey(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),Ty=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){fd(t=Wp(t,ud));var n=cd(t),r=t._freezeSettings(),i=new mp;return ld(n,i,new gp(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){fd(t=Wp(t,ud));var e=cd(t),n=t._freezeSettings(),r=new mp;return ld(e,r,new vp(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new Ko($o.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Lc;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return Rt(e,void 0,void 0,(function(){var e;return Ot(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Rt(this,void 0,void 0,(function(){var e;return Ot(this,(function(n){switch(n.label){case 0:return Fc.yt()?(e=t+"main",[4,Fc.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(Qh(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),Sy=function(){function t(t,e,n){var r=this;this._delegate=e,this.Xc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof Pp||(this.Zc=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||Wo("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var i=(t=Wp(t,Jp))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==e&&Wo("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:e+":"+n,ssl:!1})),r.mockUserToken){var o=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var o=xt({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Ft.encodeString(JSON.stringify({alg:"none",type:"JWT"}),!1),Ft.encodeString(JSON.stringify(o),!1),""].join(".")}(r.mockUserToken),s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new Ko($o.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new Up(new Fp(o,new El(s)))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return Rt(e,void 0,void 0,(function(){var e,n;return Ot(this,(function(r){switch(r.label){case 0:return[4,Dp(t)];case 1:return e=r.sent(),[4,Cp(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=Zo(t);return e.Or.delete(0),Hl(e)}(n))]}}))}))}))}(cd(Wp(this._delegate,ud)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return Rt(e,void 0,void 0,(function(){var e,n;return Ot(this,(function(r){switch(r.label){case 0:return[4,Dp(t)];case 1:return e=r.sent(),[4,Cp(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return Rt(this,void 0,void 0,(function(){var e;return Ot(this,(function(n){switch(n.label){case 0:return(e=Zo(t)).Or.add(0),[4,Ql(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(cd(Wp(this._delegate,ud)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&zp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Xc.enableMultiTabIndexedDbPersistence(this):this.Xc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Xc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.Zc&&(this.Zc._removeServiceInstance("firestore"),this.Zc._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Lc;return t.asyncQueue.enqueueAndForget((function(){return Rt(e,void 0,void 0,(function(){var e;return Ot(this,(function(r){switch(r.label){case 0:return e=Hf,[4,kp(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(cd(Wp(this._delegate,ud)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new bp(e);return t.asyncQueue.enqueueAndForget((function(){return Rt(n,void 0,void 0,(function(){var e;return Ot(this,(function(n){switch(n.label){case 0:return e=function(t,e){Zo(t).Gr.add(e),e.next()},[4,xp(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Wo(),t.asyncQueue.enqueueAndForget((function(){return Rt(n,void 0,void 0,(function(){var e;return Ot(this,(function(n){switch(n.label){case 0:return e=function(t,e){Zo(t).Gr.delete(e)},[4,xp(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(cd(t=Wp(t,ud)),ad(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.Zc)throw new Ko($o.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Zc},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Uy(this,nd(this._delegate,t))}catch(t){throw xy(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new ky(this,rd(this._delegate,t))}catch(t){throw xy(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new My(this,function(t,e){if(t=Wp(t,Jp),$p("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Ko($o.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new td(t,null,function(t){return new ha(ls.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw xy(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Lc;return t.asyncQueue.enqueueAndForget((function(){return Rt(n,void 0,void 0,(function(){var n;return Ot(this,(function(i){switch(i.label){case 0:return[4,function(t){return Ap(t).then((function(t){return t.datastore}))}(t)];case 1:return n=i.sent(),new Ep(t.asyncQueue,n,e,r).run(),[2]}}))}))})),r.promise}(cd(t),(function(n){return e(new wy(t,n))}))}(this._delegate,(function(n){return t(new Dy(e,n))}))},t.prototype.batch=function(){var t=this;return cd(this._delegate),new Ny(new py(this._delegate,(function(e){return my(t._delegate,e)})))},t.prototype.loadBundle=function(t){throw new Ko($o.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new Ko($o.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),Ay=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return kt(e,t),e.prototype.convertBytes=function(t){return new _y(new dd(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return ky.tu(e,this.firestore,null)},e}(hy);var Dy=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Ay(t)}return t.prototype.get=function(t){var e=this,n=qy(t);return this._delegate.get(n).then((function(t){return new Ly(e._firestore,new Hd(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))}))},t.prototype.set=function(t,e,n){var r=qy(t);return n?(Kp("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=qy(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Mt([s,e,n],i)),this},t.prototype.delete=function(t){var e=qy(t);return this._delegate.delete(e),this},t}(),Ny=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=qy(t);return n?(Kp("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=qy(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Mt([s,e,n],i)),this},t.prototype.delete=function(t){var e=qy(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),Cy=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new Qd(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Py(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.eu=function(e,n){var r=t.nu,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new Ay(e),n),i.set(n,o)),o},t}();Cy.nu=new WeakMap;var ky=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Ay(t)}return t.su=function(e,n,r){if(e.length%2!=0)throw new Ko($o.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new Zp(n._delegate,r,new As(e)))},t.tu=function(e,n,r){return new t(n,new Zp(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Uy(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Uy(this.firestore,nd(this._delegate,t))}catch(t){throw xy(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=Yt(t))instanceof Zp&&id(this._delegate,t)},t.prototype.set=function(t,e){e=Kp("DocumentReference.set",e);try{return function(t,e,n){t=Wp(t,Zp);var r=Wp(t.firestore,ud),i=ly(t.converter,e,n);return my(r,[Td(_d(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,Ka.none())])}(this._delegate,t,e)}catch(t){throw xy(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?gy(this._delegate,t):gy.apply(void 0,Mt([this._delegate,t,e],n))}catch(t){throw xy(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return my(Wp((t=this._delegate).firestore,ud),[new ou(t._key,Ka.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Ry(e),i=Oy(e,(function(e){return new Ly(t.firestore,new Hd(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}));return vy(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Wp(t,Zp);var e=Wp(t.firestore,ud),n=cd(e),r=new yy(e);return function(t,e){var n=this,r=new Lc;return t.asyncQueue.enqueueAndForget((function(){return Rt(n,void 0,void 0,(function(){var n;return Ot(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Rt(this,void 0,void 0,(function(){var r,i;return Ot(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=Zo(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Mn.mn(t,e)}))}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new Ko($o.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=wf(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,Np(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._key).then((function(n){return new Hd(e,r,t._key,n,new Gd(null!==n&&n.hasLocalMutations,!0),t.converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Wp(t,Zp);var e=Wp(t.firestore,ud);return Rp(cd(e),t._key,{source:"server"}).then((function(n){return by(e,t,n)}))}(this._delegate):function(t){t=Wp(t,Zp);var e=Wp(t.firestore,ud);return Rp(cd(e),t._key).then((function(n){return by(e,t,n)}))}(this._delegate)).then((function(t){return new Ly(e.firestore,new Hd(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}))},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Cy.eu(this.firestore,e)):this._delegate.withConverter(null))},t}();function xy(t,e,n){return t.message=t.message.replace(e,n),t}function Ry(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!ad(r))return r}return{}}function Oy(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=ad(t[0])?t[0]:ad(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Ly=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new ky(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return Xd(this._delegate,t._delegate)},t}(),Py=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return kt(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(Ly),My=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Ay(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,ty(this._delegate,function(t,e,n){var r=e,i=zd("where",t);return new ey(i,r,n)}(e,n,r)))}catch(e){throw xy(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,ty(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=zd("orderBy",t);return new ny(r,n)}(e,n)))}catch(e){throw xy(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,ty(this._delegate,function(t){return Yp("limit",t),new ry("limit",t,"F")}(e)))}catch(e){throw xy(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,ty(this._delegate,function(t){return Yp("limitToLast",t),new ry("limitToLast",t,"L")}(e)))}catch(e){throw xy(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,ty(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new iy("startAt",t,!0)}.apply(void 0,e)))}catch(e){throw xy(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,ty(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new iy("startAfter",t,!1)}.apply(void 0,e)))}catch(e){throw xy(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,ty(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new oy("endBefore",t,!0)}.apply(void 0,e)))}catch(e){throw xy(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,ty(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new oy("endAt",t,!1)}.apply(void 0,e)))}catch(e){throw xy(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return od(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Wp(t,td);var e=Wp(t.firestore,ud),n=cd(e),r=new yy(e);return function(t,e){var n=this,r=new Lc;return t.asyncQueue.enqueueAndForget((function(){return Rt(n,void 0,void 0,(function(){var n;return Ot(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Rt(this,void 0,void 0,(function(){var r,i,o,s,a;return Ot(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,al(t,e,!0)];case 1:return a=u.sent(),r=new Lf(e,a.Bn),i=r._o(a.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=u.sent(),a=wf(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}}))}))},[4,Np(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._query).then((function(n){return new Wd(e,r,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Wp(t,td);var e=Wp(t.firestore,ud),n=cd(e),r=new yy(e);return Op(n,t._query,{source:"server"}).then((function(n){return new Wd(e,r,t,n)}))}(this._delegate):function(t){t=Wp(t,td);var e=Wp(t.firestore,ud),n=cd(e),r=new yy(e);return Jd(t._query),Op(n,t._query).then((function(n){return new Wd(e,r,t,n)}))}(this._delegate)).then((function(t){return new Vy(e.firestore,new Wd(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Ry(e),i=Oy(e,(function(e){return new Vy(t.firestore,new Wd(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return vy(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Cy.eu(this.firestore,e)):this._delegate.withConverter(null))},t}(),Fy=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new Py(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),Vy=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new My(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new Py(t._firestore,e)}))},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new Fy(e._firestore,t)}))},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new Py(n._firestore,r))}))},t.prototype.isEqual=function(t){return Xd(this._delegate,t._delegate)},t}(),Uy=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return kt(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new ky(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new ky(this.firestore,void 0===t?rd(this._delegate):rd(this._delegate,t))}catch(t){throw xy(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Wp(t.firestore,ud),r=rd(t),i=ly(t.converter,e);return my(n,[Td(_d(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,Ka.exists(!1))]).then((function(){return r}))}(this._delegate,t).then((function(t){return new ky(e.firestore,t)}))},e.prototype.isEqual=function(t){return id(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(Cy.eu(this.firestore,t)):this._delegate.withConverter(null))},e}(My);function qy(t){return Wp(t,Zp)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var jy,By=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(pd.bind.apply(pd,Mt([void 0],t)))}return t.documentId=function(){return new t(ps.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=Yt(t))instanceof pd&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),$y=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new Dd("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new Sd("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Nd("arrayUnion",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Cd("arrayRemove",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new kd("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),Ky={Firestore:Sy,GeoPoint:gd,Timestamp:os,Blob:_y,Transaction:Dy,WriteBatch:Ny,DocumentReference:ky,DocumentSnapshot:Ly,Query:My,QueryDocumentSnapshot:Py,QuerySnapshot:Vy,CollectionReference:Uy,FieldPath:By,FieldValue:$y,setLogLevel:function(t){var e;e=t,zo.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new Xt("firestore",(function(t){return function(t,e){return new Sy(t,new ud(t,e),new Ty)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},Ky)))})(jy=Se),jy.registerVersion("@firebase/firestore","2.3.8");Se.initializeApp({projectId:"sample-project-294713"});const zy=function(){const t=window.location.search;let e;if(t)e=t.substring(1);else{const t=Nt();window.location.hash=t,window.history.replaceState("","","?"+t),e=t}return e}(),Gy=Se.firestore().collection("rooms").doc(zy),Hy=function(){const{subscribe:t,set:e}=wt([]);return{subscribe:t,set:e,append:(t,e)=>{Gy.get().then((n=>{let r=[],i={closed:!0};if(n&&n.exists){const e=n.data();r=[...e.estimates.filter((e=>e.name!==t))],i=e.tableState}r.push({name:t,point:e,appendedAt:Se.firestore.Timestamp.now()}),Gy.set({estimates:r,tableState:i})}))},remove:(t,e=null)=>{Gy.get().then((n=>{if(n&&n.exists){const r=n.data();r.estimates=r.estimates.filter((e=>e.name!==t)),Gy.set(r).then(e)}else e()}))},clear:()=>{Gy.delete()}}}(),Qy=function(){const{subscribe:t,set:e,update:n}=wt({closed:!0});return{subscribe:t,set:e,open:()=>{Gy.get().then((t=>{if(t&&t.exists){const e=t.data();e.tableState={closed:!1},Gy.set(e)}}))},close:()=>{Gy.delete()}}}(),Wy=new Promise((t=>{Gy.onSnapshot((t=>{if(t&&t.exists){const e=t.data(),n=(t,e)=>t.appendedAt.seconds-e.appendedAt.seconds;Hy.set(e.estimates.sort(n)),Qy.set(e.tableState)}else Hy.set([]),Qy.set({closed:!0})})),t()}));function Yy(e){let n,r,i,o,s=(e[2]?"":e[0])+"";return{c(){n=_("div"),r=T(s),N(n,"class","card svelte-tq9sw8"),R(n,"closed",e[2]),R(n,"selected",e[1])},m(t,s){E(t,n,s),w(n,r),i||(o=A(n,"click",e[3]),i=!0)},p(t,[e]){5&e&&s!==(s=(t[2]?"":t[0])+"")&&C(r,s),4&e&&R(n,"closed",t[2]),2&e&&R(n,"selected",t[1])},i:t,o:t,d(t){t&&I(n),i=!1,o()}}}function Xy(t,e,n){let{point:r}=e,{selected:i=!1}=e,{closed:o=!1}=e;const s=function(){const t=q();return(e,n)=>{const r=t.$$.callbacks[e];if(r){const i=O(e,n);r.slice().forEach((e=>{e.call(t,i)}))}}}();return t.$$set=t=>{"point"in t&&n(0,r=t.point),"selected"in t&&n(1,i=t.selected),"closed"in t&&n(2,o=t.closed)},[r,i,o,function(){s("selectCard",{point:r})}]}class Jy extends gt{constructor(t){super(),yt(this,t,Xy,Yy,a,{point:0,selected:1,closed:2})}}function Zy(t){let e,n,r,i,o;const s=t[3].default,a=function(t,e,n,r){if(t){const i=c(t,e,n,r);return t[0](i)}}(s,t,t[2],null);return{c(){e=_("button"),a&&a.c(),N(e,"class",n=f(t[1].class)+" svelte-xozke3"),e.disabled=t[0]},m(n,s){E(n,e,s),a&&a.m(e,null),r=!0,i||(o=A(e,"click",t[4]),i=!0)},p(t,[i]){a&&a.p&&(!r||4&i)&&h(a,s,t,t[2],r?i:-1,null,null),(!r||2&i&&n!==(n=f(t[1].class)+" svelte-xozke3"))&&N(e,"class",n),(!r||1&i)&&(e.disabled=t[0])},i(t){r||(ot(a,t),r=!0)},o(t){st(a,t),r=!1},d(t){t&&I(e),a&&a.d(t),i=!1,o()}}}function tg(t,e,r){let{$$slots:i={},$$scope:o}=e,{disabled:s=!1}=e;return t.$$set=t=>{r(1,e=n(n({},e),l(t))),"disabled"in t&&r(0,s=t.disabled),"$$scope"in t&&r(2,o=t.$$scope)},e=l(e),[s,e,o,i,function(e){j.call(this,t,e)}]}class eg extends gt{constructor(t){super(),yt(this,t,tg,Zy,a,{disabled:0})}}function ng(t,e,n){const r=t.slice();return r[6]=e[n],r}function rg(t,e){let n,r,i,o,s,a,u,c,h=e[6].name+"";return r=new Jy({props:{point:e[6].point,closed:e[1].closed}}),{key:t,first:null,c(){n=_("div"),lt(r.$$.fragment),i=S(),o=_("div"),s=T(h),a=S(),N(o,"class","name svelte-1nazvb7"),N(n,"class","estimate svelte-1nazvb7"),this.first=n},m(t,e){E(t,n,e),ft(r,n,null),w(n,i),w(n,o),w(o,s),w(n,a),c=!0},p(t,n){e=t;const i={};4&n&&(i.point=e[6].point),2&n&&(i.closed=e[1].closed),r.$set(i),(!c||4&n)&&h!==(h=e[6].name+"")&&C(s,h)},i(t){c||(ot(r.$$.fragment,t),Q((()=>{u||(u=ut(n,mt,{y:100},!0)),u.run(1)})),c=!0)},o(t){st(r.$$.fragment,t),u||(u=ut(n,mt,{y:100},!1)),u.run(0),c=!1},d(t){t&&I(n),pt(r),t&&u&&u.end()}}}function ig(t){let e,n,r;return n=new eg({props:{class:"open-button",$$slots:{default:[og]},$$scope:{ctx:t}}}),n.$on("click",t[3]),{c(){e=_("div"),lt(n.$$.fragment),N(e,"class","open-button-area svelte-1nazvb7")},m(t,i){E(t,e,i),ft(n,e,null),r=!0},p(t,e){const r={};514&e&&(r.$$scope={dirty:e,ctx:t}),n.$set(r)},i(t){r||(ot(n.$$.fragment,t),r=!0)},o(t){st(n.$$.fragment,t),r=!1},d(t){t&&I(e),pt(n)}}}function og(t){let e,n=t[1].closed?"OPEN":"RETURN";return{c(){e=T(n)},m(t,n){E(t,e,n)},p(t,r){2&r&&n!==(n=t[1].closed?"OPEN":"RETURN")&&C(e,n)},d(t){t&&I(e)}}}function sg(t){let e,n;return e=new eg({props:{class:"copy-button",$$slots:{default:[ag]},$$scope:{ctx:t}}}),e.$on("click",t[4]),{c(){lt(e.$$.fragment)},m(t,r){ft(e,t,r),n=!0},p(t,n){const r={};513&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ot(e.$$.fragment,t),n=!0)},o(t){st(e.$$.fragment,t),n=!1},d(t){pt(e,t)}}}function ag(t){let e;return{c(){e=T(t[0])},m(t,n){E(t,e,n)},p(t,n){1&n&&C(e,t[0])},d(t){t&&I(e)}}}function ug(t){let e,n,r,i,o,s=[],a=new Map,u=t[2];const c=t=>t[6].name;for(let e=0;e<u.length;e+=1){let n=ng(t,u,e),r=c(n);a.set(r,s[e]=rg(r,n))}let h=(t[2].length>0||!t[1].closed)&&ig(t),l=!t[1].closed&&sg(t);return{c(){e=_("div"),n=_("div");for(let t=0;t<s.length;t+=1)s[t].c();r=S(),h&&h.c(),i=S(),l&&l.c(),N(n,"class","estimates svelte-1nazvb7"),N(e,"class","table svelte-1nazvb7")},m(t,a){E(t,e,a),w(e,n);for(let t=0;t<s.length;t+=1)s[t].m(n,null);w(e,r),h&&h.m(e,null),w(e,i),l&&l.m(e,null),o=!0},p(t,[r]){6&r&&(u=t[2],rt(),s=function(t,e,n,r,i,o,s,a,u,c,h,l){let f=t.length,p=o.length,d=f;const y={};for(;d--;)y[t[d].key]=d;const g=[],v=new Map,m=new Map;for(d=p;d--;){const t=l(i,o,d),a=n(t);let u=s.get(a);u?r&&u.p(t,e):(u=c(a,t),u.c()),v.set(a,g[d]=u),a in y&&m.set(a,Math.abs(d-y[a]))}const b=new Set,w=new Set;function E(t){ot(t,1),t.m(a,h),s.set(t.key,t),h=t.first,p--}for(;f&&p;){const e=g[p-1],n=t[f-1],r=e.key,i=n.key;e===n?(h=e.first,f--,p--):v.has(i)?!s.has(r)||b.has(r)?E(e):w.has(i)?f--:m.get(r)>m.get(i)?(w.add(r),E(e)):(b.add(i),f--):(u(n,s),f--)}for(;f--;){const e=t[f];v.has(e.key)||u(e,s)}for(;p;)E(g[p-1]);return g}(s,r,c,1,t,u,a,n,ht,rg,null,ng),it()),t[2].length>0||!t[1].closed?h?(h.p(t,r),6&r&&ot(h,1)):(h=ig(t),h.c(),ot(h,1),h.m(e,i)):h&&(rt(),st(h,1,1,(()=>{h=null})),it()),t[1].closed?l&&(rt(),st(l,1,1,(()=>{l=null})),it()):l?(l.p(t,r),2&r&&ot(l,1)):(l=sg(t),l.c(),ot(l,1),l.m(e,null))},i(t){if(!o){for(let t=0;t<u.length;t+=1)ot(s[t]);ot(h),ot(l),o=!0}},o(t){for(let t=0;t<s.length;t+=1)st(s[t]);st(h),st(l),o=!1},d(t){t&&I(e);for(let t=0;t<s.length;t+=1)s[t].d();h&&h.d(),l&&l.d()}}}function cg(t,e,n){let r,i;u(t,Qy,(t=>n(1,r=t))),u(t,Hy,(t=>n(2,i=t)));let o="COPY";return[o,r,i,function(t){r.closed?i.length>0&&Qy.open():(Hy.clear(),Qy.close())},function(t){const e=function(){if(0===i.length)return"empty.";const t=new Date;return"["+t.toLocaleDateString()+" "+t.toLocaleTimeString()+"] "+i.sort(((t,e)=>t.name>e.name?1:-1)).reduce(((t,e)=>(t?t+" ":"")+`${e.name}(${e.point})`),null)}();navigator.clipboard.writeText(e),t.target.classList.add("copied"),t.target.disabled=!0;const r=o;n(0,o="COPIED!"),setTimeout((()=>{t.target.classList.remove("copied"),t.target.disabled=!1,n(0,o=r)}),2e3)}]}class hg extends gt{constructor(t){super(),yt(this,t,cg,ug,a,{})}}function lg(t,e,n){const r=t.slice();return r[8]=e[n],r}function fg(t){let e,n,r,i,s,a,u,c=t[1]&&dg(t);return{c(){e=_("div"),n=_("form"),r=_("input"),i=S(),c&&c.c(),N(r,"placeholder","your name"),r.autofocus=!0,N(r,"class","svelte-1pf8moc"),N(e,"class","user-name svelte-1pf8moc")},m(o,h){E(o,e,h),w(e,n),w(n,r),k(r,t[1]),w(n,i),c&&c.m(n,null),s=!0,r.focus(),a||(u=[A(r,"input",t[7]),A(n,"submit",D(t[4]))],a=!0)},p(t,e){2&e&&r.value!==t[1]&&k(r,t[1]),t[1]?c?(c.p(t,e),2&e&&ot(c,1)):(c=dg(t),c.c(),ot(c,1),c.m(n,null)):c&&(rt(),st(c,1,1,(()=>{c=null})),it())},i(t){s||(ot(c),s=!0)},o(t){st(c),s=!1},d(t){t&&I(e),c&&c.d(),a=!1,o(u)}}}function pg(t){let e,n,r,i,o,s=t[3],a=[];for(let e=0;e<s.length;e+=1)a[e]=gg(lg(t,s,e));const u=t=>st(a[t],1,1,(()=>{a[t]=null}));return{c(){e=_("div"),n=T(t[0]),r=S();for(let t=0;t<a.length;t+=1)a[t].c();i=T(""),N(e,"class","user-name svelte-1pf8moc")},m(t,s){E(t,e,s),w(e,n),E(t,r,s);for(let e=0;e<a.length;e+=1)a[e].m(t,s);E(t,i,s),o=!0},p(t,e){if((!o||1&e)&&C(n,t[0]),44&e){let n;for(s=t[3],n=0;n<s.length;n+=1){const r=lg(t,s,n);a[n]?(a[n].p(r,e),ot(a[n],1)):(a[n]=gg(r),a[n].c(),ot(a[n],1),a[n].m(i.parentNode,i))}for(rt(),n=s.length;n<a.length;n+=1)u(n);it()}},i(t){if(!o){for(let t=0;t<s.length;t+=1)ot(a[t]);o=!0}},o(t){a=a.filter(Boolean);for(let t=0;t<a.length;t+=1)st(a[t]);o=!1},d(t){t&&I(e),t&&I(r),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(a,t),t&&I(i)}}}function dg(t){let e,n;return e=new eg({props:{class:"ok-button",$$slots:{default:[yg]},$$scope:{ctx:t}}}),e.$on("click",t[4]),{c(){lt(e.$$.fragment)},m(t,r){ft(e,t,r),n=!0},p(t,n){const r={};2048&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ot(e.$$.fragment,t),n=!0)},o(t){st(e.$$.fragment,t),n=!1},d(t){pt(e,t)}}}function yg(t){let e;return{c(){e=T("OK")},m(t,n){E(t,e,n)},d(t){t&&I(e)}}}function gg(t){let e,n;return e=new Jy({props:{point:t[8],selected:t[2]===t[8]}}),e.$on("selectCard",t[5]),{c(){lt(e.$$.fragment)},m(t,r){ft(e,t,r),n=!0},p(t,n){const r={};4&n&&(r.selected=t[2]===t[8]),e.$set(r)},i(t){n||(ot(e.$$.fragment,t),n=!0)},o(t){st(e.$$.fragment,t),n=!1},d(t){pt(e,t)}}}function vg(t){let e,n,r,i;const o=[pg,fg],s=[];function a(t,e){return t[0]?0:1}return n=a(t),r=s[n]=o[n](t),{c(){e=_("div"),r.c(),N(e,"class","svelte-1pf8moc")},m(t,r){E(t,e,r),s[n].m(e,null),i=!0},p(t,[i]){let u=n;n=a(t),n===u?s[n].p(t,i):(rt(),st(s[u],1,1,(()=>{s[u]=null})),it(),r=s[n],r?r.p(t,i):(r=s[n]=o[n](t),r.c()),ot(r,1),r.m(e,null))},i(t){i||(ot(r),i=!0)},o(t){st(r),i=!1},d(t){t&&I(e),s[n].d()}}}function mg(t,e,n){let r,i;u(t,Hy,(t=>n(6,i=t)));let o,s=window.localStorage.name;return t.$$.update=()=>{65&t.$$.dirty&&n(2,r=i.filter((t=>t.name===o)).map((t=>t.point)).pop())},[o,s,r,["0","1","2","3","5","8","13","21","34","55","?",""],function(t){s&&(n(0,o=s),window.localStorage.setItem("name",o))},function(t){const e=()=>Hy.append(o,t.detail.point);r?Hy.remove(o,r===t.detail.point?null:()=>setTimeout(e,300)):e()},i,function(){s=this.value,n(1,s)}]}class bg extends gt{constructor(t){super(),yt(this,t,mg,vg,a,{})}}function wg(e){let n;return{c(){n=_("div"),n.innerHTML='<a href="https://unsplash.com" target="_blank" rel="noopener noreferrer" title="Photo by Unsplash"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="_1Jlgk" version="1.1" viewBox="0 0 32 32" aria-labelledby="unsplash-home" aria-hidden="false"><path d="M10 9V0h12v9H10zm12 5h10v18H0V14h10v9h12v-9z"></path></svg></a>',N(n,"class","unsplash-credit svelte-1vmngv8")},m(t,e){E(t,n,e)},p:t,i:t,o:t,d(t){t&&I(n)}}}class Eg extends gt{constructor(t){super(),yt(this,t,null,wg,a,{})}}const{document:Ig}=ct;function _g(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function Tg(t){let e,n,r,i,o,s,a,u,c;return s=new hg({}),u=new bg({}),{c(){e=_("h1"),n=T(t[0]),r=S(),i=_("p"),i.textContent="share the URL of this page with your team members.",o=S(),lt(s.$$.fragment),a=S(),lt(u.$$.fragment),N(e,"class","svelte-1d5hlxr"),N(i,"class","svelte-1d5hlxr")},m(t,h){E(t,e,h),w(e,n),E(t,r,h),E(t,i,h),E(t,o,h),ft(s,t,h),E(t,a,h),ft(u,t,h),c=!0},p(t,e){(!c||1&e)&&C(n,t[0])},i(t){c||(ot(s.$$.fragment,t),ot(u.$$.fragment,t),c=!0)},o(t){st(s.$$.fragment,t),st(u.$$.fragment,t),c=!1},d(t){t&&I(e),t&&I(r),t&&I(i),t&&I(o),pt(s,t),t&&I(a),pt(u,t)}}}function Sg(e){let n;return{c(){n=_("p"),n.textContent="...waiting",N(n,"class","svelte-1d5hlxr")},m(t,e){E(t,n,e)},p:t,i:t,o:t,d(t){t&&I(n)}}}function Ag(t){let e,n,r,i,s,a,u,c,h;Ig.title=e=t[0];let l={ctx:t,current:null,token:null,hasCatch:!1,pending:Sg,then:Tg,catch:_g,blocks:[,,,]};return function(t,e){const n=e.token={};function r(t,r,i,o){if(e.token!==n)return;e.resolved=o;let s=e.ctx;void 0!==i&&(s=s.slice(),s[i]=o);const a=t&&(e.current=t)(s);let u=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==r&&t&&(rt(),st(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),it())})):e.block.d(1),a.c(),ot(a,1),a.m(e.mount(),e.anchor),u=!0),e.block=a,e.blocks&&(e.blocks[r]=a),u&&X()}if((i=t)&&"object"==typeof i&&"function"==typeof i.then){const n=q();if(t.then((t=>{U(n),r(e.then,1,e.value,t),U(null)}),(t=>{if(U(n),r(e.catch,2,e.error,t),U(null),!e.hasCatch)throw t})),e.current!==e.pending)return r(e.pending,0),!0}else{if(e.current!==e.then)return r(e.then,1,e.value,t),!0;e.resolved=t}var i}(Wy,l),a=new Eg({}),{c(){n=_("link"),r=S(),i=_("main"),l.block.c(),s=S(),lt(a.$$.fragment),N(n,"href","https://fonts.googleapis.com/css?family=M+PLUS+1p"),N(n,"rel","stylesheet"),x(i,"height",t[1]),N(i,"class","svelte-1d5hlxr")},m(e,o){w(Ig.head,n),E(e,r,o),E(e,i,o),l.block.m(i,l.anchor=null),l.mount=()=>i,l.anchor=null,E(e,s,o),ft(a,e,o),u=!0,c||(h=[A(window,"resize",t[2]),A(window,"load",t[2])],c=!0)},p(n,[r]){t=n,(!u||1&r)&&e!==(e=t[0])&&(Ig.title=e),function(t,e,n){const r=e.slice(),{resolved:i}=t;t.current===t.then&&(r[t.value]=i),t.current===t.catch&&(r[t.error]=i),t.block.p(r,n)}(l,t,r),(!u||2&r)&&x(i,"height",t[1])},i(t){u||(ot(l.block),ot(a.$$.fragment,t),u=!0)},o(t){for(let t=0;t<3;t+=1){st(l.blocks[t])}st(a.$$.fragment,t),u=!1},d(t){I(n),t&&I(r),t&&I(i),l.block.d(),l.token=null,l=null,t&&I(s),pt(a,t),c=!1,o(h)}}}function Dg(t,e,n){let{name:r}=e,i=null;return t.$$set=t=>{"name"in t&&n(0,r=t.name)},[r,i,()=>{n(1,i=document.documentElement.offsetHeight<document.documentElement.scrollHeight?"auto":"100%")}]}return new class extends gt{constructor(t){super(),yt(this,t,Dg,Ag,a,{name:0})}}({target:document.body,props:{name:"Planning Poker"}})}();
//# sourceMappingURL=bundle.js.map
