var app=function(){"use strict";function t(){}const e=t=>t;function n(t){return t()}function r(){return Object.create(null)}function i(t){t.forEach(n)}function o(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function a(e,n,r){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function u(t){return null==t?"":t}const c="undefined"!=typeof window;let h=c?()=>window.performance.now():()=>Date.now(),l=c?t=>requestAnimationFrame(t):t;const f=new Set;function p(t){f.forEach((e=>{e.c(t)||(f.delete(e),e.f())})),0!==f.size&&l(p)}function d(t,e){t.appendChild(e)}function y(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function g(t){const e=b("style");return function(t,e){d(t.head||t,e)}(y(t),e),e}function v(t,e,n){t.insertBefore(e,n||null)}function m(t){t.parentNode.removeChild(t)}function b(t){return document.createElement(t)}function w(t){return document.createTextNode(t)}function E(){return w(" ")}function I(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function T(t){return function(e){return e.preventDefault(),t.call(this,e)}}function _(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function S(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function A(t,e){t.value=null==e?"":e}function N(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}function D(t,e,n){t.classList[n?"add":"remove"](e)}function C(t,e,n=!1){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,!1,e),r}const k=new Set;let x,R=0;function O(t,e,n,r,i,o,s,a=0){const u=16.666/r;let c="{\n";for(let t=0;t<=1;t+=u){const r=e+(n-e)*o(t);c+=100*t+`%{${s(r,1-r)}}\n`}const h=c+`100% {${s(n,1-n)}}\n}`,l=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(h)}_${a}`,f=y(t);k.add(f);const p=f.__svelte_stylesheet||(f.__svelte_stylesheet=g(t).sheet),d=f.__svelte_rules||(f.__svelte_rules={});d[l]||(d[l]=!0,p.insertRule(`@keyframes ${l} ${h}`,p.cssRules.length));const v=t.style.animation||"";return t.style.animation=`${v?`${v}, `:""}${l} ${r}ms linear ${i}ms 1 both`,R+=1,l}function L(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),i=n.length-r.length;i&&(t.style.animation=r.join(", "),R-=i,R||l((()=>{R||(k.forEach((t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}})),k.clear())})))}function P(t){x=t}function F(){if(!x)throw new Error("Function called outside component initialization");return x}function M(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const V=[],U=[],q=[],j=[],B=Promise.resolve();let K=!1;function z(t){q.push(t)}let $=!1;const G=new Set;function H(){if(!$){$=!0;do{for(let t=0;t<V.length;t+=1){const e=V[t];P(e),Q(e.$$)}for(P(null),V.length=0;U.length;)U.pop()();for(let t=0;t<q.length;t+=1){const e=q[t];G.has(e)||(G.add(e),e())}q.length=0}while(V.length);for(;j.length;)j.pop()();K=!1,$=!1,G.clear()}}function Q(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(z)}}let W;function Y(t,e,n){t.dispatchEvent(C(`${e?"intro":"outro"}${n}`))}const X=new Set;let J;function Z(){J={r:0,c:[],p:J}}function tt(){J.r||i(J.c),J=J.p}function et(t,e){t&&t.i&&(X.delete(t),t.i(e))}function nt(t,e,n,r){if(t&&t.o){if(X.has(t))return;X.add(t),J.c.push((()=>{X.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}const rt={duration:0};function it(n,r,s,a){let u=r(n,s),c=a?0:1,d=null,y=null,g=null;function v(){g&&L(n,g)}function m(t,e){const n=t.b-c;return e*=Math.abs(n),{a:c,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function b(r){const{delay:o=0,duration:s=300,easing:a=e,tick:b=t,css:w}=u||rt,E={start:h()+o,b:r};r||(E.group=J,J.r+=1),d||y?y=E:(w&&(v(),g=O(n,c,r,s,o,a,w)),r&&b(0,1),d=m(E,s),z((()=>Y(n,r,"start"))),function(t){let e;0===f.size&&l(p),new Promise((n=>{f.add(e={c:t,f:n})}))}((t=>{if(y&&t>y.start&&(d=m(y,s),y=null,Y(n,d.b,"start"),w&&(v(),g=O(n,c,d.b,d.duration,0,a,u.css))),d)if(t>=d.end)b(c=d.b,1-c),Y(n,d.b,"end"),y||(d.b?v():--d.group.r||i(d.group.c)),d=null;else if(t>=d.start){const e=t-d.start;c=d.a+d.d*a(e/d.duration),b(c,1-c)}return!(!d&&!y)})))}return{run(t){o(u)?(W||(W=Promise.resolve(),W.then((()=>{W=null}))),W).then((()=>{u=u(),b(t)})):b(t)},end(){v(),d=y=null}}}const ot="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function st(t,e){nt(t,1,1,(()=>{e.delete(t.key)}))}function at(t){t&&t.c()}function ut(t,e,r,s){const{fragment:a,on_mount:u,on_destroy:c,after_update:h}=t.$$;a&&a.m(e,r),s||z((()=>{const e=u.map(n).filter(o);c?c.push(...e):i(e),t.$$.on_mount=[]})),h.forEach(z)}function ct(t,e){const n=t.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ht(t,e){-1===t.$$.dirty[0]&&(V.push(t),K||(K=!0,B.then(H)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function lt(e,n,o,s,a,u,c,h=[-1]){const l=x;P(e);const f=e.$$={fragment:null,ctx:null,props:u,update:t,not_equal:a,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(l?l.$$.context:[])),callbacks:r(),dirty:h,skip_bound:!1,root:n.target||l.$$.root};c&&c(f.root);let p=!1;if(f.ctx=o?o(e,n.props||{},((t,n,...r)=>{const i=r.length?r[0]:n;return f.ctx&&a(f.ctx[t],f.ctx[t]=i)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](i),p&&ht(e,t)),n})):[],f.update(),p=!0,i(f.before_update),f.fragment=!!s&&s(f.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);f.fragment&&f.fragment.l(t),t.forEach(m)}else f.fragment&&f.fragment.c();n.intro&&et(e.$$.fragment),ut(e,n.target,n.anchor,n.customElement),H()}P(l)}class ft{$destroy(){ct(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function pt(t){const e=t-1;return e*e*e+1}function dt(t,{delay:e=0,duration:n=400,easing:r=pt,x:i=0,y:o=0,opacity:s=0}={}){const a=getComputedStyle(t),u=+a.opacity,c="none"===a.transform?"":a.transform,h=u*(1-s);return{delay:e,duration:n,easing:r,css:(t,e)=>`\n\t\t\ttransform: ${c} translate(${(1-t)*i}px, ${(1-t)*o}px);\n\t\t\topacity: ${u-h*e}`}}const yt=[];function gt(e,n=t){let r;const i=new Set;function o(t){if(s(e,t)&&(e=t,r)){const t=!yt.length;for(const t of i)t[1](),yt.push(t,e);if(t){for(let t=0;t<yt.length;t+=2)yt[t][0](yt[t+1]);yt.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(s,a=t){const u=[s,a];return i.add(u),1===i.size&&(r=n(o)||t),s(e),()=>{i.delete(u),0===i.size&&(r(),r=null)}}}}var vt,mt=new Uint8Array(16);function bt(){if(!vt&&!(vt="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return vt(mt)}var wt=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Et(t){return"string"==typeof t&&wt.test(t)}for(var It=[],Tt=0;Tt<256;++Tt)It.push((Tt+256).toString(16).substr(1));function _t(t,e,n){var r=(t=t||{}).random||(t.rng||bt)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(It[t[e+0]]+It[t[e+1]]+It[t[e+2]]+It[t[e+3]]+"-"+It[t[e+4]]+It[t[e+5]]+"-"+It[t[e+6]]+It[t[e+7]]+"-"+It[t[e+8]]+It[t[e+9]]+"-"+It[t[e+10]]+It[t[e+11]]+It[t[e+12]]+It[t[e+13]]+It[t[e+14]]+It[t[e+15]]).toLowerCase();if(!Et(n))throw TypeError("Stringified UUID is invalid");return n}(r)}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var St=function(t,e){return St=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},St(t,e)};function At(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}St(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Nt=function(){return Nt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Nt.apply(this,arguments)};function Dt(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function Ct(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function kt(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function xt(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function Rt(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ot=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},Lt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|a>>4,f=(15&a)<<2|c>>6,p=63&c;u||(p=64,s||(f=64)),r.push(n[h],n[l],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Ot(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();var c=o<<2|s>>4;if(r.push(c),64!==a){var h=s<<4&240|a>>2;if(r.push(h),64!==u){var l=a<<6&192|u;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},Pt=function(t){return function(t){var e=Ot(t);return Lt.encodeByteArray(e,!0)}(t).replace(/\./g,"")};function Ft(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=Ft(t[n],e[n]));return t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Mt=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Vt(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Ut(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var qt=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,jt.prototype.create),o}return At(e,t),e}(Error),jt=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?Bt(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new qt(i,a,r);return u},t}();function Bt(t,e){return t.replace(Kt,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var Kt=/\{\$([^}]+)}/g;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function zt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function $t(t,e){var n=new Gt(t,e);return n.subscribe.bind(n)}var Gt=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n},void 0===r.next&&(r.next=Ht),void 0===r.error&&(r.error=Ht),void 0===r.complete&&(r.complete=Ht);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function Ht(){}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Qt(t){return t&&t._delegate?t._delegate:t}var Wt=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),Yt="[DEFAULT]",Xt=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new Mt;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(r)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t))try{this.getOrInitializeService({instanceIdentifier:Yt})}catch(t){}try{for(var r=kt(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=xt(i.value,2),s=o[0],a=o[1],u=this.normalizeInstanceIdentifier(s);try{var c=this.getOrInitializeService({instanceIdentifier:u});a.resolve(c)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=Yt),this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return Dt(this,void 0,void 0,(function(){var t;return Ct(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(Rt(Rt([],xt(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),xt(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=Yt),this.instances.has(t)},t.prototype.getOptions=function(t){return void 0===t&&(t=Yt),this.instancesOptions.get(t)||{}},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var r=t.options,i=void 0===r?{}:r,o=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(o))throw Error(this.name+"("+o+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var s=this.getOrInitializeService({instanceIdentifier:o,options:i});try{for(var a=kt(this.instancesDeferred.entries()),u=a.next();!u.done;u=a.next()){var c=xt(u.value,2),h=c[0],l=c[1];o===this.normalizeInstanceIdentifier(h)&&l.resolve(s)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return s},t.prototype.onInit=function(t,e){var n,r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&t(o,r),function(){i.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,r,i=this.onInitCallbacks.get(e);if(i)try{for(var o=kt(i),s=o.next();!s.done;s=o.next()){var a=s.value;try{a(t,e)}catch(t){}}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===Yt?void 0:e),options:i}),this.instances.set(n,o),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(o,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(t){}return o||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=Yt),this.component?this.component.multipleInstances?t:Yt:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Jt,Zt=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new Xt(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function te(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ee,ne=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(ee||(ee={}));var re,ie={debug:ee.DEBUG,verbose:ee.VERBOSE,info:ee.INFO,warn:ee.WARN,error:ee.ERROR,silent:ee.SILENT},oe=ee.INFO,se=((Jt={})[ee.DEBUG]="log",Jt[ee.VERBOSE]="log",Jt[ee.INFO]="info",Jt[ee.WARN]="warn",Jt[ee.ERROR]="error",Jt),ae=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=se[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,te(["["+i+"]  "+t.name+":"],n))}},ue=function(){function t(t){this.name=t,this._logLevel=oe,this._logHandler=ae,this._userLogHandler=null,ne.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in ee))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?ie[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,te([this,ee.DEBUG],t)),this._logHandler.apply(this,te([this,ee.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,te([this,ee.VERBOSE],t)),this._logHandler.apply(this,te([this,ee.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,te([this,ee.INFO],t)),this._logHandler.apply(this,te([this,ee.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,te([this,ee.WARN],t)),this._logHandler.apply(this,te([this,ee.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,te([this,ee.ERROR],t)),this._logHandler.apply(this,te([this,ee.ERROR],t))},t}();function ce(t){ne.forEach((function(e){e.setLogLevel(t)}))}var he,le=((re={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",re["bad-app-name"]="Illegal App name: '{$appName}",re["duplicate-app"]="Firebase App named '{$appName}' already exists",re["app-deleted"]="Firebase App named '{$appName}' already deleted",re["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",re["invalid-log-argument"]="First argument to `onLog` must be null or a function.",re),fe=new jt("app","Firebase",le),pe="@firebase/app",de="[DEFAULT]",ye=((he={})[pe]="fire-core",he["@firebase/analytics"]="fire-analytics",he["@firebase/app-check"]="fire-app-check",he["@firebase/auth"]="fire-auth",he["@firebase/database"]="fire-rtdb",he["@firebase/functions"]="fire-fn",he["@firebase/installations"]="fire-iid",he["@firebase/messaging"]="fire-fcm",he["@firebase/performance"]="fire-perf",he["@firebase/remote-config"]="fire-rc",he["@firebase/storage"]="fire-gcs",he["@firebase/firestore"]="fire-fst",he["fire-js"]="fire-js",he["firebase-wrapper"]="fire-js-all",he),ge=new ue("@firebase/app"),ve=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=Ft(void 0,t),this.container=new Zt(e.name),this._addComponent(new Wt("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){var n;void 0===e&&(e=de),this.checkDestroyed_();var r=this.container.getProvider(t);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=de),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){ge.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw fe.create("app-deleted",{appName:this.name_})},t}();ve.prototype.name&&ve.prototype.options||ve.prototype.delete||console.log("dc");
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function me(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var o=i;void 0===o.name&&(o.name=de);var s=o.name;if("string"!=typeof s||!s)throw fe.create("bad-app-name",{appName:String(s)});if(zt(e,s))throw fe.create("duplicate-app",{appName:s});var a=new t(n,o,r);return e[s]=a,a},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=ye[t])&&void 0!==r?r:t;n&&(i+="-"+n);var s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return s&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),s&&a&&u.push("and"),a&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void ge.warn(u.join(" "))}o(new Wt(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:ce,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw fe.create("invalid-log-argument");!function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=ie[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:ee[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=ne;r<i.length;r++)n(i[r])}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t,e)},apps:null,SDK_VERSION:"8.10.0",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){if("serverAuth"===e)return null;return e}}};function i(t){if(!zt(e,t=t||de))throw fe.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return ge.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var a=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[s])throw fe.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&Ft(a,o.serviceProps),r[s]=a,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,s);return n.apply(this,o.multipleInstances?t:[])}}for(var u=0,c=Object.keys(e);u<c.length;u++){var h=c[u];e[h]._addComponent(o)}return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var be=function t(){var e=me(ve);return e.INTERNAL=Nt(Nt({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){Ft(e,t)},createSubscribe:$t,ErrorFactory:jt,deepExtend:Ft}),e}(),we=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){ge.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var Ee=self.firebase.SDK_VERSION;Ee&&Ee.indexOf("LITE")>=0&&ge.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Ie=be.initializeApp;be.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Ut()&&ge.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),Ie.apply(void 0,t)};var Te=be;!function(t,e){t.INTERNAL.registerComponent(new Wt("platform-logger",(function(t){return new we(t)}),"PRIVATE")),t.registerVersion(pe,"0.6.30",e),t.registerVersion("fire-js","")}(Te);var _e="8.10.0";
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
Te.registerVersion("firebase",_e,"app"),Te.SDK_VERSION=_e;
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var Se=function(t,e){return Se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},Se(t,e)};function Ae(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var Ne,De="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Ce=Ce||{},ke=De||self;function xe(){}function Re(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Oe(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Le="closure_uid_"+(1e9*Math.random()>>>0),Pe=0;function Fe(t,e,n){return t.call.apply(t.bind,arguments)}function Me(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Ve(t,e,n){return(Ve=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Fe:Me).apply(null,arguments)}function Ue(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function qe(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function je(){this.s=this.s,this.o=this.o}var Be={};je.prototype.s=!1,je.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,Le)&&t[Le]||(t[Le]=++Pe)}(this);delete Be[t]}},je.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Ke=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},ze=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function $e(t){return Array.prototype.concat.apply([],arguments)}function Ge(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function He(t){return/^[\s\xa0]*$/.test(t)}var Qe,We=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Ye(t,e){return-1!=t.indexOf(e)}function Xe(t,e){return t<e?-1:t>e?1:0}t:{var Je=ke.navigator;if(Je){var Ze=Je.userAgent;if(Ze){Qe=Ze;break t}}Qe=""}function tn(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function en(t){var e={};for(var n in t)e[n]=t[n];return e}var nn="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rn(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<nn.length;o++)n=nn[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function on(t){return on[" "](t),t}on[" "]=xe;var sn,an,un=Ye(Qe,"Opera"),cn=Ye(Qe,"Trident")||Ye(Qe,"MSIE"),hn=Ye(Qe,"Edge"),ln=hn||cn,fn=Ye(Qe,"Gecko")&&!(Ye(Qe.toLowerCase(),"webkit")&&!Ye(Qe,"Edge"))&&!(Ye(Qe,"Trident")||Ye(Qe,"MSIE"))&&!Ye(Qe,"Edge"),pn=Ye(Qe.toLowerCase(),"webkit")&&!Ye(Qe,"Edge");function dn(){var t=ke.document;return t?t.documentMode:void 0}t:{var yn="",gn=(an=Qe,fn?/rv:([^\);]+)(\)|;)/.exec(an):hn?/Edge\/([\d\.]+)/.exec(an):cn?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(an):pn?/WebKit\/(\S+)/.exec(an):un?/(?:Version)[ \/]?(\S+)/.exec(an):void 0);if(gn&&(yn=gn?gn[1]:""),cn){var vn=dn();if(null!=vn&&vn>parseFloat(yn)){sn=String(vn);break t}}sn=yn}var mn,bn={};function wn(){return function(t){var e=bn;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}((function(){for(var t=0,e=We(String(sn)).split("."),n=We("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Xe(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Xe(0==o[2].length,0==s[2].length)||Xe(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t}))}if(ke.document&&cn){var En=dn();mn=En||(parseInt(sn,10)||void 0)}else mn=void 0;var In=mn,Tn=function(){if(!ke.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{ke.addEventListener("test",xe,e),ke.removeEventListener("test",xe,e)}catch(t){}return t}();function _n(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function Sn(t,e){if(_n.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(fn){t:{try{on(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:An[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Sn.Z.h.call(this)}}_n.prototype.h=function(){this.defaultPrevented=!0},qe(Sn,_n);var An={2:"touch",3:"pen",4:"mouse"};Sn.prototype.h=function(){Sn.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Nn="closure_listenable_"+(1e6*Math.random()|0),Dn=0;function Cn(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++Dn,this.ca=this.fa=!1}function kn(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function xn(t){this.src=t,this.g={},this.h=0}function Rn(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],o=Ke(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(kn(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function On(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ca&&o.listener==e&&o.capture==!!n&&o.ia==r)return i}return-1}xn.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var s=On(t,e,r,i);return-1<s?(e=t[s],n||(e.fa=!1)):((e=new Cn(e,this.src,o,!!r,i)).fa=n,t.push(e)),e};var Ln="closure_lm_"+(1e6*Math.random()|0),Pn={};function Fn(t,e,n,r,i){if(r&&r.once)return Vn(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Fn(t,e[o],n,r,i);return null}return n=$n(n),t&&t[Nn]?t.N(e,n,Oe(r)?!!r.capture:!!r,i):Mn(t,e,n,!1,r,i)}function Mn(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=Oe(i)?!!i.capture:!!i,a=Kn(t);if(a||(t[Ln]=a=new xn(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){function t(n){return e.call(t.src,t.listener,n)}var e=Bn;return t}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Tn||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(jn(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Vn(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Vn(t,e[o],n,r,i);return null}return n=$n(n),t&&t[Nn]?t.O(e,n,Oe(r)?!!r.capture:!!r,i):Mn(t,e,n,!0,r,i)}function Un(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Un(t,e[o],n,r,i);else r=Oe(r)?!!r.capture:!!r,n=$n(n),t&&t[Nn]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=On(o=t.g[e],n,r,i))&&(kn(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.g[e],t.h--)))):t&&(t=Kn(t))&&(e=t.g[e.toString()],t=-1,e&&(t=On(e,n,r,i)),(n=-1<t?e[t]:null)&&qn(n))}function qn(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[Nn])Rn(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(jn(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Kn(e))?(Rn(n,t),0==n.h&&(n.src=null,e[Ln]=null)):kn(t)}}}function jn(t){return t in Pn?Pn[t]:Pn[t]="on"+t}function Bn(t,e){if(t.ca)t=!0;else{e=new Sn(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&qn(t),t=n.call(r,e)}return t}function Kn(t){return(t=t[Ln])instanceof xn?t:null}var zn="__closure_events_fn_"+(1e9*Math.random()>>>0);function $n(t){return"function"==typeof t?t:(t[zn]||(t[zn]=function(e){return t.handleEvent(e)}),t[zn])}function Gn(){je.call(this),this.i=new xn(this),this.P=this,this.I=null}function Hn(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"==typeof e)e=new _n(e,t);else if(e instanceof _n)e.target=e.target||t;else{var i=e;rn(e=new _n(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.g=n[o];i=Qn(s,r,!0,e)&&i}if(i=Qn(s=e.g=t,r,!0,e)&&i,i=Qn(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Qn(s=e.g=n[o],r,!1,e)&&i}function Qn(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.ca&&s.capture==n){var a=s.listener,u=s.ia||s.src;s.fa&&Rn(t.i,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}qe(Gn,je),Gn.prototype[Nn]=!0,Gn.prototype.removeEventListener=function(t,e,n,r){Un(this,t,e,n,r)},Gn.prototype.M=function(){if(Gn.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)kn(n[r]);delete e.g[t],e.h--}}this.I=null},Gn.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},Gn.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var Wn=ke.JSON.stringify;function Yn(){var t=ir,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Xn,Jn=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=Zn.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),Zn=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t},t}())((function(){return new tr}),(function(t){return t.reset()})),tr=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function er(t){ke.setTimeout((function(){throw t}),0)}function nr(t,e){Xn||function(){var t=ke.Promise.resolve(void 0);Xn=function(){t.then(or)}}(),rr||(Xn(),rr=!0),ir.add(t,e)}var rr=!1,ir=new Jn;function or(){for(var t;t=Yn();){try{t.h.call(t.g)}catch(t){er(t)}var e=Zn;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}rr=!1}function sr(t,e){Gn.call(this),this.h=t||1,this.g=e||ke,this.j=Ve(this.kb,this),this.l=Date.now()}function ar(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function ur(t,e,n){if("function"==typeof t)n&&(t=Ve(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Ve(t.handleEvent,t)}return 2147483647<Number(e)?-1:ke.setTimeout(t,e||0)}function cr(t){t.g=ur((function(){t.g=null,t.i&&(t.i=!1,cr(t))}),t.j);var e=t.h;t.h=null,t.m.apply(null,e)}qe(sr,Gn),(Ne=sr.prototype).da=!1,Ne.S=null,Ne.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Hn(this,"tick"),this.da&&(ar(this),this.start()))}},Ne.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Ne.M=function(){sr.Z.M.call(this),ar(this),delete this.g};var hr=function(t){function e(e,n){var r=t.call(this)||this;return r.m=e,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Se(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:cr(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(ke.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(je);function lr(t){je.call(this),this.h=t,this.g={}}qe(lr,je);var fr=[];function pr(t,e,n,r){Array.isArray(n)||(n&&(fr[0]=n.toString()),n=fr);for(var i=0;i<n.length;i++){var o=Fn(e,n[i],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function dr(t){tn(t.g,(function(t,e){this.g.hasOwnProperty(e)&&qn(t)}),t),t.g={}}function yr(){this.g=!0}function gr(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Wn(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}lr.prototype.M=function(){lr.Z.M.call(this),dr(this)},lr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},yr.prototype.Aa=function(){this.g=!1},yr.prototype.info=function(){};var vr={},mr=null;function br(){return mr=mr||new Gn}function wr(t){_n.call(this,vr.Ma,t)}function Er(t){var e=br();Hn(e,new wr(e,t))}function Ir(t,e){_n.call(this,vr.STAT_EVENT,t),this.stat=e}function Tr(t){var e=br();Hn(e,new Ir(e,t))}function _r(t,e){_n.call(this,vr.Na,t),this.size=e}function Sr(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return ke.setTimeout((function(){t()}),e)}vr.Ma="serverreachability",qe(wr,_n),vr.STAT_EVENT="statevent",qe(Ir,_n),vr.Na="timingevent",qe(_r,_n);var Ar={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Nr={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Dr(){}function Cr(t){return t.h||(t.h=t.i())}function kr(){}Dr.prototype.h=null;var xr,Rr={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Or(){_n.call(this,"d")}function Lr(){_n.call(this,"c")}function Pr(){}function Fr(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new lr(this),this.P=Vr,t=ln?125:void 0,this.W=new sr(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Mr}function Mr(){this.i=null,this.g="",this.h=!1}qe(Or,_n),qe(Lr,_n),qe(Pr,Dr),Pr.prototype.g=function(){return new XMLHttpRequest},Pr.prototype.i=function(){return{}},xr=new Pr;var Vr=45e3,Ur={},qr={};function jr(t,e,n){t.K=1,t.v=hi(ii(e)),t.s=n,t.U=!0,Br(t,null)}function Br(t,e){t.F=Date.now(),Gr(t),t.A=ii(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),Ti(n.h,"t",r),t.C=0,n=t.l.H,t.h=new Mr,t.g=So(t.l,n?e:null,!t.s),0<t.O&&(t.L=new hr(Ve(t.Ia,t,t.g),t.O)),pr(t.V,t.g,"readystatechange",t.gb),e=t.H?en(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Er(1),function(t,e,n,r,i,o){t.info((function(){if(t.g)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&"type"==l[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function Kr(t){return!!t.g&&("GET"==t.u&&2!=t.K&&t.l.Ba)}function zr(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;){if((r=$r(t,n))==qr){4==e&&(t.o=4,Tr(14),i=!1),gr(t.j,t.m,null,"[Incomplete Response]");break}if(r==Ur){t.o=4,Tr(15),gr(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}gr(t.j,t.m,r,null),Xr(t,r)}Kr(t)&&r!=qr&&r!=Ur&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,Tr(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),vo(e),e.L=!0,Tr(11))):(gr(t.j,t.m,n,"[Invalid Chunked Response]"),Yr(t),Wr(t))}function $r(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?qr:(n=Number(e.substring(n,r)),isNaN(n)?Ur:(r+=1)+n>e.length?qr:(e=e.substr(r,n),t.C=r+n,e))}function Gr(t){t.Y=Date.now()+t.P,Hr(t,t.P)}function Hr(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Sr(Ve(t.eb,t),e)}function Qr(t){t.B&&(ke.clearTimeout(t.B),t.B=null)}function Wr(t){0==t.l.G||t.I||wo(t.l,t)}function Yr(t){Qr(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,ar(t.W),dr(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Xr(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||ki(n.i,t)))if(n.I=t.N,!t.J&&ki(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(o){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;bo(n),ao(n)}go(n),Tr(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=Sr(Ve(n.ab,n),6e3));if(1>=Ci(n.i)&&n.ka){try{n.ka()}catch(o){}n.ka=void 0}}else Io(n,11)}else if((t.J||n.g==t)&&bo(n),!He(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var o=i[e];if(n.U=o[0],o=o[1],2==n.G)if("c"==o[0]){n.J=o[1],n.la=o[2];var s=o[3];null!=s&&(n.ma=s,n.h.info("VER="+n.ma));var a=o[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var u=o[5];null!=u&&"number"==typeof u&&0<u&&(r=1.5*u,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=t.g;if(c){var h=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=r.i;!l.g&&(Ye(h,"spdy")||Ye(h,"quic")||Ye(h,"h2"))&&(l.j=l.l,l.g=new Set,l.h&&(xi(l,l.h),l.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,ci(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var p=t;if((r=n).oa=_o(r,r.H?r.la:null,r.W),p.J){Ri(r.i,p);var d=p,y=r.K;y&&d.setTimeout(y),d.B&&(Qr(d),Gr(d)),r.g=p}else yo(r);0<n.l.length&&ho(n)}else"stop"!=o[0]&&"close"!=o[0]||Io(n,7);else 3==n.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?Io(n,7):so(n):"noop"!=o[0]&&n.j&&n.j.wa(o),n.A=0)}Er(4)}catch(o){}}function Jr(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Re(t)||"string"==typeof t)ze(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(Re(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;r=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(Re(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),i=r.length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Zr(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Zr)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ti(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];ei(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)ei(i,r=t.g[e])||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}function ei(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(Ne=Fr.prototype).setTimeout=function(t){this.P=t},Ne.gb=function(t){t=t.target;var e=this.L;e&&3==eo(t)?e.l():this.Ia(t)},Ne.Ia=function(t){try{if(t==this.g)t:{var e=eo(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||ln||this.g&&(this.h.h||this.g.ga()||no(this.g)))){this.I||4!=e||7==n||Er(8==n||0>=r?3:2),Qr(this);var i=this.g.ba();this.N=i;e:if(Kr(this)){var o=no(this.g);t="";var s=o.length,a=4==eo(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Yr(this),Wr(this);var u="";break e}this.h.i=new ke.TextDecoder}for(n=0;n<s;n++)this.h.h=!0,t+=this.h.i.decode(o[n],{stream:a&&n==s-1});o.splice(0,s),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,h=this.g;if((c=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!He(c)){var l=c;break e}}l=null}if(!(i=l)){this.i=!1,this.o=3,Tr(12),Yr(this),Wr(this);break t}gr(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Xr(this,i)}this.U?(zr(this,e,u),ln&&this.i&&3==e&&(pr(this.V,this.W,"tick",this.fb),this.W.start())):(gr(this.j,this.m,u,null),Xr(this,u)),4==e&&Yr(this),this.i&&!this.I&&(4==e?wo(this.l,this):(this.i=!1,Gr(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,Tr(12)):(this.o=0,Tr(13)),Yr(this),Wr(this)}}}catch(e){}},Ne.fb=function(){if(this.g){var t=eo(this.g),e=this.g.ga();this.C<e.length&&(Qr(this),zr(this,t,e),this.i&&4!=t&&Gr(this))}},Ne.cancel=function(){this.I=!0,Yr(this)},Ne.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(Er(3),Tr(17)),Yr(this),this.o=2,Wr(this)):Hr(this,this.Y-t)},(Ne=Zr.prototype).R=function(){ti(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},Ne.T=function(){return ti(this),this.g.concat()},Ne.get=function(t,e){return ei(this.h,t)?this.h[t]:e},Ne.set=function(t,e){ei(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},Ne.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var ni=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function ri(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof ri){this.g=void 0!==e?e:t.g,oi(this,t.j),this.s=t.s,si(this,t.i),ai(this,t.m),this.l=t.l,e=t.h;var n=new bi;n.i=e.i,e.g&&(n.g=new Zr(e.g),n.h=e.h),ui(this,n),this.o=t.o}else t&&(n=String(t).match(ni))?(this.g=!!e,oi(this,n[1]||"",!0),this.s=li(n[2]||""),si(this,n[3]||"",!0),ai(this,n[4]),this.l=li(n[5]||"",!0),ui(this,n[6]||"",!0),this.o=li(n[7]||"")):(this.g=!!e,this.h=new bi(null,this.g))}function ii(t){return new ri(t)}function oi(t,e,n){t.j=n?li(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function si(t,e,n){t.i=n?li(e,!0):e}function ai(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function ui(t,e,n){e instanceof bi?(t.h=e,function(t,e){e&&!t.j&&(wi(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Ei(this,e),Ti(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=fi(e,vi)),t.h=new bi(e,t.g))}function ci(t,e,n){t.h.set(e,n)}function hi(t){return ci(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function li(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function fi(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,pi),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function pi(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}ri.prototype.toString=function(){var t=[],e=this.j;e&&t.push(fi(e,di,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(fi(e,di,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(fi(n,"/"==n.charAt(0)?gi:yi,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",fi(n,mi)),t.join("")};var di=/[#\/\?@]/g,yi=/[#\?:]/g,gi=/[#\?]/g,vi=/[#\?@]/g,mi=/#/g;function bi(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function wi(t){t.g||(t.g=new Zr,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Ei(t,e){wi(t),e=_i(t,e),ei(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,ei((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&ti(t)))}function Ii(t,e){return wi(t),e=_i(t,e),ei(t.g.h,e)}function Ti(t,e,n){Ei(t,e),0<n.length&&(t.i=null,t.g.set(_i(t,e),Ge(n)),t.h+=n.length)}function _i(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(Ne=bi.prototype).add=function(t,e){wi(this),this.i=null,t=_i(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},Ne.forEach=function(t,e){wi(this),this.g.forEach((function(n,r){ze(n,(function(n){t.call(e,n,r,this)}),this)}),this)},Ne.T=function(){wi(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},Ne.R=function(t){wi(this);var e=[];if("string"==typeof t)Ii(this,t)&&(e=$e(e,this.g.get(_i(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=$e(e,t[n])}return e},Ne.set=function(t,e){return wi(this),this.i=null,Ii(this,t=_i(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},Ne.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},Ne.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.i=t.join("&")};var Si=function(t,e){this.h=t,this.g=e};function Ai(t){this.l=t||Ni,ke.PerformanceNavigationTiming?t=0<(t=ke.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(ke.g&&ke.g.Ea&&ke.g.Ea()&&ke.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Ni=10;function Di(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Ci(t){return t.h?1:t.g?t.g.size:0}function ki(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function xi(t,e){t.g?t.g.add(e):t.h=e}function Ri(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Oi(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var r=t.i;try{for(var i=Ae(t.g.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.D)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return Ge(t.i)}function Li(){}function Pi(){this.g=new Li}function Fi(t,e,n){var r=n||"";try{Jr(t,(function(t,n){var i=t;Oe(t)&&(i=Wn(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function Mi(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function Vi(t){this.l=t.$b||null,this.j=t.ib||!1}function Ui(t,e){Gn.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=qi,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ai.prototype.cancel=function(){var t,e;if(this.i=Oi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=Ae(this.g.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},Li.prototype.stringify=function(t){return ke.JSON.stringify(t,void 0)},Li.prototype.parse=function(t){return ke.JSON.parse(t,void 0)},qe(Vi,Dr),Vi.prototype.g=function(){return new Ui(this.l,this.j)},Vi.prototype.i=function(t){return function(){return t}}({}),qe(Ui,Gn);var qi=0;function ji(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function Bi(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Ki(t)}function Ki(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(Ne=Ui.prototype).open=function(t,e){if(this.readyState!=qi)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Ki(this)},Ne.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||ke).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},Ne.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Bi(this)),this.readyState=qi},Ne.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Ki(this)),this.g&&(this.readyState=3,Ki(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==ke.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ji(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},Ne.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Bi(this):Ki(this),3==this.readyState&&ji(this)}},Ne.Ua=function(t){this.g&&(this.response=this.responseText=t,Bi(this))},Ne.Ta=function(t){this.g&&(this.response=t,Bi(this))},Ne.ha=function(){this.g&&Bi(this)},Ne.setRequestHeader=function(t,e){this.v.append(t,e)},Ne.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},Ne.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Ui.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var zi=ke.JSON.parse;function $i(t){Gn.call(this),this.headers=new Zr,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Gi,this.K=this.L=!1}qe($i,Gn);var Gi="",Hi=/^https?$/i,Qi=["POST","PUT"];function Wi(t){return"content-type"==t.toLowerCase()}function Yi(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Xi(t),Zi(t)}function Xi(t){t.D||(t.D=!0,Hn(t,"complete"),Hn(t,"error"))}function Ji(t){if(t.h&&void 0!==Ce&&(!t.C[1]||4!=eo(t)||2!=t.ba()))if(t.v&&4==eo(t))ur(t.Fa,0,t);else if(Hn(t,"readystatechange"),4==eo(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.H).match(ni)[1]||null;if(!o&&ke.self&&ke.self.location){var s=ke.self.location.protocol;o=s.substr(0,s.length-1)}i=!Hi.test(o?o.toLowerCase():"")}e=i}if(e)Hn(t,"complete"),Hn(t,"success");else{t.m=6;try{var a=2<eo(t)?t.g.statusText:""}catch(t){a=""}t.j=a+" ["+t.ba()+"]",Xi(t)}}finally{Zi(t)}}}function Zi(t,e){if(t.g){to(t);var n=t.g,r=t.C[0]?xe:null;t.g=null,t.C=null,e||Hn(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function to(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(ke.clearTimeout(t.A),t.A=null)}function eo(t){return t.g?t.g.readyState:0}function no(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Gi:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function ro(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return tn(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):ci(t,e,n))}function io(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function oo(t){this.za=0,this.l=[],this.h=new yr,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=io("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=io("baseRetryDelayMs",5e3,t),this.$a=io("retryDelaySeedMs",1e4,t),this.Ya=io("forwardChannelMaxRetries",2,t),this.ra=io("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new Ai(t&&t.concurrentRequestLimit),this.Ca=new Pi,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function so(t){if(uo(t),3==t.G){var e=t.V++,n=ii(t.F);ci(n,"SID",t.J),ci(n,"RID",e),ci(n,"TYPE","terminate"),fo(t,n),(e=new Fr(t,t.h,e,void 0)).K=2,e.v=hi(ii(n)),n=!1,ke.navigator&&ke.navigator.sendBeacon&&(n=ke.navigator.sendBeacon(e.v.toString(),"")),!n&&ke.Image&&((new Image).src=e.v,n=!0),n||(e.g=So(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Gr(e)}To(t)}function ao(t){t.g&&(vo(t),t.g.cancel(),t.g=null)}function uo(t){ao(t),t.u&&(ke.clearTimeout(t.u),t.u=null),bo(t),t.i.cancel(),t.m&&("number"==typeof t.m&&ke.clearTimeout(t.m),t.m=null)}function co(t,e){t.l.push(new Si(t.Za++,e)),3==t.G&&ho(t)}function ho(t){Di(t.i)||t.m||(t.m=!0,nr(t.Ha,t),t.C=0)}function lo(t,e){var n;n=e?e.m:t.V++;var r=ii(t.F);ci(r,"SID",t.J),ci(r,"RID",n),ci(r,"AID",t.U),fo(t,r),t.o&&t.s&&ro(r,t.o,t.s),n=new Fr(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=po(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),xi(t.i,n),jr(n,r,e)}function fo(t,e){t.j&&Jr({},(function(t,n){ci(e,n,t)}))}function po(t,e,n){n=Math.min(t.l.length,n);var r=t.j?Ve(t.j.Oa,t.j,t):null;t:for(var i=t.l,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].h,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].h,h=i[u].g;if(0>(c-=o))o=Math.max(0,i[u].h-100),a=!1;else try{Fi(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function yo(t){t.g||t.u||(t.Y=1,nr(t.Ga,t),t.A=0)}function go(t){return!(t.g||t.u||3<=t.A)&&(t.Y++,t.u=Sr(Ve(t.Ga,t),Eo(t,t.A)),t.A++,!0)}function vo(t){null!=t.B&&(ke.clearTimeout(t.B),t.B=null)}function mo(t){t.g=new Fr(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=ii(t.oa);ci(e,"RID","rpc"),ci(e,"SID",t.J),ci(e,"CI",t.N?"0":"1"),ci(e,"AID",t.U),fo(t,e),ci(e,"TYPE","xmlhttp"),t.o&&t.s&&ro(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=hi(ii(e)),n.s=null,n.U=!0,Br(n,t)}function bo(t){null!=t.v&&(ke.clearTimeout(t.v),t.v=null)}function wo(t,e){var n=null;if(t.g==e){bo(t),vo(t),t.g=null;var r=2}else{if(!ki(t.i,e))return;n=e.D,Ri(t.i,e),r=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;Hn(r=br(),new _r(r,n,e,i)),ho(t)}else yo(t);else if(3==(i=e.o)||0==i&&0<t.I||!(1==r&&function(t,e){return!(Ci(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=Sr(Ve(t.Ha,t,e),Eo(t,t.C)),t.C++,0)))}(t,e)||2==r&&go(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Io(t,5);break;case 4:Io(t,10);break;case 3:Io(t,6);break;default:Io(t,2)}}function Eo(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function Io(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var r=Ve(t.jb,t);n||(n=new ri("//www.google.com/images/cleardot.gif"),ke.location&&"http"==ke.location.protocol||oi(n,"https"),hi(n)),function(t,e){var n=new yr;if(ke.Image){var r=new Image;r.onload=Ue(Mi,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Ue(Mi,n,r,"TestLoadImage: error",!1,e),r.onabort=Ue(Mi,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Ue(Mi,n,r,"TestLoadImage: timeout",!1,e),ke.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Tr(2);t.G=0,t.j&&t.j.va(e),To(t),uo(t)}function To(t){t.G=0,t.I=-1,t.j&&(0==Oi(t.i).length&&0==t.l.length||(t.i.i.length=0,Ge(t.l),t.l.length=0),t.j.ua())}function _o(t,e,n){var r=function(t){return t instanceof ri?ii(t):new ri(t,void 0)}(n);if(""!=r.i)e&&si(r,e+"."+r.i),ai(r,r.m);else{var i=ke.location;r=function(t,e,n,r){var i=new ri(null,void 0);return t&&oi(i,t),e&&si(i,e),n&&ai(i,n),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&tn(t.aa,(function(t,e){ci(r,e,t)})),e=t.D,n=t.sa,e&&n&&ci(r,e,n),ci(r,"VER",t.ma),fo(t,r),r}function So(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new $i(new Vi({ib:!0})):new $i(t.qa)).L=t.H,e}function Ao(){}function No(){if(cn&&!(10<=Number(In)))throw Error("Environmental error: no available transport.")}function Do(t,e){Gn.call(this),this.g=new oo(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!He(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!He(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new xo(this)}function Co(t){Or.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function ko(){Lr.call(this),this.status=1}function xo(t){this.g=t}(Ne=$i.prototype).ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():xr.g(),this.C=this.u?Cr(this.u):Cr(xr),this.g.onreadystatechange=Ve(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void Yi(this,t)}t=n||"";var i=new Zr(this.headers);r&&Jr(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=Wi,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.T()),n=ke.FormData&&t instanceof ke.FormData,!(0<=Ke(Qi,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{to(this),0<this.B&&((this.K=function(t){return cn&&wn()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ve(this.pa,this)):this.A=ur(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Yi(this,t)}},Ne.pa=function(){void 0!==Ce&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Hn(this,"timeout"),this.abort(8))},Ne.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Hn(this,"complete"),Hn(this,"abort"),Zi(this))},Ne.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Zi(this,!0)),$i.Z.M.call(this)},Ne.Fa=function(){this.s||(this.F||this.v||this.l?Ji(this):this.cb())},Ne.cb=function(){Ji(this)},Ne.ba=function(){try{return 2<eo(this)?this.g.status:-1}catch(t){return-1}},Ne.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},Ne.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),zi(e)}},Ne.Da=function(){return this.m},Ne.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(Ne=oo.prototype).ma=8,Ne.G=1,Ne.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(t){}},Ne.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new Fr(this,this.h,t,void 0),n=this.s;if(this.P&&(n?rn(n=en(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var o=this.l[i];if(void 0===(o="__data__"in o.g&&"string"==typeof(o=o.g.__data__)?o.length:void 0))break;if(4096<(r+=o)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=po(this,e,r),ci(i=ii(this.F),"RID",t),ci(i,"CVER",22),this.D&&ci(i,"X-HTTP-Session-Id",this.D),fo(this,i),this.o&&n&&ro(i,this.o,n),xi(this.i,e),this.Ra&&ci(i,"TYPE","init"),this.ja?(ci(i,"$req",r),ci(i,"SID","null"),e.$=!0,jr(e,i,null)):jr(e,i,r),this.G=2}}else 3==this.G&&(t?lo(this,t):0==this.l.length||Di(this.i)||lo(this))},Ne.Ga=function(){if(this.u=null,mo(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Sr(Ve(this.bb,this),t)}},Ne.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Tr(10),ao(this),mo(this))},Ne.ab=function(){null!=this.v&&(this.v=null,ao(this),go(this),Tr(19))},Ne.jb=function(t){t?(this.h.info("Successfully pinged google.com"),Tr(2)):(this.h.info("Failed to ping google.com"),Tr(1))},(Ne=Ao.prototype).xa=function(){},Ne.wa=function(){},Ne.va=function(){},Ne.ua=function(){},Ne.Oa=function(){},No.prototype.g=function(t,e){return new Do(t,e)},qe(Do,Gn),Do.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),nr(Ve(t.hb,t,e))),Tr(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=_o(t,null,t.W),ho(t)},Do.prototype.close=function(){so(this.g)},Do.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,co(this.g,e)}else this.v?((e={}).__data__=Wn(t),co(this.g,e)):co(this.g,t)},Do.prototype.M=function(){this.g.j=null,delete this.j,so(this.g),delete this.g,Do.Z.M.call(this)},qe(Co,Or),qe(ko,Lr),qe(xo,Ao),xo.prototype.xa=function(){Hn(this.g,"a")},xo.prototype.wa=function(t){Hn(this.g,new Co(t))},xo.prototype.va=function(t){Hn(this.g,new ko(t))},xo.prototype.ua=function(){Hn(this.g,"b")},No.prototype.createWebChannel=No.prototype.g,Do.prototype.send=Do.prototype.u,Do.prototype.open=Do.prototype.m,Do.prototype.close=Do.prototype.close,Ar.NO_ERROR=0,Ar.TIMEOUT=8,Ar.HTTP_ERROR=6,Nr.COMPLETE="complete",kr.EventType=Rr,Rr.OPEN="a",Rr.CLOSE="b",Rr.ERROR="c",Rr.MESSAGE="d",Gn.prototype.listen=Gn.prototype.N,$i.prototype.listenOnce=$i.prototype.O,$i.prototype.getLastError=$i.prototype.La,$i.prototype.getLastErrorCode=$i.prototype.Da,$i.prototype.getStatus=$i.prototype.ba,$i.prototype.getResponseJson=$i.prototype.Qa,$i.prototype.getResponseText=$i.prototype.ga,$i.prototype.send=$i.prototype.ea;var Ro=Ar,Oo=Nr,Lo=vr,Po=10,Fo=11,Mo=Vi,Vo=kr,Uo=$i,qo=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();qo.o=-1;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var jo={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Bo=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return At(e,t),e}(Error),Ko=new ue("@firebase/firestore");function zo(){return Ko.logLevel}function $o(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ko.logLevel<=ee.DEBUG){var r=e.map(Qo);Ko.debug.apply(Ko,Rt(["Firestore (8.10.0): "+t],r))}}function Go(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ko.logLevel<=ee.ERROR){var r=e.map(Qo);Ko.error.apply(Ko,Rt(["Firestore (8.10.0): "+t],r))}}function Ho(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ko.logLevel<=ee.WARN){var r=e.map(Qo);Ko.warn.apply(Ko,Rt(["Firestore (8.10.0): "+t],r))}}function Qo(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Wo(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.10.0) INTERNAL ASSERTION FAILED: "+t;throw Go(e),new Error(e)}function Yo(t,e){t||Wo()}function Xo(t,e){return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Jo(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Zo=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Jo(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function ts(t,e){return t<e?-1:t>e?1:0}function es(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function ns(t){return t+"\0"}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var rs=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Bo(jo.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Bo(jo.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Bo(jo.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Bo(jo.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?ts(this.nanoseconds,t.nanoseconds):ts(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),is=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new rs(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function os(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ss(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function as(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var us=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Wo(),void 0===n?n=t.length-e:n>t.length-e&&Wo(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),cs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return At(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Bo(jo.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.emptyPath=function(){return new e([])},e}(us),hs=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ls=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return At(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return hs.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Bo(jo.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new Bo(jo.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Bo(jo.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new Bo(jo.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(us),fs=function(){function t(t){this.fields=t,t.sort(ls.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return es(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),ps=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return ts(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();ps.EMPTY_BYTE_STRING=new ps("");var ds=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ys(t){if(Yo(!!t),"string"==typeof t){var e=0,n=ds.exec(t);if(Yo(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:gs(t.seconds),nanos:gs(t.nanos)}}function gs(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function vs(t){return"string"==typeof t?ps.fromBase64String(t):ps.fromUint8Array(t)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ms(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function bs(t){var e=t.mapValue.fields.__previous_value__;return ms(e)?bs(e):e}function ws(t){var e=ys(t.mapValue.fields.__local_write_time__.timestampValue);return new rs(e.seconds,e.nanos)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Es(t){return null==t}function Is(t){return 0===t&&1/t==-1/0}function Ts(t){return"number"==typeof t&&Number.isInteger(t)&&!Is(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var _s=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(cs.fromString(e))},t.fromName=function(e){return new t(cs.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===cs.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return cs.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new cs(e.slice()))},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ss(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ms(t)?4:10:Wo()}function As(t,e){var n=Ss(t);if(n!==Ss(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ws(t).isEqual(ws(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=ys(t.timestampValue),r=ys(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return vs(t.bytesValue).isEqual(vs(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return gs(t.geoPointValue.latitude)===gs(e.geoPointValue.latitude)&&gs(t.geoPointValue.longitude)===gs(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return gs(t.integerValue)===gs(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=gs(t.doubleValue),r=gs(e.doubleValue);return n===r?Is(n)===Is(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return es(t.arrayValue.values||[],e.arrayValue.values||[],As);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(os(n)!==os(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!As(n[i],r[i])))return!1;return!0}(t,e);default:return Wo()}}function Ns(t,e){return void 0!==(t.values||[]).find((function(t){return As(t,e)}))}function Ds(t,e){var n=Ss(t),r=Ss(e);if(n!==r)return ts(n,r);switch(n){case 0:return 0;case 1:return ts(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=gs(t.integerValue||t.doubleValue),r=gs(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Cs(t.timestampValue,e.timestampValue);case 4:return Cs(ws(t),ws(e));case 5:return ts(t.stringValue,e.stringValue);case 6:return function(t,e){var n=vs(t),r=vs(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=ts(n[i],r[i]);if(0!==o)return o}return ts(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=ts(gs(t.latitude),gs(e.latitude));return 0!==n?n:ts(gs(t.longitude),gs(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Ds(n[i],r[i]);if(o)return o}return ts(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=ts(r[s],o[s]);if(0!==a)return a;var u=Ds(n[r[s]],i[o[s]]);if(0!==u)return u}return ts(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Wo()}}function Cs(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ts(t,e);var n=ys(t),r=ys(e),i=ts(n.seconds,r.seconds);return 0!==i?i:ts(n.nanos,r.nanos)}function ks(t){return xs(t)}function xs(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=ys(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?vs(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,_s.fromName(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=xs(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+xs(t.fields[o])}return e+"}"}(t.mapValue):Wo();var e,n}function Rs(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function Os(t){return!!t&&"integerValue"in t}function Ls(t){return!!t&&"arrayValue"in t}function Ps(t){return!!t&&"nullValue"in t}function Fs(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ms(t){return!!t&&"mapValue"in t}function Vs(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){var e={mapValue:{fields:{}}};return ss(t.mapValue.fields,(function(t,n){return e.mapValue.fields[t]=Vs(n)})),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Vs(t.arrayValue.values[r]);return n}return Object.assign({},t)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Us=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!Ms(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Vs(e)},t.prototype.setAll=function(t){var e=this,n=ls.emptyPath(),r={},i=[];t.forEach((function(t,o){if(!n.isImmediateParentOf(o)){var s=e.getFieldsMap(n);e.applyChanges(s,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=Vs(t):i.push(o.lastSegment())}));var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());Ms(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return As(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];Ms(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){ss(e,(function(e,n){return t[e]=n}));for(var r=0,i=n;r<i.length;r++){var o=i[r];delete t[o]}},t.prototype.clone=function(){return new t(Vs(this.value))},t}();function qs(t){var e=[];return ss(t.fields,(function(t,n){var r=new ls([t]);if(Ms(n)){var i=qs(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var a=s[o];e.push(r.child(a))}}else e.push(r)})),new fs(e)
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var js=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,is.min(),Us.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,Us.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,Us.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=Us.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=Us.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),Bs=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ks(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Bs(t,e,n,r,i,o,s)}function zs(t){var e=Xo(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+ks(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),Es(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=ra(e.startAt)),e.endAt&&(n+="|ub:",n+=ra(e.endAt)),e.h=n}return e.h}function $s(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!oa(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!As(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!aa(t.startAt,e.startAt)&&aa(t.endAt,e.endAt)}function Gs(t){return _s.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Hs=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return At(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new Qs(t,n,r):"array-contains"===n?new Js(t,r):"in"===n?new Zs(t,r):"not-in"===n?new ta(t,r):"array-contains-any"===n?new ea(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new Ws(t,n):new Ys(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(Ds(e,this.value)):null!==e&&Ss(this.value)===Ss(e)&&this.m(Ds(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Wo()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),Qs=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=_s.fromName(r.referenceValue),i}return At(e,t),e.prototype.matches=function(t){var e=_s.comparator(t.key,this.key);return this.m(e)},e}(Hs),Ws=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Xs("in",n),r}return At(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Hs),Ys=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Xs("not-in",n),r}return At(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Hs);function Xs(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return _s.fromName(t.referenceValue)}))}var Js=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return At(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return Ls(e)&&Ns(e.arrayValue,this.value)},e}(Hs),Zs=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return At(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&Ns(this.value.arrayValue,e)},e}(Hs),ta=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return At(e,t),e.prototype.matches=function(t){if(Ns(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!Ns(this.value.arrayValue,e)},e}(Hs),ea=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return At(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!Ls(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return Ns(e.value.arrayValue,t)}))},e}(Hs),na=function(t,e){this.position=t,this.before=e};function ra(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return ks(t)})).join(",")}var ia=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function oa(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function sa(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?_s.comparator(_s.fromName(s.referenceValue),n.key):Ds(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function aa(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!As(t.position[n],e.position[n]))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ua=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt};function ca(t,e,n,r,i,o,s,a){return new ua(t,e,n,r,i,o,s,a)}function ha(t){return new ua(t)}function la(t){return!Es(t.limit)&&"F"===t.limitType}function fa(t){return!Es(t.limit)&&"L"===t.limitType}function pa(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function da(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function ya(t){return null!==t.collectionGroup}function ga(t){var e=Xo(t);if(null===e.p){e.p=[];var n=da(e),r=pa(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new ia(n)),e.p.push(new ia(ls.keyField(),"asc"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var a=s[o];e.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new ia(ls.keyField(),u))}}}return e.p}function va(t){var e=Xo(t);if(!e.T)if("F"===e.limitType)e.T=Ks(e.path,e.collectionGroup,ga(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=ga(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ia(o.field,s))}var a=e.endAt?new na(e.endAt.position,!e.endAt.before):null,u=e.startAt?new na(e.startAt.position,!e.startAt.before):null;e.T=Ks(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.T}function ma(t,e,n){return new ua(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ba(t,e){return $s(va(t),va(e))&&t.limitType===e.limitType}function wa(t){return zs(va(t))+"|lt:"+t.limitType}function Ea(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+ks(e.value);var e})).join(", ")+"]"),Es(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+ra(t.startAt)),t.endAt&&(e+=", endAt: "+ra(t.endAt)),"Target("+e+")"}(va(t))+"; limitType="+t.limitType+")"}function Ia(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):_s.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!sa(t.startAt,ga(t),e)||t.endAt&&sa(t.endAt,ga(t),e))}(t,e)}function Ta(t){return function(e,n){for(var r=!1,i=0,o=ga(t);i<o.length;i++){var s=o[i],a=_a(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function _a(t,e,n){var r=t.field.isKeyField()?_s.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?Ds(r,i):Wo()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Wo()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Sa(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Is(e)?"-0":e}}function Aa(t){return{integerValue:""+t}}function Na(t,e){return Ts(e)?Aa(e):Sa(t,e)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Da=function(){this._=void 0};function Ca(t,e,n){return t instanceof Ra?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Oa?La(t,e):t instanceof Pa?Fa(t,e):function(t,e){var n=xa(t,e),r=Va(n)+Va(t.A);return Os(n)&&Os(t.A)?Aa(r):Sa(t.R,r)}(t,e)}function ka(t,e,n){return t instanceof Oa?La(t,e):t instanceof Pa?Fa(t,e):n}function xa(t,e){return t instanceof Ma?Os(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Ra=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return At(e,t),e}(Da),Oa=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return At(e,t),e}(Da);function La(t,e){for(var n=Ua(e),r=function(t){n.some((function(e){return As(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Pa=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return At(e,t),e}(Da);function Fa(t,e){for(var n=Ua(e),r=function(t){n=n.filter((function(e){return!As(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Ma=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return At(e,t),e}(Da);function Va(t){return gs(t.integerValue||t.doubleValue)}function Ua(t){return Ls(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var qa=function(t,e){this.field=t,this.transform=e},ja=function(t,e){this.version=t,this.transformResults=e},Ba=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Ka(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var za=function(){};function $a(t,e,n){t instanceof Ya?function(t,e,n){var r=t.value.clone(),i=Za(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof Xa?function(t,e,n){if(Ka(t.precondition,e)){var r=Za(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(Ja(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Ga(t,e,n){t instanceof Ya?function(t,e,n){if(Ka(t.precondition,e)){var r=t.value.clone(),i=tu(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(Wa(e),r).setHasLocalMutations()}}(t,e,n):t instanceof Xa?function(t,e,n){if(Ka(t.precondition,e)){var r=tu(t.fieldTransforms,n,e),i=e.data;i.setAll(Ja(t)),i.setAll(r),e.convertToFoundDocument(Wa(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){Ka(t.precondition,e)&&e.convertToNoDocument(is.min())}(t,e)}function Ha(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),a=xa(o.transform,s||null);null!=a&&(null==n&&(n=Us.empty()),n.set(o.field,a))}return n||null}function Qa(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&es(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Oa&&e instanceof Oa||t instanceof Pa&&e instanceof Pa?es(t.elements,e.elements,As):t instanceof Ma&&e instanceof Ma?As(t.A,e.A):t instanceof Ra&&e instanceof Ra}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Wa(t){return t.isFoundDocument()?t.version:is.min()}var Ya=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return At(e,t),e}(za),Xa=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return At(e,t),e}(za);function Ja(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function Za(t,e,n){var r=new Map;Yo(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,ka(s,a,n[i]))}return r}function tu(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=n.data.field(s.field);r.set(s.field,Ca(a,u,e))}return r}var eu,nu,ru=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return At(e,t),e}(za),iu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return At(e,t),e}(za),ou=function(t){this.count=t};function su(t){switch(t){default:return Wo();case jo.CANCELLED:case jo.UNKNOWN:case jo.DEADLINE_EXCEEDED:case jo.RESOURCE_EXHAUSTED:case jo.INTERNAL:case jo.UNAVAILABLE:case jo.UNAUTHENTICATED:return!1;case jo.INVALID_ARGUMENT:case jo.NOT_FOUND:case jo.ALREADY_EXISTS:case jo.PERMISSION_DENIED:case jo.FAILED_PRECONDITION:case jo.ABORTED:case jo.OUT_OF_RANGE:case jo.UNIMPLEMENTED:case jo.DATA_LOSS:return!0}}function au(t){if(void 0===t)return Go("GRPC error has no .code"),jo.UNKNOWN;switch(t){case eu.OK:return jo.OK;case eu.CANCELLED:return jo.CANCELLED;case eu.UNKNOWN:return jo.UNKNOWN;case eu.DEADLINE_EXCEEDED:return jo.DEADLINE_EXCEEDED;case eu.RESOURCE_EXHAUSTED:return jo.RESOURCE_EXHAUSTED;case eu.INTERNAL:return jo.INTERNAL;case eu.UNAVAILABLE:return jo.UNAVAILABLE;case eu.UNAUTHENTICATED:return jo.UNAUTHENTICATED;case eu.INVALID_ARGUMENT:return jo.INVALID_ARGUMENT;case eu.NOT_FOUND:return jo.NOT_FOUND;case eu.ALREADY_EXISTS:return jo.ALREADY_EXISTS;case eu.PERMISSION_DENIED:return jo.PERMISSION_DENIED;case eu.FAILED_PRECONDITION:return jo.FAILED_PRECONDITION;case eu.ABORTED:return jo.ABORTED;case eu.OUT_OF_RANGE:return jo.OUT_OF_RANGE;case eu.UNIMPLEMENTED:return jo.UNIMPLEMENTED;case eu.DATA_LOSS:return jo.DATA_LOSS;default:return Wo()}}(nu=eu||(eu={}))[nu.OK=0]="OK",nu[nu.CANCELLED=1]="CANCELLED",nu[nu.UNKNOWN=2]="UNKNOWN",nu[nu.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",nu[nu.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",nu[nu.NOT_FOUND=5]="NOT_FOUND",nu[nu.ALREADY_EXISTS=6]="ALREADY_EXISTS",nu[nu.PERMISSION_DENIED=7]="PERMISSION_DENIED",nu[nu.UNAUTHENTICATED=16]="UNAUTHENTICATED",nu[nu.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",nu[nu.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",nu[nu.ABORTED=10]="ABORTED",nu[nu.OUT_OF_RANGE=11]="OUT_OF_RANGE",nu[nu.UNIMPLEMENTED=12]="UNIMPLEMENTED",nu[nu.INTERNAL=13]="INTERNAL",nu[nu.UNAVAILABLE=14]="UNAVAILABLE",nu[nu.DATA_LOSS=15]="DATA_LOSS";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var uu=function(){function t(t,e){this.comparator=t,this.root=e||hu.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,hu.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,hu.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new cu(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new cu(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new cu(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new cu(this.root,t,this.comparator,!0)},t}(),cu=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),hu=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Wo();if(this.right.isRed())throw Wo();var t=this.left.check();if(t!==this.right.check())throw Wo();return t+(this.isRed()?0:1)},t}();hu.EMPTY=null,hu.RED=!0,hu.BLACK=!1,hu.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Wo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Wo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Wo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Wo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Wo()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new hu(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var lu=function(){function t(t){this.comparator=t,this.data=new uu(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new fu(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new fu(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),fu=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),pu=new uu(_s.comparator);function du(){return pu}var yu=new uu(_s.comparator);function gu(){return yu}var vu=new uu(_s.comparator);var mu=new lu(_s.comparator);function bu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=mu,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var wu=new lu(ts);function Eu(){return wu}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Iu=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,Tu.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(is.min(),r,Eu(),du(),bu())},t}(),Tu=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(ps.EMPTY_BYTE_STRING,n,bu(),bu(),bu())},t}(),_u=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},Su=function(t,e){this.targetId=t,this.V=e},Au=function(t,e,n,r){void 0===n&&(n=ps.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Nu=function(){function t(){this.S=0,this.D=ku(),this.C=ps.EMPTY_BYTE_STRING,this.N=!1,this.k=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"F",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.k},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.k=!0,this.C=t)},t.prototype.M=function(){var t=bu(),e=bu(),n=bu();return this.D.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Wo()}})),new Tu(this.C,this.N,t,e,n)},t.prototype.L=function(){this.k=!1,this.D=ku()},t.prototype.B=function(t,e){this.k=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.k=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.k=!0,this.N=!0},t}(),Du=function(){function t(t){this.W=t,this.G=new Map,this.H=du(),this.J=Cu(),this.Y=new lu(ts)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.F||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.F||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:Wo()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach((function(t,r){n.st(r)&&e(r)}))},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(Gs(i))if(0===n){var o=new _s(i.path);this.tt(e,o,js.newNoDocument(o,is.min()))}else Yo(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach((function(r,i){var o=e.ot(i);if(o){if(r.current&&Gs(o.target)){var s=new _s(o.target.path);null!==e.H.get(s)||e.at(i,s)||e.tt(i,s,js.newNoDocument(s,t))}r.$&&(n.set(i,r.M()),r.L())}}));var r=bu();this.J.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Iu(t,n,this.Y,this.H,r);return this.H=du(),this.J=Cu(),this.Y=new lu(ts),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new Nu,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new lu(ts),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||$o("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.F?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new Nu),this.W.getRemoteKeysForTarget(t).forEach((function(n){e.tt(t,n,null)}))},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function Cu(){return new uu(_s.comparator)}function ku(){return new uu(_s.comparator)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var xu={asc:"ASCENDING",desc:"DESCENDING"},Ru={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ou=function(t,e){this.databaseId=t,this.I=e};function Lu(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Pu(t,e){return t.I?e.toBase64():e.toUint8Array()}function Fu(t,e){return Lu(t,e.toTimestamp())}function Mu(t){return Yo(!!t),is.fromTimestamp(function(t){var e=ys(t);return new rs(e.seconds,e.nanos)}(t))}function Vu(t,e){return function(t){return new cs(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Uu(t){var e=cs.fromString(t);return Yo(uc(e)),e}function qu(t,e){return Vu(t.databaseId,e.path)}function ju(t,e){var n=Uu(e);if(n.get(1)!==t.databaseId.projectId)throw new Bo(jo.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Bo(jo.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new _s($u(n))}function Bu(t,e){return Vu(t.databaseId,e)}function Ku(t){var e=Uu(t);return 4===e.length?cs.emptyPath():$u(e)}function zu(t){return new cs(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function $u(t){return Yo(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Gu(t,e,n){return{name:qu(t,e),fields:n.value.mapValue.fields}}function Hu(t,e){var n;if(e instanceof Ya)n={update:Gu(t,e.key,e.value)};else if(e instanceof ru)n={delete:qu(t,e.key)};else if(e instanceof Xa)n={update:Gu(t,e.key,e.data),updateMask:ac(e.fieldMask)};else{if(!(e instanceof iu))return Wo();n={verify:qu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof Ra)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Oa)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Pa)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Ma)return{fieldPath:e.field.canonicalString(),increment:n.A};throw Wo()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Fu(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Wo()}(t,e.precondition)),n}function Qu(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Ba.updateTime(Mu(t.updateTime)):void 0!==t.exists?Ba.exists(t.exists):Ba.none()}(e.currentDocument):Ba.none(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)Yo("REQUEST_TIME"===e.setToServerValue),n=new Ra;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new Oa(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new Pa(i)}else"increment"in e?n=new Ma(t,e.increment):Wo();var o=ls.fromServerFormat(e.fieldPath);return new qa(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=ju(t,e.update.name),o=new Us({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){var e=t.fieldPaths||[];return new fs(e.map((function(t){return ls.fromServerFormat(t)})))}(e.updateMask);return new Xa(i,o,s,n,r)}return new Ya(i,o,n,r)}if(e.delete){var a=ju(t,e.delete);return new ru(a,n)}if(e.verify){var u=ju(t,e.verify);return new iu(u,n)}return Wo()}function Wu(t,e){return{documents:[Bu(t,e.path)]}}function Yu(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Bu(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Bu(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(Fs(t.value))return{unaryFilter:{field:rc(t.field),op:"IS_NAN"}};if(Ps(t.value))return{unaryFilter:{field:rc(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Fs(t.value))return{unaryFilter:{field:rc(t.field),op:"IS_NOT_NAN"}};if(Ps(t.value))return{unaryFilter:{field:rc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:rc(t.field),op:nc(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:rc(t.field),direction:ec(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.I||Es(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=Zu(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Zu(e.endAt)),n}function Xu(t){var e=Ku(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Yo(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=Ju(n.where));var a=[];n.orderBy&&(a=n.orderBy.map((function(t){return function(t){return new ia(ic(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return Es(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=tc(n.startAt));var h=null;return n.endAt&&(h=tc(n.endAt)),ca(e,i,a,s,u,"F",c,h)}function Ju(t){return t?void 0!==t.unaryFilter?[sc(t)]:void 0!==t.fieldFilter?[oc(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return Ju(t)})).reduce((function(t,e){return t.concat(e)})):Wo():[]}function Zu(t){return{before:t.before,values:t.position}}function tc(t){var e=!!t.before,n=t.values||[];return new na(n,e)}function ec(t){return xu[t]}function nc(t){return Ru[t]}function rc(t){return{fieldPath:t.canonicalString()}}function ic(t){return ls.fromServerFormat(t.fieldPath)}function oc(t){return Hs.create(ic(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Wo()}}(t.fieldFilter.op),t.fieldFilter.value)}function sc(t){switch(t.unaryFilter.op){case"IS_NAN":var e=ic(t.unaryFilter.field);return Hs.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=ic(t.unaryFilter.field);return Hs.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=ic(t.unaryFilter.field);return Hs.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=ic(t.unaryFilter.field);return Hs.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Wo()}}function ac(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function uc(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function cc(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=lc(e)),e=hc(t.get(n),e);return lc(e)}function hc(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function lc(t){return t+""}function fc(t){var e=t.length;if(Yo(e>=2),2===e)return Yo(""===t.charAt(0)&&""===t.charAt(1)),cs.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&Wo(),t.charAt(s+1)){case"":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Wo()}o=s+2}return new cs(r)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var pc=function(t,e){this.seconds=t,this.nanoseconds=e},dc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};dc.store="owner",dc.key="owner";var yc=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};yc.store="mutationQueues",yc.keyPath="userId";var gc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};gc.store="mutations",gc.keyPath="batchId",gc.userMutationsIndex="userMutationsIndex",gc.userMutationsKeyPath=["userId","batchId"];var vc=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,cc(e)]},t.key=function(t,e,n){return[t,cc(e),n]},t}();vc.store="documentMutations",vc.PLACEHOLDER=new vc;var mc=function(t,e){this.path=t,this.readTime=e},bc=function(t,e){this.path=t,this.version=e},wc=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};wc.store="remoteDocuments",wc.readTimeIndex="readTimeIndex",wc.readTimeIndexPath="readTime",wc.collectionReadTimeIndex="collectionReadTimeIndex",wc.collectionReadTimeIndexPath=["parentPath","readTime"];var Ec=function(t){this.byteSize=t};Ec.store="remoteDocumentGlobal",Ec.key="remoteDocumentGlobalKey";var Ic=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Ic.store="targets",Ic.keyPath="targetId",Ic.queryTargetsIndexName="queryTargetsIndex",Ic.queryTargetsKeyPath=["canonicalId","targetId"];var Tc=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Tc.store="targetDocuments",Tc.keyPath=["targetId","path"],Tc.documentTargetsIndex="documentTargetsIndex",Tc.documentTargetsKeyPath=["path","targetId"];var _c=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};_c.key="targetGlobalKey",_c.store="targetGlobal";var Sc=function(t,e){this.collectionId=t,this.parent=e};Sc.store="collectionParents",Sc.keyPath=["collectionId","parent"];var Ac=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Ac.store="clientMetadata",Ac.keyPath="clientId";var Nc=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Nc.store="bundles",Nc.keyPath="bundleId";var Dc=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Dc.store="namedQueries",Dc.keyPath="name";var Cc=Rt(Rt([],Rt(Rt([],Rt(Rt([],Rt(Rt([],[yc.store,gc.store,vc.store,wc.store,Ic.store,dc.store,_c.store,Tc.store]),[Ac.store])),[Ec.store])),[Sc.store])),[Nc.store,Dc.store]),kc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",xc=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),Rc=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},Oc=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&Wo(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),Lc=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new Rc,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new Mc(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=Bc(e.target.error);n.ft.reject(new Mc(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Mc(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||($o("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Uc(e)},t}(),Pc=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t(Vt())&&Go("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return $o("SimpleDb","Removing database:",t),qc(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=Vt(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return Dt(this,void 0,void 0,(function(){var e,n=this;return Ct(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:($o("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new Mc(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new Bo(jo.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new Mc(t,n))},i.onupgradeneeded=function(t){$o("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.wt.Rt(e,i.transaction,t.oldVersion,n.version).next((function(){$o("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}}))}))},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return Dt(this,void 0,void 0,(function(){var i,o,s,a,u;return Ct(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,h;return Ct(this,(function(l){switch(l.label){case 0:++o,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,a.At(t)];case 2:return a.db=l.sent(),e=Lc.open(a.db,t,i?"readonly":"readwrite",n),s=r(e).catch((function(t){return e.abort(t),Oc.reject(t)})).toPromise(),u={},s.catch((function(){})),[4,e.dt];case 3:return[2,(u.value=(l.sent(),s),u)];case 4:return c=l.sent(),h="FirebaseError"!==c.name&&o<3,$o("SimpleDb","Transaction failed with error:",c.message,"Retrying:",h),a.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Fc=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return qc(this.Pt.delete())},t}(),Mc=function(t){function e(e,n){var r=this;return(r=t.call(this,jo.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return At(e,t),e}(Bo);function Vc(t){return"IndexedDbTransactionError"===t.name}var Uc=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?($o("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):($o("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),qc(n)},t.prototype.add=function(t){return $o("SimpleDb","ADD",this.store.name,t,t),qc(this.store.add(t))},t.prototype.get=function(t){var e=this;return qc(this.store.get(t)).next((function(n){return void 0===n&&(n=null),$o("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return $o("SimpleDb","DELETE",this.store.name,t),qc(this.store.delete(t))},t.prototype.count=function(){return $o("SimpleDb","COUNT",this.store.name),qc(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.kt=function(t,e){$o("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Ft=!1;var r=this.cursor(n);return this.xt(r,(function(t,e,n){return n.delete()}))},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new Oc((function(n,r){e.onerror=function(t){var e=Bc(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.xt=function(t,e){var n=[];return new Oc((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Fc(i),s=e(i.primaryKey,i.value,o);if(s instanceof Oc){var a=s.catch((function(t){return o.done(),Oc.reject(t)}));n.push(a)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return Oc.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Ft?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function qc(t){return new Oc((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=Bc(t.target.error);n(e)}}))}var jc=!1;function Bc(t){var e=Pc._t(Vt());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Bo("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return jc||(jc=!0,setTimeout((function(){throw r}),0)),r}}return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Kc=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return At(e,t),e}(xc);function zc(t,e){var n=Xo(t);return Pc.It(n.Mt,e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var $c=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&$a(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&Ga(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&Ga(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(is.min())}))},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),bu())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&es(this.mutations,t.mutations,(function(t,e){return Qa(t,e)}))&&es(this.baseMutations,t.baseMutations,(function(t,e){return Qa(t,e)}))},t}(),Gc=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){Yo(e.mutations.length===r.length);for(var i=vu,o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Hc=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=is.min()),void 0===o&&(o=is.min()),void 0===s&&(s=ps.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),Qc=function(t){this.Lt=t};function Wc(t,e){if(e.document)return function(t,e,n){var r=ju(t,e.name),i=Mu(e.updateTime),o=new Us({mapValue:{fields:e.fields}}),s=js.newFoundDocument(r,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=_s.fromSegments(e.noDocument.path),r=th(e.noDocument.readTime),i=js.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=_s.fromSegments(e.unknownDocument.path);return r=th(e.unknownDocument.version),js.newUnknownDocument(o,r)}return Wo()}function Yc(t,e,n){var r=Xc(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:qu(t,e.key),fields:e.data.value.mapValue.fields,updateTime:Lu(t,e.version.toTimestamp())}}(t.Lt,e),s=e.hasCommittedMutations;return new wc(null,null,o,s,r,i)}if(e.isNoDocument()){var a=e.key.path.toArray(),u=Zc(e.version);return s=e.hasCommittedMutations,new wc(null,new mc(a,u),null,s,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),h=Zc(e.version);return new wc(new bc(c,h),null,null,!0,r,i)}return Wo()}function Xc(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Jc(t){var e=new rs(t[0],t[1]);return is.fromTimestamp(e)}function Zc(t){var e=t.toTimestamp();return new pc(e.seconds,e.nanoseconds)}function th(t){var e=new rs(t.seconds,t.nanoseconds);return is.fromTimestamp(e)}function eh(t,e){for(var n=(e.baseMutations||[]).map((function(e){return Qu(t.Lt,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var s=e.mutations.map((function(e){return Qu(t.Lt,e)})),a=rs.fromMillis(e.localWriteTimeMs);return new $c(e.batchId,a,n,s)}function nh(t){var e,n,r=th(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?th(t.lastLimboFreeSnapshotVersion):is.min();return void 0!==t.query.documents?(Yo(1===(n=t.query).documents.length),e=va(ha(Ku(n.documents[0])))):e=function(t){return va(Xu(t))}(t.query),new Hc(e,t.targetId,0,t.lastListenSequenceNumber,r,i,ps.fromBase64String(t.resumeToken))}function rh(t,e){var n,r=Zc(e.snapshotVersion),i=Zc(e.lastLimboFreeSnapshotVersion);n=Gs(e.target)?Wu(t.Lt,e.target):Yu(t.Lt,e.target);var o=e.resumeToken.toBase64();return new Ic(e.targetId,zs(e.target),r,o,e.sequenceNumber,i,n)}function ih(t){var e=Xu({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?ma(e,e.limit,"L"):e}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var oh=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return sh(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:th(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return sh(t).put({bundleId:(n=e).id,createTime:Zc(Mu(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return ah(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:ih(e.bundledQuery),readTime:th(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return ah(t).put(function(t){return{name:t.name,readTime:Zc(Mu(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function sh(t){return zc(t,Nc.store)}function ah(t){return zc(t,Dc.store)}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var uh=function(){function t(){this.Bt=new ch}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),Oc.resolve()},t.prototype.getCollectionParents=function(t,e){return Oc.resolve(this.Bt.getEntries(e))},t}(),ch=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new lu(cs.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new lu(cs.comparator)).toArray()},t}(),hh=function(){function t(){this.qt=new ch}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.qt.add(e)}));var o={collectionId:r,parent:cc(i)};return lh(t).put(o)}return Oc.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[ns(e),""],!1,!0);return lh(t).Nt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(fc(o.parent))}return n}))},t}();function lh(t){return zc(t,Sc.store)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var fh={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ph=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function dh(t,e,n){var r=t.store(gc.store),i=t.store(vc.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.$t({range:s},(function(t,e,n){return a++,n.delete()}));o.push(u.next((function(){Yo(1===a)})));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],p=vc.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return Oc.waitFor(o).next((function(){return c}))}function yh(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Wo();e=t.noDocument}return JSON.stringify(e).length}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */ph.DEFAULT_COLLECTION_PERCENTILE=10,ph.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ph.DEFAULT=new ph(41943040,ph.DEFAULT_COLLECTION_PERCENTILE,ph.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ph.DISABLED=new ph(-1,0,0);var gh=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Kt={}}return t.Qt=function(e,n,r,i){return Yo(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return mh(t).$t({index:gc.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=bh(t),s=mh(t);return s.add({}).next((function(a){Yo("number"==typeof a);for(var u=new $c(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return Hu(t.Lt,e)})),i=n.mutations.map((function(e){return Hu(t.Lt,e)}));return new gc(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),h=[],l=new lu((function(t,e){return ts(t.canonicalString(),e.canonicalString())})),f=0,p=r;f<p.length;f++){var d=p[f],y=vc.key(i.userId,d.key.path,a);l=l.add(d.key.path.popLast()),h.push(s.put(c)),h.push(o.put(y,vc.PLACEHOLDER))}return l.forEach((function(e){h.push(i.Ut.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.Kt[a]=u.keys()})),Oc.waitFor(h).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return mh(t).get(e).next((function(t){return t?(Yo(t.userId===n.userId),eh(n.R,t)):null}))},t.prototype.jt=function(t,e){var n=this;return this.Kt[e]?Oc.resolve(this.Kt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.Kt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return mh(t).$t({index:gc.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(Yo(e.batchId>=r),o=eh(n.R,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return mh(t).$t({index:gc.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return mh(t).Nt(gc.userMutationsIndex,n).next((function(t){return t.map((function(t){return eh(e.R,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=vc.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return bh(t).$t({range:i},(function(r,i,s){var a=r[0],u=r[1],c=r[2],h=fc(u);if(a===n.userId&&e.path.isEqual(h))return mh(t).get(c).next((function(t){if(!t)throw Wo();Yo(t.userId===n.userId),o.push(eh(n.R,t))}));s.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new lu(ts),i=[];return e.forEach((function(e){var o=vc.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=bh(t).$t({range:s},(function(t,i,o){var s=t[0],a=t[1],u=t[2],c=fc(a);s===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(a)})),Oc.waitFor(i).next((function(){return n.Wt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=vc.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new lu(ts);return bh(t).$t({range:s},(function(t,e,o){var s=t[0],u=t[1],c=t[2],h=fc(u);s===n.userId&&r.isPrefixOf(h)?h.length===i&&(a=a.add(c)):o.done()})).next((function(){return n.Wt(t,a)}))},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(mh(t).get(e).next((function(t){if(null===t)throw Wo();Yo(t.userId===n.userId),r.push(eh(n.R,t))})))})),Oc.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return dh(t.Mt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Gt(e.batchId)})),Oc.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Gt=function(t){delete this.Kt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return Oc.resolve();var r=IDBKeyRange.lowerBound(vc.prefixForUser(e.userId)),i=[];return bh(t).$t({range:r},(function(t,n,r){if(t[0]===e.userId){var o=fc(t[1]);i.push(o)}else r.done()})).next((function(){Yo(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return vh(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return wh(t).get(this.userId).next((function(t){return t||new yc(e.userId,-1,"")}))},t}();function vh(t,e,n){var r=vc.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return bh(t).$t({range:o,Ft:!0},(function(t,n,r){var o=t[0],a=t[1];t[2],o===e&&a===i&&(s=!0),r.done()})).next((function(){return s}))}function mh(t){return zc(t,gc.store)}function bh(t){return zc(t,vc.store)}function wh(t){return zc(t,yc.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Eh=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),Ih=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next((function(n){var r=new Eh(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next((function(t){return is.fromTimestamp(new rs(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next((function(){return n.Xt(t).next((function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return Th(t).delete(e.targetId)})).next((function(){return n.Xt(t)})).next((function(e){return Yo(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Th(t).$t((function(s,a){var u=nh(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return Oc.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return Th(t).$t((function(t,n){var r=nh(n);e(r)}))},t.prototype.Xt=function(t){return _h(t).get(_c.key).next((function(t){return Yo(null!==t),t}))},t.prototype.Zt=function(t,e){return _h(t).put(_c.key,e)},t.prototype.te=function(t,e){return Th(t).put(rh(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=zs(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Th(t).$t({range:r,index:Ic.queryTargetsIndexName},(function(t,n,r){var o=nh(n);$s(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Sh(t);return e.forEach((function(e){var s=cc(e.path);i.push(o.put(new Tc(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))})),Oc.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Sh(t);return Oc.forEach(e,(function(e){var o=cc(e.path);return Oc.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Sh(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Sh(t),i=bu();return r.$t({range:n,Ft:!0},(function(t,e,n){var r=fc(t[1]),o=new _s(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=cc(e.path),r=IDBKeyRange.bound([n],[ns(n)],!1,!0),i=0;return Sh(t).$t({index:Tc.documentTargetsIndex,Ft:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.lt=function(t,e){return Th(t).get(e).next((function(t){return t?nh(t):null}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Th(t){return zc(t,Ic.store)}function _h(t){return zc(t,_c.store)}function Sh(t){return zc(t,Tc.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ah(t){return Dt(this,void 0,void 0,(function(){return Ct(this,(function(e){if(t.code!==jo.FAILED_PRECONDITION||t.message!==kc)throw t;return $o("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Nh(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=ts(n,i);return 0===s?ts(r,o):s}var Dh=function(){function t(t){this.ne=t,this.buffer=new lu(Nh),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Nh(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Ch=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;$o("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return Dt(e,void 0,void 0,(function(){var e;return Ct(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return Vc(e=n.sent())?($o("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Ah(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),kh=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return Oc.resolve(qo.o);var r=new Dh(e);return this.ae.forEachTarget(t,(function(t){return r.re(t.sequenceNumber)})).next((function(){return n.ae.le(t,(function(t){return r.re(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?($o("LruGarbageCollector","Garbage collection skipped; disabled"),Oc.resolve(fh)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?($o("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),fh):n.fe(t,e)}))},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,s,a,u,c=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>c.params.maximumSequenceNumbersToCollect?($o("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)})).next((function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)})).next((function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)})).next((function(t){return u=Date.now(),zo()<=ee.DEBUG&&$o("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-h)+"ms"),Oc.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),xh=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new kh(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.de=function(t){var e=0;return this.le(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return Rh(t,n)},t.prototype.removeReference=function(t,e,n){return Rh(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return Rh(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return wh(t).Ot((function(r){return vh(t,r,e).next((function(t){return t&&(n=!0),Oc.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,(function(s,a){if(a<=e){var u=n._e(t,s).next((function(e){if(!e)return o++,r.getEntry(t,s).next((function(){return r.removeEntry(s),Sh(t).delete([0,cc(s.path)])}))}));i.push(u)}})).next((function(){return Oc.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Rh(t,e)},t.prototype.we=function(t,e){var n,r=Sh(t),i=qo.o;return r.$t({index:Tc.documentTargetsIndex},(function(t,r){var o=t[0];t[1];var s=r.path,a=r.sequenceNumber;0===o?(i!==qo.o&&e(new _s(fc(n)),i),i=a,n=s):i=qo.o})).next((function(){i!==qo.o&&e(new _s(fc(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function Rh(t,e){return Sh(t).put(function(t,e){return new Tc(0,cc(t.path),e)}(e,t.currentSequenceNumber))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Oh=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.equalsFn(s,t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){ss(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];t(s,a)}}))},t.prototype.isEmpty=function(){return as(this.inner)},t}(),Lh=function(){function t(){this.changes=new Oh((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:is.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:js.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?Oc.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),Ph=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return Vh(t).put(Uh(e),n)},t.prototype.removeEntry=function(t,e){var n=Vh(t),r=Uh(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.me(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return Vh(t).get(Uh(e)).next((function(t){return n.ye(e,t)}))},t.prototype.ge=function(t,e){var n=this;return Vh(t).get(Uh(e)).next((function(t){return{document:n.ye(e,t),size:yh(t)}}))},t.prototype.getEntries=function(t,e){var n=this,r=du();return this.pe(t,e,(function(t,e){var i=n.ye(t,e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.Ee=function(t,e){var n=this,r=du(),i=new uu(_s.comparator);return this.pe(t,e,(function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,yh(e))})).next((function(){return{documents:r,Te:i}}))},t.prototype.pe=function(t,e,n){if(e.isEmpty())return Oc.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return Vh(t).$t({range:r},(function(t,e,r){for(var s=_s.fromSegments(t);o&&_s.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=du(),o=e.path.length+1,s={};if(n.isEqual(is.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=Xc(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=wc.collectionReadTimeIndex}return Vh(t).$t(s,(function(t,n,s){if(t.length===o){var a=Wc(r.R,n);e.path.isPrefixOf(a.key.path)?Ia(e,a)&&(i=i.insert(a.key,a)):s.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new Fh(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return Mh(t).get(Ec.key).next((function(t){return Yo(!!t),t}))},t.prototype.me=function(t,e){return Mh(t).put(Ec.key,e)},t.prototype.ye=function(t,e){if(e){var n=Wc(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(is.min()))return n}return js.newInvalidDocument(t)},t}(),Fh=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new Oh((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return At(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new lu((function(t,e){return ts(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,s){var a=e.Ae.get(o);if(s.document.isValidDocument()){var u=Yc(e.Ie.R,s.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=yh(u);r+=c-a,n.push(e.Ie.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var h=Yc(e.Ie.R,js.newNoDocument(o,is.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,h))}else n.push(e.Ie.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))})),n.push(this.Ie.updateMetadata(t,r)),Oc.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next((function(t){return n.Ae.set(e,t.size),t.document}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next((function(t){var e=t.documents;return t.Te.forEach((function(t,e){n.Ae.set(t,e)})),e}))},e}(Lh);
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Mh(t){return zc(t,Ec.store)}function Vh(t){return zc(t,wc.store)}function Uh(t){return t.path.toArray()}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var qh=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;Yo(n<r&&n>=0&&r<=11);var o=new Lc("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(dc.store)}(t),function(t){t.createObjectStore(yc.store,{keyPath:yc.keyPath}),t.createObjectStore(gc.store,{keyPath:gc.keyPath,autoIncrement:!0}).createIndex(gc.userMutationsIndex,gc.userMutationsKeyPath,{unique:!0}),t.createObjectStore(vc.store)}(t),jh(t),function(t){t.createObjectStore(wc.store)}(t));var s=Oc.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Tc.store),t.deleteObjectStore(Ic.store),t.deleteObjectStore(_c.store)}(t),jh(t)),s=s.next((function(){return function(t){var e=t.store(_c.store),n=new _c(0,0,is.min().toTimestamp(),0);return e.put(_c.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(gc.store).Nt().next((function(n){t.deleteObjectStore(gc.store),t.createObjectStore(gc.store,{keyPath:gc.keyPath,autoIncrement:!0}).createIndex(gc.userMutationsIndex,gc.userMutationsKeyPath,{unique:!0});var r=e.store(gc.store),i=n.map((function(t){return r.put(t)}));return Oc.waitFor(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Ac.store,{keyPath:Ac.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.Re(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(Ec.store)}(t),i.be(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ve(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.Pe(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(wc.store);e.createIndex(wc.readTimeIndex,wc.readTimeIndexPath,{unique:!1}),e.createIndex(wc.collectionReadTimeIndex,wc.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(Nc.store,{keyPath:Nc.keyPath})}(t),function(t){t.createObjectStore(Dc.store,{keyPath:Dc.keyPath})}(t)}))),s},t.prototype.be=function(t){var e=0;return t.store(wc.store).$t((function(t,n){e+=yh(n)})).next((function(){var n=new Ec(e);return t.store(Ec.store).put(Ec.key,n)}))},t.prototype.Re=function(t){var e=this,n=t.store(yc.store),r=t.store(gc.store);return n.Nt().next((function(n){return Oc.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(gc.userMutationsIndex,i).next((function(r){return Oc.forEach(r,(function(r){Yo(r.userId===n.userId);var i=eh(e.R,r);return dh(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ve=function(t){var e=t.store(Tc.store),n=t.store(wc.store);return t.store(_c.store).get(_c.key).next((function(t){var r=[];return n.$t((function(n,i){var o=new cs(n),s=function(t){return[0,cc(t)]}(o);r.push(e.get(s).next((function(n){return n?Oc.resolve():function(n){return e.put(new Tc(0,cc(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return Oc.waitFor(r)}))}))},t.prototype.Pe=function(t,e){t.createObjectStore(Sc.store,{keyPath:Sc.keyPath});var n=e.store(Sc.store),r=new ch,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:cc(i)})}};return e.store(wc.store).$t({Ft:!0},(function(t,e){var n=new cs(t);return i(n.popLast())})).next((function(){return e.store(vc.store).$t({Ft:!0},(function(t,e){t[0];var n=t[1];t[2];var r=fc(n);return i(r.popLast())}))}))},t.prototype.Ve=function(t){var e=this,n=t.store(Ic.store);return n.$t((function(t,r){var i=nh(r),o=rh(e.R,i);return n.put(o)}))},t}();function jh(t){t.createObjectStore(Tc.store,{keyPath:Tc.keyPath}).createIndex(Tc.documentTargetsIndex,Tc.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ic.store,{keyPath:Ic.keyPath}).createIndex(Ic.queryTargetsIndexName,Ic.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(_c.store)}var Bh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Kh=function(){function t(e,n,r,i,o,s,a,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=s,this.document=a,this.De=c,this.Ce=h,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ke=null,this.inForeground=!1,this.Fe=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new Bo(jo.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new xh(this,i),this.Le=n+"main",this.R=new Qc(u),this.Be=new Pc(this.Le,11,new qh(this.R)),this.qe=new Ih(this.referenceDelegate,this.R),this.Ut=new hh,this.Ue=function(t,e){return new Ph(t,e)}(this.R,this.Ut),this.Ke=new oh,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===h&&Go("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Bo(jo.FAILED_PRECONDITION,Bh);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.qe.getHighestSequenceNumber(e)}))})).then((function(e){t.Ne=new qo(e,t.De)})).then((function(){t.xe=!0})).catch((function(e){return t.Be&&t.Be.close(),Promise.reject(e)}))},t.prototype.He=function(t){var e=this;return this.Me=function(n){return Dt(e,void 0,void 0,(function(){return Ct(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt((function(n){return Dt(e,void 0,void 0,(function(){return Ct(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget((function(){return Dt(e,void 0,void 0,(function(){return Ct(this,(function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return $h(e).put(new Ac(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Je(e).next((function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable((function(){return t.Me(!1)})))}))})).next((function(){return t.Ye(e)})).next((function(n){return t.isPrimary&&!n?t.Xe(e).next((function(){return!1})):!!n&&t.Ze(e).next((function(){return!0}))}))})).catch((function(e){if(Vc(e))return $o("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return $o("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Se.enqueueRetryable((function(){return t.Me(e)})),t.isPrimary=e}))},t.prototype.Je=function(t){var e=this;return zh(t).get(dc.key).next((function(t){return Oc.resolve(e.tn(t))}))},t.prototype.en=function(t){return $h(t).delete(this.clientId)},t.prototype.nn=function(){return Dt(this,void 0,void 0,(function(){var t,e,n,r,i=this;return Ct(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=zc(t,Ac.store);return e.Nt().next((function(t){var n=i.rn(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return Oc.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Qe)for(e=0,n=t;e<n.length;e++)r=n[e],this.Qe.removeItem(this.on(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.je().then((function(){return t.nn()})).then((function(){return t.ze()}))}))},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?Oc.resolve(!0):zh(t).get(dc.key).next((function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new Bo(jo.FAILED_PRECONDITION,Bh);return!1}}return!(!e.networkEnabled||!e.inForeground)||$h(t).Nt().next((function(t){return void 0===e.rn(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&$o("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return Dt(this,void 0,void 0,(function(){var t=this;return Ct(this,(function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[dc.store,Ac.store],(function(e){var n=new Kc(e,qo.o);return t.Xe(n).next((function(){return t.en(n)}))}))];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}}))}))},t.prototype.rn=function(t,e){var n=this;return t.filter((function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)}))},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return $h(e).Nt().next((function(e){return t.rn(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return gh.Qt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;$o("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Be.runTransaction(t,o,Cc,(function(o){return i=new Kc(o,r.Ne?r.Ne.next():qo.o),"readwrite-primary"===e?r.Je(i).next((function(t){return!!t||r.Ye(i)})).next((function(e){if(!e)throw Go("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new Bo(jo.FAILED_PRECONDITION,kc);return n(i)})).next((function(t){return r.Ze(i).next((function(){return t}))})):r.dn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.dn=function(t){var e=this;return zh(t).get(dc.key).next((function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Bo(jo.FAILED_PRECONDITION,Bh)}))},t.prototype.Ze=function(t){var e=new dc(this.clientId,this.allowTabSynchronization,Date.now());return zh(t).put(dc.key,e)},t.yt=function(){return Pc.yt()},t.prototype.Xe=function(t){var e=this,n=zh(t);return n.get(dc.key).next((function(t){return e.tn(t)?($o("IndexedDbPersistence","Releasing primary lease."),n.delete(dc.key)):Oc.resolve()}))},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Go("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Fe=function(){t.Se.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.je()}))},this.document.addEventListener("visibilitychange",this.Fe),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.Fe&&(this.document.removeEventListener("visibilitychange",this.Fe),this.Fe=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.ke=function(){e.un(),!Ut()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")&&navigator.appVersion.match("Version/14")&&e.Se.enterRestrictedMode(!0),e.Se.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.ke))},t.prototype.hn=function(){this.ke&&(this.window.removeEventListener("pagehide",this.ke),this.ke=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Qe)||void 0===e?void 0:e.getItem(this.on(t)));return $o("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Go("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(t){Go("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function zh(t){return zc(t,dc.store)}function $h(t){return zc(t,Ac.store)}function Gh(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var Hh=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.yn(t,e,r)}))},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next((function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t}))},t.prototype.gn=function(t,e){t.forEach((function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)}))},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next((function(e){return n.En(t,e).next((function(){return e}))}))},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.gn(e,t)}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return _s.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):ya(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new _s(e)).next((function(t){var e=gu();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=gu();return this.Ut.getCollectionParents(t,i).next((function(s){return Oc.forEach(s,(function(s){var a=function(t,e){return new ua(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.An(t,a,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.Rn(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,h=r.get(c);null==h&&(h=js.newInvalidDocument(c),r=r.insert(c,h)),Ga(u,h,o.localWriteTime),h.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(t,n){Ia(e,n)||(r=r.remove(t))})),r}))},t.prototype.Rn=function(t,e,n){for(var r=bu(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof Xa&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))})),c}))},t}(),Qh=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=bu(),i=bu(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Wh=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(is.min())?this.Dn(t,e):this.Sn.pn(t,r).next((function(o){var s=i.Cn(e,o);return(la(e)||fa(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(zo()<=ee.DEBUG&&$o("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Ea(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next((function(t){return s.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.Cn=function(t,e){var n=new lu(Ta(t));return e.forEach((function(e,r){Ia(t,r)&&(n=n.add(r))})),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return zo()<=ee.DEBUG&&$o("QueryEngine","Using full collection scan to execute query:",Ea(e)),this.Sn.getDocumentsMatchingQuery(t,e,is.min())},t}(),Yh=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.kn=new uu(ts),this.Fn=new Oh((function(t){return zs(t)}),$s),this.$n=is.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new Hh(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.kn)}))},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Xh(t,e,n,r){return new Yh(t,e,n,r)}function Jh(t,e){return Dt(this,void 0,void 0,(function(){var n,r,i,o;return Ct(this,(function(s){switch(s.label){case 0:return n=Xo(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n._n.getAllMutationBatches(t).next((function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new Hh(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],s=bu(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];s=s.add(f.key)}}for(var p=0,d=e;p<d.length;p++){var y=d[p];r.push(y.batchId);for(var g=0,v=y.mutations;g<v.length;g++){var m=v[g];s=s.add(m.key)}}return i.pn(t,s).next((function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return o=s.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}}))}))}function Zh(t,e){var n=Xo(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=Oc.resolve();return o.forEach((function(t){s=s.next((function(){return r.getEntry(e,t)})).next((function(e){var o=n.docVersions.get(t);Yo(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))}))})),s.next((function(){return t._n.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}function tl(t){var e=Xo(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.qe.getLastRemoteSnapshotVersion(t)}))}function el(t,e){var n=Xo(t),r=e.snapshotVersion,i=n.kn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.kn;var s=[];e.targetChanges.forEach((function(e,o){var a=i.get(o);if(a){s.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)})));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=a.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return Yo(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,c,e)&&s.push(n.qe.updateTargetData(t,c))}}}));var a=du();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),s.push(function(t,e,n,r,i){var o=bu();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=du();return n.forEach((function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s.isNoDocument()&&s.version.isEqual(is.min())?(e.removeEntry(n,u),o=o.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):$o("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)})),o}))}(t,o,e.documentUpdates,r,void 0).next((function(t){a=t}))),!r.isEqual(is.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next((function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)}));s.push(u)}return Oc.waitFor(s).next((function(){return o.apply(t)})).next((function(){return n.Mn.En(t,a)})).next((function(){return a}))})).then((function(t){return n.kn=i,t}))}function nl(t,e){var n=Xo(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)}))}function rl(t,e){var n=Xo(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.qe.getTargetData(t,e).next((function(i){return i?(r=i,Oc.resolve(r)):n.qe.allocateTargetId(t).next((function(i){return r=new Hc(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.kn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.kn=n.kn.insert(t.targetId,t),n.Fn.set(e,t.targetId)),t}))}function il(t,e,n){return Dt(this,void 0,void 0,(function(){var r,i,o,s;return Ct(this,(function(a){switch(a.label){case 0:r=Xo(t),i=r.kn.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.referenceDelegate.removeTarget(t,i)}))];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!Vc(s=a.sent()))throw s;return $o("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.kn=r.kn.remove(e),r.Fn.delete(i.target),[2]}}))}))}function ol(t,e,n){var r=Xo(t),i=is.min(),o=bu();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=Xo(t),i=r.Fn.get(n);return void 0!==i?Oc.resolve(r.kn.get(i)):r.qe.getTargetData(e,n)}(r,t,va(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:is.min(),n?o:bu())})).next((function(t){return{documents:t,Bn:o}}))}))}function sl(t,e){var n=Xo(t),r=Xo(n.qe),i=n.kn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.lt(t,e).next((function(t){return t?t.target:null}))}))}function al(t){var e=Xo(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=Xo(t),i=du(),o=Xc(n),s=Vh(e),a=IDBKeyRange.lowerBound(o,!0);return s.$t({index:wc.readTimeIndex,range:a},(function(t,e){var n=Wc(r.R,e);i=i.insert(n.key,n),o=e.readTime})).next((function(){return{wn:i,readTime:Jc(o)}}))}(e.On,t,e.$n)})).then((function(t){var n=t.wn,r=t.readTime;return e.$n=r,n}))}function ul(t){return Dt(this,void 0,void 0,(function(){var e;return Ct(this,(function(n){return[2,(e=Xo(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=Vh(t),n=is.min();return e.$t({index:wc.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=Jc(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.$n=t}))]}))}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var cl=function(){function t(t){this.R=t,this.Qn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return Oc.resolve(this.Qn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Qn.set(e.id,{id:(n=e).id,version:n.version,createTime:Mu(n.createTime)}),Oc.resolve()},t.prototype.getNamedQuery=function(t,e){return Oc.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:ih(t.bundledQuery),readTime:Mu(t.readTime)}}(e)),Oc.resolve()},t}(),hl=function(){function t(){this.Wn=new lu(ll.Gn),this.zn=new lu(ll.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new ll(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.Yn(new ll(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.Zn=function(t){var e=this,n=new _s(new cs([])),r=new ll(n,t),i=new ll(n,t+1),o=[];return this.zn.forEachInRange([r,i],(function(t){e.Yn(t),o.push(t.key)})),o},t.prototype.ts=function(){var t=this;this.Wn.forEach((function(e){return t.Yn(e)}))},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new _s(new cs([])),n=new ll(e,t),r=new ll(e,t+1),i=bu();return this.zn.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new ll(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),ll=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return _s.comparator(t.key,e.key)||ts(t.ns,e.ns)},t.Hn=function(t,e){return ts(t.ns,e.ns)||_s.comparator(t.key,e.key)},t}(),fl=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new lu(ll.Gn)}return t.prototype.checkEmpty=function(t){return Oc.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new $c(i,e,n,r);this._n.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.rs=this.rs.add(new ll(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return Oc.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return Oc.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.cs(n),i=r<0?0:r;return Oc.resolve(this._n.length>i?this._n[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return Oc.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return Oc.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new ll(e,0),i=new ll(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(t){var e=n.os(t.ns);o.push(e)})),Oc.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new lu(ts);return e.forEach((function(t){var e=new ll(t,0),i=new ll(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],(function(t){r=r.add(t.ns)}))})),Oc.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;_s.isDocumentKey(i)||(i=i.child(""));var o=new ll(new _s(i),0),s=new lu(ts);return this.rs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.ns)),!0)}),o),Oc.resolve(this.us(s))},t.prototype.us=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.os(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;Yo(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return Oc.forEach(e.mutations,(function(i){var o=new ll(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.rs=r}))},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new ll(e,0),r=this.rs.firstAfterOrEqual(n);return Oc.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return this._n.length,Oc.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),pl=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new uu(_s.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:s,readTime:n}),this.size+=s-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Oc.resolve(n?n.document.clone():js.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=du();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():js.newInvalidDocument(t))})),Oc.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=du(),i=new _s(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.key,u=s.value,c=u.document,h=u.readTime;if(!e.path.isPrefixOf(a.path))break;h.compareTo(n)<=0||Ia(e,c)&&(r=r.insert(c.key,c.clone()))}return Oc.resolve(r)},t.prototype.fs=function(t,e){return Oc.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new dl(this)},t.prototype.getSize=function(t){return Oc.resolve(this.size)},t}(),dl=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return At(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)})),Oc.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(Lh),yl=function(){function t(t){this.persistence=t,this.ds=new Oh((function(t){return zs(t)}),$s),this.lastRemoteSnapshotVersion=is.min(),this.highestTargetId=0,this.ws=0,this._s=new hl,this.targetCount=0,this.ys=Eh.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach((function(t,n){return e(n)})),Oc.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return Oc.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return Oc.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),Oc.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),Oc.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new Eh(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,Oc.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),Oc.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,Oc.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach((function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.ds.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)})),Oc.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return Oc.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return Oc.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),Oc.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),Oc.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),Oc.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return Oc.resolve(n)},t.prototype.containsKey=function(t,e){return Oc.resolve(this._s.containsKey(e))},t}(),gl=function(){function t(t,e){var n=this;this.gs={},this.Ne=new qo(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new yl(this),this.Ut=new uh,this.Ue=function(t,e){return new pl(t,(function(t){return n.referenceDelegate.ps(t)}))}(this.Ut),this.R=new Qc(e),this.Ke=new cl(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new fl(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;$o("MemoryPersistence","Starting transaction:",t);var i=new vl(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(t){return r.referenceDelegate.Ts(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Is=function(t,e){return Oc.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),vl=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return At(e,t),e}(xc),ml=function(){function t(t){this.persistence=t,this.As=new hl,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw Wo()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),Oc.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),Oc.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),Oc.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach((function(t){return n.vs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.vs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Oc.forEach(this.vs,(function(r){var i=_s.fromPath(r);return e.Ps(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Rs=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next((function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())}))},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return Oc.or([function(){return Oc.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),bl=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function wl(t,e){return"firestore_clients_"+t+"_"+e}function El(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function Il(t,e){return"firestore_targets_"+t+"_"+e}bl.UNAUTHENTICATED=new bl(null),bl.GOOGLE_CREDENTIALS=new bl("google-credentials-uid"),bl.FIRST_PARTY=new bl("first-party-uid"),bl.MOCK_USER=new bl("mock-user");var Tl=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new Bo(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(Go("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),_l=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Bo(i.error.code,i.error.message)),o?new t(e,i.state,r):(Go("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Sl=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Eu(),s=0;i&&s<r.activeTargetIds.length;++s)i=Ts(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(Go("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),Al=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Go("SharedClientState","Failed to parse online state: "+e),null)},t}(),Nl=function(){function t(){this.activeTargetIds=Eu()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Dl=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.ks.bind(this),this.Fs=new uu(ts),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=wl(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Fs=this.Fs.insert(this.Ns,new Nl),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Ks=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return Dt(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,a,u,c,h,l=this;return Ct(this,(function(f){switch(f.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(wl(this.persistenceKey,r)))&&(o=Sl.Vs(r,i))&&(this.Fs=this.Fs.insert(o.clientId,o));for(this.Qs(),(s=this.storage.getItem(this.Us))&&(a=this.js(s))&&this.Ws(a),u=0,c=this.$s;u<c.length;u++)h=c[u],this.ks(h);return this.$s=[],this.window.addEventListener("pagehide",(function(){return l.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.Fs)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.Fs.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(Il(this.persistenceKey,t));if(n){var r=_l.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Qs(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(Il(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.Hs(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return $o("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){$o("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){$o("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.ks=function(t){var e=this,n=t;if(n.storageArea===this.storage){if($o("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void Go("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return Dt(e,void 0,void 0,(function(){var t,e,r,i,o,s;return Ct(this,(function(a){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(s=function(t){var e=qo.o;if(null!=t)try{var n=JSON.parse(t);Yo("number"==typeof n),e=n}catch(t){Go("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==qo.o&&this.sequenceNumberHandler(s);else if(n.key===this.Ks)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.Fs.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new Tl(this.currentUser,t,e,n),i=El(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=El(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){var e={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(e))},t.prototype.Ys=function(t,e,n){var r=Il(this.persistenceKey,t),i=new _l(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return Sl.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Tl.Vs(new bl(i),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return _l.Vs(r,e)},t.prototype.js=function(t){return Al.Vs(t)},t.prototype.ii=function(t){return Dt(this,void 0,void 0,(function(){return Ct(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:($o("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.Fs.insert(t,e):this.Fs.remove(t),i=this.Gs(this.Fs),o=this.Gs(r),s=[],a=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||a.push(t)})),this.syncEngine.hi(s,a).then((function(){n.Fs=r}))},t.prototype.Ws=function(t){this.Fs.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=Eu();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),Cl=function(){function t(){this.li=new Nl,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new Nl,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),kl=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),xl=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){$o("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){$o("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Rl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Ol=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),Ll=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return At(e,t),e.prototype.Fi=function(t,e,n,r){return new Promise((function(i,o){var s=new Uo;s.listenOnce(Oo.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case Ro.NO_ERROR:var e=s.getResponseJson();$o("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Ro.TIMEOUT:$o("Connection",'RPC "'+t+'" timed out'),o(new Bo(jo.DEADLINE_EXCEEDED,"Request time out"));break;case Ro.HTTP_ERROR:var n=s.getStatus();if($o("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(jo).indexOf(e)>=0?e:jo.UNKNOWN}(r.status);o(new Bo(a,r.message))}else o(new Bo(jo.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Bo(jo.UNAVAILABLE,"Connection failed."));break;default:Wo()}}finally{$o("Connection",'RPC "'+t+'" completed.')}}));var a=JSON.stringify(r);s.send(e,"POST",a,n,15)}))},e.prototype.Oi=function(t,e){var n,r=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new No,o=br(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(s.xmlHttpFactory=new Mo({})),this.ki(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Vt())||"object"==typeof navigator&&"ReactNative"===navigator.product||Vt().indexOf("Electron/")>=0||function(){var t=Vt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||Vt().indexOf("MSAppHost/")>=0||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=r.join("");$o("Connection","Creating WebChannel: "+a,s);var u=i.createWebChannel(a,s),c=!1,h=!1,l=new Ol({Ei:function(t){h?$o("Connection","Not sending because WebChannel is closed:",t):(c||($o("Connection","Opening WebChannel transport."),u.open(),c=!0),$o("Connection","WebChannel sending:",t),u.send(t))},Ti:function(){return u.close()}}),f=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(u,Vo.EventType.OPEN,(function(){h||$o("Connection","WebChannel transport opened.")})),f(u,Vo.EventType.CLOSE,(function(){h||(h=!0,$o("Connection","WebChannel transport closed"),l.Vi())})),f(u,Vo.EventType.ERROR,(function(t){h||(h=!0,Ho("Connection","WebChannel transport errored:",t),l.Vi(new Bo(jo.UNAVAILABLE,"The operation could not be completed")))})),f(u,Vo.EventType.MESSAGE,(function(t){var e;if(!h){var n=t.data[0];Yo(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){$o("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=eu[t];if(void 0!==e)return au(e)}(o),a=i.message;void 0===s&&(s=jo.INTERNAL,a="Unknown error status: "+o+" with message "+i.message),h=!0,l.Vi(new Bo(s,a)),u.close()}else $o("Connection","WebChannel received:",n),l.Si(n)}})),f(o,Lo.STAT_EVENT,(function(t){t.stat===Po?$o("Connection","Detected buffering proxy"):t.stat===Fo&&$o("Connection","Detected no buffering proxy")})),setTimeout((function(){l.Pi()}),0),l},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);$o("RestConnection","Sending: ",i,n);var o={};return this.ki(o,r),this.Fi(t,i,o,n).then((function(t){return $o("RestConnection","Received: ",t),t}),(function(e){throw Ho("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.ki=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.10.0",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){var n=Rl[t];return this.Di+"/v1/"+e+":"+n},t}());
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Pl(){return"undefined"!=typeof window?window:null}function Fl(){return"undefined"!=typeof document?document:null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ml(t){return new Ou(t,!0)}var Vl=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Qi=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Ki),i=Math.max(0,n-r);i>0&&$o("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return e.Ki=Date.now(),t()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),Ul=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Vl(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return Dt(this,void 0,void 0,(function(){return Ct(this,(function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return t.rr()})))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return Dt(this,void 0,void 0,(function(){return Ct(this,(function(t){return this.er()?[2,this.close(0)]:[2]}))}))},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return Dt(this,void 0,void 0,(function(){return Ct(this,(function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===jo.RESOURCE_EXHAUSTED?(Go(e.toString()),Go("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):e&&e.code===jo.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(e){t.Yi===n&&t.lr(e)}),(function(n){e((function(){var e=new Bo(jo.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)}))}))},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii((function(){n((function(){return e.state=2,e.listener.Ii()}))})),this.stream.Ri((function(t){n((function(){return e.dr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji((function(){return Dt(t,void 0,void 0,(function(){return Ct(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.dr=function(t){return $o("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget((function(){return e.Yi===t?n():($o("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),ql=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,s}return At(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Wo()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(Yo(void 0===e||"string"==typeof e),ps.fromBase64String(e||"")):(Yo(void 0===e||e instanceof Uint8Array),ps.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?jo.UNKNOWN:au(t.code);return new Bo(e,t.message||"")}(a);n=new Au(r,i,o,s||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=ju(t,r.document.name),o=Mu(r.document.updateTime);var a=new Us({mapValue:{fields:r.document.fields}}),u=(s=js.newFoundDocument(i,o,a),r.targetIds||[]),c=r.removedTargetIds||[];n=new _u(u,c,s.key,s)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=ju(t,r.document),o=r.readTime?Mu(r.readTime):is.min(),a=js.newNoDocument(i,o),s=r.removedTargetIds||[],n=new _u([],s,a.key,a);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=ju(t,r.document),o=r.removedTargetIds||[],n=new _u([],o,i,null);else{if(!("filter"in e))return Wo();e.filter;var h=e.filter;h.targetId,r=h.count||0,i=new ou(r),o=h.targetId,n=new Su(o,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return is.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?is.min():e.readTime?Mu(e.readTime):is.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=zu(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=Gs(r)?{documents:Wu(t,r)}:{query:Yu(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Pu(t,e.resumeToken):e.snapshotVersion.compareTo(is.min())>0&&(n.readTime=Lu(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Wo()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=zu(this.R),e.removeTarget=t,this.cr(e)},e}(Ul),jl=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,s.gr=!1,s}return At(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(Yo(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(Yo(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?Mu(t.updateTime):Mu(e);return n.isEqual(is.min())&&(n=Mu(e)),new ja(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=Mu(t.commitTime);return this.listener.Tr(n,e)}return Yo(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=zu(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Hu(e.R,t)}))};this.cr(n)},e}(Ul),Bl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return At(e,t),e.prototype.br=function(){if(this.Rr)throw new Bo(jo.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===jo.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Bo(jo.UNKNOWN,t.toString())}))},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.$i(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===jo.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Bo(jo.UNKNOWN,t.toString())}))},e.prototype.terminate=function(){this.Rr=!0},e}((function(){})),Kl=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()})))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.kr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.kr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(Go(e),this.Vr=!1):$o("OnlineStateTracker",e)},t.prototype.kr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),zl=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Fr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di((function(t){n.enqueueAndForget((function(){return Dt(o,void 0,void 0,(function(){return Ct(this,(function(t){switch(t.label){case 0:return Zl(this)?($o("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return Dt(this,void 0,void 0,(function(){var e;return Ct(this,(function(n){switch(n.label){case 0:return(e=Xo(t)).Or.add(4),[4,Gl(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,$l(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Br=new Kl(n,r)};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function $l(t){return Dt(this,void 0,void 0,(function(){var e,n;return Ct(this,(function(r){switch(r.label){case 0:if(!Zl(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Gl(t){return Dt(this,void 0,void 0,(function(){var e,n;return Ct(this,(function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Hl(t,e){var n=Xo(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),Jl(n)?Xl(n):yf(n).er()&&Wl(n,e))}function Ql(t,e){var n=Xo(t),r=yf(n);n.$r.delete(e),r.er()&&Yl(n,e),0===n.$r.size&&(r.er()?r.ir():Zl(n)&&n.Br.set("Unknown"))}function Wl(t,e){t.qr.U(e.targetId),yf(t).mr(e)}function Yl(t,e){t.qr.U(e),yf(t).yr(e)}function Xl(t){t.qr=new Du({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),yf(t).start(),t.Br.Sr()}function Jl(t){return Zl(t)&&!yf(t).tr()&&t.$r.size>0}function Zl(t){return 0===Xo(t).Or.size}function tf(t){t.qr=void 0}function ef(t){return Dt(this,void 0,void 0,(function(){return Ct(this,(function(e){return t.$r.forEach((function(e,n){Wl(t,e)})),[2]}))}))}function nf(t,e){return Dt(this,void 0,void 0,(function(){return Ct(this,(function(n){return tf(t),Jl(t)?(t.Br.Nr(e),Xl(t)):t.Br.set("Unknown"),[2]}))}))}function rf(t,e,n){return Dt(this,void 0,void 0,(function(){var r,i,o;return Ct(this,(function(s){switch(s.label){case 0:if(t.Br.set("Online"),!(e instanceof Au&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return Dt(this,void 0,void 0,(function(){var n,r,i,o;return Ct(this,(function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?(o=i[r],t.$r.has(o)?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]):[3,5];case 2:s.sent(),t.$r.delete(o),t.qr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),$o("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,of(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof _u?t.qr.X(e):e instanceof Su?t.qr.rt(e):t.qr.et(e),n.isEqual(is.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,tl(t.localStore)];case 8:return i=s.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(ps.EMPTY_BYTE_STRING,n.snapshotVersion)),Yl(t,e);var r=new Hc(n.target,e,1,n.sequenceNumber);Wl(t,r)}})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return $o("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,of(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}}))}))}function of(t,e,n){return Dt(this,void 0,void 0,(function(){var r=this;return Ct(this,(function(i){switch(i.label){case 0:if(!Vc(e))throw e;return t.Or.add(1),[4,Gl(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return tl(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return Dt(r,void 0,void 0,(function(){return Ct(this,(function(e){switch(e.label){case 0:return $o("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,$l(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function sf(t,e){return e().catch((function(n){return of(t,n,e)}))}function af(t){return Dt(this,void 0,void 0,(function(){var e,n,r,i,o;return Ct(this,(function(s){switch(s.label){case 0:e=Xo(t),n=gf(e),r=e.Fr.length>0?e.Fr[e.Fr.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return Zl(t)&&t.Fr.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,nl(e.localStore,r)];case 3:return null===(i=s.sent())?(0===e.Fr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.Fr.push(e);var n=gf(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,of(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return uf(e)&&cf(e),[2]}}))}))}function uf(t){return Zl(t)&&!gf(t).tr()&&t.Fr.length>0}function cf(t){gf(t).start()}function hf(t){return Dt(this,void 0,void 0,(function(){return Ct(this,(function(e){return gf(t).Ar(),[2]}))}))}function lf(t){return Dt(this,void 0,void 0,(function(){var e,n,r,i;return Ct(this,(function(o){for(e=gf(t),n=0,r=t.Fr;n<r.length;n++)i=r[n],e.Er(i.mutations);return[2]}))}))}function ff(t,e,n){return Dt(this,void 0,void 0,(function(){var r,i;return Ct(this,(function(o){switch(o.label){case 0:return r=t.Fr.shift(),i=Gc.from(r,e,n),[4,sf(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,af(t)];case 2:return o.sent(),[2]}}))}))}function pf(t,e){return Dt(this,void 0,void 0,(function(){return Ct(this,(function(n){switch(n.label){case 0:return e&&gf(t).pr?[4,function(t,e){return Dt(this,void 0,void 0,(function(){var n,r;return Ct(this,(function(i){switch(i.label){case 0:return su(r=e.code)&&r!==jo.ABORTED?(n=t.Fr.shift(),gf(t).sr(),[4,sf(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,af(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return uf(t)&&cf(t),[2]}}))}))}function df(t,e){return Dt(this,void 0,void 0,(function(){var n;return Ct(this,(function(r){switch(r.label){case 0:return n=Xo(t),e?(n.Or.delete(2),[4,$l(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,Gl(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function yf(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=Xo(t);return r.br(),new ql(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:ef.bind(null,t),Ri:nf.bind(null,t),_r:rf.bind(null,t)}),t.Mr.push((function(n){return Dt(e,void 0,void 0,(function(){return Ct(this,(function(e){switch(e.label){case 0:return n?(t.Ur.sr(),Jl(t)?Xl(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),tf(t),e.label=3;case 3:return[2]}}))}))}))),t.Ur}function gf(t){var e=this;return t.Kr||(t.Kr=function(t,e,n){var r=Xo(t);return r.br(),new jl(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:hf.bind(null,t),Ri:pf.bind(null,t),Ir:lf.bind(null,t),Tr:ff.bind(null,t)}),t.Mr.push((function(n){return Dt(e,void 0,void 0,(function(){return Ct(this,(function(e){switch(e.label){case 0:return n?(t.Kr.sr(),[4,af(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kr.stop()];case 3:e.sent(),t.Fr.length>0&&($o("RemoteStore","Stopping write stream with "+t.Fr.length+" pending writes"),t.Fr=[]),e.label=4;case 4:return[2]}}))}))}))),t.Kr
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var vf=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Rc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Bo(jo.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function mf(t,e){if(Go("AsyncQueue",e+": "+t),Vc(t))return new Bo(jo.UNAVAILABLE,e+": "+t);throw t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var bf=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||_s.comparator(e.key,n.key)}:function(t,e){return _s.comparator(t.key,e.key)},this.keyedMap=gu(),this.sortedSet=new uu(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),wf=function(){function t(){this.Qr=new uu(_s.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Qr.get(e);n?0!==t.type&&3===n.type?this.Qr=this.Qr.insert(e,t):3===t.type&&1!==n.type?this.Qr=this.Qr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Qr=this.Qr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Qr=this.Qr.remove(e):1===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):Wo():this.Qr=this.Qr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Qr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),Ef=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,bf.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&ba(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),If=function(){this.Wr=void 0,this.listeners=[]},Tf=function(){this.queries=new Oh((function(t){return wa(t)}),ba),this.onlineState="Unknown",this.Gr=new Set};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function _f(t,e){return Dt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u;return Ct(this,(function(c){switch(c.label){case 0:if(n=Xo(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new If),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=c.sent(),[3,4];case 3:return a=c.sent(),u=mf(a,"Initialization of query '"+Ea(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&Df(n),[2]}}))}))}function Sf(t,e){return Dt(this,void 0,void 0,(function(){var n,r,i,o,s;return Ct(this,(function(a){return n=Xo(t),r=e.query,i=!1,(o=n.queries.get(r))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function Af(t,e){for(var n=Xo(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,u=n.queries.get(a);if(u){for(var c=0,h=u.listeners;c<h.length;c++)h[c].Hr(s)&&(r=!0);u.Wr=s}}r&&Df(n)}function Nf(t,e,n){var r=Xo(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Df(t){t.Gr.forEach((function(t){t.next()}))}var Cf=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Ef(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.so&&n||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=Ef.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),kf=function(t){this.key=t},xf=function(t){this.key=t},Rf=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=bu(),this.mutatedKeys=bu(),this.lo=Ta(t),this.fo=new bf(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new wf,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=la(this.query)&&i.size===this.query.limit?i.last():null,c=fa(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var h=i.get(t),l=Ia(n.query,e)?e:null,f=!!h&&n.mutatedKeys.has(h.key),p=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),d=!1;h&&l?h.data.isEqual(l.data)?f!==p&&(r.track({type:3,doc:l}),d=!0):n.yo(h,l)||(r.track({type:2,doc:l}),d=!0,(u&&n.lo(l,u)>0||c&&n.lo(l,c)<0)&&(a=!0)):!h&&l?(r.track({type:0,doc:l}),d=!0):h&&!l&&(r.track({type:1,doc:h}),d=!0,(u||c)&&(a=!0)),d&&(l?(s=s.add(l),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),la(this.query)||fa(this.query))for(;s.size>this.query.limit;){var h=la(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fo:s,mo:r,Nn:a,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Wo()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)})),this.po(n);var s=e?this.Eo():[],a=0===this.ho.size&&this.current?1:0,u=a!==this.ao;return this.ao=a,0!==o.length||u?{snapshot:new Ef(this.query,t.fo,i,o,t.mutatedKeys,0===a,u,!1),To:s}:{To:s}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new wf,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.uo=e.uo.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.uo=e.uo.delete(t)})),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=bu(),this.fo.forEach((function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))}));var n=[];return e.forEach((function(e){t.ho.has(e)||n.push(new xf(e))})),this.ho.forEach((function(t){e.has(t)||n.push(new kf(t))})),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=bu();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return Ef.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),Of=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Lf=function(t){this.key=t,this.bo=!1},Pf=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new Oh((function(t){return wa(t)}),ba),this.Vo=new Map,this.So=new Set,this.Do=new uu(_s.comparator),this.Co=new Map,this.No=new hl,this.xo={},this.ko=new Map,this.Fo=Eh.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ff(t,e){return Dt(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Ct(this,(function(u){switch(u.label){case 0:return n=lp(t),(o=n.Po.get(e))?(r=o.targetId,n.sharedClientState.addLocalQueryTarget(r),i=o.view.Ro(),[3,4]):[3,1];case 1:return[4,rl(n.localStore,va(e))];case 2:return s=u.sent(),a=n.sharedClientState.addLocalQueryTarget(s.targetId),r=s.targetId,[4,Mf(n,e,r,"current"===a)];case 3:i=u.sent(),n.isPrimaryClient&&Hl(n.remoteStore,s),u.label=4;case 4:return[2,i]}}))}))}function Mf(t,e,n,r){return Dt(this,void 0,void 0,(function(){var i,o,s,a,u,c;return Ct(this,(function(h){switch(h.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return Dt(this,void 0,void 0,(function(){var i,o,s;return Ct(this,(function(a){switch(a.label){case 0:return(i=e.view._o(n)).Nn?[4,ol(t.localStore,e.query,!1).then((function(t){var n=t.documents;return e.view._o(n,i)}))]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(Yf(t,e.targetId,s.To),s.snapshot)]}}))}))}(t,e,n,r)},[4,ol(t.localStore,e,!0)];case 1:return i=h.sent(),o=new Rf(e,i.Bn),s=o._o(i.documents),a=Tu.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(s,t.isPrimaryClient,a),Yf(t,n,u.To),c=new Of(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}}))}))}function Vf(t,e){return Dt(this,void 0,void 0,(function(){var n,r,i;return Ct(this,(function(o){switch(o.label){case 0:return n=Xo(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter((function(t){return!ba(t,e)}))),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,il(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),Ql(n.remoteStore,r.targetId),Qf(n,r.targetId)})).catch(Ah)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Qf(n,r.targetId),[4,il(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function Uf(t,e,n){return Dt(this,void 0,void 0,(function(){var r,i,o,s;return Ct(this,(function(a){switch(a.label){case 0:r=fp(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=Xo(t),i=rs.now(),o=e.reduce((function(t,e){return t.add(e.key)}),bu());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Mn.pn(t,o).next((function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],h=Ha(c,n.get(c.key));null!=h&&s.push(new Xa(c.key,h,qs(h.value.mapValue),Ba.exists(!0)))}return r._n.addMutationBatch(t,i,s,e)}))})).then((function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}}))}(r.localStore,e)];case 2:return i=a.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new uu(ts)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,Zf(r,i.changes)];case 3:return a.sent(),[4,af(r.remoteStore)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=mf(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}}))}))}function qf(t,e){return Dt(this,void 0,void 0,(function(){var n,r;return Ct(this,(function(i){switch(i.label){case 0:n=Xo(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,el(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.Co.get(e);r&&(Yo(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?Yo(r.bo):t.removedDocuments.size>0&&(Yo(r.bo),r.bo=!1))})),[4,Zf(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Ah(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function jf(t,e,n){var r=Xo(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=Xo(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)})),r&&Df(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Bf(t,e,n){return Dt(this,void 0,void 0,(function(){var r,i,o,s,a,u;return Ct(this,(function(c){switch(c.label){case 0:return(r=Xo(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(s=(s=new uu(_s.comparator)).insert(o,js.newNoDocument(o,is.min())),a=bu().add(o),u=new Iu(is.min(),new Map,new lu(ts),s,a),[4,qf(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),Jf(r),[3,4];case 2:return[4,il(r.localStore,e,!1).then((function(){return Qf(r,e,n)})).catch(Ah)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function Kf(t,e){return Dt(this,void 0,void 0,(function(){var n,r,i;return Ct(this,(function(o){switch(o.label){case 0:n=Xo(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,Zh(n.localStore,e)];case 2:return i=o.sent(),Hf(n,r,null),Gf(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,Zf(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ah(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function zf(t,e,n){return Dt(this,void 0,void 0,(function(){var r,i;return Ct(this,(function(o){switch(o.label){case 0:r=Xo(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Xo(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n._n.lookupMutationBatch(t,e).next((function(e){return Yo(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}(r.localStore,e)];case 2:return i=o.sent(),Hf(r,e,n),Gf(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,Zf(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ah(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function $f(t,e){return Dt(this,void 0,void 0,(function(){var n,r,i,o,s;return Ct(this,(function(a){switch(a.label){case 0:Zl((n=Xo(t)).remoteStore)||$o("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=Xo(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e._n.getHighestUnacknowledgedBatchId(t)}))}(n.localStore)];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.ko.get(r)||[]).push(e),n.ko.set(r,i),[3,4]);case 3:return o=a.sent(),s=mf(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}}))}))}function Gf(t,e){(t.ko.get(e)||[]).forEach((function(t){t.resolve()})),t.ko.delete(e)}function Hf(t,e,n){var r=Xo(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function Qf(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach((function(e){t.No.containsKey(e)||Wf(t,e)}))}function Wf(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(Ql(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),Jf(t))}function Yf(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof kf?(t.No.addReference(o.key,e),Xf(t,o)):o instanceof xf?($o("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||Wf(t,o.key)):Wo()}}function Xf(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||($o("SyncEngine","New document in limbo: "+n),t.So.add(r),Jf(t))}function Jf(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new _s(cs.fromString(e)),r=t.Fo.next();t.Co.set(r,new Lf(n)),t.Do=t.Do.insert(n,r),Hl(t.remoteStore,new Hc(va(ha(n.path)),r,2,qo.o))}}function Zf(t,e,n){return Dt(this,void 0,void 0,(function(){var r,i,o,s;return Ct(this,(function(a){switch(a.label){case 0:return r=Xo(t),i=[],o=[],s=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach((function(t,a){s.push(r.Oo(a,e,n).then((function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Qh.Pn(a.targetId,t);o.push(e)}})))})),[4,Promise.all(s)]);case 1:return a.sent(),r.vo._r(i),[4,function(t,e){return Dt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,h;return Ct(this,(function(l){switch(l.label){case 0:n=Xo(t),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return Oc.forEach(e,(function(e){return Oc.forEach(e.bn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return Oc.forEach(e.vn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return l.sent(),[3,4];case 3:if(!Vc(r=l.sent()))throw r;return $o("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)s=o[i],a=s.targetId,s.fromCache||(u=n.kn.get(a),c=u.snapshotVersion,h=u.withLastLimboFreeSnapshotVersion(c),n.kn=n.kn.insert(a,h));return[2]}}))}))}(r.localStore,o)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function tp(t,e){return Dt(this,void 0,void 0,(function(){var n,r;return Ct(this,(function(i){switch(i.label){case 0:return(n=Xo(t)).currentUser.isEqual(e)?[3,3]:($o("SyncEngine","User change. New user:",e.toKey()),[4,Jh(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.ko.forEach((function(t){t.forEach((function(t){t.reject(new Bo(jo.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.ko.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,Zf(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function ep(t,e){var n=Xo(t),r=n.Co.get(e);if(r&&r.bo)return bu().add(r.key);var i=bu(),o=n.Vo.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=a[s],c=n.Po.get(u);i=i.unionWith(c.view.wo)}return i}function np(t,e){return Dt(this,void 0,void 0,(function(){var n,r,i;return Ct(this,(function(o){switch(o.label){case 0:return[4,ol((n=Xo(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&Yf(n,e.targetId,i.To),i)]}}))}))}function rp(t){return Dt(this,void 0,void 0,(function(){var e;return Ct(this,(function(n){return[2,al((e=Xo(t)).localStore).then((function(t){return Zf(e,t)}))]}))}))}function ip(t,e,n,r){return Dt(this,void 0,void 0,(function(){var i,o;return Ct(this,(function(s){switch(s.label){case 0:return[4,function(t,e){var n=Xo(t),r=Xo(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.jt(t,e).next((function(e){return e?n.Mn.pn(t,e):Oc.resolve(null)}))}))}((i=Xo(t)).localStore,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,af(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Hf(i,e,r||null),Gf(i,e),function(t,e){Xo(Xo(t)._n).Gt(e)}(i.localStore,e)):Wo(),s.label=4;case 4:return[4,Zf(i,o)];case 5:return s.sent(),[3,7];case 6:$o("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}}))}))}function op(t,e){return Dt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c;return Ct(this,(function(h){switch(h.label){case 0:return lp(n=Xo(t)),fp(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,sp(n,r.toArray())]);case 1:return i=h.sent(),n.$o=!0,[4,df(n.remoteStore,!0)];case 2:for(h.sent(),o=0,s=i;o<s.length;o++)a=s[o],Hl(n.remoteStore,a);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(u=[],c=Promise.resolve(),n.Vo.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?u.push(e):c=c.then((function(){return Qf(n,e),il(n.localStore,e,!0)})),Ql(n.remoteStore,e)})),[4,c]);case 4:return h.sent(),[4,sp(n,u)];case 5:return h.sent(),function(t){var e=Xo(t);e.Co.forEach((function(t,n){Ql(e.remoteStore,n)})),e.No.ts(),e.Co=new Map,e.Do=new uu(_s.comparator)}(n),n.$o=!1,[4,df(n.remoteStore,!1)];case 6:h.sent(),h.label=7;case 7:return[2]}}))}))}function sp(t,e,n){return Dt(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,h,l,f,p,d,y;return Ct(this,(function(g){switch(g.label){case 0:n=Xo(t),r=[],i=[],o=0,s=e,g.label=1;case 1:return o<s.length?(a=s[o],u=void 0,(c=n.Vo.get(a))&&0!==c.length?[4,rl(n.localStore,va(c[0]))]:[3,7]):[3,13];case 2:u=g.sent(),h=0,l=c,g.label=3;case 3:return h<l.length?(f=l[h],p=n.Po.get(f),[4,np(n,p)]):[3,6];case 4:(d=g.sent()).snapshot&&i.push(d.snapshot),g.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,sl(n.localStore,a)];case 8:return y=g.sent(),[4,rl(n.localStore,y)];case 9:return u=g.sent(),[4,Mf(n,ap(y),a,!1)];case 10:g.sent(),g.label=11;case 11:r.push(u),g.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}}))}))}function ap(t){return ca(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function up(t){var e=Xo(t);return Xo(Xo(e.localStore).persistence).fn()}function cp(t,e,n,r){return Dt(this,void 0,void 0,(function(){var i,o,s;return Ct(this,(function(a){switch(a.label){case 0:return(i=Xo(t)).$o?($o("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,al(i.localStore)];case 3:return o=a.sent(),s=Iu.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,Zf(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,il(i.localStore,e,!0)];case 6:return a.sent(),Qf(i,e,r),[3,8];case 7:Wo(),a.label=8;case 8:return[2]}}))}))}function hp(t,e,n){return Dt(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,h,l,f;return Ct(this,(function(p){switch(p.label){case 0:if(!(r=lp(t)).$o)return[3,10];i=0,o=e,p.label=1;case 1:return i<o.length?(s=o[i],r.Vo.has(s)?($o("SyncEngine","Adding an already active target "+s),[3,5]):[4,sl(r.localStore,s)]):[3,6];case 2:return a=p.sent(),[4,rl(r.localStore,a)];case 3:return u=p.sent(),[4,Mf(r,ap(a),u.targetId,!1)];case 4:p.sent(),Hl(r.remoteStore,u),p.label=5;case 5:return i++,[3,1];case 6:c=function(t){return Ct(this,(function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,il(r.localStore,t,!1).then((function(){Ql(r.remoteStore,t),Qf(r,t)})).catch(Ah)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},h=0,l=n,p.label=7;case 7:return h<l.length?(f=l[h],[5,c(f)]):[3,10];case 8:p.sent(),p.label=9;case 9:return h++,[3,7];case 10:return[2]}}))}))}function lp(t){var e=Xo(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=qf.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ep.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Bf.bind(null,e),e.vo._r=Af.bind(null,e.eventManager),e.vo.Mo=Nf.bind(null,e.eventManager),e}function fp(t){var e=Xo(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Kf.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=zf.bind(null,e),e}var pp=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return Dt(this,void 0,void 0,(function(){return Ct(this,(function(e){switch(e.label){case 0:return this.R=Ml(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Ko(t),[2]}}))}))},t.prototype.Uo=function(t){return null},t.prototype.Ko=function(t){return Xh(this.persistence,new Wh,t.initialUser,this.R)},t.prototype.qo=function(t){return new gl(ml.bs,this.R)},t.prototype.Bo=function(t){return new Cl},t.prototype.terminate=function(){return Dt(this,void 0,void 0,(function(){return Ct(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),dp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qo=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return At(e,t),e.prototype.initialize=function(e){return Dt(this,void 0,void 0,(function(){var n=this;return Ct(this,(function(r){switch(r.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return r.sent(),[4,ul(this.localStore)];case 2:return r.sent(),[4,this.Qo.initialize(this,e)];case 3:return r.sent(),[4,fp(this.Qo.syncEngine)];case 4:return r.sent(),[4,af(this.Qo.remoteStore)];case 5:return r.sent(),[4,this.persistence.He((function(){return n.gcScheduler&&!n.gcScheduler.started&&n.gcScheduler.start(n.localStore),Promise.resolve()}))];case 6:return r.sent(),[2]}}))}))},e.prototype.Ko=function(t){return Xh(this.persistence,new Wh,t.initialUser,this.R)},e.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new Ch(e,t.asyncQueue)},e.prototype.qo=function(t){var e=Gh(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?ph.withCacheSize(this.cacheSizeBytes):ph.DEFAULT;return new Kh(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,Pl(),Fl(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new Cl},e}(pp),yp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Qo=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return At(e,t),e.prototype.initialize=function(e){return Dt(this,void 0,void 0,(function(){var n,r=this;return Ct(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Qo.syncEngine,this.sharedClientState instanceof Dl?(this.sharedClientState.syncEngine={ui:ip.bind(null,n),ai:cp.bind(null,n),hi:hp.bind(null,n),fn:up.bind(null,n),ci:rp.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He((function(t){return Dt(r,void 0,void 0,(function(){return Ct(this,(function(e){switch(e.label){case 0:return[4,op(this.Qo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Bo=function(t){var e=Pl();if(!Dl.yt(e))throw new Bo(jo.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Gh(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new Dl(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(dp),gp=function(){function t(){}return t.prototype.initialize=function(t,e){return Dt(this,void 0,void 0,(function(){var n=this;return Ct(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return jf(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=tp.bind(null,this.syncEngine),[4,df(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new Tf},t.prototype.createDatastore=function(t){var e,n=Ml(t.databaseInfo.databaseId),r=(e=t.databaseInfo,new Ll(e));return function(t,e,n){return new Bl(t,e,n)}(t.credentials,r,n)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return jf(s.syncEngine,t,0)},o=xl.yt()?new xl:new kl,new zl(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){var a=new Pf(t,e,n,r,i,o);return s&&(a.$o=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return Dt(this,void 0,void 0,(function(){var e;return Ct(this,(function(n){switch(n.label){case 0:return e=Xo(t),$o("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,Gl(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}(),vp=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),mp=function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return Dt(this,void 0,void 0,(function(){var e,n=this;return Ct(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Bo(jo.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return Dt(this,void 0,void 0,(function(){var n,r,i,o,s,a;return Ct(this,(function(u){switch(u.label){case 0:return n=Xo(t),r=zu(n.R)+"/documents",i={documents:e.map((function(t){return qu(n.R,t)}))},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){Yo(!!e.found),e.found.name,e.found.updateTime;var n=ju(t,e.found.name),r=Mu(e.found.updateTime),i=new Us({mapValue:{fields:e.found.fields}});return js.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){Yo(!!e.missing),Yo(!!e.readTime);var n=ju(t,e.missing),r=Mu(e.readTime);return js.newNoDocument(n,r)}(t,e):Wo()}(n.R,t);s.set(e.key.toString(),e)})),a=[],[2,(e.forEach((function(t){var e=s.get(t.toString());Yo(!!e),a.push(e)})),a)]}}))}))}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach((function(t){return n.recordVersion(t)})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new ru(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return Dt(this,void 0,void 0,(function(){var t,e=this;return Ct(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=_s.fromPath(n);e.mutations.push(new iu(r,e.precondition(r)))})),[4,function(t,e){return Dt(this,void 0,void 0,(function(){var n,r,i;return Ct(this,(function(o){switch(o.label){case 0:return n=Xo(t),r=zu(n.R)+"/documents",i={writes:e.map((function(t){return Hu(n.R,t)}))},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw Wo();e=is.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Bo(jo.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?Ba.updateTime(e):Ba.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(is.min()))throw new Bo(jo.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ba.updateTime(e)}return Ba.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}(),bp=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new Vl(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.ec-=1,this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji((function(){return Dt(t,void 0,void 0,(function(){var t,e,n=this;return Ct(this,(function(r){return t=new mp(this.datastore),(e=this.sc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.ic(t)}))}))})).catch((function(t){n.ic(t)})),[2]}))}))}))},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!Es(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return e.nc(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!su(e)}return!1},t}(),wp=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=bl.UNAUTHENTICATED,this.clientId=Zo.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,(function(t){return Dt(r,void 0,void 0,(function(){return Ct(this,(function(e){switch(e.label){case 0:return $o("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}}))}))}))}return t.prototype.getConfiguration=function(){return Dt(this,void 0,void 0,(function(){return Ct(this,(function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}))}))},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Bo(jo.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new Rc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return Dt(t,void 0,void 0,(function(){var t,n;return Ct(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=mf(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Ep(t,e){return Dt(this,void 0,void 0,(function(){var n,r,i=this;return Ct(this,(function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),$o("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener((function(t){return Dt(i,void 0,void 0,(function(){return Ct(this,(function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,Jh(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}}))}))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function Ip(t,e){return Dt(this,void 0,void 0,(function(){var n,r;return Ct(this,(function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,Tp(t)];case 1:return n=i.sent(),$o("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener((function(t){return function(t,e){return Dt(this,void 0,void 0,(function(){var n,r;return Ct(this,(function(i){switch(i.label){case 0:return(n=Xo(t)).asyncQueue.verifyOperationInProgress(),$o("RemoteStore","RemoteStore received new credentials"),r=Zl(n),n.Or.add(3),[4,Gl(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,$l(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,t)})),t.onlineComponents=e,[2]}}))}))}function Tp(t){return Dt(this,void 0,void 0,(function(){return Ct(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:($o("FirestoreClient","Using default OfflineComponentProvider"),[4,Ep(t,new pp)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function _p(t){return Dt(this,void 0,void 0,(function(){return Ct(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:($o("FirestoreClient","Using default OnlineComponentProvider"),[4,Ip(t,new gp)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function Sp(t){return Tp(t).then((function(t){return t.persistence}))}function Ap(t){return Tp(t).then((function(t){return t.localStore}))}function Np(t){return _p(t).then((function(t){return t.remoteStore}))}function Dp(t){return _p(t).then((function(t){return t.syncEngine}))}function Cp(t){return Dt(this,void 0,void 0,(function(){var e,n;return Ct(this,(function(r){switch(r.label){case 0:return[4,_p(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=Ff.bind(null,e.syncEngine),n.onUnlisten=Vf.bind(null,e.syncEngine),n)]}}))}))}function kp(t,e,n){var r=this;void 0===n&&(n={});var i=new Rc;return t.asyncQueue.enqueueAndForget((function(){return Dt(r,void 0,void 0,(function(){var r;return Ct(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new vp({next:function(o){e.enqueueAndForget((function(){return Sf(t,s)}));var a=o.docs.has(n);!a&&o.fromCache?i.reject(new Bo(jo.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new Bo(jo.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Cf(ha(n.path),o,{includeMetadataChanges:!0,so:!0});return _f(t,s)},[4,Cp(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}function xp(t,e,n){var r=this;void 0===n&&(n={});var i=new Rc;return t.asyncQueue.enqueueAndForget((function(){return Dt(r,void 0,void 0,(function(){var r;return Ct(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new vp({next:function(n){e.enqueueAndForget((function(){return Sf(t,s)})),n.fromCache&&"server"===r.source?i.reject(new Bo(jo.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Cf(n,o,{includeMetadataChanges:!0,so:!0});return _f(t,s)},[4,Cp(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}var Rp=function(t,e,n,r,i,o,s,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},Op=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Lp=new Map,Pp=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},Fp=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable((function(){return e(bl.UNAUTHENTICATED)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Mp=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Vp=function(){function t(t){var e=this;this.currentUser=bl.UNAUTHENTICATED,this.oc=new Rc,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)}))};var n=function(t){$o("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit((function(t){return n(t)})),setTimeout((function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):($o("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}}),0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.cc!==e?($o("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Yo("string"==typeof n.accessToken),new Pp(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable((function(){return Dt(n,void 0,void 0,(function(){return Ct(this,(function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}}))}))}))},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return Yo(null===t||"string"==typeof t),new bl(t)},t}(),Up=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=bl.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),qp=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new Up(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable((function(){return e(bl.FIRST_PARTY)}))},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function jp(t,e,n){if(!n)throw new Bo(jo.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Bp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Bo(jo.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Kp(t,e,n,r){if(!0===e&&!0===r)throw new Bo(jo.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function zp(t){if(!_s.isDocumentKey(t))throw new Bo(jo.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function $p(t){if(_s.isDocumentKey(t))throw new Bo(jo.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Gp(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Wo()}function Hp(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Bo(jo.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Gp(t);throw new Bo(jo.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Qp(t,e){if(e<=0)throw new Bo(jo.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Wp=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Bo(jo.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Bo(jo.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,Kp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),Yp=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Wp({}),this._settingsFrozen=!1,t instanceof Op?(this._databaseId=t,this._credentials=new Fp):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Bo(jo.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Op(t.options.projectId)}(t),this._credentials=new Vp(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new Bo(jo.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new Bo(jo.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Wp(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new Fp;switch(t.type){case"gapi":var e=t.client;return Yo(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new qp(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Bo(jo.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return this,(t=Lp.get(this))&&($o("ComponentProvider","Removing Datastore"),Lp.delete(this),t.terminate()),Promise.resolve();var t},t}(),Xp=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Zp(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),Jp=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),Zp=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,ha(r))||this)._path=r,i.type="collection",i}return At(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new Xp(this.firestore,null,new _s(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(Jp);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function td(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Qt(t),jp("collection","path",e),t instanceof Yp)return $p(n=cs.fromString.apply(cs,Rt([e],r))),new Zp(t,null,n);if(!(t instanceof Xp||t instanceof Zp))throw new Bo(jo.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return $p(n=cs.fromString.apply(cs,Rt([t.path],r)).child(cs.fromString(e))),new Zp(t.firestore,null,n)}function ed(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=Qt(t),1===arguments.length&&(e=Zo.u()),jp("doc","path",e),t instanceof Yp)return zp(n=cs.fromString.apply(cs,Rt([e],r))),new Xp(t,null,new _s(n));if(!(t instanceof Xp||t instanceof Zp))throw new Bo(jo.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return zp(n=t._path.child(cs.fromString.apply(cs,Rt([e],r)))),new Xp(t.firestore,t instanceof Zp?t.converter:null,new _s(n))}function nd(t,e){return t=Qt(t),e=Qt(e),(t instanceof Xp||t instanceof Zp)&&(e instanceof Xp||e instanceof Zp)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function rd(t,e){return t=Qt(t),e=Qt(e),t instanceof Jp&&e instanceof Jp&&t.firestore===e.firestore&&ba(t._query,e._query)&&t.converter===e.converter
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}var id=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=!1,this.Tc=[],this.Zi=new Vl(this,"async_queue_retry"),this.Ic=function(){var e=Fl();e&&$o("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=Fl();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ic)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ac(),this.Rc(t)},t.prototype.enterRestrictedMode=function(t){if(!this._c){this._c=!0,this.Ec=t||!1;var e=Fl();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Ic)}},t.prototype.enqueue=function(t){var e=this;if(this.Ac(),this._c)return new Promise((function(){}));var n=new Rc;return this.Rc((function(){return e._c&&e.Ec?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.wc.push(t),e.bc()}))},t.prototype.bc=function(){return Dt(this,void 0,void 0,(function(){var t,e=this;return Ct(this,(function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!Vc(t=n.sent()))throw t;return $o("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji((function(){return e.bc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Rc=function(t){var e=this,n=this.dc.then((function(){return e.gc=!0,t().catch((function(t){throw e.yc=t,e.gc=!1,Go("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.gc=!1,t}))}));return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ac(),this.Tc.indexOf(t)>-1&&(e=0);var i=vf.createAndSchedule(this,t,e,n,(function(t){return r.vc(t)}));return this.mc.push(i),i},t.prototype.Ac=function(){this.yc&&Wo()},t.prototype.verifyOperationInProgress=function(){},t.prototype.Pc=function(){return Dt(this,void 0,void 0,(function(){var t;return Ct(this,(function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Vc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Sc=function(t){var e=this;return this.Pc().then((function(){e.mc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.Pc()}))},t.prototype.Dc=function(t){this.Tc.push(t)},t.prototype.vc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function od(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var sd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new id,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return At(e,t),e.prototype._terminate=function(){return this._firestoreClient||ud(this),this._firestoreClient.terminate()},e}(Yp);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ad(t){return t._firestoreClient||ud(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function ud(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new Rp(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new wp(t._credentials,t._queue,r)}function cd(t,e,n){var r=this,i=new Rc;return t.asyncQueue.enqueue((function(){return Dt(r,void 0,void 0,(function(){var r;return Ct(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,Ep(t,n)];case 1:return o.sent(),[4,Ip(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===jo.FAILED_PRECONDITION||t.code===jo.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function hd(t){if(t._initialized||t._terminated)throw new Bo(jo.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ld=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Bo(jo.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ls(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),fd=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(ps.fromBase64String(e))}catch(e){throw new Bo(jo.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(ps.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),pd=function(t){this._methodName=t},dd=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Bo(jo.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Bo(jo.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return ts(this._lat,t._lat)||ts(this._long,t._long)},t}(),yd=/^__.*__$/,gd=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new Xa(t,this.data,this.fieldMask,e,this.fieldTransforms):new Ya(t,this.data,e,this.fieldTransforms)},t}(),vd=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new Xa(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function md(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Wo()}}var bd=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Cc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Nc",{get:function(){return this.settings.Nc},enumerable:!1,configurable:!0}),t.prototype.xc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.kc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,Fc:!1});return r.$c(t),r},t.prototype.Oc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,Fc:!1});return r.Cc(),r},t.prototype.Mc=function(t){return this.xc({path:void 0,Fc:!0})},t.prototype.Lc=function(t){return Ud(t,this.settings.methodName,this.settings.Bc||!1,this.path,this.settings.qc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.Cc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.$c(this.path.get(t))},t.prototype.$c=function(t){if(0===t.length)throw this.Lc("Document fields must not be empty");if(md(this.Nc)&&yd.test(t))throw this.Lc('Document fields cannot begin and end with "__"')},t}(),wd=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||Ml(t)}return t.prototype.Uc=function(t,e,n,r){return void 0===r&&(r=!1),new bd({Nc:t,methodName:e,qc:n,path:ls.emptyPath(),Fc:!1,Bc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function Ed(t){var e=t._freezeSettings(),n=Ml(t._databaseId);return new wd(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Id(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Uc(o.merge||o.mergeFields?2:0,e,n,i);Pd("Data must be an object, but it was:",s,r);var a,u,c=Od(r,s);if(o.merge)a=new fs(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var p=Fd(e,f[l],n);if(!s.contains(p))throw new Bo(jo.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");qd(h,p)||h.push(p)}a=new fs(h),u=s.fieldTransforms.filter((function(t){return a.covers(t.field)}))}else a=null,u=s.fieldTransforms;return new gd(new Us(c),a,u)}var Td=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return At(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Nc)throw 1===t.Nc?t.Lc(this._methodName+"() can only appear at the top level of your update data"):t.Lc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(pd);function _d(t,e,n){return new bd({Nc:3,qc:e.settings.qc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var Sd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return At(e,t),e.prototype._toFieldTransform=function(t){return new qa(t.path,new Ra)},e.prototype.isEqual=function(t){return t instanceof e},e}(pd),Ad=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return At(e,t),e.prototype._toFieldTransform=function(t){var e=_d(this,t,!0),n=this.Kc.map((function(t){return Rd(t,e)})),r=new Oa(n);return new qa(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(pd),Nd=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return At(e,t),e.prototype._toFieldTransform=function(t){var e=_d(this,t,!0),n=this.Kc.map((function(t){return Rd(t,e)})),r=new Pa(n);return new qa(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(pd),Dd=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Qc=n,r}return At(e,t),e.prototype._toFieldTransform=function(t){var e=new Ma(t.R,Na(t.R,this.Qc));return new qa(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(pd);function Cd(t,e,n,r){var i=t.Uc(1,e,n);Pd("Data must be an object, but it was:",i,r);var o=[],s=Us.empty();ss(r,(function(t,r){var a=Vd(e,t,n);r=Qt(r);var u=i.Oc(a);if(r instanceof Td)o.push(a);else{var c=Rd(r,u);null!=c&&(o.push(a),s.set(a,c))}}));var a=new fs(o);return new vd(s,a,i.fieldTransforms)}function kd(t,e,n,r,i,o){var s=t.Uc(1,e,n),a=[Fd(e,r,n)],u=[i];if(o.length%2!=0)throw new Bo(jo.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(Fd(e,o[c])),u.push(o[c+1]);for(var h=[],l=Us.empty(),f=a.length-1;f>=0;--f)if(!qd(h,a[f])){var p=a[f],d=u[f];d=Qt(d);var y=s.Oc(p);if(d instanceof Td)h.push(p);else{var g=Rd(d,y);null!=g&&(h.push(p),l.set(p,g))}}var v=new fs(h);return new vd(l,v,s.fieldTransforms)}function xd(t,e,n,r){return void 0===r&&(r=!1),Rd(n,t.Uc(r?4:3,e))}function Rd(t,e){if(Ld(t=Qt(t)))return Pd("Unsupported field value:",e,t),Od(t,e);if(t instanceof pd)return function(t,e){if(!md(e.Nc))throw e.Lc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Lc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&4!==e.Nc)throw e.Lc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Rd(o[i],e.Mc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=Qt(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Na(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=rs.fromDate(t);return{timestampValue:Lu(e.R,n)}}if(t instanceof rs)return n=new rs(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Lu(e.R,n)};if(t instanceof dd)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof fd)return{bytesValue:Pu(e.R,t._byteString)};if(t instanceof Xp){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Lc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Vu(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Lc("Unsupported field value: "+Gp(t))}(t,e)}function Od(t,e){var n={};return as(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ss(t,(function(t,r){var i=Rd(r,e.kc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Ld(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof rs||t instanceof dd||t instanceof fd||t instanceof Xp||t instanceof pd)}function Pd(t,e,n){if(!Ld(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Gp(n);throw"an object"===r?e.Lc(t+" a custom object"):e.Lc(t+" "+r)}}function Fd(t,e,n){if((e=Qt(e))instanceof ld)return e._internalPath;if("string"==typeof e)return Vd(t,e);throw Ud("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Md=new RegExp("[~\\*/\\[\\]]");function Vd(t,e,n){if(e.search(Md)>=0)throw Ud("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(ld.bind.apply(ld,Rt([void 0],e.split(".")))))._internalPath}catch(r){throw Ud("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Ud(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new Bo(jo.INVALID_ARGUMENT,(a+=". ")+t+u)}function qd(t,e){return t.some((function(t){return t.isEqual(e)}))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var jd=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Xp(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new Bd(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(Kd("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),Bd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return At(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(jd);function Kd(t,e){return"string"==typeof e?Vd(t,e):e instanceof ld?e._internalPath:e._delegate._internalPath}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var zd=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),$d=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return At(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new Gd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(Kd("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(jd),Gd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return At(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}($d),Hd=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new zd(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new Gd(n._firestore,n._userDataWriter,r.key,r,new zd(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Bo(jo.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){return{type:"added",doc:new Gd(t._firestore,t._userDataWriter,e.doc.key,e.doc,new zd(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new Gd(t._firestore,t._userDataWriter,e.doc.key,e.doc,new zd(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Qd(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function Qd(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Wo()}}function Wd(t,e){return t instanceof $d&&e instanceof $d?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Hd&&e instanceof Hd&&t._firestore===e._firestore&&rd(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Yd(t){if(fa(t)&&0===t.explicitOrderBy.length)throw new Bo(jo.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Xd=function(){};function Jd(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var Zd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).jc=e,i.Wc=n,i.Gc=r,i.type="where",i}return At(e,t),e.prototype._apply=function(t){var e=Ed(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new Bo(jo.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){sy(s,o);for(var u=[],c=0,h=s;c<h.length;c++){var l=h[c];u.push(oy(r,t,l))}a={arrayValue:{values:u}}}else a=oy(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||sy(s,o),a=xd(n,"where",s,"in"===o||"not-in"===o);var f=Hs.create(i,o,a);return function(t,e){if(e.g()){var n=da(t);if(null!==n&&!n.isEqual(e.field))throw new Bo(jo.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=pa(t);null!==r&&ay(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new Bo(jo.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Bo(jo.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t._query,0,e,t.firestore._databaseId,this.jc,this.Wc,this.Gc);return new Jp(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new ua(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(Xd),ty=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).jc=e,r.zc=n,r.type="orderBy",r}return At(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Bo(jo.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Bo(jo.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ia(e,n);return function(t,e){if(null===pa(t)){var n=da(t);null!==n&&ay(t,n,e.field)}}(t,r),r}(t._query,this.jc,this.zc);return new Jp(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new ua(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(Xd),ey=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Hc=n,i.Jc=r,i}return At(e,t),e.prototype._apply=function(t){return new Jp(t.firestore,t.converter,ma(t._query,this.Hc,this.Jc))},e}(Xd),ny=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return At(e,t),e.prototype._apply=function(t){var e=iy(t,this.type,this.Yc,this.Xc);return new Jp(t.firestore,t.converter,function(t,e){return new ua(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(Xd),ry=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return At(e,t),e.prototype._apply=function(t){var e=iy(t,this.type,this.Yc,this.Xc);return new Jp(t.firestore,t.converter,function(t,e){return new ua(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(Xd);function iy(t,e,n,r){if(n[0]=Qt(n[0]),n[0]instanceof jd)return function(t,e,n,r,i){if(!r)throw new Bo(jo.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=ga(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(Rs(e,r.key));else{var c=r.data.field(u.field);if(ms(c))throw new Bo(jo.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.canonicalString();throw new Bo(jo.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new na(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=Ed(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new Bo(jo.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new Bo(jo.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!ya(t)&&-1!==c.indexOf("/"))throw new Bo(jo.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(cs.fromString(c));if(!_s.isDocumentKey(h))throw new Bo(jo.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new _s(h);a.push(Rs(e,l))}else{var f=xd(n,r,c);a.push(f)}}return new na(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function oy(t,e,n){if("string"==typeof(n=Qt(n))){if(""===n)throw new Bo(jo.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ya(e)&&-1!==n.indexOf("/"))throw new Bo(jo.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(cs.fromString(n));if(!_s.isDocumentKey(r))throw new Bo(jo.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Rs(t,new _s(r))}if(n instanceof Xp)return Rs(t,n._key);throw new Bo(jo.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Gp(n)+".")}function sy(t,e){if(!Array.isArray(t)||0===t.length)throw new Bo(jo.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Bo(jo.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function ay(t,e,n){if(!n.isEqual(e))throw new Bo(jo.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var uy=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),Ss(t)){case 0:return null;case 1:return t.booleanValue;case 2:return gs(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(vs(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Wo()}},t.prototype.convertObject=function(t,e){var n=this,r={};return ss(t.fields,(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new dd(gs(t.latitude),gs(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=bs(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(ws(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=ys(t);return new rs(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=cs.fromString(t);Yo(uc(n));var r=new Op(n.get(1),n.get(3)),i=new _s(n.popFirst(5));return r.isEqual(e)||Go("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function cy(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var hy=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return At(e,t),e.prototype.convertBytes=function(t){return new fd(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Xp(this.firestore,null,e)},e}(uy),ly=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=Ed(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=fy(t,this._firestore),i=cy(r.converter,e,n),o=Id(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,Ba.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=fy(t,this._firestore);return o="string"==typeof(e=Qt(e))||e instanceof ld?kd(this._dataReader,"WriteBatch.update",s._key,e,n,r):Cd(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,Ba.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=fy(t,this._firestore);return this._mutations=this._mutations.concat(new ru(e._key,Ba.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new Bo(jo.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function fy(t,e){if((t=Qt(t)).firestore!==e)throw new Bo(jo.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var py=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return At(e,t),e.prototype.convertBytes=function(t){return new fd(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Xp(this.firestore,null,e)},e}(uy);function dy(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Hp(t,Xp);var o=Hp(t.firestore,sd),s=Ed(o);return gy(o,[("string"==typeof(e=Qt(e))||e instanceof ld?kd(s,"updateDoc",t._key,e,n,r):Cd(s,"updateDoc",t._key,e)).toMutation(t._key,Ba.exists(!0))])}function yy(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=Qt(t);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||od(i[a])||(s=i[a],a++);var u,c,h,l={includeMetadataChanges:s.includeMetadataChanges};if(od(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof Xp)c=Hp(t.firestore,sd),h=ha(t._key.path),u={next:function(e){i[a]&&i[a](vy(c,t,e))},error:i[a+1],complete:i[a+2]};else{var p=Hp(t,Jp);c=Hp(p.firestore,sd),h=p._query;var d=new py(c);u={next:function(t){i[a]&&i[a](new Hd(c,d,p,t))},error:i[a+1],complete:i[a+2]},Yd(t._query)}return function(t,e,n,r){var i=this,o=new vp(r),s=new Cf(e,o,n);return t.asyncQueue.enqueueAndForget((function(){return Dt(i,void 0,void 0,(function(){var e;return Ct(this,(function(n){switch(n.label){case 0:return e=_f,[4,Cp(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))})),function(){o.Wo(),t.asyncQueue.enqueueAndForget((function(){return Dt(i,void 0,void 0,(function(){var e;return Ct(this,(function(n){switch(n.label){case 0:return e=Sf,[4,Cp(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))}))}}(ad(c),h,l,u)}function gy(t,e){return function(t,e){var n=this,r=new Rc;return t.asyncQueue.enqueueAndForget((function(){return Dt(n,void 0,void 0,(function(){var n;return Ct(this,(function(i){switch(i.label){case 0:return n=Uf,[4,Dp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(ad(t),e)}function vy(t,e,n){var r=n.docs.get(e._key),i=new py(t);return new $d(t,i,e._key,r,new zd(n.hasPendingWrites,n.fromCache),e.converter)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var my=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return At(e,t),e.prototype.get=function(e){var n=this,r=fy(e,this._firestore),i=new py(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new $d(n._firestore,i,r._key,t._document,new zd(!1,!1),r.converter)}))},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=Ed(t)}return t.prototype.get=function(t){var e=this,n=fy(t,this._firestore),r=new hy(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return Wo();var i=t[0];if(i.isFoundDocument())return new jd(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new jd(e._firestore,r,n._key,null,n.converter);throw Wo()}))},t.prototype.set=function(t,e,n){var r=fy(t,this._firestore),i=cy(r.converter,e,n),o=Id(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=fy(t,this._firestore);return o="string"==typeof(e=Qt(e))||e instanceof ld?kd(this._dataReader,"Transaction.update",s._key,e,n,r):Cd(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=fy(t,this._firestore);return this._transaction.delete(e._key),this},t}());
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function by(){if("undefined"==typeof Uint8Array)throw new Bo(jo.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function wy(){if("undefined"==typeof atob)throw new Bo(jo.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Ey=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return wy(),new t(fd.fromBase64String(e))},t.fromUint8Array=function(e){return by(),new t(fd.fromUint8Array(e))},t.prototype.toBase64=function(){return wy(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return by(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),Iy=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){hd(t=Hp(t,sd));var n=ad(t),r=t._freezeSettings(),i=new gp;return cd(n,i,new dp(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){hd(t=Hp(t,sd));var e=ad(t),n=t._freezeSettings(),r=new gp;return cd(e,r,new yp(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new Bo(jo.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Rc;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return Dt(e,void 0,void 0,(function(){var e;return Ct(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return Dt(this,void 0,void 0,(function(){var e;return Ct(this,(function(n){switch(n.label){case 0:return Pc.yt()?(e=t+"main",[4,Pc.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(Gh(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),Ty=function(){function t(t,e,n){var r=this;this._delegate=e,this.Zc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof Op||(this.tu=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||Ho("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){var i;void 0===r&&(r={});var o=(t=Hp(t,Yp))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==e&&Ho("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},o),{host:e+":"+n,ssl:!1})),r.mockUserToken){var s,a;if("string"==typeof r.mockUserToken)s=r.mockUserToken,a=bl.MOCK_USER;else{s=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var o=Nt({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Pt(JSON.stringify({alg:"none",type:"JWT"})),Pt(JSON.stringify(o)),""].join(".")}(r.mockUserToken,null===(i=t._app)||void 0===i?void 0:i.options.projectId);var u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new Bo(jo.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new bl(u)}t._credentials=new Mp(new Pp(s,a))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return Dt(e,void 0,void 0,(function(){var e,n;return Ct(this,(function(r){switch(r.label){case 0:return[4,Sp(t)];case 1:return e=r.sent(),[4,Np(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=Xo(t);return e.Or.delete(0),$l(e)}(n))]}}))}))}))}(ad(Hp(this._delegate,sd)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return Dt(e,void 0,void 0,(function(){var e,n;return Ct(this,(function(r){switch(r.label){case 0:return[4,Sp(t)];case 1:return e=r.sent(),[4,Np(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return Dt(this,void 0,void 0,(function(){var e;return Ct(this,(function(n){switch(n.label){case 0:return(e=Xo(t)).Or.add(0),[4,Gl(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(ad(Hp(this._delegate,sd)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Kp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Zc.enableMultiTabIndexedDbPersistence(this):this.Zc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Zc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.tu&&(this.tu._removeServiceInstance("firestore"),this.tu._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Rc;return t.asyncQueue.enqueueAndForget((function(){return Dt(e,void 0,void 0,(function(){var e;return Ct(this,(function(r){switch(r.label){case 0:return e=$f,[4,Dp(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(ad(Hp(this._delegate,sd)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new vp(e);return t.asyncQueue.enqueueAndForget((function(){return Dt(n,void 0,void 0,(function(){var e;return Ct(this,(function(n){switch(n.label){case 0:return e=function(t,e){Xo(t).Gr.add(e),e.next()},[4,Cp(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Wo(),t.asyncQueue.enqueueAndForget((function(){return Dt(n,void 0,void 0,(function(){var e;return Ct(this,(function(n){switch(n.label){case 0:return e=function(t,e){Xo(t).Gr.delete(e)},[4,Cp(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(ad(t=Hp(t,sd)),od(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.tu)throw new Bo(jo.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.tu},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new My(this,td(this._delegate,t))}catch(t){throw Cy(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new Dy(this,ed(this._delegate,t))}catch(t){throw Cy(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new Ly(this,function(t,e){if(t=Hp(t,Yp),jp("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Bo(jo.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Jp(t,null,function(t){return new ua(cs.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw Cy(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Rc;return t.asyncQueue.enqueueAndForget((function(){return Dt(n,void 0,void 0,(function(){var n;return Ct(this,(function(i){switch(i.label){case 0:return[4,function(t){return _p(t).then((function(t){return t.datastore}))}(t)];case 1:return n=i.sent(),new bp(t.asyncQueue,n,e,r).run(),[2]}}))}))})),r.promise}(ad(t),(function(n){return e(new my(t,n))}))}(this._delegate,(function(n){return t(new Sy(e,n))}))},t.prototype.batch=function(){var t=this;return ad(this._delegate),new Ay(new ly(this._delegate,(function(e){return gy(t._delegate,e)})))},t.prototype.loadBundle=function(t){throw new Bo(jo.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new Bo(jo.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),_y=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return At(e,t),e.prototype.convertBytes=function(t){return new Ey(new fd(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return Dy.eu(e,this.firestore,null)},e}(uy);var Sy=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new _y(t)}return t.prototype.get=function(t){var e=this,n=Vy(t);return this._delegate.get(n).then((function(t){return new Ry(e._firestore,new $d(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))}))},t.prototype.set=function(t,e,n){var r=Vy(t);return n?(Bp("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Vy(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Rt([s,e,n],i)),this},t.prototype.delete=function(t){var e=Vy(t);return this._delegate.delete(e),this},t}(),Ay=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=Vy(t);return n?(Bp("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Vy(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,Rt([s,e,n],i)),this},t.prototype.delete=function(t){var e=Vy(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),Ny=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new Gd(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Oy(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.nu=function(e,n){var r=t.su,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new _y(e),n),i.set(n,o)),o},t}();Ny.su=new WeakMap;var Dy=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new _y(t)}return t.iu=function(e,n,r){if(e.length%2!=0)throw new Bo(jo.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new Xp(n._delegate,r,new _s(e)))},t.eu=function(e,n,r){return new t(n,new Xp(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new My(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new My(this.firestore,td(this._delegate,t))}catch(t){throw Cy(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=Qt(t))instanceof Xp&&nd(this._delegate,t)},t.prototype.set=function(t,e){e=Bp("DocumentReference.set",e);try{return function(t,e,n){t=Hp(t,Xp);var r=Hp(t.firestore,sd),i=cy(t.converter,e,n);return gy(r,[Id(Ed(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,Ba.none())])}(this._delegate,t,e)}catch(t){throw Cy(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?dy(this._delegate,t):dy.apply(void 0,Rt([this._delegate,t,e],n))}catch(t){throw Cy(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return gy(Hp((t=this._delegate).firestore,sd),[new ru(t._key,Ba.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=ky(e),i=xy(e,(function(e){return new Ry(t.firestore,new $d(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}));return yy(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Hp(t,Xp);var e=Hp(t.firestore,sd),n=ad(e),r=new py(e);return function(t,e){var n=this,r=new Rc;return t.asyncQueue.enqueueAndForget((function(){return Dt(n,void 0,void 0,(function(){var n;return Ct(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Dt(this,void 0,void 0,(function(){var r,i;return Ct(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=Xo(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Mn.mn(t,e)}))}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new Bo(jo.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=mf(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,Ap(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._key).then((function(n){return new $d(e,r,t._key,n,new zd(null!==n&&n.hasLocalMutations,!0),t.converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Hp(t,Xp);var e=Hp(t.firestore,sd);return kp(ad(e),t._key,{source:"server"}).then((function(n){return vy(e,t,n)}))}(this._delegate):function(t){t=Hp(t,Xp);var e=Hp(t.firestore,sd);return kp(ad(e),t._key).then((function(n){return vy(e,t,n)}))}(this._delegate)).then((function(t){return new Ry(e.firestore,new $d(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}))},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Ny.nu(this.firestore,e)):this._delegate.withConverter(null))},t}();function Cy(t,e,n){return t.message=t.message.replace(e,n),t}function ky(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!od(r))return r}return{}}function xy(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=od(t[0])?t[0]:od(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Ry=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new Dy(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return Wd(this._delegate,t._delegate)},t}(),Oy=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return At(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(Ry),Ly=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new _y(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,Jd(this._delegate,function(t,e,n){var r=e,i=Kd("where",t);return new Zd(i,r,n)}(e,n,r)))}catch(e){throw Cy(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,Jd(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=Kd("orderBy",t);return new ty(r,n)}(e,n)))}catch(e){throw Cy(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,Jd(this._delegate,function(t){return Qp("limit",t),new ey("limit",t,"F")}(e)))}catch(e){throw Cy(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,Jd(this._delegate,function(t){return Qp("limitToLast",t),new ey("limitToLast",t,"L")}(e)))}catch(e){throw Cy(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Jd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ny("startAt",t,!0)}.apply(void 0,e)))}catch(e){throw Cy(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Jd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ny("startAfter",t,!1)}.apply(void 0,e)))}catch(e){throw Cy(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Jd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ry("endBefore",t,!0)}.apply(void 0,e)))}catch(e){throw Cy(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Jd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ry("endAt",t,!1)}.apply(void 0,e)))}catch(e){throw Cy(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return rd(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Hp(t,Jp);var e=Hp(t.firestore,sd),n=ad(e),r=new py(e);return function(t,e){var n=this,r=new Rc;return t.asyncQueue.enqueueAndForget((function(){return Dt(n,void 0,void 0,(function(){var n;return Ct(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return Dt(this,void 0,void 0,(function(){var r,i,o,s,a;return Ct(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,ol(t,e,!0)];case 1:return a=u.sent(),r=new Rf(e,a.Bn),i=r._o(a.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=u.sent(),a=mf(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}}))}))},[4,Ap(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._query).then((function(n){return new Hd(e,r,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Hp(t,Jp);var e=Hp(t.firestore,sd),n=ad(e),r=new py(e);return xp(n,t._query,{source:"server"}).then((function(n){return new Hd(e,r,t,n)}))}(this._delegate):function(t){t=Hp(t,Jp);var e=Hp(t.firestore,sd),n=ad(e),r=new py(e);return Yd(t._query),xp(n,t._query).then((function(n){return new Hd(e,r,t,n)}))}(this._delegate)).then((function(t){return new Fy(e.firestore,new Hd(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=ky(e),i=xy(e,(function(e){return new Fy(t.firestore,new Hd(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return yy(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Ny.nu(this.firestore,e)):this._delegate.withConverter(null))},t}(),Py=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new Oy(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),Fy=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new Ly(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new Oy(t._firestore,e)}))},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new Py(e._firestore,t)}))},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new Oy(n._firestore,r))}))},t.prototype.isEqual=function(t){return Wd(this._delegate,t._delegate)},t}(),My=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return At(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new Dy(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Dy(this.firestore,void 0===t?ed(this._delegate):ed(this._delegate,t))}catch(t){throw Cy(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Hp(t.firestore,sd),r=ed(t),i=cy(t.converter,e);return gy(n,[Id(Ed(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,Ba.exists(!1))]).then((function(){return r}))}(this._delegate,t).then((function(t){return new Dy(e.firestore,t)}))},e.prototype.isEqual=function(t){return nd(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(Ny.nu(this.firestore,t)):this._delegate.withConverter(null))},e}(Ly);function Vy(t){return Hp(t,Xp)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Uy,qy=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(ld.bind.apply(ld,Rt([void 0],t)))}return t.documentId=function(){return new t(ls.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=Qt(t))instanceof ld&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),jy=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new Sd("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new Td("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ad("arrayUnion",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Nd("arrayRemove",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new Dd("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}(),By={Firestore:Ty,GeoPoint:dd,Timestamp:rs,Blob:Ey,Transaction:Sy,WriteBatch:Ay,DocumentReference:Dy,DocumentSnapshot:Ry,Query:Ly,QueryDocumentSnapshot:Oy,QuerySnapshot:Fy,CollectionReference:My,FieldPath:qy,FieldValue:jy,setLogLevel:function(t){var e;e=t,Ko.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new Wt("firestore",(function(t){return function(t,e){return new Ty(t,new sd(t,e),new Iy)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},By)))})(Uy=Te),Uy.registerVersion("@firebase/firestore","2.4.0");Te.initializeApp({projectId:"sample-project-294713"});const Ky=function(){const t=window.location.search;let e;if(t)e=t.substring(1);else{const t=_t();window.location.hash=t,window.history.replaceState("","","?"+t),e=t}return e}(),zy=Te.firestore().collection("rooms").doc(Ky),$y=function(){const{subscribe:t,set:e}=gt([]);return{subscribe:t,set:e,append:(t,e)=>{zy.get().then((n=>{let r=[],i={closed:!0};if(n&&n.exists){const e=n.data();r=[...e.estimates.filter((e=>e.name!==t))],i=e.tableState}r.push({name:t,point:e,appendedAt:Te.firestore.Timestamp.now()}),zy.set({estimates:r,tableState:i})}))},remove:(t,e=null)=>{zy.get().then((n=>{if(n&&n.exists){const r=n.data();r.estimates=r.estimates.filter((e=>e.name!==t)),zy.set(r).then(e)}else e()}))},clear:()=>{zy.delete()}}}(),Gy=function(){const{subscribe:t,set:e,update:n}=gt({closed:!0});return{subscribe:t,set:e,open:()=>{zy.get().then((t=>{if(t&&t.exists){const e=t.data();e.tableState={closed:!1},zy.set(e)}}))},close:()=>{zy.delete()}}}(),Hy=new Promise((t=>{zy.onSnapshot((t=>{if(t&&t.exists){const e=t.data(),n=(t,e)=>t.appendedAt.seconds-e.appendedAt.seconds;$y.set(e.estimates.sort(n)),Gy.set(e.tableState)}else $y.set([]),Gy.set({closed:!0})})),t()}));function Qy(e){let n,r,i,s,a,c=(e[3]?"":e[0])+"";return{c(){n=b("div"),r=w(c),_(n,"class",i=u("card "+e[4])+" svelte-1lt9def"),D(n,"selectable",e[1]),D(n,"closed",e[3]),D(n,"selected",e[2])},m(t,i){v(t,n,i),d(n,r),s||(a=I(n,"click",(function(){o(e[1]?e[5]:void 0)&&(e[1]?e[5]:void 0).apply(this,arguments)})),s=!0)},p(t,[o]){e=t,9&o&&c!==(c=(e[3]?"":e[0])+"")&&S(r,c),16&o&&i!==(i=u("card "+e[4])+" svelte-1lt9def")&&_(n,"class",i),18&o&&D(n,"selectable",e[1]),24&o&&D(n,"closed",e[3]),20&o&&D(n,"selected",e[2])},i:t,o:t,d(t){t&&m(n),s=!1,a()}}}function Wy(t,e,n){let{point:r}=e,{selectable:i=!1}=e,{selected:o=!1}=e,{closed:s=!1}=e,{size:a="medium"}=e;const u=function(){const t=F();return(e,n)=>{const r=t.$$.callbacks[e];if(r){const i=C(e,n);r.slice().forEach((e=>{e.call(t,i)}))}}}();return t.$$set=t=>{"point"in t&&n(0,r=t.point),"selectable"in t&&n(1,i=t.selectable),"selected"in t&&n(2,o=t.selected),"closed"in t&&n(3,s=t.closed),"size"in t&&n(4,a=t.size)},[r,i,o,s,a,function(){u("selectCard",{point:r})}]}class Yy extends ft{constructor(t){super(),lt(this,t,Wy,Qy,s,{point:0,selectable:1,selected:2,closed:3,size:4})}}function Xy(e){let n,r,i,o,s=e[0]?"OPEN":"RETURN";return{c(){n=b("button"),r=w(s),_(n,"class",u("open-button")+" svelte-2fsuv3")},m(t,s){v(t,n,s),d(n,r),i||(o=I(n,"click",e[1]),i=!0)},p(t,[e]){1&e&&s!==(s=t[0]?"OPEN":"RETURN")&&S(r,s)},i:t,o:t,d(t){t&&m(n),i=!1,o()}}}function Jy(t,e,n){let{isClosed:r=!0}=e;return t.$$set=t=>{"isClosed"in t&&n(0,r=t.isClosed)},[r,function(e){M.call(this,t,e)}]}class Zy extends ft{constructor(t){super(),lt(this,t,Jy,Xy,s,{isClosed:0})}}function tg(e){let n,r,i,o,s,a,c=e[0]?"COPIED":"COPY";return{c(){n=b("button"),r=w(c),_(n,"class",i=u(["copy-button",e[0]?"copied":""].join(" "))+" svelte-1tdg2ne"),n.disabled=o=!!e[0]},m(t,i){v(t,n,i),d(n,r),s||(a=I(n,"click",e[1]),s=!0)},p(t,[e]){1&e&&c!==(c=t[0]?"COPIED":"COPY")&&S(r,c),1&e&&i!==(i=u(["copy-button",t[0]?"copied":""].join(" "))+" svelte-1tdg2ne")&&_(n,"class",i),1&e&&o!==(o=!!t[0])&&(n.disabled=o)},i:t,o:t,d(t){t&&m(n),s=!1,a()}}}function eg(t,e,n){let{isCopied:r=!1}=e;return t.$$set=t=>{"isCopied"in t&&n(0,r=t.isCopied)},[r,function(e){M.call(this,t,e)}]}class ng extends ft{constructor(t){super(),lt(this,t,eg,tg,s,{isCopied:0})}}function rg(t,e,n){const r=t.slice();return r[6]=e[n],r}function ig(t,e){let n,r,i,o,s,a,u,c,h=e[6].name+"";return r=new Yy({props:{point:e[6].point,size:"large",selectable:!1,closed:e[2].closed}}),{key:t,first:null,c(){n=b("div"),at(r.$$.fragment),i=E(),o=b("div"),s=w(h),a=E(),_(o,"class","name svelte-i2wlfs"),_(n,"class","estimate svelte-i2wlfs"),this.first=n},m(t,e){v(t,n,e),ut(r,n,null),d(n,i),d(n,o),d(o,s),d(n,a),c=!0},p(t,n){e=t;const i={};2&n&&(i.point=e[6].point),4&n&&(i.closed=e[2].closed),r.$set(i),(!c||2&n)&&h!==(h=e[6].name+"")&&S(s,h)},i(t){c||(et(r.$$.fragment,t),z((()=>{u||(u=it(n,dt,{y:100},!0)),u.run(1)})),c=!0)},o(t){nt(r.$$.fragment,t),u||(u=it(n,dt,{y:100},!1)),u.run(0),c=!1},d(t){t&&m(n),ct(r),t&&u&&u.end()}}}function og(t){let e,n,r;return n=new Zy({props:{isClosed:t[2].closed}}),n.$on("click",t[3]),{c(){e=b("div"),at(n.$$.fragment),_(e,"class","open-button-area svelte-i2wlfs")},m(t,i){v(t,e,i),ut(n,e,null),r=!0},p(t,e){const r={};4&e&&(r.isClosed=t[2].closed),n.$set(r)},i(t){r||(et(n.$$.fragment,t),r=!0)},o(t){nt(n.$$.fragment,t),r=!1},d(t){t&&m(e),ct(n)}}}function sg(t){let e,n;return e=new ng({props:{isCopied:t[0]}}),e.$on("click",t[4]),{c(){at(e.$$.fragment)},m(t,r){ut(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.isCopied=t[0]),e.$set(r)},i(t){n||(et(e.$$.fragment,t),n=!0)},o(t){nt(e.$$.fragment,t),n=!1},d(t){ct(e,t)}}}function ag(t){let e,n,r,i,o,s=[],a=new Map,u=t[1];const c=t=>t[6].name;for(let e=0;e<u.length;e+=1){let n=rg(t,u,e),r=c(n);a.set(r,s[e]=ig(r,n))}let h=(t[1].length>0||!t[2].closed)&&og(t),l=!t[2].closed&&sg(t);return{c(){e=b("div"),n=b("div");for(let t=0;t<s.length;t+=1)s[t].c();r=E(),h&&h.c(),i=E(),l&&l.c(),_(n,"class","estimates svelte-i2wlfs"),_(e,"class","table svelte-i2wlfs")},m(t,a){v(t,e,a),d(e,n);for(let t=0;t<s.length;t+=1)s[t].m(n,null);d(e,r),h&&h.m(e,null),d(e,i),l&&l.m(e,null),o=!0},p(t,[r]){6&r&&(u=t[1],Z(),s=function(t,e,n,r,i,o,s,a,u,c,h,l){let f=t.length,p=o.length,d=f;const y={};for(;d--;)y[t[d].key]=d;const g=[],v=new Map,m=new Map;for(d=p;d--;){const t=l(i,o,d),a=n(t);let u=s.get(a);u?r&&u.p(t,e):(u=c(a,t),u.c()),v.set(a,g[d]=u),a in y&&m.set(a,Math.abs(d-y[a]))}const b=new Set,w=new Set;function E(t){et(t,1),t.m(a,h),s.set(t.key,t),h=t.first,p--}for(;f&&p;){const e=g[p-1],n=t[f-1],r=e.key,i=n.key;e===n?(h=e.first,f--,p--):v.has(i)?!s.has(r)||b.has(r)?E(e):w.has(i)?f--:m.get(r)>m.get(i)?(w.add(r),E(e)):(b.add(i),f--):(u(n,s),f--)}for(;f--;){const e=t[f];v.has(e.key)||u(e,s)}for(;p;)E(g[p-1]);return g}(s,r,c,1,t,u,a,n,st,ig,null,rg),tt()),t[1].length>0||!t[2].closed?h?(h.p(t,r),6&r&&et(h,1)):(h=og(t),h.c(),et(h,1),h.m(e,i)):h&&(Z(),nt(h,1,1,(()=>{h=null})),tt()),t[2].closed?l&&(Z(),nt(l,1,1,(()=>{l=null})),tt()):l?(l.p(t,r),4&r&&et(l,1)):(l=sg(t),l.c(),et(l,1),l.m(e,null))},i(t){if(!o){for(let t=0;t<u.length;t+=1)et(s[t]);et(h),et(l),o=!0}},o(t){for(let t=0;t<s.length;t+=1)nt(s[t]);nt(h),nt(l),o=!1},d(t){t&&m(e);for(let t=0;t<s.length;t+=1)s[t].d();h&&h.d(),l&&l.d()}}}function ug(t,e,n){let r,i;a(t,$y,(t=>n(1,r=t))),a(t,Gy,(t=>n(2,i=t)));let o=!1;return[o,r,i,function(t){i.closed?r.length>0&&Gy.open():($y.clear(),Gy.close())},function(t){const e=function(){if(0===r.length)return"empty.";const t=new Date;return"["+t.toLocaleDateString()+" "+t.toLocaleTimeString()+"] "+r.sort(((t,e)=>t.name>e.name?1:-1)).reduce(((t,e)=>(t?t+" ":"")+`${e.name}(${e.point})`),null)}();navigator.clipboard.writeText(e),n(0,o=!0),setTimeout((()=>{n(0,o=!1)}),1e3)}]}class cg extends ft{constructor(t){super(),lt(this,t,ug,ag,s,{})}}function hg(e){let n,r,i;return{c(){n=b("button"),n.textContent="OK",_(n,"class",u("ok-button")+" svelte-1hvp3ls")},m(t,o){v(t,n,o),r||(i=I(n,"click",e[0]),r=!0)},p:t,i:t,o:t,d(t){t&&m(n),r=!1,i()}}}function lg(t){return[function(e){M.call(this,t,e)}]}class fg extends ft{constructor(t){super(),lt(this,t,lg,hg,s,{})}}function pg(t,e,n){const r=t.slice();return r[8]=e[n],r}function dg(t){let e,n,r,o,s,a,u,c=t[1]&&gg(t);return{c(){e=b("div"),n=b("form"),r=b("input"),o=E(),c&&c.c(),_(r,"placeholder","your name"),r.autofocus=!0,_(r,"class","svelte-3jrjlv"),_(e,"class","user-name svelte-3jrjlv")},m(i,h){v(i,e,h),d(e,n),d(n,r),A(r,t[1]),d(n,o),c&&c.m(n,null),s=!0,r.focus(),a||(u=[I(r,"input",t[7]),I(n,"submit",T(t[4]))],a=!0)},p(t,e){2&e&&r.value!==t[1]&&A(r,t[1]),t[1]?c?(c.p(t,e),2&e&&et(c,1)):(c=gg(t),c.c(),et(c,1),c.m(n,null)):c&&(Z(),nt(c,1,1,(()=>{c=null})),tt())},i(t){s||(et(c),s=!0)},o(t){nt(c),s=!1},d(t){t&&m(e),c&&c.d(),a=!1,i(u)}}}function yg(t){let e,n,r,i,o,s=t[3],a=[];for(let e=0;e<s.length;e+=1)a[e]=vg(pg(t,s,e));const u=t=>nt(a[t],1,1,(()=>{a[t]=null}));return{c(){e=b("div"),n=w(t[0]),r=E();for(let t=0;t<a.length;t+=1)a[t].c();i=w(""),_(e,"class","user-name svelte-3jrjlv")},m(t,s){v(t,e,s),d(e,n),v(t,r,s);for(let e=0;e<a.length;e+=1)a[e].m(t,s);v(t,i,s),o=!0},p(t,e){if((!o||1&e)&&S(n,t[0]),44&e){let n;for(s=t[3],n=0;n<s.length;n+=1){const r=pg(t,s,n);a[n]?(a[n].p(r,e),et(a[n],1)):(a[n]=vg(r),a[n].c(),et(a[n],1),a[n].m(i.parentNode,i))}for(Z(),n=s.length;n<a.length;n+=1)u(n);tt()}},i(t){if(!o){for(let t=0;t<s.length;t+=1)et(a[t]);o=!0}},o(t){a=a.filter(Boolean);for(let t=0;t<a.length;t+=1)nt(a[t]);o=!1},d(t){t&&m(e),t&&m(r),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(a,t),t&&m(i)}}}function gg(e){let n,r;return n=new fg({}),n.$on("click",e[4]),{c(){at(n.$$.fragment)},m(t,e){ut(n,t,e),r=!0},p:t,i(t){r||(et(n.$$.fragment,t),r=!0)},o(t){nt(n.$$.fragment,t),r=!1},d(t){ct(n,t)}}}function vg(t){let e,n;return e=new Yy({props:{point:t[8],selectable:!0,size:"medium",selected:t[2]===t[8]}}),e.$on("selectCard",t[5]),{c(){at(e.$$.fragment)},m(t,r){ut(e,t,r),n=!0},p(t,n){const r={};4&n&&(r.selected=t[2]===t[8]),e.$set(r)},i(t){n||(et(e.$$.fragment,t),n=!0)},o(t){nt(e.$$.fragment,t),n=!1},d(t){ct(e,t)}}}function mg(t){let e,n,r,i;const o=[yg,dg],s=[];function a(t,e){return t[0]?0:1}return n=a(t),r=s[n]=o[n](t),{c(){e=b("div"),r.c(),_(e,"class","svelte-3jrjlv")},m(t,r){v(t,e,r),s[n].m(e,null),i=!0},p(t,[i]){let u=n;n=a(t),n===u?s[n].p(t,i):(Z(),nt(s[u],1,1,(()=>{s[u]=null})),tt(),r=s[n],r?r.p(t,i):(r=s[n]=o[n](t),r.c()),et(r,1),r.m(e,null))},i(t){i||(et(r),i=!0)},o(t){nt(r),i=!1},d(t){t&&m(e),s[n].d()}}}function bg(t,e,n){let r,i;a(t,$y,(t=>n(6,i=t)));let o,s=window.localStorage.name;return t.$$.update=()=>{65&t.$$.dirty&&n(2,r=i.filter((t=>t.name===o)).map((t=>t.point)).pop())},[o,s,r,["0","1","2","3","5","8","13","21","34","55","?",""],function(t){s&&(n(0,o=s),window.localStorage.setItem("name",o))},function(t){const e=()=>$y.append(o,t.detail.point);r?$y.remove(o,r===t.detail.point?null:()=>setTimeout(e,300)):e()},i,function(){s=this.value,n(1,s)}]}class wg extends ft{constructor(t){super(),lt(this,t,bg,mg,s,{})}}function Eg(e){let n;return{c(){n=b("div"),n.innerHTML='<a href="https://unsplash.com" target="_blank" rel="noopener noreferrer" title="Photo by Unsplash"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="_1Jlgk" version="1.1" viewBox="0 0 32 32" aria-labelledby="unsplash-home" aria-hidden="false"><path d="M10 9V0h12v9H10zm12 5h10v18H0V14h10v9h12v-9z"></path></svg></a>',_(n,"class","unsplash-credit svelte-1vmngv8")},m(t,e){v(t,n,e)},p:t,i:t,o:t,d(t){t&&m(n)}}}class Ig extends ft{constructor(t){super(),lt(this,t,null,Eg,s,{})}}const{document:Tg}=ot;function _g(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function Sg(t){let e,n,r,i,o,s,a,u,c;return s=new cg({}),u=new wg({}),{c(){e=b("h1"),n=w(t[0]),r=E(),i=b("p"),i.textContent="share the URL of this page with your team members.",o=E(),at(s.$$.fragment),a=E(),at(u.$$.fragment),_(e,"class","svelte-1d5hlxr"),_(i,"class","svelte-1d5hlxr")},m(t,h){v(t,e,h),d(e,n),v(t,r,h),v(t,i,h),v(t,o,h),ut(s,t,h),v(t,a,h),ut(u,t,h),c=!0},p(t,e){(!c||1&e)&&S(n,t[0])},i(t){c||(et(s.$$.fragment,t),et(u.$$.fragment,t),c=!0)},o(t){nt(s.$$.fragment,t),nt(u.$$.fragment,t),c=!1},d(t){t&&m(e),t&&m(r),t&&m(i),t&&m(o),ct(s,t),t&&m(a),ct(u,t)}}}function Ag(e){let n;return{c(){n=b("p"),n.textContent="...waiting",_(n,"class","svelte-1d5hlxr")},m(t,e){v(t,n,e)},p:t,i:t,o:t,d(t){t&&m(n)}}}function Ng(t){let e,n,r,o,s,a,u,c,h;Tg.title=e=t[0];let l={ctx:t,current:null,token:null,hasCatch:!1,pending:Ag,then:Sg,catch:_g,blocks:[,,,]};return function(t,e){const n=e.token={};function r(t,r,i,o){if(e.token!==n)return;e.resolved=o;let s=e.ctx;void 0!==i&&(s=s.slice(),s[i]=o);const a=t&&(e.current=t)(s);let u=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==r&&t&&(Z(),nt(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),tt())})):e.block.d(1),a.c(),et(a,1),a.m(e.mount(),e.anchor),u=!0),e.block=a,e.blocks&&(e.blocks[r]=a),u&&H()}if((i=t)&&"object"==typeof i&&"function"==typeof i.then){const n=F();if(t.then((t=>{P(n),r(e.then,1,e.value,t),P(null)}),(t=>{if(P(n),r(e.catch,2,e.error,t),P(null),!e.hasCatch)throw t})),e.current!==e.pending)return r(e.pending,0),!0}else{if(e.current!==e.then)return r(e.then,1,e.value,t),!0;e.resolved=t}var i}(Hy,l),a=new Ig({}),{c(){n=b("link"),r=E(),o=b("main"),l.block.c(),s=E(),at(a.$$.fragment),_(n,"href","https://fonts.googleapis.com/css?family=M+PLUS+1p"),_(n,"rel","stylesheet"),N(o,"height",t[1]),_(o,"class","svelte-1d5hlxr")},m(e,i){d(Tg.head,n),v(e,r,i),v(e,o,i),l.block.m(o,l.anchor=null),l.mount=()=>o,l.anchor=null,v(e,s,i),ut(a,e,i),u=!0,c||(h=[I(window,"resize",t[2]),I(window,"load",t[2])],c=!0)},p(n,[r]){t=n,(!u||1&r)&&e!==(e=t[0])&&(Tg.title=e),function(t,e,n){const r=e.slice(),{resolved:i}=t;t.current===t.then&&(r[t.value]=i),t.current===t.catch&&(r[t.error]=i),t.block.p(r,n)}(l,t,r),(!u||2&r)&&N(o,"height",t[1])},i(t){u||(et(l.block),et(a.$$.fragment,t),u=!0)},o(t){for(let t=0;t<3;t+=1){nt(l.blocks[t])}nt(a.$$.fragment,t),u=!1},d(t){m(n),t&&m(r),t&&m(o),l.block.d(),l.token=null,l=null,t&&m(s),ct(a,t),c=!1,i(h)}}}function Dg(t,e,n){let{name:r}=e,i=null;return t.$$set=t=>{"name"in t&&n(0,r=t.name)},[r,i,()=>{n(1,i=document.documentElement.offsetHeight<document.documentElement.scrollHeight?"auto":"100%")}]}return new class extends ft{constructor(t){super(),lt(this,t,Dg,Ng,s,{name:0})}}({target:document.body,props:{name:"Planning Poker"}})}();
//# sourceMappingURL=bundle.js.map
